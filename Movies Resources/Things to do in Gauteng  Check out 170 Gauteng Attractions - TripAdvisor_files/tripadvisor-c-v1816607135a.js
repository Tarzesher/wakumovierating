(function(){this.MooTools={version:"1.3.1dev",build:"%build%"};var p=this.typeOf=function(t){if(t==null){return"null"}if(t.$family){return t.$family()}if(t.nodeName){if(t.nodeType==1){return"element"}if(t.nodeType==3){return(/\S/).test(t.nodeValue)?"textnode":"whitespace"}}else{if(typeof t.length=="number"){if(t.callee){return"arguments"}if("item" in t){return"collection"}}}return typeof t};var j=this.instanceOf=function(v,t){if(v==null){return false}var u=v.$constructor||v.constructor;while(u){if(u===t){return true}u=u.parent}return v instanceof t};var g=this.Function;var q=true;for(var k in {toString:1}){q=null}if(q){q=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}g.prototype.overloadSetter=function(u){var t=this;return function(w,v){if(w==null){return this}if(u||typeof w!="string"){for(var y in w){t.call(this,y,w[y])}if(q){for(var z=q.length;z--;){y=q[z];if(w.hasOwnProperty(y)){t.call(this,y,w[y])}}}}else{t.call(this,w,v)}return this}};g.prototype.overloadGetter=function(u){var t=this;return function(w){var y,v;if(u||typeof w!="string"){y=w}else{if(arguments.length>1){y=arguments}}if(y){v={};for(var z=0;z<y.length;z++){v[y[z]]=t.call(this,y[z])}}else{v=t.call(this,w)}return v}};g.prototype.extend=function(t,u){this[t]=u}.overloadSetter();g.prototype.implement=function(t,u){this.prototype[t]=u}.overloadSetter();var o=Array.prototype.slice;g.from=function(t){return(p(t)=="function")?t:function(){return t}};Array.from=function(t){if(t==null){return[]}return(a.isEnumerable(t)&&typeof t!="string")?(p(t)=="array")?t:o.call(t):[t]};Number.from=function(u){var t=parseFloat(u);return isFinite(t)?t:null};String.from=function(t){return t+""};g.implement({hide:function(){this.$hidden=true;return this},protect:function(){this.$protected=true;return this}});var a=this.Type=function(w,v){if(w){var u=w.toLowerCase();var t=function(y){return(p(y)==u)};a["is"+w]=t;if(v!=null){v.prototype.$family=(function(){return u}).hide()}}if(v==null){return null}v.extend(this);v.$constructor=a;v.prototype.$constructor=v;return v};var f=Object.prototype.toString;a.isEnumerable=function(t){return(t!=null&&typeof t.length=="number"&&f.call(t)!="[object Function]")};var r={};var s=function(t){var u=p(t.prototype);return r[u]||(r[u]=[])};var b=function(u,z){if(z&&z.$hidden){return this}var t=s(this);for(var v=0;v<t.length;v++){var y=t[v];if(p(y)=="type"){b.call(y,u,z)}else{y.call(this,u,z)}}var w=this.prototype[u];if(w==null||!w.$protected){this.prototype[u]=z}if(this[u]==null&&p(z)=="function"){m.call(this,u,function(A){return z.apply(A,o.call(arguments,1))})}return this};var m=function(t,v){if(v&&v.$hidden){return this}var u=this[t];if(u==null||!u.$protected){this[t]=v}return this};a.implement({implement:b.overloadSetter(),extend:m.overloadSetter(),alias:function(t,u){b.call(this,t,this.prototype[u])}.overloadSetter(),mirror:function(t){s(this).push(t);return this}});new a("Type",a);var d=function(t,y,v){var u=(y!=Object),C=y.prototype;if(u){y=new a(t,y)}for(var z=0,w=v.length;z<w;z++){var D=v[z],B=y[D],A=C[D];if(B){B.protect()}if(u&&A){delete C[D];C[D]=A.protect()}}if(u){y.implement(C)}return d};d("String",String,["charAt","charCodeAt","concat","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",g,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]);Object.extend=m.overloadSetter();Date.extend("now",function(){return +(new Date)});new a("Boolean",Boolean);Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide();Number.extend("random",function(u,t){return Math.floor(Math.random()*(t-u+1)+u)});Object.extend("forEach",function(t,v,w){for(var u in t){if(t.hasOwnProperty(u)){v.call(w,t[u],u,t)}}});Object.each=Object.forEach;Array.implement({forEach:function(v,w){for(var u=0,t=this.length;u<t;u++){if(u in this){v.call(w,this[u],u,this)}}},each:function(t,u){Array.forEach(this,t,u);return this}});var l=function(t){switch(p(t)){case"array":return t.clone();case"object":return Object.clone(t);default:return t}};Array.implement("clone",function(){var t=this.length,u=new Array(t);while(t--){u[t]=l(this[t])}return u});var h=function(u,t,v){switch(p(v)){case"object":if(p(u[t])=="object"){Object.merge(u[t],v)}else{u[t]=Object.clone(v)}break;case"array":u[t]=v.clone();break;default:u[t]=v}return u};Object.extend({merge:function(B,w,u){if(p(w)=="string"){return h(B,w,u)}for(var A=1,t=arguments.length;A<t;A++){var y=arguments[A];for(var z in y){h(B,z,y[z])}}return B},clone:function(t){var v={};for(var u in t){v[u]=l(t[u])}return v},append:function(y){for(var w=1,u=arguments.length;w<u;w++){var t=arguments[w]||{};for(var v in t){y[v]=t[v]}}return y}});["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(t){new a(t)});var c=Date.now();String.extend("uniqueID",function(){return(c++).toString(36)})})();Array.implement({invoke:function(a){var b=Array.slice(arguments,1);return this.map(function(c){return c[a].apply(c,b)})},every:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&!c.call(d,this[b],b,this)){return false}}return true},filter:function(d,f){var c=[];for(var b=0,a=this.length;b<a;b++){if((b in this)&&d.call(f,this[b],b,this)){c.push(this[b])}}return c},clean:function(){return this.filter(function(a){return a!=null})},indexOf:function(c,d){var a=this.length;for(var b=(d<0)?Math.max(0,a+d):d||0;b<a;b++){if(this[b]===c){return b}}return -1},map:function(d,f){var c=[];for(var b=0,a=this.length;b<a;b++){if(b in this){c[b]=d.call(f,this[b],b,this)}}return c},some:function(c,d){for(var b=0,a=this.length;b<a;b++){if((b in this)&&c.call(d,this[b],b,this)){return true}}return false},associate:function(c){var d={},b=Math.min(this.length,c.length);for(var a=0;a<b;a++){d[c[a]]=this[a]}return d},link:function(c){var a={};for(var f=0,b=this.length;f<b;f++){for(var d in c){if(c[d](this[f])){a[d]=this[f];delete c[d];break}}}return a},contains:function(a,b){return this.indexOf(a,b)!=-1},append:function(a){this.push.apply(this,a);return this},getLast:function(){return(this.length)?this[this.length-1]:null},getRandom:function(){return(this.length)?this[Number.random(0,this.length-1)]:null},include:function(a){if(!this.contains(a)){this.push(a)}return this},combine:function(c){for(var b=0,a=c.length;b<a;b++){this.include(c[b])}return this},erase:function(b){for(var a=this.length;a--;){if(this[a]===b){this.splice(a,1)}}return this},empty:function(){this.length=0;return this},flatten:function(){var d=[];for(var b=0,a=this.length;b<a;b++){var c=typeOf(this[b]);if(c=="null"){continue}d=d.concat((c=="array"||c=="collection"||c=="arguments"||instanceOf(this[b],Array))?Array.flatten(this[b]):this[b])}return d},pick:function(){for(var b=0,a=this.length;b<a;b++){if(this[b]!=null){return this[b]}}return null},hexToRgb:function(b){if(this.length!=3){return null}var a=this.map(function(c){if(c.length==1){c+=c}return c.toInt(16)});return(b)?a:"rgb("+a+")"},rgbToHex:function(d){if(this.length<3){return null}if(this.length==4&&this[3]==0&&!d){return"transparent"}var b=[];for(var a=0;a<3;a++){var c=(this[a]-0).toString(16);b.push((c.length==1)?"0"+c:c)}return(d)?b:"#"+b.join("")}});var Event=new Type("Event",function(a,k){if(!k){k=window}var r=k.document;a=a||k.event;if(a.$extended){return a}this.$extended=true;var q=a.type,m=a.target||a.srcElement,p={},c={};while(m&&m.nodeType==3){m=m.parentNode}if(q.indexOf("key")!=-1){var b=a.which||a.keyCode;var t=Object.keyOf(Event.Keys,b);if(q=="keydown"){var d=b-111;if(d>0&&d<13){t="f"+d}}if(!t){t=String.fromCharCode(b).toLowerCase()}}else{if((/click|mouse|menu/i).test(q)){r=(!r.compatMode||r.compatMode=="CSS1Compat")?r.html:r.body;p={x:(a.pageX!=null)?a.pageX:a.clientX+r.scrollLeft,y:(a.pageY!=null)?a.pageY:a.clientY+r.scrollTop};c={x:(a.pageX!=null)?a.pageX-k.pageXOffset:a.clientX,y:(a.pageY!=null)?a.pageY-k.pageYOffset:a.clientY};if((/DOMMouseScroll|mousewheel/).test(q)){var o=(a.wheelDelta)?a.wheelDelta/120:-(a.detail||0)/3}var j=(a.which==3)||(a.button==2),s=null;if((/over|out/).test(q)){s=a.relatedTarget||a[(q=="mouseover"?"from":"to")+"Element"];var l=function(){while(s&&s.nodeType==3){s=s.parentNode}return true};var h=(Browser.firefox2)?l.attempt():l();s=(h)?s:null}}else{if((/gesture|touch/i).test(q)){this.rotation=a.rotation;this.scale=a.scale;this.targetTouches=a.targetTouches;this.changedTouches=a.changedTouches;var g=this.touches=a.touches;if(g&&g[0]){var f=g[0];p={x:f.pageX,y:f.pageY};c={x:f.clientX,y:f.clientY}}}else{if((/drag(enter|leave|over)|drop/i).test(q)){this.dataTransfer=a.dataTransfer}}}}return Object.append(this,{event:a,type:q,page:p,client:c,rightClick:j,wheel:o,relatedTarget:document.id(s),target:document.id(m),code:b,key:t,keyCode:a.keyCode,clientX:a.clientX,clientY:a.clientY,shift:a.shiftKey,control:a.ctrlKey,alt:a.altKey,meta:a.metaKey})});Event.Keys={enter:13,up:38,down:40,left:37,right:39,esc:27,space:32,backspace:8,tab:9,"delete":46};Event.implement({stop:function(){return this.stopPropagation().preventDefault()},stopPropagation:function(){if(this.event.stopPropagation){this.event.stopPropagation()}else{this.event.cancelBubble=true}return this},preventDefault:function(){if(this.event.preventDefault){this.event.preventDefault()}else{this.event.returnValue=false}return this}});Function.extend({attempt:function(){for(var b=0,a=arguments.length;b<a;b++){try{return arguments[b]()}catch(c){}}return null}});Function.implement({attempt:function(a,c){try{return this.apply(c,Array.from(a))}catch(b){}return null},bind:function(c){var a=this,b=(arguments.length>1)?Array.slice(arguments,1):null;return function(){if(!b&&!arguments.length){return a.call(c)}if(b&&arguments.length){return a.apply(c,b.concat(Array.from(arguments)))}return a.apply(c,b||arguments)}},pass:function(b,c){var a=this;if(b!=null){b=Array.from(b)}return function(){return a.apply(c,b||arguments)}},delay:function(b,c,a){return setTimeout(this.pass((a==null?[]:a),c),b)},periodical:function(c,b,a){return setInterval(this.pass((a==null?[]:a),b),c)}});Number.implement({limit:function(b,a){return Math.min(a,Math.max(b,this))},round:function(a){a=Math.pow(10,a||0).toFixed(a<0?-a:0);return Math.round(this*a)/a},times:function(b,c){for(var a=0;a<this;a++){b.call(c,a,this)}},toFloat:function(){return parseFloat(this)},toInt:function(a){return parseInt(this,a||10)}});Number.alias("each","times");(function(b){var a={};b.each(function(c){if(!Number[c]){a[c]=function(){return Math[c].apply(null,[this].concat(Array.from(arguments)))}}});Number.implement(a)})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);Object.extend({subset:function(c,g){var f={};for(var d=0,a=g.length;d<a;d++){var b=g[d];f[b]=c[b]}return f},map:function(a,d,f){var c={};for(var b in a){if(a.hasOwnProperty(b)){c[b]=d.call(f,a[b],b,a)}}return c},filter:function(a,c,d){var b={};Object.each(a,function(g,f){if(c.call(d,g,f,a)){b[f]=g}});return b},every:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&!c.call(d,a[b],b)){return false}}return true},some:function(a,c,d){for(var b in a){if(a.hasOwnProperty(b)&&c.call(d,a[b],b)){return true}}return false},keys:function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){c.push(b)}}return c},values:function(b){var a=[];for(var c in b){if(b.hasOwnProperty(c)){a.push(b[c])}}return a},getLength:function(a){return Object.keys(a).length},keyOf:function(a,c){for(var b in a){if(a.hasOwnProperty(b)&&a[b]===c){return b}}return null},contains:function(a,b){return Object.keyOf(a,b)!=null},toQueryString:function(a,b){var c=[];Object.each(a,function(h,g){if(b){g=b+"["+g+"]"}var f;switch(typeOf(h)){case"object":f=Object.toQueryString(h,g);break;case"array":var d={};h.each(function(k,j){d[j]=k});f=Object.toQueryString(d,g);break;default:f=g+"="+encodeURIComponent(h)}if(h!=null){c.push(f)}});return c.join("&")}});String.implement({test:function(a,b){return((typeOf(a)=="regexp")?a:new RegExp(""+a,b)).test(this)},contains:function(a,b){return(b)?(b+this+b).indexOf(b+a+b)>-1:this.indexOf(a)>-1},trim:function(){return this.replace(/^\s+|\s+$/g,"")},clean:function(){return this.replace(/\s+/g," ").trim()},camelCase:function(){return this.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},hyphenate:function(){return this.replace(/[A-Z]/g,function(a){return("-"+a.charAt(0).toLowerCase())})},capitalize:function(){return this.replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},escapeRegExp:function(){return this.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(b){var a=this.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(a)?a.slice(1).hexToRgb(b):null},rgbToHex:function(b){var a=this.match(/\d{1,3}/g);return(a)?a.rgbToHex(b):null},substitute:function(a,b){return this.replace(b||(/\\?\{([^{}]+)\}/g),function(d,c){if(d.charAt(0)=="\\"){return d.slice(1)}return(a[c]!=null)?a[c]:""})}});(function(){var m,q,o,h,a={},c={},p=/\\/g;var f=function(t,s){if(t==null){return null}if(t.Slick===true){return t}t=(""+t).replace(/^\s+|\s+$/g,"");h=!!s;var r=(h)?c:a;if(r[t]){return r[t]}m={Slick:true,expressions:[],raw:t,reverse:function(){return f(this.raw,true)}};q=-1;while(t!=(t=t.replace(l,b))){}m.length=m.expressions.length;return r[t]=(h)?j(m):m};var k=function(r){if(r==="!"){return" "}else{if(r===" "){return"!"}else{if((/^!/).test(r)){return r.replace(/^!/,"")}else{return"!"+r}}}};var j=function(y){var u=y.expressions;for(var s=0;s<u.length;s++){var w=u[s];var t={parts:[],tag:"*",combinator:k(w[0].combinator)};for(var r=0;r<w.length;r++){var v=w[r];if(!v.reverseCombinator){v.reverseCombinator=" "}v.combinator=v.reverseCombinator;delete v.reverseCombinator}w.reverse().push(t)}return y};var g=function(r){return r.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,"\\$&")};var l=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|:+(<unicode>+)(?:\\((?:(?:([\"'])([^\\12]*)\\12)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+g(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function b(B,v,H,D,u,G,t,F,E,C,y,J,z,s,A){if(v||q===-1){m.expressions[++q]=[];o=-1;if(v){return""}}if(H||D||o===-1){H=H||" ";var w=m.expressions[q];if(h&&w[o]){w[o].reverseCombinator=k(H)}w[++o]={combinator:H,tag:"*"}}var r=m.expressions[q][o];if(u){r.tag=u.replace(p,"")}else{if(G){r.id=G.replace(p,"")}else{if(t){t=t.replace(p,"");if(!r.classList){r.classList=[]}if(!r.classes){r.classes=[]}r.classList.push(t);r.classes.push({value:t,regexp:new RegExp("(^|\\s)"+g(t)+"(\\s|$)")})}else{if(J){A=A||s;A=A?A.replace(p,""):null;if(!r.pseudos){r.pseudos=[]}r.pseudos.push({key:J.replace(p,""),value:A})}else{if(F){F=F.replace(p,"");y=(y||"").replace(p,"");var I,K;switch(E){case"^=":K=new RegExp("^"+g(y));break;case"$=":K=new RegExp(g(y)+"$");break;case"~=":K=new RegExp("(^|\\s)"+g(y)+"(\\s|$)");break;case"|=":K=new RegExp("^"+g(y)+"(-|$)");break;case"=":I=function(L){return y==L};break;case"*=":I=function(L){return L&&L.indexOf(y)>-1};break;case"!=":I=function(L){return y!=L};break;default:I=function(L){return !!L}}if(y==""&&(/^[*$^]=$/).test(E)){I=function(){return false}}if(!I){I=function(L){return L&&K.test(L)}}if(!r.attributes){r.attributes=[]}r.attributes.push({key:F,operator:E,value:y,test:I})}}}}}return""}var d=(this.Slick||{});d.parse=function(r){return f(r)};d.escapeRegExp=g;if(!this.Slick){this.Slick=d}}).apply(this);(function(){var b={};b.isNativeCode=function(c){return(/\{\s*\[native code\]\s*\}/).test(""+c)};b.isXML=function(c){return(!!c.xmlVersion)||(!!c.xml)||(Object.prototype.toString.call(c)==="[object XMLDocument]")||(c.nodeType===9&&c.documentElement.nodeName!=="HTML")};b.setDocument=function(q){if(q.nodeType===9){}else{if(q.ownerDocument){q=q.ownerDocument}else{if(q.navigator){q=q.document}else{return}}}if(this.document===q){return}this.document=q;var r=this.root=q.documentElement;this.isXMLDocument=this.isXML(q);this.brokenStarGEBTN=this.starSelectsClosedQSA=this.idGetsName=this.brokenMixedCaseQSA=this.brokenGEBCN=this.brokenCheckedQSA=this.brokenEmptyAttributeQSA=this.isHTMLDocument=false;var k,l,s,m;var o,c;var t=q.createElement("div");r.appendChild(t);try{c="slick_getbyid_test";t.innerHTML='<a id="'+c+'"></a>';this.isHTMLDocument=!!q.getElementById(c)}catch(p){}if(this.isHTMLDocument){t.style.display="none";t.appendChild(q.createComment(""));l=(t.getElementsByTagName("*").length>0);try{t.innerHTML="foo</foo>";o=t.getElementsByTagName("*");k=(o&&o.length&&o[0].nodeName.charAt(0)=="/")}catch(p){}this.brokenStarGEBTN=l||k;if(t.querySelectorAll){try{t.innerHTML="foo</foo>";o=t.querySelectorAll("*");this.starSelectsClosedQSA=(o&&o.length&&o[0].nodeName.charAt(0)=="/")}catch(p){}}try{c="slick_id_gets_name";t.innerHTML='<a name="'+c+'"></a><b id="'+c+'"></b>';this.idGetsName=q.getElementById(c)===t.firstChild}catch(p){}try{t.innerHTML='<a class="MiXedCaSe"></a>';this.brokenMixedCaseQSA=!t.querySelectorAll(".MiXedCaSe").length}catch(p){}try{t.innerHTML='<a class="f"></a><a class="b"></a>';t.getElementsByClassName("b").length;t.firstChild.className="b";m=(t.getElementsByClassName("b").length!=2)}catch(p){}try{t.innerHTML='<a class="a"></a><a class="f b a"></a>';s=(t.getElementsByClassName("a").length!=2)}catch(p){}this.brokenGEBCN=m||s;try{t.innerHTML='<select><option selected="selected">a</option></select>';this.brokenCheckedQSA=(t.querySelectorAll(":checked").length==0)}catch(p){}try{t.innerHTML='<a class=""></a>';this.brokenEmptyAttributeQSA=(t.querySelectorAll('[class*=""]').length!=0)}catch(p){}}r.removeChild(t);t=null;this.hasAttribute=(r&&this.isNativeCode(r.hasAttribute))?function(v,u){return v.hasAttribute(u)}:function(v,u){v=v.getAttributeNode(u);return !!(v&&(v.specified||v.nodeValue))};this.contains=(r&&this.isNativeCode(r.contains))?function(u,v){return u.contains(v)}:(r&&r.compareDocumentPosition)?function(u,v){return u===v||!!(u.compareDocumentPosition(v)&16)}:function(u,v){if(v){do{if(v===u){return true}}while((v=v.parentNode))}return false};this.documentSorter=(r.compareDocumentPosition)?function(v,u){if(!v.compareDocumentPosition||!u.compareDocumentPosition){return 0}return v.compareDocumentPosition(u)&4?-1:v===u?0:1}:("sourceIndex" in r)?function(v,u){if(!v.sourceIndex||!u.sourceIndex){return 0}return v.sourceIndex-u.sourceIndex}:(q.createRange)?function(y,v){if(!y.ownerDocument||!v.ownerDocument){return 0}var w=y.ownerDocument.createRange(),u=v.ownerDocument.createRange();w.setStart(y,0);w.setEnd(y,0);u.setStart(v,0);u.setEnd(v,0);return w.compareBoundaryPoints(Range.START_TO_END,u)}:null;this.getUID=(this.isHTMLDocument)?this.getUIDHTML:this.getUIDXML};b.search=function(k,y,G,q){var w=this.found=(q)?null:(G||[]);if(!k){return w}if(k.navigator){k=k.document}else{if(!k.nodeType){return w}}var t,F;var o=this.uniques={};if(this.document!==(k.ownerDocument||k)){this.setDocument(k)}var z=!!(G&&G.length);if(z){for(F=w.length;F--;){this.uniques[this.getUID(w[F])]=true}}if(typeof y=="string"){for(F=this.overrides.length;F--;){var u=this.overrides[F];if(u.regexp.test(y)){var v=u.method.call(k,y,w,q);if(v===false){continue}if(v===true){return w}return v}}t=this.Slick.parse(y);if(!t.length){return w}}else{if(y==null){return w}else{if(y.Slick){t=y}else{if(this.contains(k.documentElement||k,y)){(w)?w.push(y):w=y;return w}else{return w}}}}this.posNTH={};this.posNTHLast={};this.posNTHType={};this.posNTHTypeLast={};this.push=(!z&&(q||(t.length==1&&t.expressions[0].length==1)))?this.pushArray:this.pushUID;if(w==null){w=[]}var E,C,B;var D,L,A,K,H,s,p;var r,l,c,I,J=t.expressions;search:for(F=0;(l=J[F]);F++){for(E=0;(c=l[E]);E++){D="combinator:"+c.combinator;if(!this[D]){continue search}L=(this.isXMLDocument)?c.tag:c.tag.toUpperCase();A=c.id;K=c.classList;H=c.classes;s=c.attributes;p=c.pseudos;I=(E===(l.length-1));this.bitUniques={};if(I){this.uniques=o;this.found=w}else{this.uniques={};this.found=[]}if(E===0){this[D](k,L,A,H,s,p,K);if(q&&I&&w.length){break search}}else{if(q&&I){for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K);if(w.length){break search}}}else{for(C=0,B=r.length;C<B;C++){this[D](r[C],L,A,H,s,p,K)}}}r=this.found}}if(z||(t.expressions.length>1)){this.sort(w)}return(q)?(w[0]||null):w};b.uidx=1;b.uidk="slick:uniqueid";b.getUIDXML=function(k){var c=k.getAttribute(this.uidk);if(!c){c=this.uidx++;k.setAttribute(this.uidk,c)}return c};b.getUIDHTML=function(c){return c.uniqueNumber||(c.uniqueNumber=this.uidx++)};b.sort=function(c){if(!this.documentSorter){return c}c.sort(this.documentSorter);return c};b.cacheNTH={};b.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/;b.parseNTHArgument=function(o){var l=o.match(this.matchNTH);if(!l){return false}var m=l[2]||false;var k=l[1]||1;if(k=="-"){k=-1}var c=+l[3]||0;l=(m=="n")?{a:k,b:c}:(m=="odd")?{a:2,b:1}:(m=="even")?{a:2,b:0}:{a:0,b:k};return(this.cacheNTH[o]=l)};b.createNTHPseudo=function(m,k,c,l){return function(q,o){var s=this.getUID(q);if(!this[c][s]){var z=q.parentNode;if(!z){return false}var p=z[m],r=1;if(l){var y=q.nodeName;do{if(p.nodeName!==y){continue}this[c][this.getUID(p)]=r++}while((p=p[k]))}else{do{if(p.nodeType!==1){continue}this[c][this.getUID(p)]=r++}while((p=p[k]))}}o=o||"n";var t=this.cacheNTH[o]||this.parseNTHArgument(o);if(!t){return false}var w=t.a,v=t.b,u=this[c][s];if(w==0){return v==u}if(w>0){if(u<v){return false}}else{if(v<u){return false}}return((u-v)%w)==0}};b.pushArray=function(m,c,p,l,k,o){if(this.matchSelector(m,c,p,l,k,o)){this.found.push(m)}};b.pushUID=function(o,c,q,m,k,p){var l=this.getUID(o);if(!this.uniques[l]&&this.matchSelector(o,c,q,m,k,p)){this.uniques[l]=true;this.found.push(o)}};b.matchNode=function(p,c){var l=this.Slick.parse(c);if(!l){return true}if(l.length==1&&l.expressions[0].length==1){var q=l.expressions[0][0];return this.matchSelector(p,(this.isXMLDocument)?q.tag:q.tag.toUpperCase(),q.id,q.classes,q.attributes,q.pseudos)}var k=this.search(this.document,l);for(var m=0,o;o=k[m++];){if(o===p){return true}}return false};b.matchPseudo=function(o,c,m){var k="pseudo:"+c;if(this[k]){return this[k](o,m)}var l=this.getAttribute(o,c);return(m)?m==l:!!l};b.matchSelector=function(l,s,c,m,o,q){if(s){if(s=="*"){if(l.nodeName<"@"){return false}}else{if(l.nodeName!=s){return false}}}if(c&&l.getAttribute("id")!=c){return false}var p,k,r;if(m){for(p=m.length;p--;){r=("className" in l)?l.className:l.getAttribute("class");if(!(r&&m[p].regexp.test(r))){return false}}}if(o){for(p=o.length;p--;){k=o[p];if(k.operator?!k.test(this.getAttribute(l,k.key)):!this.hasAttribute(l,k.key)){return false}}}if(q){for(p=q.length;p--;){k=q[p];if(!this.matchPseudo(l,k.key,k.value)){return false}}}return true};var a={" ":function(m,t,c,o,p,r,l){var q,s,k;if(this.isHTMLDocument){getById:if(c){s=this.document.getElementById(c);if((!s&&m.all)||(this.idGetsName&&s&&s.getAttributeNode("id").nodeValue!=c)){k=m.all[c];if(!k){return}if(!k[0]){k=[k]}for(q=0;s=k[q++];){if(s.getAttributeNode("id").nodeValue==c){this.push(s,t,null,o,p,r);break}}return}if(!s){if(this.contains(this.document.documentElement,m)){return}else{break getById}}else{if(this.document!==m&&!this.contains(m,s)){return}}this.push(s,t,null,o,p,r);return}getByClass:if(o&&m.getElementsByClassName&&!this.brokenGEBCN){k=m.getElementsByClassName(l.join(" "));if(!(k&&k.length)){break getByClass}for(q=0;s=k[q++];){this.push(s,t,c,null,p,r)}return}}getByTag:{k=m.getElementsByTagName(t);if(!(k&&k.length)){break getByTag}if(!this.brokenStarGEBTN){t=null}for(q=0;s=k[q++];){this.push(s,t,c,o,p,r)}}},">":function(m,c,p,l,k,o){if((m=m.firstChild)){do{if(m.nodeType===1){this.push(m,c,p,l,k,o)}}while((m=m.nextSibling))}},"+":function(m,c,p,l,k,o){while((m=m.nextSibling)){if(m.nodeType===1){this.push(m,c,p,l,k,o);break}}},"^":function(m,c,p,l,k,o){m=m.firstChild;if(m){if(m.nodeType===1){this.push(m,c,p,l,k,o)}else{this["combinator:+"](m,c,p,l,k,o)}}},"~":function(o,c,q,m,k,p){while((o=o.nextSibling)){if(o.nodeType!==1){continue}var l=this.getUID(o);if(this.bitUniques[l]){break}this.bitUniques[l]=true;this.push(o,c,q,m,k,p)}},"++":function(m,c,p,l,k,o){this["combinator:+"](m,c,p,l,k,o);this["combinator:!+"](m,c,p,l,k,o)},"~~":function(m,c,p,l,k,o){this["combinator:~"](m,c,p,l,k,o);this["combinator:!~"](m,c,p,l,k,o)},"!":function(m,c,p,l,k,o){while((m=m.parentNode)){if(m!==this.document){this.push(m,c,p,l,k,o)}}},"!>":function(m,c,p,l,k,o){m=m.parentNode;if(m!==this.document){this.push(m,c,p,l,k,o)}},"!+":function(m,c,p,l,k,o){while((m=m.previousSibling)){if(m.nodeType===1){this.push(m,c,p,l,k,o);break}}},"!^":function(m,c,p,l,k,o){m=m.lastChild;if(m){if(m.nodeType===1){this.push(m,c,p,l,k,o)}else{this["combinator:!+"](m,c,p,l,k,o)}}},"!~":function(o,c,q,m,k,p){while((o=o.previousSibling)){if(o.nodeType!==1){continue}var l=this.getUID(o);if(this.bitUniques[l]){break}this.bitUniques[l]=true;this.push(o,c,q,m,k,p)}}};for(var j in a){b["combinator:"+j]=a[j]}var h={empty:function(c){var k=c.firstChild;return !(k&&k.nodeType==1)&&!(c.innerText||c.textContent||"").length},not:function(c,k){return !this.matchNode(c,k)},contains:function(c,k){return(c.innerText||c.textContent||"").indexOf(k)>-1},"first-child":function(c){while((c=c.previousSibling)){if(c.nodeType===1){return false}}return true},"last-child":function(c){while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"only-child":function(l){var k=l;while((k=k.previousSibling)){if(k.nodeType===1){return false}}var c=l;while((c=c.nextSibling)){if(c.nodeType===1){return false}}return true},"nth-child":b.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":b.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":b.createNTHPseudo("firstChild","nextSibling","posNTHType",true),"nth-last-of-type":b.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",true),index:function(k,c){return this["pseudo:nth-child"](k,""+c+1)},even:function(k,c){return this["pseudo:nth-child"](k,"2n")},odd:function(k,c){return this["pseudo:nth-child"](k,"2n+1")},"first-of-type":function(c){var k=c.nodeName;while((c=c.previousSibling)){if(c.nodeName===k){return false}}return true},"last-of-type":function(c){var k=c.nodeName;while((c=c.nextSibling)){if(c.nodeName===k){return false}}return true},"only-of-type":function(l){var k=l,m=l.nodeName;while((k=k.previousSibling)){if(k.nodeName===m){return false}}var c=l;while((c=c.nextSibling)){if(c.nodeName===m){return false}}return true},enabled:function(c){return(c.disabled===false)},disabled:function(c){return(c.disabled===true)},checked:function(c){return c.checked||c.selected},focus:function(c){return this.isHTMLDocument&&this.document.activeElement===c&&(c.href||c.type||this.hasAttribute(c,"tabindex"))},root:function(c){return(c===this.root)},selected:function(c){return c.selected}};for(var d in h){b["pseudo:"+d]=h[d]}b.attributeGetters={"class":function(){return("className" in this)?this.className:this.getAttribute("class")},"for":function(){return("htmlFor" in this)?this.htmlFor:this.getAttribute("for")},href:function(){return("href" in this)?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return(this.style)?this.style.cssText:this.getAttribute("style")}};b.getAttribute=function(l,c){var m=this.attributeGetters[c];if(m){return m.call(l)}var k=l.getAttributeNode(c);return k?k.nodeValue:null};b.overrides=[];b.override=function(c,k){this.overrides.push({regexp:c,method:k})};var g=/\[.*[*$^]=(?:["']{2})?\]/;b.override(/./,function(r,p,q){if(!this.querySelectorAll||this.nodeType!=9||!b.isHTMLDocument||b.brokenMixedCaseQSA||(b.brokenCheckedQSA&&r.indexOf(":checked")>-1)||(b.brokenEmptyAttributeQSA&&g.test(r))||f.disableQSA){return false}var k,o;try{if(q){return this.querySelector(r)||null}else{k=this.querySelectorAll(r)}}catch(l){return false}var m,c=!!(p.length);if(b.starSelectsClosedQSA){for(m=0;o=k[m++];){if(o.nodeName>"@"&&(!c||!b.uniques[b.getUIDHTML(o)])){p.push(o)}}}else{for(m=0;o=k[m++];){if(!c||!b.uniques[b.getUIDHTML(o)]){p.push(o)}}}if(c){b.sort(p)}return true});b.override(/^[\w-]+$|^\*$/,function(r,p,q){var k=r;if(k=="*"&&b.brokenStarGEBTN){return false}var l=this.getElementsByTagName(k);if(q){return l[0]||null}var m,o,c=!!(p.length);for(m=0;o=l[m++];){if(!c||!b.uniques[b.getUID(o)]){p.push(o)}}if(c){b.sort(p)}return true});b.override(/^\.[\w-]+$/,function(q,s,o){if(!b.isHTMLDocument||(!this.getElementsByClassName&&this.querySelectorAll)){return false}var c,l,m,k=!!(s&&s.length),r=q.substring(1);if(this.getElementsByClassName&&!b.brokenGEBCN){c=this.getElementsByClassName(r);if(o){return c[0]||null}for(m=0;l=c[m++];){if(!k||!b.uniques[b.getUIDHTML(l)]){s.push(l)}}}else{var p=new RegExp("(^|\\s)"+f.escapeRegExp(r)+"(\\s|$)");c=this.getElementsByTagName("*");for(m=0;l=c[m++];){r=l.className;if(!r||!p.test(r)){continue}if(o){return l}if(!k||!b.uniques[b.getUIDHTML(l)]){s.push(l)}}}if(k){b.sort(s)}return(o)?null:true});b.override(/^#[\w-]+$/,function(o,l,m){if(!b.isHTMLDocument||this.nodeType!=9){return false}var p=o.substring(1),k=this.getElementById(p);if(!k){return l}if(b.idGetsName&&k.getAttributeNode("id").nodeValue!=p){return false}if(m){return k||null}var c=!!(l.length);if(!c||!b.uniques[b.getUIDHTML(k)]){l.push(k)}if(c){b.sort(l)}return true});if(typeof document!="undefined"){b.setDocument(document)}var f=b.Slick=(this.Slick||{});f.version="0.9dev";f.search=function(k,l,c){return b.search(k,l,c)};f.find=function(c,k){return b.search(c,k,null,true)};f.contains=function(c,k){b.setDocument(c);return b.contains(c,k)};f.getAttribute=function(k,c){return b.getAttribute(k,c)};f.match=function(k,c){if(!(k&&c)){return false}if(!c||c===k){return true}if(typeof c!="string"){return false}b.setDocument(k);return b.matchNode(k,c)};f.defineAttributeGetter=function(c,k){b.attributeGetters[c]=k;return this};f.lookupAttributeGetter=function(c){return b.attributeGetters[c]};f.definePseudo=function(c,k){b["pseudo:"+c]=function(m,l){return k.call(m,l)};return this};f.lookupPseudo=function(c){var k=b["pseudo:"+c];if(k){return function(l){return k.call(this,l)}}return null};f.override=function(k,c){b.override(k,c);return this};f.isXML=b.isXML;f.uidOf=function(c){return b.getUIDHTML(c)};if(!this.Slick){this.Slick=f}}).apply(this);(function(){var document=this.document;var window=document.window=this;var UID=1;this.$uid=(window.ActiveXObject)?function(item){return(item.uid||(item.uid=[UID++]))[0]}:function(item){return item.uid||(item.uid=UID++)};$uid(window);$uid(document);var ua=navigator.userAgent.toLowerCase(),platform=navigator.platform.toLowerCase(),UA=ua.match(/(opera|ie|firefox|chrome|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],mode=UA[1]=="ie"&&document.documentMode;var Browser=this.Browser={extend:Function.prototype.extend,name:(UA[1]=="version")?UA[3]:UA[1],version:mode||parseFloat((UA[1]=="opera"&&UA[4])?UA[4]:UA[2]),Platform:{name:ua.match(/ip(?:ad|od|hone)/)?"ios":(ua.match(/(?:webos|android)/)||platform.match(/mac|win|linux/)||["other"])[0]},Features:{xpath:!!(document.evaluate),air:!!(window.runtime),query:!!(document.querySelector),json:!!(window.JSON)},Plugins:{}};Browser[Browser.name]=true;Browser[Browser.name+parseInt(Browser.version,10)]=true;Browser.Platform[Browser.Platform.name]=true;Browser.Request=(function(){var XMLHTTP=function(){return new XMLHttpRequest()};var MSXML2=function(){return new ActiveXObject("MSXML2.XMLHTTP")};var MSXML=function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Function.attempt(function(){XMLHTTP();return XMLHTTP},function(){MSXML2();return MSXML2},function(){MSXML();return MSXML})})();Browser.Features.xhr=!!(Browser.Request);var version=(Function.attempt(function(){return navigator.plugins["Shockwave Flash"].description},function(){return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")})||"0 r0").match(/\d+/g);Browser.Plugins.Flash={version:Number(version[0]||"0."+version[1])||0,build:Number(version[2])||0};Browser.exec=function(text,force){if(!text){return text}if(window.execScript){window.execScript(text)}else{if(Browser.firefox&&force){window.eval(text)}else{var script=document.createElement("script");script.setAttribute("type","text/javascript");script.text=text;document.head.appendChild(script);document.head.removeChild(script)}}return text};String.implement("stripScripts",function(exec,force){var scripts="";var text=this.replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(all,attribs,code){if(/type=['"]text\/html['"]/.test(attribs)&&exec===true){var script=document.createElement("script");script.setAttribute("type","text/html");if(/id=['"]([^'"]+)['"]/.test(attribs)){script.setAttribute("id",RegExp.$1)}script.text=code;document.head.appendChild(script);return""}scripts+=code+"\n";return""});if(exec===true){Browser.exec(scripts,force)}else{if(typeOf(exec)=="function"){exec(scripts,text)}}return text});Browser.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event});this.Window=this.$constructor=new Type("Window",function(){});this.$family=Function.from("window").hide();Window.mirror(function(name,method){window[name]=method});this.Document=document.$constructor=new Type("Document",function(){});document.$family=Function.from("document").hide();Document.mirror(function(name,method){document[name]=method});document.html=document.documentElement;document.head=document.getElementsByTagName("head")[0];if(document.execCommand){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}if(this.attachEvent&&!this.addEventListener){var unloadEvent=function(){this.detachEvent("onunload",unloadEvent);document.head=document.html=document.window=null};this.attachEvent("onunload",unloadEvent)}var arrayFrom=Array.from;try{arrayFrom(document.html.childNodes)}catch(e){Array.from=function(item){if(typeof item!="string"&&Type.isEnumerable(item)&&typeOf(item)!="array"){var i=item.length,array=new Array(i);while(i--){array[i]=item[i]}return array}return arrayFrom(item)};var prototype=Array.prototype,slice=prototype.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(name){var method=prototype[name];Array[name]=function(item){return method.apply(Array.from(item),slice.call(arguments,1))}})}})();(function(){var a=this.Class=new Type("Class",function(j){if(instanceOf(j,Function)){j={initialize:j}}var h=function(){f(this);if(h.$prototyping){return this}this.$caller=null;var k=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;return k}.extend(this).implement(j);h.$constructor=a;h.prototype.$constructor=h;h.prototype.parent=c;return h});var c=function(){if(!this.$caller){throw new Error('The method "parent" cannot be called.')}var h=this.$caller.$name,j=this.$caller.$owner.parent,k=(j)?j.prototype[h]:null;if(!k){throw new Error('The method "'+h+'" has no parent.')}return k.apply(this,arguments)};var f=function(h){for(var j in h){var l=h[j];switch(typeOf(l)){case"object":var k=function(){};k.prototype=l;h[j]=f(new k);break;case"array":h[j]=l.clone();break}}return h};var b=function(h,j,l){if(l.$origin){l=l.$origin}var k=function(){if(l.$protected&&this.$caller==null){throw new Error('The method "'+j+'" cannot be called.')}var o=this.caller,p=this.$caller;this.caller=p;this.$caller=k;var m=l.apply(this,arguments);this.$caller=p;this.caller=o;return m}.extend({$owner:h,$origin:l,$name:j});return k};var g=function(j,k,h){if(a.Mutators.hasOwnProperty(j)){k=a.Mutators[j].call(this,k);if(k==null){return this}}if(typeOf(k)=="function"){if(k.$hidden){return this}this.prototype[j]=(h)?k:b(this,j,k)}else{Object.merge(this.prototype,j,k)}return this};var d=function(h){h.$prototyping=true;var j=new h;delete h.$prototyping;return j};a.implement("implement",g.overloadSetter());a.Mutators={Extends:function(h){this.parent=h;this.prototype=d(h)},Implements:function(h){Array.from(h).each(function(l){var j=new l;for(var k in j){g.call(this,k,j[k],true)}},this)}}})();(function(){this.Chain=new Class({$chain:[],chain:function(){this.$chain.append(Array.flatten(arguments));return this},callChain:function(){return(this.$chain.length)?this.$chain.shift().apply(this,arguments):false},clearChain:function(){this.$chain.empty();return this}});var a=function(b){return b.replace(/^on([A-Z])/,function(c,d){return d.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(d,c,b){d=a(d);this.$events[d]=(this.$events[d]||[]).include(c);if(b){c.internal=true}return this},addEvents:function(b){for(var c in b){this.addEvent(c,b[c])}return this},fireEvent:function(f,c,b){f=a(f);var d=this.$events[f];if(!d){return this}c=Array.from(c);d.each(function(g){if(b){g.delay(b,this,c)}else{g.apply(this,c)}},this);return this},removeEvent:function(f,d){f=a(f);var c=this.$events[f];if(c&&!d.internal){var b=c.indexOf(d);if(b!=-1){delete c[b]}}return this},removeEvents:function(d){var f;if(typeOf(d)=="object"){for(f in d){this.removeEvent(f,d[f])}return this}if(d){d=a(d)}for(f in this.$events){if(d&&d!=f){continue}var c=this.$events[f];for(var b=c.length;b--;){if(b in c){this.removeEvent(f,c[b])}}}return this}});this.Options=new Class({setOptions:function(){var b=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent){for(var c in b){if(typeOf(b[c])!="function"||!(/^on[A-Z]/).test(c)){continue}this.addEvent(c,b[c]);delete b[c]}}return this}})})();var Element=function(b,h){var j=Element.Constructors[b];if(j){return j(h)}if(typeof b!="string"){return document.id(b).set(h)}if(!h){h={}}if(!(/^[\w-]+$/).test(b)){var f=Slick.parse(b).expressions[0][0];b=(f.tag=="*")?"div":f.tag;if(f.id&&h.id==null){h.id=f.id}var d=f.attributes;if(d){for(var g=0,c=d.length;g<c;g++){var a=d[g];if(a.value!=null&&a.operator=="="&&h[a.key]==null){h[a.key]=a.value}}}if(f.classList&&h["class"]==null){h["class"]=f.classList.join(" ")}}return document.newElement(b,h)};if(Browser.Element){Element.prototype=Browser.Element.prototype}new Type("Element",Element).mirror(function(a){if(Array.prototype[a]){return}var b={};b[a]=function(){var j=[],f=arguments,k=true;for(var h=0,d=this.length;h<d;h++){var g=this[h],c=j[h]=g[a].apply(g,f);k=(k&&typeOf(c)=="element")}return(k)?new Elements(j):j};Elements.implement(b)});if(!Browser.Element){Element.parent=Object;Element.Prototype={"$family":Function.from("element").hide()};Element.mirror(function(a,b){Element.Prototype[a]=b})}Element.Constructors={};var IFrame=new Type("IFrame",function(){var f=Array.link(arguments,{properties:Type.isObject,iframe:function(g){return(g!=null)}});var c=f.properties||{},b;if(f.iframe){b=document.id(f.iframe)}var d=c.onload||function(){};delete c.onload;c.id=c.name=[c.id,c.name,b?(b.id||b.name):"IFrame_"+String.uniqueID()].pick();b=new Element(b||"iframe",c);var a=function(){d.call(b.contentWindow)};if(window.frames[c.id]){a()}else{b.addListener("load",a)}return b});var Elements=this.Elements=function(a){if(a&&a.length){var f={},d;for(var c=0;d=a[c++];){var b=Slick.uidOf(d);if(!f[b]){f[b]=true;this.push(d)}}}};Elements.prototype={length:0};Elements.parent=Array;new Type("Elements",Elements).implement({filter:function(a,b){if(!a){return this}return new Elements(Array.filter(this,(typeOf(a)=="string")?function(c){return c.match(a)}:a,b))}.protect(),push:function(){var d=this.length;for(var b=0,a=arguments.length;b<a;b++){var c=document.id(arguments[b]);if(c){this[d++]=c}}return(this.length=d)}.protect(),unshift:function(){var b=[];for(var c=0,a=arguments.length;c<a;c++){var d=document.id(arguments[c]);if(d){b.push(d)}}return Array.prototype.unshift.apply(this,b)}.protect(),concat:function(){var b=new Elements(this);for(var c=0,a=arguments.length;c<a;c++){var d=arguments[c];if(Type.isEnumerable(d)){b.append(d)}else{b.push(d)}}return b}.protect(),append:function(c){for(var b=0,a=c.length;b<a;b++){this.push(c[b])}return this}.protect(),empty:function(){while(this.length){delete this[--this.length]}return this}.protect()});(function(){var g=Array.prototype.splice,b={"0":0,"1":1,length:2};g.call(b,1,1);if(b[1]==1){Elements.implement("splice",function(){var h=this.length;g.apply(this,arguments);while(h>=this.length){delete this[h--]}return this}.protect())}Elements.implement(Array.prototype);Array.mirror(Elements);var f;try{var a=document.createElement("<input name=x>");f=(a.name=="x")}catch(c){}var d=function(h){return(""+h).replace(/&/g,"&amp;").replace(/"/g,"&quot;")};Document.implement({newElement:function(h,j){if(j&&j.checked!=null){j.defaultChecked=j.checked}if(f&&j){h="<"+h;if(j.name){h+=' name="'+d(j.name)+'"'}if(j.type){h+=' type="'+d(j.type)+'"'}h+=">";delete j.name;delete j.type}return this.id(this.createElement(h)).set(j)}})})();Document.implement({newTextNode:function(a){return this.createTextNode(a)},getDocument:function(){return this},getWindow:function(){return this.window},id:(function(){var a={string:function(d,c,b){d=Slick.find(b,"#"+d.replace(/(\W)/g,"\\$1"));return(d)?a.element(d,c):null},element:function(b,c){$uid(b);if(!c&&!b.$family&&!(/^(?:object|embed)$/i).test(b.tagName)){Object.append(b,Element.Prototype)}return b},object:function(c,d,b){if(c.toElement){return a.element(c.toElement(b),d)}return null}};a.textnode=a.whitespace=a.window=a.document=function(b){return b};return function(c,f,d){if(c&&c.$family&&c.uid){return c}var b=typeOf(c);return(a[b])?a[b](c,f,d||document):null}})()});if(window.$==null){Window.implement("$",function(a,b){return document.id(a,b,this.document)})}Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}});[Document,Element].invoke("implement",{getElements:function(a){return Slick.search(this,a,new Elements)},getElement:function(a){return document.id(Slick.find(this,a))}});if(window.$$==null){Window.implement("$$",function(a){if(arguments.length==1){if(typeof a=="string"){return Slick.search(this.document,a,new Elements)}else{if(Type.isEnumerable(a)){return new Elements(a)}}}return new Elements(arguments)})}(function(){var m={},k={};var q={input:"checked",option:"selected",textarea:"value"};var f=function(s){return(k[s]||(k[s]={}))};var l=function(t){if(t.removeEvents){t.removeEvents()}if(t.clearAttributes){t.clearAttributes()}var s=t.uid;if(s!=null){delete m[s];delete k[s]}return t};var r=["defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","maxLength","readOnly","rowSpan","tabIndex","useMap"];var d=["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked"];var h={html:"innerHTML","class":"className","for":"htmlFor",text:(function(){var s=document.createElement("div");return(s.innerText==null)?"textContent":"innerText"})()};var p=["type"];var j=["value","defaultValue"];var o=/^(?:href|src|usemap)$/i;d=d.associate(d);r=r.associate(r.map(String.toLowerCase));p=p.associate(p);Object.append(h,j.associate(j));var c={before:function(t,s){var u=s.parentNode;if(u){u.insertBefore(t,s)}},after:function(t,s){var u=s.parentNode;if(u){u.insertBefore(t,s.nextSibling)}},bottom:function(t,s){s.appendChild(t)},top:function(t,s){s.insertBefore(t,s.firstChild)}};c.inside=c.bottom;var b=function(v,u){if(!v){return u}v=Slick.parse(v);var t=v.expressions;for(var s=t.length;s--;){t[s][0].combinator=u}return v};Element.implement({set:function(u,t){var s=Element.Properties[u];(s&&s.set)?s.set.call(this,t):this.setProperty(u,t)}.overloadSetter(),get:function(t){var s=Element.Properties[t];return(s&&s.get)?s.get.apply(this):this.getProperty(t)}.overloadGetter(),erase:function(t){var s=Element.Properties[t];(s&&s.erase)?s.erase.apply(this):this.removeProperty(t);return this},setProperty:function(t,u){t=r[t]||t;if(u==null){return this.removeProperty(t)}var s=h[t];(s)?this[s]=u:(d[t])?this[t]=!!u:this.setAttribute(t,""+u);return this},setProperties:function(s){for(var t in s){this.setProperty(t,s[t])}return this},getProperty:function(t){t=r[t]||t;var s=h[t]||p[t];return(s)?this[s]:(d[t])?!!this[t]:(o.test(t)?this.getAttribute(t,2):(s=this.getAttributeNode(t))?s.nodeValue:null)||null},getProperties:function(){var s=Array.from(arguments);return s.map(this.getProperty,this).associate(s)},removeProperty:function(t){t=r[t]||t;var s=h[t];(s)?this[s]="":(d[t])?this[t]=false:this.removeAttribute(t);return this},removeProperties:function(){Array.each(arguments,this.removeProperty,this);return this},hasClass:function(s){return this.className.clean().contains(s," ")},addClass:function(s){if(!this.hasClass(s)){this.className=(this.className+" "+s).clean()}return this},removeClass:function(s){this.className=this.className.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)"),"$1");return this},toggleClass:function(s,t){if(t==null){t=!this.hasClass(s)}return(t)?this.addClass(s):this.removeClass(s)},adopt:function(){var v=this,s,y=Array.flatten(arguments),w=y.length;if(w>1){v=s=document.createDocumentFragment()}for(var u=0;u<w;u++){var t=document.id(y[u],true);if(t){v.appendChild(t)}}if(s){this.appendChild(s)}return this},appendText:function(t,s){return this.grab(this.getDocument().newTextNode(t),s)},grab:function(t,s){c[s||"bottom"](document.id(t,true),this);return this},inject:function(t,s){c[s||"bottom"](this,document.id(t,true));return this},replaces:function(s){s=document.id(s,true);s.parentNode.replaceChild(this,s);return this},wraps:function(t,s){t=document.id(t,true);return this.replaces(t).grab(t,s)},getPrevious:function(s){return document.id(Slick.find(this,b(s,"!~")))},getAllPrevious:function(s){return Slick.search(this,b(s,"!~"),new Elements)},getNext:function(s){return document.id(Slick.find(this,b(s,"~")))},getAllNext:function(s){return Slick.search(this,b(s,"~"),new Elements)},getFirst:function(s){return document.id(Slick.search(this,b(s,">"))[0])},getLast:function(s){return document.id(Slick.search(this,b(s,">")).getLast())},getParent:function(s){return document.id(Slick.find(this,b(s,"!")))},getParents:function(s){return Slick.search(this,b(s,"!"),new Elements)},getSiblings:function(s){return Slick.search(this,b(s,"~~"),new Elements)},getChildren:function(s){return Slick.search(this,b(s,">"),new Elements)},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(s){return document.id(Slick.find(this,"#"+(""+s).replace(/(\W)/g,"\\$1")))},getSelected:function(){this.selectedIndex;return new Elements(Array.from(this.options).filter(function(s){return s.selected}))},toQueryString:function(){var s=[];this.getElements("input, select, textarea").each(function(u){var t=u.type;if(!u.name||u.disabled||t=="submit"||t=="reset"||t=="file"||t=="image"){return}var v=(u.get("tag")=="select")?u.getSelected().map(function(w){return document.id(w).get("value")}):((t=="radio"||t=="checkbox")&&!u.checked)?null:u.get("value");Array.from(v).each(function(w){if(typeof w!="undefined"){s.push(encodeURIComponent(u.name)+"="+encodeURIComponent(w))}})});return s.join("&")},destroy:function(){var s=l(this).getElementsByTagName("*");Array.each(s,l);Element.dispose(this);return null},empty:function(){Array.from(this.childNodes).each(Element.dispose);return this},dispose:function(){return(this.parentNode)?this.parentNode.removeChild(this):this},match:function(s){return !s||Slick.match(this,s)}});var a=function(y,w,u){var s=y.getAttributeNode("id");if(s){y.removeAttributeNode(s)}if(u){y.setAttribute("id",w.getAttribute("id"))}if(Browser.ie){y.clearAttributes();y.mergeAttributes(w);y.removeAttribute("uid");if(y.options){var z=y.options,t=w.options;for(var v=z.length;v--;){z[v].selected=t[v].selected}}}var A=q[w.tagName.toLowerCase()];if(A&&w[A]){y[A]=w[A]}};Element.implement("clone",function(u,s){u=u!==false;var A=this.cloneNode(u);if(u){var v=A.getElementsByTagName("*"),y=this.getElementsByTagName("*");for(var t=v.length;t--;){a(v[t],y[t],s)}}a(A,this,s);if(Browser.ie){var w=A.getElementsByTagName("object"),z=this.getElementsByTagName("object");for(var t=w.length;t--;){w[t].outerHTML=z[t].outerHTML}}return document.id(A)});var g={contains:function(s){return Slick.contains(this,s)}};if(!document.contains){Document.implement(g)}if(!document.createElement("div").contains){Element.implement(g)}[Element,Window,Document].invoke("implement",{addListener:function(v,u){if(v=="unload"){var s=u,t=this;u=function(){t.removeListener("unload",u);s()}}else{m[$uid(this)]=this}if(this.addEventListener){this.addEventListener(v,u,!!arguments[2])}else{this.attachEvent("on"+v,u)}return this},removeListener:function(t,s){if(this.removeEventListener){this.removeEventListener(t,s,!!arguments[2])}else{this.detachEvent("on"+t,s)}return this},retrieve:function(t,s){var v=f($uid(this)),u=v[t];if(s!=null&&u==null){u=v[t]=s}return u!=null?u:null},store:function(t,s){var u=f($uid(this));u[t]=s;return this},eliminate:function(s){var t=f($uid(this));delete t[s];return this}});if(window.attachEvent&&!window.addEventListener){window.addListener("unload",function(){Object.each(m,l);if(window.CollectGarbage){CollectGarbage()}})}})();Element.Properties={};Element.Properties.style={set:function(a){this.style.cssText=a},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}};Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}};(function(a){if(a!=null){Element.Properties.maxlength=Element.Properties.maxLength={get:function(){var b=this.getAttribute("maxLength");return b==a?null:b}}}})(document.createElement("input").getAttribute("maxLength"));Element.Properties.html=(function(){var c=Function.attempt(function(){var f=document.createElement("table");f.innerHTML="<tr><td></td></tr>"});var d=document.createElement("div");var a={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]};a.thead=a.tfoot=a.tbody;var b={set:function(){var g=Array.flatten(arguments).join("");var h=(!c&&a[this.get("tag")]);if(h){var j=d;j.innerHTML=h[1]+g+h[2];for(var f=h[0];f--;){j=j.firstChild}this.empty().adopt(j.childNodes)}else{this.innerHTML=g}}};b.erase=b.set;return b})();(function(){var c=document.html;Element.Properties.styles={set:function(g){this.setStyles(g)}};var f=(c.style.opacity!=null);var d=/alpha\(opacity=([\d.]+)\)/i;var b=function(h,g){if(!h.currentStyle||!h.currentStyle.hasLayout){h.style.zoom=1}if(f){h.style.opacity=g}else{g=(g==1)?"":"alpha(opacity="+g*100+")";var j=h.style.filter||h.getComputedStyle("filter")||"";h.style.filter=d.test(j)?j.replace(d,g):j+g}};Element.Properties.opacity={set:function(h){var g=this.style.visibility;if(h==0&&g!="hidden"){this.style.visibility="hidden"}else{if(h!=0&&g!="visible"){this.style.visibility="visible"}}b(this,h)},get:(f)?function(){var g=this.style.opacity||this.getComputedStyle("opacity");return(g=="")?1:g}:function(){var g,h=(this.style.filter||this.getComputedStyle("filter"));if(h){g=h.match(d)}return(g==null||h==null)?1:(g[1]/100)}};var a=(c.style.cssFloat==null)?"styleFloat":"cssFloat";Element.implement({getComputedStyle:function(j){if(this.currentStyle){return this.currentStyle[j.camelCase()]}var h=Element.getDocument(this).defaultView,g=h?h.getComputedStyle(this,null):null;return(g)?g.getPropertyValue((j==a)?"float":j.hyphenate()):null},setOpacity:function(g){b(this,g);return this},getOpacity:function(){return this.get("opacity")},setStyle:function(h,g){switch(h){case"opacity":return this.set("opacity",parseFloat(g));case"float":h=a}h=h.camelCase();if(typeOf(g)!="string"){var j=(Element.Styles[h]||"@").split(" ");g=Array.from(g).map(function(l,k){if(!j[k]){return""}return(typeOf(l)=="number")?j[k].replace("@",Math.round(l)):l}).join(" ")}else{if(g==String(Number(g))){g=Math.round(g)}}this.style[h]=g;return this},getStyle:function(o){switch(o){case"opacity":return this.get("opacity");case"float":o=a}o=o.camelCase();var g=this.style[o];if(!g||o=="zIndex"){g=[];for(var m in Element.ShortStyles){if(o!=m){continue}for(var l in Element.ShortStyles[m]){g.push(this.getStyle(l))}return g.join(" ")}g=this.getComputedStyle(o)}if(g){g=String(g);var j=g.match(/rgba?\([\d\s,]+\)/);if(j){g=g.replace(j[0],j[0].rgbToHex())}}if(Browser.opera||(Browser.ie&&isNaN(parseFloat(g)))){if((/^(height|width)$/).test(o)){var h=(o=="width")?["left","right"]:["top","bottom"],k=0;h.each(function(p){k+=this.getStyle("border-"+p+"-width").toInt()+this.getStyle("padding-"+p).toInt()},this);return this["offset"+o.capitalize()]-k+"px"}if(Browser.opera&&String(g).indexOf("px")!=-1){return g}if((/^border(.+)Width|margin|padding/).test(o)){return"0px"}}return g},setStyles:function(h){for(var g in h){this.setStyle(g,h[g])}return this},getStyles:function(){var g={};Array.flatten(arguments).each(function(h){g[h]=this.getStyle(h)},this);return g}});Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@"};Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}};["Top","Right","Bottom","Left"].each(function(o){var m=Element.ShortStyles;var h=Element.Styles;["margin","padding"].each(function(p){var q=p+o;m[p][q]=h[q]="@px"});var l="border"+o;m.border[l]=h[l]="@px @ rgb(@, @, @)";var k=l+"Width",g=l+"Style",j=l+"Color";m[l]={};m.borderWidth[k]=m[l][k]=h[k]="@px";m.borderStyle[g]=m[l][g]=h[g]="@";m.borderColor[j]=m[l][j]=h[j]="rgb(@, @, @)"})})();(function(){var j=document.createElement("div"),f=document.createElement("div");j.style.height="0";j.appendChild(f);var d=(f.offsetParent===j);j=f=null;var o=function(p){return m(p,"position")!="static"||a(p)};var k=function(p){return o(p)||(/^(?:table|td|th)$/i).test(p.tagName)};Element.implement({scrollTo:function(p,q){if(a(this)){this.getWindow().scrollTo(p,q)}else{this.scrollLeft=p;this.scrollTop=q}return this},getSize:function(){if(a(this)){return this.getWindow().getSize()}return{x:this.offsetWidth,y:this.offsetHeight}},getScrollSize:function(){if(a(this)){return this.getWindow().getScrollSize()}return{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){if(a(this)){return this.getWindow().getScroll()}return{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){var q=this.parentNode,p={x:0,y:0};while(q&&!a(q)){p.x+=q.scrollLeft;p.y+=q.scrollTop;q=q.parentNode}return p},getOffsetParent:d?function(){var p=this;if(a(p)||m(p,"position")=="fixed"){return null}var q=(m(p,"position")=="static")?k:o;while((p=p.parentNode)){if(q(p)){return p}}return null}:function(){var p=this;if(a(p)||m(p,"position")=="fixed"){return null}try{return p.offsetParent}catch(q){}return null},getOffsets:function(){if(this.getBoundingClientRect&&!Browser.Platform.ios){var u=this.getBoundingClientRect(),r=document.id(this.getDocument().documentElement),t=r.getScroll(),w=this.getScrolls(),v=(m(this,"position")=="fixed");return{x:u.left.toInt()+w.x+((v)?0:t.x)-r.clientLeft,y:u.top.toInt()+w.y+((v)?0:t.y)-r.clientTop}}var q=this,p={x:0,y:0};if(a(this)){return p}while(q&&!a(q)){p.x+=q.offsetLeft;p.y+=q.offsetTop;if(Browser.firefox){if(!c(q)){p.x+=b(q);p.y+=h(q)}var s=q.parentNode;if(s&&m(s,"overflow")!="visible"){p.x+=b(s);p.y+=h(s)}}else{if(q!=this&&Browser.safari){p.x+=b(q);p.y+=h(q)}}q=q.offsetParent}if(Browser.firefox&&!c(this)){p.x-=b(this);p.y-=h(this)}return p},getPosition:function(s){if(a(this)){return{x:0,y:0}}var t=this.getOffsets(),q=this.getScrolls();var p={x:t.x-q.x,y:t.y-q.y};if(s&&(s=document.id(s))){var r=s.getPosition();return{x:p.x-r.x-b(s),y:p.y-r.y-h(s)}}return p},getCoordinates:function(r){if(a(this)){return this.getWindow().getCoordinates()}var p=this.getPosition(r),q=this.getSize();var s={left:p.x,top:p.y,width:q.x,height:q.y};s.right=s.left+s.width;s.bottom=s.top+s.height;return s},computePosition:function(p){return{left:p.x-l(this,"margin-left"),top:p.y-l(this,"margin-top")}},setPosition:function(p){return this.setStyles(this.computePosition(p))}});[Document,Window].invoke("implement",{getSize:function(){var p=g(this);return{x:p.clientWidth,y:p.clientHeight}},getScroll:function(){var q=this.getWindow(),p=g(this);return{x:q.pageXOffset||p.scrollLeft,y:q.pageYOffset||p.scrollTop}},getScrollSize:function(){var r=g(this),q=this.getSize(),p=this.getDocument().body;return{x:Math.max(r.scrollWidth,p.scrollWidth,q.x),y:Math.max(r.scrollHeight,p.scrollHeight,q.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var p=this.getSize();return{top:0,left:0,bottom:p.y,right:p.x,height:p.y,width:p.x}}});var m=Element.getComputedStyle;function l(p,q){return m(p,q).toInt()||0}function c(p){return m(p,"-moz-box-sizing")=="border-box"}function h(p){return l(p,"border-top-width")}function b(p){return l(p,"border-left-width")}function a(p){return(/^(?:body|html)$/i).test(p.tagName)}function g(p){var q=p.getDocument();return(!q.compatMode||q.compatMode=="CSS1Compat")?q.html:q.body}})();Element.alias({position:"setPosition"});[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}});(function(){Element.Properties.events={set:function(c){this.addEvents(c)}};[Element,Window,Document].invoke("implement",{addEvent:function(h,k){var l=this.retrieve("events",{});if(!l[h]){l[h]={keys:[],values:[]}}if(l[h].keys.contains(k)){return this}l[h].keys.push(k);var j=h,c=Element.Events[h],f=k,m=this;if(c){if(c.onAdd){c.onAdd.call(this,k)}if(c.condition){f=function(o){if(c.condition.call(this,o)){return k.call(this,o)}return true}}j=c.base||j}var g=function(){return k.call(m)};var d=Element.NativeEvents[j];if(d){if(d==2){g=function(o){o=new Event(o,m.getWindow());if(f.call(m,o)===false){o.stop()}}}this.addListener(j,g,arguments[2])}l[h].values.push(g);return this},removeEvent:function(g,f){var d=this.retrieve("events");if(!d||!d[g]){return this}var k=d[g];var c=k.keys.indexOf(f);if(c==-1){return this}var j=k.values[c];delete k.keys[c];delete k.values[c];var h=Element.Events[g];if(h){if(h.onRemove){h.onRemove.call(this,f)}g=h.base||g}return(Element.NativeEvents[g])?this.removeListener(g,j,arguments[2]):this},addEvents:function(c){for(var d in c){this.addEvent(d,c[d])}return this},removeEvents:function(c){var f;if(typeOf(c)=="object"){for(f in c){this.removeEvent(f,c[f])}return this}var d=this.retrieve("events");if(!d){return this}if(!c){for(f in d){this.removeEvents(f)}this.eliminate("events")}else{if(d[c]){d[c].keys.each(function(g){this.removeEvent(c,g)},this);delete d[c]}}return this},fireEvent:function(g,d,c){var f=this.retrieve("events");if(!f||!f[g]){return this}d=Array.from(d);f[g].keys.each(function(h){if(c){h.delay(c,this,d)}else{h.apply(this,d)}},this);return this},cloneEvents:function(g,f){g=document.id(g);var d=g.retrieve("events");if(!d){return this}if(!f){for(var c in d){this.cloneEvents(g,c)}}else{if(d[f]){d[f].keys.each(function(h){this.addEvent(f,h)},this)}}return this}});try{if(typeof HTMLElement!="undefined"){HTMLElement.prototype.fireEvent=Element.prototype.fireEvent}}catch(b){}Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1};var a=function(c){var d=c.relatedTarget;if(d==null){return true}if(!d){return false}return(d!=this&&d.prefix!="xul"&&typeOf(this)!="document"&&!this.contains(d))};Element.Events={mouseenter:{base:"mouseover",condition:a},mouseleave:{base:"mouseout",condition:a},mousewheel:{base:(Browser.firefox)?"DOMMouseScroll":"mousewheel"}}})();(function(){var g=this.Fx=new Class({Implements:[Chain,Events,Options],options:{fps:60,unit:false,duration:500,frames:null,frameSkip:true,link:"ignore"},initialize:function(h){this.subject=this.subject||this;this.setOptions(h)},getTransition:function(){return function(h){return -(Math.cos(Math.PI*h)-1)/2}},step:function(h){if(this.options.frameSkip){var j=(this.time!=null)?(h-this.time):0,k=j/this.frameInterval;this.time=h;this.frame+=k}else{this.frame++}if(this.frame<this.frames){var l=this.transition(this.frame/this.frames);this.set(this.compute(this.from,this.to,l))}else{this.frame=this.frames;this.set(this.compute(this.from,this.to,1));this.stop()}},set:function(h){return h},compute:function(k,j,h){return g.compute(k,j,h)},check:function(){if(!this.isRunning()){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},start:function(m,l){if(!this.check(m,l)){return this}this.from=m;this.to=l;this.frame=(this.options.frameSkip)?0:-1;this.time=null;this.transition=this.getTransition();var k=this.options.frames,j=this.options.fps,h=this.options.duration;this.duration=g.Durations[h]||h.toInt();this.frameInterval=1000/j;this.frames=k||Math.round(this.duration/this.frameInterval);this.fireEvent("start",this.subject);b.call(this,j);return this},stop:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);if(this.frames==this.frame){this.fireEvent("complete",this.subject);if(!this.callChain()){this.fireEvent("chainComplete",this.subject)}}else{this.fireEvent("stop",this.subject)}}return this},cancel:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps);this.frame=this.frames;this.fireEvent("cancel",this.subject).clearChain()}return this},pause:function(){if(this.isRunning()){this.time=null;d.call(this,this.options.fps)}return this},resume:function(){if((this.frame<this.frames)&&!this.isRunning()){b.call(this,this.options.fps)}return this},isRunning:function(){var h=f[this.options.fps];return h&&h.contains(this)}});g.compute=function(k,j,h){return(j-k)*h+k};g.Durations={"short":250,normal:500,"long":1000};var f={},c={};var a=function(){var j=Date.now();for(var k=this.length;k--;){var h=this[k];if(h){h.step(j)}}};var b=function(j){var h=f[j]||(f[j]=[]);h.push(this);if(!c[j]){c[j]=a.periodical(Math.round(1000/j),h)}};var d=function(j){var h=f[j];if(h){h.erase(this);if(!h.length&&c[j]){delete f[j];c[j]=clearInterval(c[j])}}}})();Fx.CSS=new Class({Extends:Fx,prepare:function(c,d,b){b=Array.from(b);if(b[1]==null){b[1]=b[0];b[0]=c.getStyle(d)}var a=b.map(this.parse);return{from:a[0],to:a[1]}},parse:function(a){a=Function.from(a)();a=(typeof a=="string")?a.split(" "):Array.from(a);return a.map(function(c){c=String(c);var b=false;Object.each(Fx.CSS.Parsers,function(g,f){if(b){return}var d=g.parse(c);if(d||d===0){b={value:d,parser:g}}});b=b||{value:c,parser:Fx.CSS.Parsers.String};return b})},compute:function(d,c,b){var a=[];(Math.min(d.length,c.length)).times(function(f){a.push({value:d[f].parser.compute(d[f].value,c[f].value,b),parser:d[f].parser})});a.$family=Function.from("fx:css:value");return a},serve:function(c,b){if(typeOf(c)!="fx:css:value"){c=this.parse(c)}var a=[];c.each(function(d){a=a.concat(d.parser.serve(d.value,b))});return a},render:function(a,d,c,b){a.setStyle(d,this.serve(c,b))},search:function(a){if(Fx.CSS.Cache[a]){return Fx.CSS.Cache[a]}var c={},b=new RegExp("^"+a.escapeRegExp()+"$");Array.each(document.styleSheets,function(g,f){var d=g.href;if(d&&d.contains("://")&&!d.contains(document.domain)){return}var h=g.rules||g.cssRules;Array.each(h,function(l,j){if(!l.style){return}var k=(l.selectorText)?l.selectorText.replace(/^\w+/,function(o){return o.toLowerCase()}):null;if(!k||!b.test(k)){return}Object.each(Element.Styles,function(o,m){if(!l.style[m]||Element.ShortStyles[m]){return}o=String(l.style[m]);c[m]=((/^rgb/).test(o))?o.rgbToHex():o})})});return Fx.CSS.Cache[a]=c}});Fx.CSS.Cache={};Fx.CSS.Parsers={Color:{parse:function(a){if(a.match(/^#[0-9a-f]{3,6}$/i)){return a.hexToRgb(true)}return((a=a.match(/(\d+),\s*(\d+),\s*(\d+)/)))?[a[1],a[2],a[3]]:false},compute:function(c,b,a){return c.map(function(f,d){return Math.round(Fx.compute(c[d],b[d],a))})},serve:function(a){return a.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(b,a){return(a)?b+a:b}},String:{parse:Function.from(false),compute:function(b,a){return a},serve:function(a){return a}}};Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(a){if(typeof a=="string"){a=this.search(a)}for(var b in a){this.render(this.element,b,a[b],this.options.unit)}return this},compute:function(f,d,c){var a={};for(var b in f){a[b]=this.parent(f[b],d[b],c)}return a},start:function(b){if(!this.check(b)){return this}if(typeof b=="string"){b=this.search(b)}var f={},d={};for(var c in b){var a=this.prepare(this.element,c,b[c]);f[c]=a.from;d[c]=a.to}return this.parent(f,d)}});Element.Properties.morph={set:function(a){this.get("morph").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("morph");if(!a){a=new Fx.Morph(this,{link:"cancel"});this.store("morph",a)}return a}};Element.implement({morph:function(a){this.get("morph").start(a);return this}});Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(b,a){this.element=this.subject=document.id(b);this.parent(a)},set:function(b,a){if(arguments.length==1){a=b;b=this.property||this.options.property}this.render(this.element,b,a,this.options.unit);return this},start:function(c,f,d){if(!this.check(c,f,d)){return this}var b=Array.flatten(arguments);this.property=this.options.property||b.shift();var a=this.prepare(this.element,this.property,b);return this.parent(a.from,a.to)}});Element.Properties.tween={set:function(a){this.get("tween").cancel().setOptions(a);return this},get:function(){var a=this.retrieve("tween");if(!a){a=new Fx.Tween(this,{link:"cancel"});this.store("tween",a)}return a}};Element.implement({tween:function(a,c,b){this.get("tween").start(arguments);return this},fade:function(c){var f=this.get("tween"),d="opacity",a;c=[c,"toggle"].pick();switch(c){case"in":f.start(d,1);break;case"out":f.start(d,0);break;case"show":f.set(d,1);break;case"hide":f.set(d,0);break;case"toggle":var b=this.retrieve("fade:flag",this.get("opacity")==1);f.start(d,(b)?0:1);this.store("fade:flag",!b);a=true;break;default:f.start(d,arguments)}if(!a){this.eliminate("fade:flag")}return this},highlight:function(c,a){if(!a){a=this.retrieve("highlight:original",this.getStyle("background-color"));a=(a=="transparent")?"#fff":a}var b=this.get("tween");b.start("background-color",c||"#ffff88",a).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original"));b.callChain()}.bind(this));return this}});(function(){var a=("onprogress" in new Browser.Request);var c=this.Request=new Class({Implements:[Chain,Events,Options],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:true,format:false,method:"post",link:"ignore",isSuccess:null,emulation:true,urlEncoded:true,encoding:"utf-8",evalScripts:false,evalResponse:false,timeout:0,noCache:false},initialize:function(d){this.xhr=new Browser.Request();this.setOptions(d);this.headers=this.options.headers},onStateChange:function(){var d=this.xhr;if(d.readyState!=4||!this.running){return}this.running=false;this.status=0;Function.attempt(function(){var f=d.status;this.status=(f==1223)?204:f}.bind(this));d.onreadystatechange=function(){};clearTimeout(this.timer);this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML};if(this.options.isSuccess.call(this,this.status)){this.success(this.response.text,this.response.xml)}else{this.failure()}},isSuccess:function(){var d=this.status;return(d>=200&&d<300)},isRunning:function(){return !!this.running},processScripts:function(d){if(this.options.evalResponse||(/(ecma|java)script/).test(this.getHeader("Content-type"))){return Browser.exec(d)}return d.stripScripts(this.options.evalScripts,true)},success:function(f,d){this.onSuccess(this.processScripts(f),d)},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure()},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(d){this.fireEvent("loadstart",[d,this.xhr])},progress:function(d){this.fireEvent("progress",[d,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr)},setHeader:function(d,f){this.headers[d]=f;return this},getHeader:function(d){return Function.attempt(function(){return this.xhr.getResponseHeader(d)}.bind(this))},check:function(){if(!this.running){return true}switch(this.options.link){case"cancel":this.cancel();return true;case"chain":this.chain(this.caller.pass(arguments,this));return false}return false},send:function(q){if(!this.check(q)){return this}this.options.isSuccess=this.options.isSuccess||this.isSuccess;this.running=true;var m=typeOf(q);if(m=="string"||m=="element"){q={data:q}}var h=this.options;q=Object.append({data:h.data,url:h.url,method:h.method},q);var k=q.data,f=String(q.url),d=q.method.toLowerCase();switch(typeOf(k)){case"element":k=document.id(k).toQueryString();break;case"object":case"hash":k=Object.toQueryString(k)}if(this.options.format){var o="format="+this.options.format;k=(k)?o+"&"+k:o}if(this.options.emulation&&!["get","post"].contains(d)){var l="_method="+d;k=(k)?l+"&"+k:l;d="post"}if(this.options.urlEncoded&&["post","put"].contains(d)){var g=(this.options.encoding)?"; charset="+this.options.encoding:"";this.headers["Content-type"]="application/x-www-form-urlencoded"+g}if(!f){f=document.location.pathname}var j=f.lastIndexOf("/");if(j>-1&&(j=f.indexOf("#"))>-1){f=f.substr(0,j)}if(this.options.noCache){f+=(f.contains("?")?"&":"?")+String.uniqueID()}if(k&&d=="get"){f+=(f.contains("?")?"&":"?")+k;k=null}var p=this.xhr;if(a){p.onloadstart=this.loadstart.bind(this);p.onprogress=this.progress.bind(this)}p.open(d.toUpperCase(),f,this.options.async,this.options.user,this.options.password);if(this.options.user&&"withCredentials" in p){p.withCredentials=true}p.onreadystatechange=this.onStateChange.bind(this);Object.each(this.headers,function(s,r){try{p.setRequestHeader(r,s)}catch(t){this.fireEvent("exception",[r,s])}},this);this.fireEvent("request");p.send(k);if(!this.options.async){this.onStateChange()}if(this.options.timeout){this.timer=this.timeout.delay(this.options.timeout,this)}return this},cancel:function(){if(!this.running){return this}this.running=false;var d=this.xhr;d.abort();clearTimeout(this.timer);d.onreadystatechange=d.onprogress=d.onloadstart=function(){};this.xhr=new Browser.Request();this.fireEvent("cancel");return this}});var b={};["get","post","put","delete","GET","POST","PUT","DELETE"].each(function(d){b[d]=function(g){var f={method:d};if(g!=null){f.data=g}return this.send(f)}});c.implement(b);Element.Properties.send={set:function(d){var f=this.get("send").cancel();f.setOptions(d);return this},get:function(){var d=this.retrieve("send");if(!d){d=new c({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")});this.store("send",d)}return d}};Element.implement({send:function(d){var f=this.get("send");f.send({data:this,url:d||f.options.url});return this}})})();Request.HTML=new Class({Extends:Request,options:{update:false,append:false,evalScripts:true,filter:false,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(f){var d=this.options,b=this.response;b.html=f.stripScripts(function(g){b.javascript=g});var c=b.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(c){b.html=c[1]}var a=new Element("div").set("html",b.html);b.tree=a.childNodes;b.elements=a.getElements("*");if(d.filter){b.tree=b.elements.filter(d.filter)}if(d.update){document.id(d.update).empty().set("html",b.html)}else{if(d.append){document.id(d.append).adopt(a.getChildren())}}if(d.evalScripts){Browser.exec(b.javascript)}this.onSuccess(b.tree,b.elements,b.html,b.javascript)}});Element.Properties.load={set:function(a){var b=this.get("load").cancel();b.setOptions(a);return this},get:function(){var a=this.retrieve("load");if(!a){a=new Request.HTML({data:this,link:"cancel",update:this,method:"get"});this.store("load",a)}return a}};Element.implement({load:function(){this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString}));return this}});Request.JSON=new Class({Extends:Request,options:{secure:true},initialize:function(a){this.parent(a);Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(c){var b=this.options.secure;var a=this.response.json=Function.attempt(function(){return JSON.decode(c,b)});if(a==null){this.onFailure()}else{this.onSuccess(a,c)}}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:false,duration:false,secure:false,document:document,encode:true},initialize:function(b,a){this.key=b;this.setOptions(a)},write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},read:function(){var a=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return(a)?decodeURIComponent(a[1]):null},dispose:function(){new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write("");return this}});Cookie.write=function(b,c,a){return new Cookie(b,a).write(c)};Cookie.read=function(a){return new Cookie(a).read()};Cookie.dispose=function(b,a){return new Cookie(b,a).dispose()};(function(k,m){var o,g,f=[],c,b,p=true;try{p=k.frameElement!=null}catch(j){}var h=function(){clearTimeout(b);if(o){return}Browser.loaded=o=true;m.removeListener("DOMContentLoaded",h).removeListener("readystatechange",a);m.fireEvent("domready");k.fireEvent("domready")};var a=function(){for(var q=f.length;q--;){if(f[q]()){h();return true}}return false};var l=function(){clearTimeout(b);if(!a()){b=setTimeout(l,10)}};m.addListener("DOMContentLoaded",h);var d=m.createElement("div");if(d.doScroll&&!p){f.push(function(){try{d.doScroll();return true}catch(q){}return false});c=true}if(m.readyState){f.push(function(){var q=m.readyState;return(q=="loaded"||q=="complete")})}if("onreadystatechange" in m){m.addListener("readystatechange",a)}else{c=true}if(c){l()}Element.Events.domready={onAdd:function(q){if(o){q.call(this)}}};Element.Events.load={base:"load",onAdd:function(q){if(g&&this==k){q.call(this)}},condition:function(){if(this==k){h();delete Element.Events.load}return true}};k.addEvent("load",function(){g=true})})(window,document);if(typeof JSON=="undefined"){this.JSON={}}Object.append(JSON,{$specialChars:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},$replaceChars:function(a){return JSON.$specialChars[a]||"\\u00"+Math.floor(a.charCodeAt()/16).toString(16)+(a.charCodeAt()%16).toString(16)},encode:function(b){switch(typeOf(b)){case"string":return'"'+b.replace(/[\x00-\x1f\\"]/g,JSON.$replaceChars)+'"';case"array":return"["+String(b.map(JSON.encode).clean())+"]";case"object":case"hash":var a=[];Object.each(b,function(f,d){var c=JSON.encode(f);if(c){a.push(JSON.encode(d)+":"+c)}});return"{"+a+"}";case"number":case"boolean":return String(b);case"null":return"null"}return null},decode:function(string,secure){if(typeOf(string)!="string"||!string.length){return null}if(secure&&!(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(string.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""))){return null}return eval("("+string+")")}});Class.Mutators.Binds=function(a){if(!this.prototype.initialize){this.implement("initialize",function(){})}return a};Class.Mutators.initialize=function(a){return function(){Array.from(this.Binds).each(function(b){var c=this[b];if(c){this[b]=c.bind(this)}},this);return a.apply(this,arguments)}};Class.Occlude=new Class({occlude:function(c,b){b=document.id(b||this.element);var a=b.retrieve(c||this.property);if(a&&this.occluded!=null){return this.occluded=a}this.occluded=false;b.store(c||this.property,this);return this.occluded}});Class.refactor=function(b,a){Object.each(a,function(f,d){var c=b.prototype[d];if(c&&c.$origin){c=c.$origin}if(typeof f=="function"){b.implement(d,function(){var g=this.previous;this.previous=c||function(){};var h=f.apply(this,arguments);this.previous=g;return h})}else{b.implement(d,f)}});return b};(function(){var a=function(b){return b!=null};Object.extend({getFromPath:function(f,d){var g=d.split(".");for(var c=0,b=g.length;c<b;c++){if(f.hasOwnProperty(g[c])){f=f[g[c]]}else{return null}}return f},cleanValues:function(b,c){c=c||a;for(key in b){if(!c(b[key])){delete b[key]}}return b},erase:function(b,c){if(b.hasOwnProperty(c)){delete b[c]}return b},run:function(c){var b=Array.slice(arguments,1);for(key in c){if(c[key].apply){c[key].apply(c,b)}}return c}})})();Element.implement({isDisplayed:function(){return this.getStyle("display")!="none"},isVisible:function(){var a=this.offsetWidth,b=this.offsetHeight;return(a==0&&b==0)?false:(a>0&&b>0)?true:this.style.display!="none"},toggle:function(){return this[this.isDisplayed()?"hide":"show"]()},hide:function(){var b;try{b=this.getStyle("display")}catch(a){}if(b=="none"){return this}return this.store("element:_originalDisplay",b||"").setStyle("display","none")},show:function(a){if(!a&&this.isDisplayed()){return this}a=a||this.retrieve("element:_originalDisplay")||"block";return this.setStyle("display",(a=="none")?"block":a)},swapClass:function(a,b){return this.removeClass(a).addClass(b)}});Document.implement({clearSelection:function(){if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){var a=window.getSelection();if(a&&a.removeAllRanges){a.removeAllRanges()}}}}});Elements.from=function(f,d){if(d||d==null){f=f.stripScripts()}var b,c=f.match(/^\s*<(t[dhr]|tbody|tfoot|thead)/i);if(c){b=new Element("table");var a=c[1].toLowerCase();if(["td","th","tr"].contains(a)){b=new Element("tbody").inject(b);if(a!="tr"){b=new Element("tr").inject(b)}}}return(b||new Element("div")).set("html",f).getChildren()};Events.Pseudos=function(g,c,d){var b="monitorEvents:";var a=function(h){return{store:h.store?function(j,k){h.store(b+j,k)}:function(j,k){(h.$monitorEvents||(h.$monitorEvents={}))[j]=k},retrieve:h.retrieve?function(j,k){return h.retrieve(b+j,k)}:function(j,k){if(!h.$monitorEvents){return k}return h.$monitorEvents[j]||k}}};var f=function(j){if(j.indexOf(":")==-1){return null}var h=Slick.parse(j).expressions[0][0],k=h.pseudos;return(g&&g[k[0].key])?{event:h.tag,value:k[0].value,pseudo:k[0].key,original:j}:null};return{addEvent:function(o,q,k){var p=f(o);if(!p){return c.call(this,o,q,k)}var l=a(this),u=l.retrieve(o,[]),r=g[p.pseudo],v=r.options||{};var t=this;var s=function(){r.listener.call(t,p,q,arguments,v)};u.include({event:q,monitor:s});l.store(o,u);var h=p.event,j=v[h]||{},m=Array.slice(arguments,2);if(j.args){m.append(Array.from(j.args))}if(j.base){h=j.base}c.apply(this,[o,q].concat(m));return c.apply(this,[h,s].concat(m))},removeEvent:function(m,p){var o=f(m);if(!o){return d.call(this,m,p)}var k=a(this),r=k.retrieve(m),q=g[o.pseudo],s=q.options||{};if(!r){return this}var h=o.event,j=s[h]||{},l=Array.slice(arguments,2);if(j.args){l.append(Array.from(j.args))}if(j.base){h=j.base}d.apply(this,[m,p].concat(l));r.each(function(t,u){if(!p||t.event==p){d.apply(this,[h,t.monitor].concat(l))}delete r[u]},this);k.store(m,r);return this}}};(function(b){var c={once:{listener:function(f,g,d){g.apply(this,d);this.removeEvent(f.original,g)}}};Events.definePseudo=function(d,f){c[d]=Type.isFunction(f)?{listener:f}:f;return this};var a=Events.prototype;Events.implement(Events.Pseudos(c,a.addEvent,a.removeEvent));["Request","Fx"].each(function(d){if(b[d]){b[d].implement(Events.prototype)}})})(this);(function(){var b={once:{listener:function(d,f,c){f.apply(this,c);this.removeEvent(d.original,f)}}};Event.definePseudo=function(c,d){b[c]=Type.isFunction(d)?{listener:d}:d;return this};var a=Element.prototype;[Element,Window,Document].invoke("implement",Events.Pseudos(b,a.addEvent,a.removeEvent))})();(function(){var a=!(window.attachEvent&&!window.addEventListener),b=Element.NativeEvents;b.focusin=2;b.focusout=2;Event.definePseudo("relay",{listener:function(j,k,h,m){var c=h[0],f=m[j.event],d=f?f.condition:null;for(var g=c.target;g&&g!=this;g=g.parentNode){var l=document.id(g);if(Slick.match(g,j.value)&&(!d||d.call(l,c))){if(l){k.call(l,c,l)}return}}},options:{mouseenter:{base:"mouseover",condition:Element.Events.mouseenter.condition},mouseleave:{base:"mouseout",condition:Element.Events.mouseleave.condition},focus:{base:"focus"+(a?"":"in"),args:[true]},blur:{base:a?"blur":"focusout",args:[true]}}})})();Fx.Elements=new Class({Extends:Fx.CSS,initialize:function(b,a){this.elements=this.subject=$$(b);this.parent(a)},compute:function(h,j,k){var c={};for(var d in h){var a=h[d],f=j[d],g=c[d]={};for(var b in a){g[b]=this.parent(a[b],f[b],k)}}return c},set:function(b){for(var c in b){if(!this.elements[c]){continue}var a=b[c];for(var d in a){this.render(this.elements[c],d,a[d],this.options.unit)}}return this},start:function(c){if(!this.check(c)){return this}var j={},k={};for(var d in c){if(!this.elements[d]){continue}var g=c[d],a=j[d]={},h=k[d]={};for(var b in g){var f=this.prepare(this.elements[d],b,g[b]);a[b]=f.from;h[b]=f.to}}return this.parent(j,k)}});(function(){var b=null,a={},d={};var c=function(g){if(instanceOf(g,f.Set)){return g}else{return a[g]}};var f=this.Locale={define:function(g,l,j,k){var h;if(instanceOf(g,f.Set)){h=g.name;if(h){a[h]=g}}else{h=g;if(!a[h]){a[h]=new f.Set(h)}g=a[h]}if(l){g.define(l,j,k)}if(!b){b=g}return g},use:function(g){g=c(g);if(g){b=g;this.fireEvent("change",g)}return this},getCurrent:function(){return b},get:function(h,g){return(b)?b.get(h,g):""},inherit:function(g,h,j){g=c(g);if(g){g.inherit(h,j)}return this},list:function(){return Object.keys(a)}};Object.append(f,new Events);f.Set=new Class({sets:{},inherits:{locales:[],sets:{}},initialize:function(g){this.name=g||""},define:function(k,h,j){var g=this.sets[k];if(!g){g={}}if(h){if(typeOf(h)=="object"){g=Object.merge(g,h)}else{g[h]=j}}this.sets[k]=g;return this},get:function(t,k,s){var r=Object.getFromPath(this.sets,t);if(r!=null){var o=typeOf(r);if(o=="function"){r=r.apply(null,Array.from(k))}else{if(o=="object"){r=Object.clone(r)}}return r}var j=t.indexOf("."),q=j<0?t:t.substr(0,j),m=(this.inherits.sets[q]||[]).combine(this.inherits.locales).include("en-US");if(!s){s=[]}for(var h=0,g=m.length;h<g;h++){if(s.contains(m[h])){continue}s.include(m[h]);var p=a[m[h]];if(!p){continue}r=p.get(t,k,s);if(r!=null){return r}}return""},inherit:function(h,j){h=Array.from(h);if(j&&!this.inherits.sets[j]){this.inherits.sets[j]=[]}var g=h.length;while(g--){(j?this.inherits.sets[j]:this.inherits.locales).unshift(h[g])}return this}})})();Locale.define("en-US","Date",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_abbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateOrder:["month","date","year"],shortDate:"%m/%d/%Y",shortTime:"%I:%M%p",AM:"AM",PM:"PM",ordinal:function(a){return(a>3&&a<21)?"th":["th","st","nd","rd","th"][Math.min(a%10,4)]},lessThanMinuteAgo:"less than a minute ago",minuteAgo:"about a minute ago",minutesAgo:"{delta} minutes ago",hourAgo:"about an hour ago",hoursAgo:"about {delta} hours ago",dayAgo:"1 day ago",daysAgo:"{delta} days ago",weekAgo:"1 week ago",weeksAgo:"{delta} weeks ago",monthAgo:"1 month ago",monthsAgo:"{delta} months ago",yearAgo:"1 year ago",yearsAgo:"{delta} years ago",lessThanMinuteUntil:"less than a minute from now",minuteUntil:"about a minute from now",minutesUntil:"{delta} minutes from now",hourUntil:"about an hour from now",hoursUntil:"about {delta} hours from now",dayUntil:"1 day from now",daysUntil:"{delta} days from now",weekUntil:"1 week from now",weeksUntil:"{delta} weeks from now",monthUntil:"1 month from now",monthsUntil:"{delta} months from now",yearUntil:"1 year from now",yearsUntil:"{delta} years from now"});(function(){var a=this.Date;a.Methods={ms:"Milliseconds",year:"FullYear",min:"Minutes",mo:"Month",sec:"Seconds",hr:"Hours"};["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","Week","Timezone","GMTOffset","DayOfYear","LastMonth","LastDayOfMonth","UTCDate","UTCDay","UTCFullYear","AMPM","Ordinal","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","UTCMilliseconds"].each(function(v){a.Methods[v.toLowerCase()]=v});var r=function(y,w,v){if(!v){v="0"}return new Array(w-String(y).length+1).join(v)+y};a.implement({set:function(y,w){y=y.toLowerCase();var v=a.Methods;if(v[y]){this["set"+v[y]](w)}return this}.overloadSetter(),get:function(w){w=w.toLowerCase();var v=a.Methods;if(v[w]){return this["get"+v[w]]()}return null},clone:function(){return new a(this.get("time"))},increment:function(v,y){v=v||"day";y=y!=null?y:1;switch(v){case"year":return this.increment("month",y*12);case"month":var w=this.get("date");this.set("date",1).set("mo",this.get("mo")+y);return this.set("date",w.min(this.get("lastdayofmonth")));case"week":return this.increment("day",y*7);case"day":return this.set("date",this.get("date")+y)}if(!a.units[v]){throw new Error(v+" is not a supported interval")}return this.set("time",this.get("time")+y*a.units[v]())},decrement:function(v,w){return this.increment(v,-1*(w!=null?w:1))},isLeapYear:function(){return a.isLeapYear(this.get("year"))},clearTime:function(){return this.set({hr:0,min:0,sec:0,ms:0})},diff:function(w,v){if(typeOf(w)=="string"){w=a.parse(w)}return((w-this)/a.units[v||"day"](3,3)).round()},getLastDayOfMonth:function(){return a.daysInMonth(this.get("mo"),this.get("year"))},getDayOfYear:function(){return(a.UTC(this.get("year"),this.get("mo"),this.get("date")+1)-a.UTC(this.get("year"),0,1))/a.units.day()},getWeek:function(){return(this.get("dayofyear")/7).ceil()},getOrdinal:function(v){return a.getMsg("ordinal",v||this.get("date"))},getTimezone:function(){return this.toString().replace(/^.*? ([A-Z]{3}).[0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},getGMTOffset:function(){var v=this.get("timezoneOffset");return((v>0)?"-":"+")+r((v.abs()/60).floor(),2)+r(v%60,2)},setAMPM:function(v){v=v.toUpperCase();var w=this.get("hr");if(w>11&&v=="AM"){return this.decrement("hour",12)}else{if(w<12&&v=="PM"){return this.increment("hour",12)}}return this},getAMPM:function(){return(this.get("hr")<12)?"AM":"PM"},parse:function(v){this.set("time",a.parse(v));return this},isValid:function(v){return !isNaN((v||this).valueOf())},format:function(w){if(!this.isValid()){return"invalid date"}if(!w){w="%x %X"}var v=w.toLowerCase();if(u[v]){return u[v](this)}w=g[v]||w;var y=this;return w.replace(/%([a-z%])/gi,function(A,z){switch(z){case"a":return a.getMsg("days_abbr")[y.get("day")];case"A":return a.getMsg("days")[y.get("day")];case"b":return a.getMsg("months_abbr")[y.get("month")];case"B":return a.getMsg("months")[y.get("month")];case"c":return y.format("%a %b %d %H:%M:%S %Y");case"d":return r(y.get("date"),2);case"e":return r(y.get("date"),2," ");case"H":return r(y.get("hr"),2);case"I":return r((y.get("hr")%12)||12,2);case"j":return r(y.get("dayofyear"),3);case"k":return r(y.get("hr"),2," ");case"l":return r((y.get("hr")%12)||12,2," ");case"L":return r(y.get("ms"),3);case"m":return r((y.get("mo")+1),2);case"M":return r(y.get("min"),2);case"o":return y.get("ordinal");case"p":return a.getMsg(y.get("ampm"));case"s":return Math.round(y/1000);case"S":return r(y.get("seconds"),2);case"U":return r(y.get("week"),2);case"w":return y.get("day");case"x":return y.format(a.getMsg("shortDate"));case"X":return y.format(a.getMsg("shortTime"));case"y":return y.get("year").toString().substr(2);case"Y":return y.get("year");case"T":return y.format("%H:%M:%S");case"z":return y.get("GMTOffset");case"Z":return y.get("Timezone")}return z})},toISOString:function(){return this.format("iso8601")}});a.alias("toJSON","toISOString");a.alias("compare","diff");a.alias("strftime","format");var g={db:"%Y-%m-%d %H:%M:%S",compact:"%Y%m%dT%H%M%S",iso8601:"%Y-%m-%dT%H:%M:%S%z","short":"%d %b %H:%M","long":"%B %d, %Y %H:%M"};var l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var u={rfc822:function(v){return l[v.get("day")]+v.format(", %d ")+h[v.get("month")]+v.format(" %Y %H:%M:%S %Z")},rfc2822:function(v){return l[v.get("day")]+v.format(", %d ")+h[v.get("month")]+v.format(" %Y %H:%M:%S %z")}};var c=[];var p=a.parse;var t=function(z,B,y){var w=-1;var A=a.getMsg(z+"s");switch(typeOf(B)){case"object":w=A[B.get(z)];break;case"number":w=A[B];if(!w){throw new Error("Invalid "+z+" index: "+B)}break;case"string":var v=A.filter(function(C){return this.test(C)},new RegExp("^"+B,"i"));if(!v.length){throw new Error("Invalid "+z+" string")}if(v.length>1){throw new Error("Ambiguous "+z)}w=v[0]}return(y)?A.indexOf(w):w};a.extend({getMsg:function(w,v){return Locale.get("Date."+w,v)},units:{ms:Function.from(1),second:Function.from(1000),minute:Function.from(60000),hour:Function.from(3600000),day:Function.from(86400000),week:Function.from(608400000),month:function(w,v){var y=new a;return a.daysInMonth(w!=null?w:y.get("mo"),v!=null?v:y.get("year"))*86400000},year:function(v){v=v||new a().get("year");return a.isLeapYear(v)?31622400000:31536000000}},daysInMonth:function(w,v){return[31,a.isLeapYear(v)?29:28,31,30,31,30,31,31,30,31,30,31][w]},isLeapYear:function(v){return((v%4===0)&&(v%100!==0))||(v%400===0)},parse:function(y){var w=typeOf(y);if(w=="number"){return new a(y)}if(w!="string"){return y}y=y.clean();if(!y.length){return null}var v;c.some(function(A){var z=A.re.exec(y);return(z)?(v=A.handler(z)):false});if(!(v&&v.isValid())){v=new a(p(y));if(!(v&&v.isValid())){v=new a(y.toInt())}}return v},parseDay:function(v,w){return t("day",v,w)},parseMonth:function(w,v){return t("month",w,v)},parseUTC:function(w){var v=new a(w);var y=a.UTC(v.get("year"),v.get("mo"),v.get("date"),v.get("hr"),v.get("min"),v.get("sec"),v.get("ms"));return new a(y)},orderIndex:function(v){return a.getMsg("dateOrder").indexOf(v)+1},defineFormat:function(v,w){g[v]=w},defineFormats:function(v){for(var w in v){a.defineFormat(w,v[w])}},defineParser:function(v){c.push((v.re&&v.handler)?v:m(v))},defineParsers:function(){Array.flatten(arguments).each(a.defineParser)},define2DigitYearStart:function(v){q=v%100;j=v-q}});var j=1900;var q=70;var d=function(v){return new RegExp("(?:"+a.getMsg(v).map(function(w){return w.substr(0,3)}).join("|")+")[a-z]*")};var o=function(v){switch(v){case"T":return"%H:%M:%S";case"x":return((a.orderIndex("month")==1)?"%m[-./]%d":"%d[-./]%m")+"([-./]%y)?";case"X":return"%H([.:]%M)?([.:]%S([.:]%s)?)? ?%p? ?%z?"}return null};var k={d:/[0-2]?[0-9]|3[01]/,H:/[01]?[0-9]|2[0-3]/,I:/0?[1-9]|1[0-2]/,M:/[0-5]?\d/,s:/\d+/,o:/[a-z]*/,p:/[ap]\.?m\.?/,y:/\d{2}|\d{4}/,Y:/\d{4}/,z:/Z|[+-]\d{2}(?::?\d{2})?/};k.m=k.I;k.S=k.M;var f;var b=function(v){f=v;k.a=k.A=d("days");k.b=k.B=d("months");c.each(function(y,w){if(y.format){c[w]=m(y.format)}})};var m=function(y){if(!f){return{format:y}}var v=[];var w=(y.source||y).replace(/%([a-z])/gi,function(A,z){return o(z)||A}).replace(/\((?!\?)/g,"(?:").replace(/ (?!\?|\*)/g,",? ").replace(/%([a-z%])/gi,function(A,z){var B=k[z];if(!B){return z}v.push(z);return"("+B.source+")"}).replace(/\[a-z\]/gi,"[a-z\\u00c0-\\uffff;&]");return{format:y,re:new RegExp("^"+w+"$","i"),handler:function(C){C=C.slice(1).associate(v);var z=new a().clearTime(),B=C.y||C.Y;if(B!=null){s.call(z,"y",B)}if("d" in C){s.call(z,"d",1)}if("m" in C||C.b||C.B){s.call(z,"m",1)}for(var A in C){s.call(z,A,C[A])}return z}}};var s=function(v,w){if(!w){return this}switch(v){case"a":case"A":return this.set("day",a.parseDay(w,true));case"b":case"B":return this.set("mo",a.parseMonth(w,true));case"d":return this.set("date",w);case"H":case"I":return this.set("hr",w);case"m":return this.set("mo",w-1);case"M":return this.set("min",w);case"p":return this.set("ampm",w.replace(/\./g,""));case"S":return this.set("sec",w);case"s":return this.set("ms",("0."+w)*1000);case"w":return this.set("day",w);case"Y":return this.set("year",w);case"y":w=+w;if(w<100){w+=j+(w<q?100:0)}return this.set("year",w);case"z":if(w=="Z"){w="+00"}var y=w.match(/([+-])(\d{2}):?(\d{2})?/);y=(y[1]+"1")*(y[2]*60+(+y[3]||0))+this.getTimezoneOffset();return this.set("time",this-y*60000)}return this};a.defineParsers("%Y([-./]%m([-./]%d((T| )%X)?)?)?","%Y%m%d(T%H(%M%S?)?)?","%x( %X)?","%d%o( %b( %Y)?)?( %X)?","%b( %d%o)?( %Y)?( %X)?","%Y %b( %d%o( %X)?)?","%o %b %d %X %z %Y","%T","%H:%M( ?%p)?");Locale.addEvent("change",function(v){if(Locale.get("Date")){b(v)}}).fireEvent("change",Locale.getCurrent())})();(function(){var a=function(b,c){b=b||"";var d=c?"<"+b+"(?!\\w)[^>]*>([\\s\\S]*?)</"+b+"(?!\\w)>":"</?"+b+"([^>]+)?>";reg=new RegExp(d,"gi");return reg};String.implement({getTags:function(b,c){return this.match(a(b,c))||[]},stripTags:function(b,c){return this.replace(a(b,c),"")}})})();var Asset={javascript:function(g,c){if(!c){c={}}var a=new Element("script",{src:g,type:"text/javascript"}),h=c.document||document,b=0,d=c.onload||c.onLoad;var f=d?function(){if(++b==1){d.call(this)}}:function(){};delete c.onload;delete c.onLoad;delete c.document;return a.addEvents({load:f,readystatechange:function(){if(["loaded","complete"].contains(this.readyState)){f.call(this)}}}).set(c).inject(h.head)},css:function(d,a){if(!a){a={}}var b=new Element("link",{rel:"stylesheet",media:"screen",type:"text/css",href:d});var c=a.onload||a.onLoad,f=a.document||document;delete a.onload;delete a.onLoad;delete a.document;if(c){b.addEvent("load",c)}return b.set(a).inject(f.head)},image:function(c,b){b=Object.merge({onload:function(){},onabort:function(){},onerror:function(){}},b);var d=new Image();var a=document.id(d)||new Element("img");["load","abort","error"].each(function(f){var h="on"+f;var g=f.capitalize();if(b["on"+g]){b[h]=b["on"+g];delete b["on"+g]}var j=b[h];delete b[h];d[h]=function(){if(!d){return}if(!a.parentNode){a.width=d.width;a.height=d.height}d=d.onload=d.onabort=d.onerror=null;j.delay(1,a,a);a.fireEvent(f,a,1)}});d.src=a.src=c;if(d&&d.complete){d.onload.delay(1)}return a.set(b)},images:function(c,b){b=Object.merge({onComplete:function(){},onProgress:function(){},onError:function(){},properties:{}},b);c=Array.from(c);var a=0;return new Elements(c.map(function(f,d){return Asset.image(f,Object.append(b.properties,{onload:function(){a++;b.onProgress.call(this,a,d,f);if(a==c.length){b.onComplete()}},onerror:function(){a++;b.onError.call(this,a,d,f);if(a==c.length){b.onComplete()}}}))}))}};var IframeShim=new Class({Implements:[Options,Events,Class.Occlude],options:{className:"iframeShim",src:'javascript:false;document.write("");',display:false,zIndex:null,margin:0,offset:{x:0,y:0},browsers:(Browser.ie6||(Browser.firefox&&Browser.version<3&&Browser.Platform.mac))},property:"IframeShim",initialize:function(b,a){this.element=document.id(b);if(this.occlude()){return this.occluded}this.setOptions(a);this.makeShim();return this},makeShim:function(){if(this.options.browsers){var c=this.element.getStyle("zIndex").toInt();if(!c){c=1;var b=this.element.getStyle("position");if(b=="static"||!b){this.element.setStyle("position","relative")}this.element.setStyle("zIndex",c)}c=((this.options.zIndex!=null||this.options.zIndex===0)&&c>this.options.zIndex)?this.options.zIndex:c-1;if(c<0){c=1}this.shim=new Element("iframe",{src:this.options.src,scrolling:"no",frameborder:0,styles:{zIndex:c,position:"absolute",border:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},"class":this.options.className}).store("IframeShim",this);var a=(function(){this.shim.inject(this.element,"after");this[this.options.display?"show":"hide"]();this.fireEvent("inject")}).bind(this);if(!IframeShim.ready){window.addEvent("load",a)}else{a()}}else{this.position=this.hide=this.show=this.dispose=Function.from(this)}},position:function(){if(!IframeShim.ready||!this.shim){return this}var a=this.element.measure(function(){return this.getSize()});if(this.options.margin!=undefined){a.x=a.x-(this.options.margin*2);a.y=a.y-(this.options.margin*2);this.options.offset.x+=this.options.margin;this.options.offset.y+=this.options.margin}this.shim.set({width:a.x,height:a.y}).position({relativeTo:this.element,offset:this.options.offset});return this},hide:function(){if(this.shim){this.shim.setStyle("display","none")}return this},show:function(){if(this.shim){this.shim.setStyle("display","block")}return this.position()},dispose:function(){if(this.shim){this.shim.dispose()}return this},destroy:function(){if(this.shim){this.shim.destroy()}return this}});window.addEvent("load",function(){IframeShim.ready=true});Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(a){if(this.options.log&&window.console&&console.log){console.log("JSONP retrieving script with url:"+a)}},onError:function(a){if(this.options.log&&window.console&&console.warn){console.warn("JSONP "+a+" will fail in Internet Explorer, which enforces a 2083 bytes length limit on URIs")}},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:false},initialize:function(a){this.setOptions(a)},send:function(c){if(!Request.prototype.check.call(this,c)){return this}this.running=true;var d=typeOf(c);if(d=="string"||d=="element"){c={data:c}}c=Object.merge(this.options,c||{});var f=c.data;switch(typeOf(f)){case"element":f=document.id(f).toQueryString();break;case"object":case"hash":f=Object.toQueryString(f)}var b=this.index=Request.JSONP.counter++;var g=c.url+(c.url.test("\\?")?"&":"?")+(c.callbackKey)+"=Request.JSONP.request_map.request_"+b+(f?"&"+f:"");if(g.length>2083){this.fireEvent("error",g)}Request.JSONP.request_map["request_"+b]=function(){this.success(arguments,b)}.bind(this);var a=this.getScript(g).inject(c.injectScript);this.fireEvent("request",[a.get("src"),a]);if(c.timeout){this.timeout.delay(c.timeout,this)}return this},getScript:function(a){if(!this.script){this.script=new Element("script[type=text/javascript]",{async:true,src:a})}return this.script},success:function(b,a){if(!this.running){return false}this.clear().fireEvent("complete",b).fireEvent("success",b).callChain()},cancel:function(){if(this.running){this.clear().fireEvent("cancel")}return this},isRunning:function(){return !!this.running},clear:function(){this.running=false;if(this.script){this.script.destroy();this.script=null}return this},timeout:function(){if(this.running){this.running=false;this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()}return this}});Request.JSONP.counter=0;Request.JSONP.request_map={};
/*
Copyright (c) 2009 Arieh Glazer

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE
*/
(function(a){function b(){}a.instantiate=function(d,h){b.prototype=d.prototype;var g=new b(),c=d.apply(g,h);return c||g};a.implement({instantiate:function(c){return a.instantiate(this,c)}})})(Function);IdleTimer=new Class({Implements:[Events,Options],options:{timeout:60000,events:["mousemove","keydown","mousewheel","mousedown"]},initialize:function(b,a){this.setOptions(a);this.element=$(b);this.activeBound=this.active.bind(this);this.isIdle=false;this.started=false},stop:function(){clearTimeout(this.timer);for(var a in this.options.events){this.element.removeEvent(this.options.events[a],this.activeBound)}this.bound=false;this.started=false;this.fireEvent("stop");return this},active:function(){clearTimeout(this.timer);if(this.isIdle){this.fireEvent("active")}this.isIdle=false;this.start()},idle:function(){if(this.timer){clearTimeout(this.timer)}this.isIdle=true;this.fireEvent("idle")},start:function(){this.timer=this.idle.delay(this.options.timeout,this);this.lastActive=new Date().getTime();if(!this.bound){this.bind()}this.started=true;return this},bind:function(){for(var a in this.options.events){this.element.addEvent(this.options.events[a],this.activeBound)}this.bound=true;this.fireEvent("start")},getIdleTime:function(a){return a?Math.round((Date.now()-this.lastActive)/1000):Date.now()-this.lastActive},setTimeout:function(c,d){var b=this.options.timeout;this.options.timeout=c;if(d){return this}clearTimeout(this.timer);this.fireEvent("timeoutChanged",c);var a=this.getIdleTime();if(a<c&&this.isIdle){this.fireEvent("active");this.isIdle=false}else{if(a>=c){this.idle();return this}}this.timer=this.idle.delay(c-a,this);return this}});Element.Properties.idle={set:function(a){var b=this.retrieve("idle");if(b){b.stop()}return this.eliminate("idle").store("idle:options",a)},get:function(a){if(a||!this.retrieve("idle")){if(a||!this.retrieve("idle:options")){this.set("idle",a)}this.store("idle",new IdleTimer(this,this.retrieve("idle:options")))}return this.retrieve("idle")}};Element.Events.idle={onAdd:function(a){var b=this.get?false:true;var c=b?window.idleTimer:this.get("idle");if(b&&!c){c=window.idleTimer=new IdleTimer(this)}if(!c.started){c.start()}c.addEvent("idle",a)}};Element.Events.active={onAdd:function(a){(this.get?this.get("idle"):window.idleTimer).addEvent("active",a)}};Array.implement({getRandomIndex:function(){return Number.random(0,this.length-1)},copy:function(){return this.splice(0,this.length)},toQueryString:function(){var a=this.map(function(c,b){switch(typeOf(c)){case"element":return ta.id(c).toQueryString();break;case"object":return Object.toQueryString(c)}});return a.join("&")}});Cookie=Class.refactor(Cookie,{write:function(b){if(this.options.encode){b=encodeURIComponent(b)}if(this.options.domain){b+="; domain="+this.options.domain}if(this.options.path){b+="; path="+this.options.path}if(this.options.duration){var a=new Date();a.setTime(a.getTime()+this.options.duration*24*60*60*1000);b+="; expires="+a.toGMTString()}if(this.options.time){var a=new Date();a.setTime(a.getTime()+this.options.time*1000);b+="; expires="+a.toGMTString()}if(this.options.expires){var a=new Date(this.options.expires);b+="; expires="+a.toGMTString()}if(this.options.secure){b+="; secure"}this.options.document.cookie=this.key+"="+b;return this},readRaw:function(a){var b=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return b?b[1]:false}});Cookie.exist=function(a){return document.cookie.match("(?:^|;)\\s*"+a.escapeRegExp()+"=([^;]*)")!=null};Cookie.readSession=function(c,a){if(a==null){a={}}var b=new Cookie("TASession",{encode:false}).readRaw();var d=a.pattern?a.pattern:"[^\\*]+";var f=new RegExp("(\\*|^)"+c+"\\.("+d+")");if(f.test(b)){return{cookie:b,pattern:f,start:RegExp.$1,value:RegExp.$2}}return{cookie:b,pattern:f}};Cookie.writeSession=function(d,f,c){var a=this.readSession(d,c);if(!a.cookie){return false}var b;if(a.value){b=a.cookie.replace(a.pattern,a.start+d+"."+f)}else{b=a.cookie+"*"+d+"."+f}new Cookie("TASession",{domain:cookieDomain,encode:false}).write(b);return true};Cookie.readRaw=function(a){return new Cookie(a).readRaw()};Element.implement({getParentBySelector:function(a){try{if(!a){return $(this.parentNode)}return this.getParents(a)[0]||null}catch(b){ta.util.error.record(b,"Element.extend - getParentBySelector",null,{selector:a})}},findParentByClass:function(b){if(!this.parentNode){return null}var a=$(this.parentNode);if(a==document){return null}if(a.hasClass(b)){return a}return a.findParentByClass(b)},getLastElement:function(a){return $(this.getElements(a,true).reverse()[0]||false)},centerOnScreen:function(){var a=this.getCoordinates();this.style.left=Math.round((Window.getWidth()-a.width)/2)+Window.getScrollLeft()+"px";this.style.top=Math.round((Window.getHeight()-a.height)/2)+Window.getScrollTop()+"px"},positionOnScreen:function(b,a){this.style.left=Window.getScrollLeft()+b+"px";this.style.top=Window.getScrollTop()+a+"px"},containsEvent:function(c){if(!c||!c.page||!c.client){return false}c=new Event(c);var b=c.page;var a=this.getCoordinates();if("fixed"==(this.getOffsetParent()||this).style.position){b=c.client}return(b.y>=a.top&&b.y<=a.bottom&&b.x>=a.left&&b.x<=a.right)},overlaps:function(b){var h=this.getCoordinates();var g=b.getCoordinates();var a=(g.left>h.left&&g.left<h.right)||(g.right>h.left&&g.right<h.right);var f=g.top>h.top&&g.top<h.bottom;var d=g.bottom>h.top&&g.bottom<h.bottom;return(f&&a)||(d&&a)},linkify:function(){var b=new Element("a",{"class":this.className,href:"javascript:;"}).set("html",this.innerHTML).replaces(this);_processLink(b);return b},setContent:function(a){if(a instanceof Array||typeOf(a)=="elements"){a.each(function(b){this.adopt($(b))},this)}else{if(typeOf(a)=="string"){this.set("html",a)}else{this.adopt($(a))}}return this},isHidden:function(){return this.getStyle("display")=="none"},inDocument:function(){return this.parentNode!=null&&this.parentNode.nodeType!=11},removePropertyEvent:function(d,b){if(d.substr(0,2)!=="on"){d="on"+d}var j="ta.call(",h=this.getProperty(d),a=h&&h.indexOf(b),g=h&&h.indexOf(")",a),f;if(!h||a<0){return}if(h.charAt(g+1)==";"){g++}if(h.charAt(a+b.length)=="("){f=h.slice(0,a)+h.slice(g+1)}else{if(a>=j.length+1&&h.substr(a-j.length-1,j.length)==j){a-=j.length+1;f=h.slice(0,a)+h.slice(g+1)}}this.setProperty(d,f&&f.trim())}});Function.implement({invokeLater:function(b,c,a){return setTimeout(this.pass(a,c),b)},executeContinuations:function(b,d){var c=Array.prototype.slice.apply(arguments);if(c.length>2){d=c[2]}if(b.length>0){var a=b[0];var f=Function.executeContinuations.partial(b.slice(1),null,d);a(f,d)}else{}},inContinuationPassingForm:function(a){return function(c,b){if(a()){if(c){c()}}else{if(b){b()}}}}});Function.implement({_:{},partial:function(){var d=this;var b=Function._;var a=Array.prototype.slice.call(arguments);var g=[],f;for(var c=0;c<arguments.length;c++){arguments[c]==b&&g.push(c)}return function(){var j=a.concat(Array.prototype.slice.call(arguments,g.length));for(var h=0;h<Math.min(g.length,arguments.length);h++){j[g[h]]=arguments[h]}for(var h=0;h<j.length;h++){if(j[h]==b){return d.partial.apply(d,j)}}return d.apply(this,j)}}});Request=Class.refactor(Request,{initialize:function(b){if(b.url){var a=String(b.url);if(!/^http/.test(a)){b.url=window.location.protocol+"//"+window.location.host+a}else{if(/^(\w+):\/\/([\w.\-]+)\/(.*)/.test(a)&&RegExp.$2!=window.location.host){b.url=RegExp.$1+"://"+window.location.host+"/"+RegExp.$3}}}if(b&&b.data&&b.data.constructor&&(b.data instanceof Array)){b.data=b.data.toQueryString()}try{if(b.trackEvent&&ta&&ta.analytics){var d=ta.analytics._toEvtParams(b.trackEvent);if(d){if(b.data){if(typeof b.data=="string"){b.data=b.data+"&"+Object.toQueryString(d)}else{if(typeof b.data=="object"){b.data=Object.merge(b.data,d)}}}else{b.data=d}}}}catch(c){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(c,"Request.Absolute.initialize.trackEvent")}}return this.previous(b)},processScripts:function(c){if(this.options.keepScripts){return c}var a=c;try{a=this.previous(c)}catch(b){ta.util.error.record(b,"Request.processScripts",null,{"request url":this.options.url})}return a},send:function(a){var c=this.previous(a);if(ta&&ta.util&&ta.util.cookie){ta.util.cookie.removePIDCookie()}try{if(this.options&&ta&&ta.analytics){if(this.options.trackEvent){ta.analytics._trackEventAfterAjax(this.options.trackEvent)}if(this.options.trackPath){ta.analytics._trackEventPathAfterAjax(this.options.trackPath)}}}catch(b){if(ta&&ta.util&&ta.util.error&&ta.util.error.record){ta.util.error.record(b,"Request.Absolute.send.trackEventAfterAjax")}}return c}});(function(){var A=this;var v=A._;var d={};var p=Array.prototype,G=Object.prototype,I=Function.prototype;var o=p.push,y=p.slice,C=p.unshift,B=G.toString,t=G.hasOwnProperty;var s=p.forEach,m=p.map,E=p.reduce,h=p.reduceRight,r=p.filter,b=p.every,D=p.some,z=p.indexOf,j=p.lastIndexOf,f=Array.isArray,F=Object.keys,q=I.bind;var H=function(K){return new l(K)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=H}exports._=H}else{A._=H}H.VERSION="1.3.3";var g=H.each=H.forEach=function(P,O,N){if(P==null){return}if(s&&P.forEach===s){P.forEach(O,N)}else{if(P.length===+P.length){for(var M=0,K=P.length;M<K;M++){if(O.call(N,P[M],M,P)===d){return}}}else{for(var L in P){if(H.has(P,L)){if(O.call(N,P[L],L,P)===d){return}}}}}};H.defaults=function(K){g(y.call(arguments,1),function(L){for(var M in L){if(K[M]==null){K[M]=L[M]}}});return K};H.extend=function(K){g(y.call(arguments,1),function(L){for(var M in L){K[M]=L[M]}});return K};H.escape=function(K){return(""+K).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};H.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var w=/.^/;var a={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var J in a){a[a[J]]=J}var c=/\\|'|\r|\n|\t|\u2028|\u2029/g;var k=/\\(\\|'|r|n|t|u2028|u2029)/g;var u=function(K){return K.replace(k,function(L,M){return a[M]})};H.template=function(P,O,M){M=H.defaults(M||{},H.templateSettings);var N="__p+='"+P.replace(c,function(Q){return"\\"+a[Q]}).replace(M.escape||w,function(Q,R){return"'+\n((__t=("+u(R)+"))==null?'':_.escape(__t))+\n'"}).replace(M.interpolate||w,function(Q,R){return"'+\n((__t=("+u(R)+"))==null?'':__t)+\n'"}).replace(M.evaluate||w,function(Q,R){return"';\n"+u(R)+"\n__p+='"})+"';\n";if(!M.variable){N="with(obj||{}){\n"+N+"}\n"}N="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'')};\n"+N+"return __p;\n";var L=new Function(M.variable||"obj","_",N);if(O){return L(O,H)}var K=function(Q){return L.call(this,Q,H)};K.source="function("+(M.variable||"obj")+"){\n"+N+"}";return K};var l=function(K){this._wrapped=K}}).call(this);if(window.IS_DEBUG==null){var IS_DEBUG=false}if(window.VERSION_MAP==null){var VERSION_MAP={}}if(window.CDNHOST==null){var CDNHOST=""}ta={overlays:{},maps:{},bmaps:{},common:{},phac:{},servlet:{},support:{},util:{},widgets:{},commerce:{},mobfull:{},photos:{},media:{},hac:{filters:{}},t4b:{},api:{maps:{}},p13n:{}};ta.id=function(a){try{return document.id(a)}catch(b){if(ta.util.error){ta.util.error.record(b,"ta.id - trouble wrapping",null,{elmtArg:ta.util.error.describe(a)})}}};ta.select=function(){var b=Array.from(arguments),c=b.length>1&&(("string"===typeof b[0])?b.pop():b.shift())||document,a=b.shift();return Slick.search(c,a,new Elements)};ta.invoke=function(a,b){a.each(function(c){c[b]()})};ta.selectInvoke=function(a,b){ta.invoke($$(a),b)};var api=ta;api.extend=_.extend;api.bind=function(a,b){return Function.prototype.bind.apply(a,Array.from(arguments).slice(1))};api.addEvent=function(a,c,b){return a&&$(a).addEvent(c,b)};api.removeEvent=function(a,c,b){return a&&$(a).removeEvent(c,b)};api.createElement=function(a,b){return new Element(a,b)};api.getSize=function(a){return a&&$(a).getSize()};api.getPosition=function(a){return a&&$(a).getPosition()};api.addClass=function(a,b){return a&&$(a).addClass(b)};api.removeClass=function(a,b){return a&&$(a).removeClass(b)};api.find=function(a,b){return $(b||document).getElement(a)};api.bindAll=function(a){if(arguments.length>1){Array.from(arguments).slice(1).each(function(b){a[b]=api.bind(a[b],a)})}else{Object.each(a,function(c,b){a[b]=api.bind(c,a)})}return a};api.checkBrowser=function(){return Array.from(arguments).some(function(a){return !!Browser[a]})};(function(a){var b={};a.store=function(c,d){b[c]=d;return d};a.retrieve=function(c){return b[c]};a.has=function(c){return typeof(b[c])!="undefined"};a.remove=function(c){var d=b[c];delete b[c];return d};a.keep=function(f,g){var d=[];var c=a.retrieve(f);if(c){if(c instanceof Array){d=c}else{d.push(c)}}if(g instanceof Array){d=d.combine(g)}else{d.push(g)}a.store(f,d)};a.merge=function(c,f){var d=a.retrieve(c)||{};a.store(c,Object.merge(d,f))};a.asInt=function(d,c){var f=parseInt(a.retrieve(d));return isNaN(f)?(c||0):f};a.asFloat=function(d,c){var g=parseFloat(a.retrieve(d));return isNaN(g)?(c||0):g}})(ta);ta.load=function(b,g){var f=false;var c=ta.findFileKey(b);if(c){f=VERSION_MAP[c]}if(f){var a=c+"_callback";if(ta.has(a)){var d=ta.retrieve(a);d.push(g);ta.store(a,d)}else{ta.store(a,[function(){delete VERSION_MAP[c];if(g){g()}}]);Asset.javascript(f,{onLoad:function(){var h=ta.remove(a);h.each(function(j){j()})}})}}return f};ta.findFileKey=function(g){if(typeof g!="string"||!VERSION_MAP){return}var d=false;var c=false;if(VERSION_MAP[g]){c=g}else{if(VERSION_MAP[g+".js"]){c=g+".js"}else{var a=g.split(".");var b=0;while(a&&a.length>1&&b<10){a=a.slice(0,-1);var f=a.join("-")+".js";if(f&&VERSION_MAP[f]){c=f;break}b++}}}return c};ta.findFile=function(c){var a=ta.findFileKey(c);var b=false;if(a){b=VERSION_MAP[a];delete VERSION_MAP[a]}return b};(function(ta){ta.call=function(funcName,evnt,elmt){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}var e=new Event(evnt||window.event);if(!elmt){elmt=e.target}elmt=ta.id(elmt);if(!elmt){ta.util.error.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:ta.util.error.describe(orgElem||{none:"none"}),funcName:funcName});elmt=orgElem}else{if(!elmt.$family){ta.util.error.record(null,"ta.call re-wrap fail - "+funcName,evnt,{elmtArg:ta.util.error.describe(elmt),funcName:funcName})}}var argSet=arguments;var args=Array.from(argSet).slice(3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(funcName);return ta.run.apply(null,args)}catch(_ex){ta.util.error.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}ta.run.apply(null,arguments)};ta.run=function(func,options){var argSet=arguments,args=Array.from(argSet).slice(2);try{var fn=ta.fn(func);if(fn&&typeOf(fn)==="function"){var retVal=fn.apply(window,Array.from(args));if(options&&options.onComplete){var completeFun=ta.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){new Event(options.evt).preventDefault()}}var callback=options&&options.callback;ta.load(func,(callback||ta.run).pass(arguments))}catch(_ex){ta.util.error.record(_ex,"ta.run - "+func)}return false};var EVENT_PASSED=function(args){this.args=args};ta.on=function(name,f){var v=ta.retrieve(name);if(v instanceof EVENT_PASSED){setTimeout(function(){f.attempt(v.args)},0)}else{ta.keep(name,f)}};ta.fireNonRecurringEvent=function(name){var listeners=ta.retrieve(name);var args=Array.from(arguments);args.shift();ta.store(name,new EVENT_PASSED(args));if(listeners instanceof Array){listeners.each(function(x){x.attempt(args)})}};ta.fireEvent=function(){var args=Array.from(arguments);var event=args.shift();var listeners=ta.retrieve(event);if(listeners){listeners.each(function(callback){callback.attempt(args)})}};ta.fireEventAndUnregister=function(){var args=Array.from(arguments),event=args.shift(),listeners=ta.remove(event);listeners&&listeners.each(function(callback){callback.attempt(args)})};var OneTimeFunctionQueue=function(evtName){var _queue=[];var _runNow=false;var _execFn=function(fn,name){try{fn()}catch(_ex){try{ta.util.error.record(_ex,"OneTimeFunctionQueue "+evtName+(name?"-"+name:""))}catch(ignore){}}};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return(a.priority-b.priority)||(a.subpriority-b.subpriority)});for(var i=0;i<_queue.length;++i){_execFn(_queue[i].func,_queue[i].name)}_queue=[]};if(evtName!=null){window.addEvent(evtName,function(){_runNow=true;_runQueuedFunctions()})}this.addToQueue=function(fn,priority,name){if(!fn){ta.util.error.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name,subpriority:_queue.length})}};this.executeQueue=function(){_runQueuedFunctions()}};var _readyQ=new OneTimeFunctionQueue("domready");var _loadQ=new OneTimeFunctionQueue("load");var _lazyImgQ=new OneTimeFunctionQueue(null);ta.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};ta.queueForLoad=function(fn,priority,name){if(typeof IS_DEBUG!="undefined"&&IS_DEBUG){var tempName=name;if(typeof priority==="string"){tempName=priority}if(!tempName){}}_loadQ.addToQueue(fn,priority,name)};ta.queueLazyImg=function(element){var priority;try{priority=element.priority||1000}catch(ignore){return}var _fn=function(){try{if(element.oSRC!=""){element.src=element.oSRC;element.oSRC="";element.priority=""}}catch(e){ta.util.error.record(e,"lazy img",null,{src:element.src,oSRC:element.oSRC})}};_lazyImgQ.addToQueue(_fn,priority)};ta.processLazyImages=function(){_lazyImgQ.executeQueue()};ta.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null}}(ta));(function(k,l,h){l=k.ta=k.ta||{};l.analytics||(l.analytics={});var y=function(){if(l&&l.util&&l.util.error&&l.util.error.record){l.util.error.record.apply(this,arguments)}};var p=function(){return typeof _gaq!="undefined"&&_gaq.push&&l.has("google_analytics_events")};var b=function(z){if(z==h||z==null){return""}if(typeof z!=="string"){z=z.toString()}return z.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*")};var s=function(C){var z=[];for(var A in C){var B=C[A];z.push(b(A)+"."+b(B))}return z.join("*")};var u=function(z){var A=/(http:\/\/[^\/]+)?\/([^#.?-]*)/;var B=A.exec(z);if(B){if(typeof B[2]!="undefined"){return(B[2])?B[2]:"Home"}}return null};var a=function(){var z=l.analytics.pageData&&l.analytics.pageData.length&&l.analytics.pageData[l.analytics.pageData.length-1];if(z&&z.url){return z.url.substring(1)}else{var A=/\/([^-]*)/.exec(k.location.pathname);return A?A[1]:null}};var q=function(B,z,C){var A=new RegExp("(-"+z+"([0-9]+))|([?&]"+C+"=([0-9]+))");var D=A.exec(B);if(D){if(typeof D[2]!="undefined"){return D[2]}if(typeof D[4]!="undefined"){return D[4]}}return null};var f=function(z){return q(z,"d","detail")||q(z,"g","geo")};var r=function(B,A){var z={gac:B[1],gaa:B[2],gal:B[3],gav:B[4],gani:B[5],gass:a(),gasl:f(document.location.href),gads:u(A),gadl:f(A)};if(!z.gass){throw new Error("Src servlet undefined, gac:"+z.gac+", gaa:"+z.gaa+", gal:"+z.gal)}if(!z.gads){throw new Error("Dst servlet undefined. gac:"+z.gac+", gaa:"+z.gaa+", gal:"+z.gal)}Cookie.write("EVT",s(z),{domain:cookieDomain,time:300})};var d=function(C,B){var A={gac:C[1],gaa:C[2],gal:C[3],gav:C[4],gani:C[5],gass:a(),gasl:f(document.location.href)};if(B){A.gacl=B}if(typeof Request!="undefined"){return new Request({url:"/GARecord",data:A})}else{var z=new XMLHttpRequest();z.open("GET","/GARecord?"+g(A),false);return{get:function(){z.send(null)}}}};var g=function(A){var B=[];for(var z in A){B.push(encodeURIComponent(z)+"="+encodeURIComponent(A[z]))}return B.join("&")};l.urlArgLookup=function(C,z){var B=new RegExp("[\\?&]"+C+"=(\\w+)");var A=B.exec(z);if(A&&typeof A[1]!=h){return A[1]}return null};l.analytics._JSON_parse=function(z){if(JSON.parse){return JSON.parse(z)}if(JSON.decode){return JSON.decode(z)}throw new Error("No JSON.parse or JSON.decode")};l.analytics._insertGAScriptElement=function(){try{var F=document.createElement("script");F.type="text/javascript";F.async=true;F.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var D=document.getElementsByTagName("script");var C=D[0];var B=false;for(var A=0;A<D.length;A++){if(D[A].src){B=D[A];break}}var z=B||C;z.parentNode.insertBefore(F,z)}catch(E){y(E,"loading ga.js problem")}};l.analytics._validatedTrackEventArray=function(B,D,z,C,A){if(B&&typeof B!="string"){B=B.toString()}if(D&&typeof D!="string"){D=D.toString()}if(z&&typeof z!="string"){z=z.toString()}if(!C){C=0}else{if(typeof C!="number"){C=parseFloat(C);if(isNaN(C)){C=0}}}if(typeof A!="boolean"){A=A==true}return["_trackEvent",B,D,z,C,A]};l.analytics._toEvtParams=function(B){try{if(p()){var z={gac:B.module,gaa:B.action,gal:B.context,gav:B.value,gani:B.noninteraction};z.gass=a();z.gasl=f(document.location.href);return z}}catch(A){y(A,"ta.analytics._toEvtParams",null,B)}};l.analytics._trackEventAfterAjax=function(B){try{if(p()){var z=l.analytics._validatedTrackEventArray(B.module,B.action,B.context,B.value,B.noninteraction);_gaq.push(z)}}catch(A){y(A,"ta.analytics._trackEventAfterAjax",null,B)}};l.getEventPathOptions=function(E,B,A){try{if(!l.has("p13n_client_tracking_tree")){return}var D=v(A,E);if(!D){y(null,"ta.getEventPathOptions - invalid element",null,arguments);return}var z=o(D);if(B){z.noninteraction=B}return z}catch(C){y(C,"ta.getEventPathOptions",null,arguments)}};l.analytics._trackEventPathAfterAjax=function(z){try{if(!l.has("p13n_client_tracking_tree")){return}l.trackEventOnPage(z.category,z.action,z.label,z.value,z.noninteraction)}catch(A){y(A,"ta.analytics._trackEventPathAfterAjax",null,arguments)}};l.trackPhysicalCommerce=function(B,A,E,z){try{if(p()){var C=l.analytics._validatedTrackEventArray(B,"Commerce-Physical",A,E,false);_gaq.push(C);d(C,z).get()}}catch(D){y(D,"ta.trackPhysicalCommerce",null,arguments)}};l.trackAttemptedCommerce=function(A,z,C,D){try{if(p()){_gaq.push(["_setCustomVar",15,"Provider",C],l.analytics._validatedTrackEventArray(A,"Commerce-Attempted",z,D,false),["_deleteCustomVar",15])}}catch(B){y(B,"ta.trackAttemptedCommerce",null,arguments)}};l.trackPhysicalAndAttemptedCommerce=function(B,A,C,D,z){l.trackPhysicalCommerce(B,A,D,z);l.trackAttemptedCommerce(B,A,C,D)};l.trackEventOnPage=function(A,E,z,D,C){try{if(p()){var B=l.analytics._validatedTrackEventArray(A,E,z,D,C);_gaq.push(B);d(B).get()}}catch(F){y(F,"ta.trackEventOnPage",null,arguments)}};l.setEvtCookie=function(B,E,A,D,z){try{if(p()){var C=l.analytics._validatedTrackEventArray(B,E,A,D,false);r(C,z)}}catch(F){y(F,"ta.setEvtCookie",null,arguments)}};var w="trk";var c=w.length;var m="etk";var t=/([A-Z]{1,2}:)?[A-Za-z_0-9]+$/;var j=function(){var z=(typeof event!="undefined")?event:k.event;if(z){return z.target||z.srcElement}return document.activeElement};var v=function(D,F){if(!D){D=j();if(!D){y(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments);return null}}if(D.nodeType!=1){return null}var I=[];if(F&&typeof F=="string"&&F!=""){if(t.test(F)){if(F.substring(0,2)=="P:"){I.push(F.substring(2));return I}else{I.push(F)}}}LOOP_PARENT_NODES:for(var B=D;B!=document.body;B=B.parentNode){var G=0;for(var z=B.previousSibling;z!=null;z=z.previousSibling){if(z.nodeType==8){var A=z.nodeValue;if(A==m){G++;continue}if(A.substring(0,c)!=w){continue}if(G>0){G--;continue}var C=A.substring(c).split("/");if(!C){y(null,'ta._getCommentTrackingPath - cannot split context class: "'+context+'"',null,arguments)}for(var H=C.length-1;H>=0;H--){var E=t.exec(C[H]);if(!E){y(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+context+'"',null,arguments);continue}if(E[1]=="P:"){I.push(E[0].substring(2));break LOOP_PARENT_NODES}else{I.push(E[0])}}}}}return I};var o=function(B){if(B.length==0){return null}var z={action:B[0],label:"",value:"1",category:B[B.length-1]};B.shift();for(var A=B.length-2;A>=0;A--){z.label+=B[A];if(A>0){z.label+="/"}if(B[A].substring(0,2)=="N:"){z.value=B[A].substring(2)}}if(z.label==""){z.label="Unknown"}return z};l.trk=function(E,B,A){try{if(l.has("p13n_client_tracking_tree")){var D=v(A,E);if(!D){y(null,"ta.trackEventPathOnPage - invalid element for "+E,null,arguments);return}var z=o(D);l.trackEventOnPage(z.category,z.action,z.label,z.value,B)}}catch(C){y(C,"ta.trackEventPathOnPage",null,arguments)}};l.setEvtCookieAndPath=function(E,z,B){try{if(l.has("p13n_client_tracking_tree")){if(!B){B=j()}var D=v(B,E);if(!D){y(null,"ta.setEvtCookieAndPath - invalid element for "+E,null,arguments);return}var A=o(D);if(!z){while(B.nodeName!="A"){if(B==document.body){break}B=B.parentNode}z=B.href;if(!z){_erroRecord(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments);return}}l.setEvtCookie(A.category,A.action,A.label,A.value,z)}}catch(C){y(C,"ta.setEvtCookieAndPath",null,arguments)}}})(window,ta);(function(a){Object.append(a,{isHotelsRedesign2011:function(){if(ta.has("hac.isHotelsRedesign2011")){return ta.retrieve("hac.isHotelsRedesign2011")}if(window.pageServlet=="LastMinute"){ta.store("hac.isHotelsRedesign2011",true);return true}var c=ta.id("HAC_SMRY");var b=c&&c.hasClass("hotels_re_2011");ta.store("hac.isHotelsRedesign2011",b);return b},isSmartDealsFilters:function(){if(ta.has("smartdeals.isSmartDealsFilters")){return ta.retrieve("smartdeals.isSmartDealsFilters")}var b=ta.id("DEALS");var c=b&&b.hasClass("sdfilters");ta.store("smartdeals.isSmartDealsFilters",c);return c},isDHTMLCRRedesign2012:function(){if(ta.has("overlays.isDHTMLCRRedesignBasic")){return ta.retrieve("overlays.isDHTMLCRRedesignBasic")}var b=$$(".overlay");var c=b&&b.hasClass("rgba_flyout");ta.store("overlays.isDHTMLCRRedesignBasic",c);return c},isRestaurantsRedesign2012:function(){if(ta.has("eateries.isRestaurants")){return ta.retrieve("eateries.isRestaurants")}var c=ta.id("EATERIES_2012");var b=c&&c.hasClass("gridA");ta.store("eateries.isRestaurants",b);return b},isAttractionsRedesign2012:function(){if(ta.has("attractions.isAttractions")){return ta.retrieve("attractions.isAttractions")}var b=ta.id("ATTRACTIONS_2012");var c=b&&b.hasClass("gridA");ta.store("attractions.isAttractions",c);return c},isMetaHomepageIntegration2013:function(){if(ta.has("home.isMetaHomepageIntegration2013")){return ta.retrieve("home.isMetaHomepageIntegration2013")}var c=ta.id("PPT");var b=c&&c.hasClass("ppt_container");ta.store("home.isMetaHomepageIntegration2013",b);return b},isMetaHotels2013:function(){if(ta.has("hotelsMeta.isMetaHotels2013")){return ta.retrieve("hotelsMeta.isMetaHotels2013")}var c=ta.id("PAGE");var b=c&&c.hasClass("meta_hotels");ta.store("hotelsMeta.isMetaHotels2013",b);return b},isMetaHotel2013:function(){if(ta.has("hotel.meta2013")){return ta.retrieve("hotel.meta2013")}var d=ta.id("MAIN"),c=d&&(d.hasClass("Hotel_Review")||d.hasClass("ShowUserReviews")||d.hasClass("Hotels")||d.hasClass("HACSearch"))&&!!ta.retrieve("meta.enabled");ta.store("hotel.meta2013",c);return c},isFlights2013:function(){return $$(".new_lander").length>0},isStateOptMiniMeta:function(){return ta.has("metaUI.stateOptMiniMeta")},isDisablePriceTabAutoToggle:function(){return ta.has("metaUI.disablePriceTabAutoToggle")},isMetaHotelMBP2013:function(){if(ta.has("hotelMeta.isMetaHotelMBP2013")){return ta.retrieve("hotelMeta.isMetaHotelMBP2013")}var b=ta.id("HR_MBP");var c=b&&b.hasClass("hackathon_mbp");ta.store("hotelMeta.isMetaHotelMBP2013",c);return c},isStateOptNoAvailOnHREnabled:function(){return ta.has("meta.bc.isMetaUIStateOptHR")},isMetaHotelsRequest:function(){return ta.has("isMetaHotelsRequest")},isMetaPriceFilterCalendar:function(){return ta.has("metaUI.isMetaPriceFilterCalendar")},isBCHoverTable:function(){return ta.has("metaUI.isBCHoverTable")},isHacMap:function(){return ta.has("hac.maps.isHacMap")}})})(ta);ta.browser={isIE9orHigher:function(){if(Browser.ie&&Browser.version>=9){return true}return false},isIE10:function(){return navigator.userAgent.contains("MSIE 10.0")},isIE10Metro:function(){var b=null,a=(window.innerWidth==screen.width&&window.innerHeight==screen.height);try{b=!!new ActiveXObject("htmlfile")}catch(d){b=false}var c=ta.retrieve("metaCheckRatesDebugFeatureEnabled");if(c){return true}else{return navigator.userAgent.contains("MSIE 10.0")&&!b&&a}},isIElt10:function(){if(Browser.ie&&Browser.version<10){return true}return false}};ta.util.cookie={expireTimeForPID:5,expireTimeForPID_remove:0,cookiePIDName:"NPID",setPIDCookie:function(a){try{Cookie.write(ta.util.cookie.cookiePIDName,a,{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID})}catch(b){var c="";if(typeof cookieDomain!="undefined"){c=cookieDomain}ta.util.error.record(b,"set pid cookie",null,{pid:a,cookieDomain:c})}},removePIDCookie:function(){try{Cookie.write(ta.util.cookie.cookiePIDName,"",{domain:cookieDomain,time:ta.util.cookie.expireTimeForPID_remove})}catch(a){}},setAjaxAction:function(c,a){if(c[0]!="/"){c="/"+c}c="target:"+c;try{var f=Array.from(arguments).join("|");Cookie.write("ajaxAction",f,{domain:cookieDomain,path:"/"})}catch(b){var d="";if(typeof cookieDomain!="undefined"){d=cookieDomain}ta.util.error.record(b,"set pid cookie",null,{pid:pid,cookieDomain:d})}},setPID:function(b,a){if(ta.id(a).get("tag")!="a"){a=a.getParent("a")}if(pid=a.className.match(/pid(\d+)/)){ta.util.cookie.setPIDCookie(pid[1])}},setPIDNoA:function(a){pid=a.className.match(/pid(\d+)/);if(pid){ta.util.cookie.setPIDCookie(pid[1])}},showCookieBanner:function(){try{var b=ta.id("COOKIE_BANNER"),c=$(document.body);if(b&&c){b.inject(c,"top");b.setStyles({position:"fixed",top:-3000,left:-3000});b.show();var a=b.getHeight();b.setStyle("margin-top",0-a);b.hide();b.setStyles({top:0,left:0,position:"relative"});b.show();b.set("tween",{duration:"long"});b.tween("margin-top",0);Cookie.write("cookieconsent","1",{duration:3600})}}catch(d){ta.util.error.record(d,"ta.util.cookie.showCookieBanner")}}};setPID=ta.util.cookie.setPIDCookie;ta.util.ASDF={asdf:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}window.location=asdf(b)},asdfPxlAndPid:function(d,b,a){var f="http://ad.doubleclick.net/ad/";var c=";sz=1x1";if(a){ta.util.cookie.setPIDCookie(a)}if(b){new Element("img",{src:f+b+c})}window.location=asdf(d)},asdfPopup:function(b,a){if(a){ta.util.cookie.setPIDCookie(a)}ta.servlet.Popup.open(asdf(b))},asdfPopupEmail:function(a){ta.servlet.Popup.open(asdf(a),"email",580,460,30,25)},asdfPopupGuide:function(a){ta.servlet.Popup.open(asdf(a),"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2)},asdfPopupTerms:function(a){ta.servlet.Popup.open(asdf(a),"terms",300,300,30,25)},asdfPopupDir:function(a){new Request({url:"/ActionRecord?action=getDirectionsListings"}).send();ta.servlet.Popup.open(asdf(a),null,800,600)},asdfDcd:function(a){return asdf(a)}};function getOffset(a){if(a>=97&&a<=122){return a-61}if(a>=65&&a<=90){return a-55}if(a>=48&&a<=71){return a-48}return -1}function asdf(d){var h={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var b="";for(var a=0;a<d.length;a++){var j=d.charAt(a);var f=j;if(h[j]&&a+1<d.length){a++;f+=d.charAt(a)}else{j=""}var g=getOffset(d.charCodeAt(a));if(g<0||typeof h[j][g]=="String"){b+=f}else{b+=h[j][g]}}return b}ta.util.Doer={doit:function(f,d){var c="/"+f;var b=0;for(var a in d){if(b===0){c+="?"}else{c+="&"}c+=a+"="+d[a];b++}return c},aimdoit:function(m,d,a,o){var b=ta.util.Doer.doit(m,d);new Event(a).preventDefault();var l=475;var f=390;var k=210;var j=5;if(o){l=980;f=800;k=240}else{if(screen.width>=1024&&screen.height>=768&&d&&(d.area=="Text_Photos"||d.area=="Thumbnail")){l=900;f=768;k=240}else{if(screen.width>1024){l=800;f=600;k=240}else{if(screen.width>800){l=620;f=500;k=240}}}}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,null,l,f,k,j,false,true));if(ta.retrieve("isDaoDao")){if(ta.retrieve("checkrates.check_more_re")){dd.commerce.checkrates.checkMorePopupAIM(a,d)}}else{var c=ta.has("checkrates.check_rates_lb_mini_meta")&&!(ta.has("checkrates.check_rates_lb_mini_meta_pre_dates")&&ta.widgets.calendar.hasPageDates());var g=ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")&&!ta.widgets.calendar.hasPageDates();if(ta.retrieve("checkrates.isCRLB")&&!ta.id("CHECK_RATES_LB")&&(!ta.retrieve("checkrates.meta_ui_post_click_prices")||c||g)){ta.run("ta.overlays.Factory.loadCheckRatesLBOverlay",{},a,null,d)}}},tadoit:function(d,b,c,a){window.location=ta.util.Doer.tadoless(d,b,c,a)},tadoless:function(h,c,g,k,b){var a="/"+h;for(var j in c){a+="-"+j+c[j]}var f=g.length;for(var d=0;d<f;d++){a+="-"+g[d]}if(!b){a+=".html"}if(k.length>0){a+=k}return a}};ta.util.pending={};ta.util.pending.waitForMore=function(f,c,a,b,d){if(ta.has("pending."+f)){ta.util.pending.cancel(f)}ta.store("pending."+f,{timer:c.delay(a,d,b),fn:c,t:"m",n:a})};ta.util.pending.waitForFn=function(id,fn){try{var tmp=eval(fn),data;if(tmp){if(typeOf(tmp)==="function"){if(ta.has("pending.callback."+id)){ta.retrieve("pending.callback."+id)()}else{if(ta.has("pending."+id)){data=ta.retrieve("pending."+id);if(data.evnt){tmp.attempt([data.evnt,data.elmt])}else{tmp.attempt()}}else{tmp.attempt()}}}else{if(IS_DEBUG){alert("fn is not a function: "+typeOf(tmp))}}}else{ta.util.pending.waitForFnAgain(id,fn)}}catch(e){ta.util.pending.waitForFnAgain(id,fn)}};ta.util.pending.WAIT_DELAY=100;ta.util.pending.WAIT_TIMEOUT=50;ta.util.pending.waitForFnAgain=function(c,a){var b=ta.has("pending."+c)?ta.retrieve("pending."+c):{t:"f",fn:a,count:1};if(b.count<ta.util.pending.WAIT_TIMEOUT){b.count++;b.timer=ta.util.pending.waitForFn.invokeLater(ta.util.pending.WAIT_DELAY,null,[c,a]);ta.store("pending."+c,b)}else{if(IS_DEBUG&&!ta.has("pending.ignore."+c)){alert("timed out ("+(ta.util.pending.WAIT_TIMEOUT*ta.util.pending.WAIT_DELAY)+"ms) waiting for function: "+a)}}};ta.util.pending.waitForFile=function(c,a,b){if(ta.load(a)){ta.util.pending.waitForFn(c,b)}};ta.util.pending.waitForHandler=function(d,b,c,a){ta.store("pending."+d,{count:0,t:"f",fn:b,evnt:c,elmt:a});ta.util.pending.waitForFn(d,b)};ta.util.pending.cancel=function(b){var a=ta.remove("pending."+b);if(a&&a.timer){clearTimeout(a.timer)}};ta.util.pending.lock=function(d,b,c,a){if(ta.has("pending."+d)){return[a,false].pick()}ta.store("pending."+d,true);if(c){ta.util.pending.unlock.delay(c,null,d)}return b()};ta.util.pending.unlock=function(b){var a=ta.remove("pending."+b);if(a&&typeof a==="object"){a.count--;if(a.count===0){a.fn()}else{ta.store("pending."+b,a)}}};ta.util.pending.multilock=function(c,a,b){ta.store("pending."+c,{count:b,fn:a})};ta.util.pending.multilockUpdate=function(d,c){var b="pending."+d,a=ta.retrieve(b);if(a){a.count+=c}};ta.util.pending.wait=function(f,c,b,d,a){ta.store("pending."+f,{timer:c.delay(b,d,a)})};ta.util.pending.waitForElement=function(d,a,c){if(ta.has("pending."+d)){return}var b=$(a);if(b){ta.util.pending.cancel("pending."+d);c(b)}else{ta.store("pending."+d,{timer:ta.util.pending.waitForElement.delay(2,null,[d,a,c])})}};ta.util.pending.waitFor=function(a,c,b){if(a()){return c()}setTimeout(function(){ta.util.pending.waitFor(a,c,b)},b);return false};ta.util.load={loadedMap:false,loadingMap:false,callbacks:[]};ta.util.load.GMaps=function loadGMaps(a){return ta.util.load.maps(a)};ta.util.load.maps=function(a){if(ta.util.load.loadedMap){a&&a()}else{if(ta.util.load.loadingMap){ta.util.load.callbacks.push(a)}else{ta.util.load.loadingMap=true;return ta.maps.load.library(function(){ta.util.load.loadedMap=true;ta.util.load.loadingMap=false;a&&a();ta.util.load.callbacks.each(function(b){b&&b()})})}}};ta.util.load.mapsLazy=function(a){return ta.run("ta.maps.load.library",{},a)};ta.util.load.GoogleLoader=function(a){if(ta.has("googleloader.state")){if(ta.retrieve("googleloader.state")=="loaded"){return a()}else{return ta.util.load.GoogleLoader.delay(500,this,a)}}else{ta.store("googleloader.state","loading");ta.store("googleloader.callback",a);new Asset.javascript("http://www.google.com/jsapi?callback=ta.util.load.GoogleLoaderCallback")}};ta.util.load.GoogleLoaderCallback=function(){ta.store("googleloader.state","loaded");var a=ta.remove("googleloader.callback");a()};ta.util.load.LocalSearch=function(a){ta.util.load.GoogleLoader(function(){google.load("search","1",{callback:function(){}})})};ta.util.date={};ta.util.date.MS_IN_DAY=1000*60*60*24;ta.util.date.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31];ta.util.date.HOUR_CONST=12;ta.util.date.THAI_BUDDHIST_YEAR_OFFSET=543;ta.util.date.inDateSet=function(c,b){if((c==null)||(b==null)){return false}var f=b.length;for(var d=0;d<f;d++){var g=b[d];if(g.length){var h=g[0].getTime();var a=g[1].getTime();if((h<=c.getTime())&&(a>=c.getTime())){return true}}else{if(c.getTime()==g.getTime()){return true}}}return false};ta.util.date.rangesIntersect=function(a,b){return Math.max(a[0].getTime(),b[0].getTime())<=Math.min(a[1].getTime(),b[1].getTime())};ta.util.date.getDaysInRange=function(b,a){return Math.round((a.getTime()-b.getTime())/ta.util.date.MS_IN_DAY)+1};ta.util.date.inSameMonth=function(b,a){return(b!=null)&&(a!=null)&&(b.getMonth()==a.getMonth())&&(b.getYear()==a.getYear())};ta.util.date.normalize=function(a){return a.setHours(ta.util.date.HOUR_CONST,0,0,0)};ta.util.date.create=function(a,b,c){return new Date(a,b,c,ta.util.date.HOUR_CONST)};ta.util.currency={};ta.util.currency.formatCurrency=function(c,a){var f=a?a:"USD";var b=currencySymbol[f];var d=ta.util.currency.formatThousands(Math.round(c));if(!b[1]){return b[0]+d}else{return d+b[0]}};ta.util.currency.formatThousands=function(b){if(typeof groupingSize=="undefined"||typeof groupingSeparator=="undefined"||groupingSize<1){return b}var a="";var d=""+b;for(var c=1;c<=d.length;c++){a=d.charAt(d.length-c)+a;if(c%groupingSize==0&&c<d.length){a=groupingSeparator+a}}return a};ta.util.Toggle={};ta.util.Toggle.siblings=function(c,b){c.preventDefault();var a=true;if(b.hasClass("closed")){a=false}b.toggleClass("closed sprite-arrow_toggle_blu_lft");b.getParent().getChildren().each(function(d){if(d!=b){d.setStyle("display",a?"none":"block")}})};ta.util.Toggle.parentClass=function(c,a){c.preventDefault();var b=a.getParent(".toggle");b.toggleClass("off")};ta.util.Toggle.toggleTarget=function(d,b,c){d.preventDefault();var a=true;if($(b).hasClass("closed")){a=false}$(b).toggleClass("closed");$(b).toggleClass("open");$(c).setStyle("display",a?"none":"block")};ta.util.Toggle.toggleForm=function(b,d,c){var a=$(b).getParent(".formToggle");if(/sel_(\w+)/.test(a.className)){var f=RegExp.$1;a.removeClass("sel_"+f);a.getElement(".form_"+f).hide();var g=a.getElement(".header_"+f);if(g){g.hide()}}a.addClass("sel_"+d);var g=a.getElement(".header_"+d);if(g){g.show()}a.getElement(".form_"+d).show();return false};ta.util.Toggle.toggleLI=function(f,d,a){var c=f.getNext();for(var b=0;b<1000&&c&&c.id!=d.id;b++){if(a){c.show()}else{c.hide()}c=c.getNext()}if(a){f.hide()}else{f.show()}if(a){d.show()}else{d.hide()}};ta.util.Toggle.splitHotel=function(){var c=$$("#HOTEL_DESCRIPTION .descriptive_text").get("text").toString();var b=1000;if(c&&c.length>b){var a=c.substring(0,b);var d=c.substring(b,c.length);$$("#HOTEL_DESCRIPTION .descriptive_text").set("text",a);$$("#HOTEL_DESCRIPTION .description_ellipsis").show("inline");$$("#HOTEL_DESCRIPTION .more_description").show("inline");$$("#HOTEL_DESCRIPTION .descriptive_text_last").set("text",d)}};ta.util.Toggle.expandHotel=function(){$$("#HOTEL_DESCRIPTION .description_ellipsis").hide();$$("#HOTEL_DESCRIPTION .more_description").hide();$$("#HOTEL_DESCRIPTION .less_description").show("inline");$$("#HOTEL_DESCRIPTION .descriptive_text_last").show("inline")};ta.util.Toggle.truncateHotel=function(){$$("#HOTEL_DESCRIPTION .descriptive_text_last").hide();$$("#HOTEL_DESCRIPTION .less_description").hide();$$("#HOTEL_DESCRIPTION .description_ellipsis").show("inline");$$("#HOTEL_DESCRIPTION .more_description").show("inline")};ta.util.Toggle.toggleRecentReview=function(c,f,d){var b=c.getPrevious().getChildren();for(i=0;i<b.length;i++){var a=b[i];if(a.style.display=="none"){a.style.display=""}else{a.style.display="none"}}c.set("text",c.get("text").contains("<")?f+" > ":d+" < ")};ta.util.Toggle.expandList=function(c,a,f){try{var b=c.getChildren();if(b.length>a){for(i=a;i<b.length;i++){b[i].hide()}var g=new Element("span",{html:f,"class":"taLnk hvrIE6 moreLink",events:{click:function(){for(i=a;i<b.length;i++){b[i].show()}g.hide()}}});g.inject(c,"after")}}catch(d){ta.util.error.record(d,"Failed to Toggle.expandList")}};ta.util.URL={parse:function(c){if(/^(\w+):(.*)/.test(c)){c=RegExp.$2;switch(RegExp.$1){case"DOM":elmt=document.getElement(c);c=(elmt&&elmt.href)?elmt.href:"#";break;case"GMapsLC":if(c.length==0){break}tmp=c.split(",");ops={from:pageServlet,Action:tmp.shift()};tmp.each(function(d){if(/^g(\d+)$/.test(d)){ops.g=RegExp.$1}else{if("ext"==d){ops.ext="y"}else{if(/^(.*)=(.*)$/.test(d)){ops[RegExp.$1]=RegExp.$2}else{ops[d]=""}}}});c="/GMapsLocationController?"+Object.toQueryString(ops);break;case"ABS":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;break;case"ABSPAGE":var a=(window.location.port=="80"||window.location.port=="")?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+c;if(c.indexOf(".html")==-1){c+=".html"}break;case"REL":var b=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/"));if(/\/$/.test(window.location.pathname)){b=window.location.pathname}var a=window.location.port=="80"?"":(":"+window.location.port);if(c.charAt(0)!="/"){c="/"+c}c=window.location.protocol+"//"+window.location.hostname+a+b+c;break;default:c=RegExp.$1+":"+c;break}}return c},getParameter:function(c,a){var b=new RegExp("[?&]"+a+"=([^&]+)");if(b.test(c)){return RegExp.$1}return false}};ta.util.i18n={};ta.util.i18n.isRtl=function(){return ta.id(document.body).hasClass("rtl")};ta.util.element={};ta.util.element.replaceContent=function(g,f,c){var d=g;var b=f;if(!b.getElement(".progresstab")){var a=c+(c.indexOf("?")==-1?"?":"&")+"xhr=true";var h=new Element("div",{"class":"progresstab"});h.inject(b);new Request({url:a,onSuccess:function(j,k){b.empty();b.innerHTML=j;if(window.behavior){window.behavior.apply(b)}b.fireEvent("onContentReplaced",[d,b])},evalScripts:true}).get()}};ta.util.element.spinner=function(b,a){$(a).getParent(".spinnerReplaceable").getChildren().each(function(c){if(c.hasClass("spinner")){c.show()}else{c.hide()}})};ta.util.element.clearDefault=function(b,a){if(a.value==a.defaultValue){a.value=""}};ta.util.element.limitLength=function(b,a,c){if(a.value.length>=c){a.value=a.value.substr(0,c);return false}};ta.util.element.moveContent=function(a,b){if(!a||!b){return}b.innerHTML=a.innerHTML;a.innerHTML=""};ta.util.link={ajaxSubmit:function(a,c,b){if(a){new Event(a).preventDefault()}if(b){ta.util.cookie.setPIDCookie(b)}if(!c.className.match(/\bform_(\w+)\b/)){return}var g=$(RegExp.$1);var f={url:c.href,data:g,onFailure:function(j){if(g){g.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("link - ajaxSubmit",j)}};var h=window["callback"+g.id];if(c.className.match(/method_(\w+)\b/)){f.method=RegExp["$1"]}if(c.className.match(/\btgt_(\w+)\b/)){f.update=RegExp["$1"]}else{f.onSuccess=function(j){if(g){g.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(j);if(h&&typeOf(h)=="function"){h()}}}var d=window["validate"+g.id];if(d&&typeOf(d)=="function"&&d.apply(g)==false){return}g.addClass("ajaxInFlight");if(c.className.match(/\bevalScripts\b/)){f.evalScripts=true}(f.update?new Request.HTML(f):new Request(f)).send()},ajaxCall:function(a,b){if(a){new Event(a).preventDefault()}if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:b.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("link - ajaxCall")}).send()},popResWidth:function(b,f,d){try{var a=475,g=390,k=210;if(screen.width>1024){a=800;g=600;k=240}else{if(screen.width>800){a=620;g=500;k=240}}var j=Object.merge({width:a,height:g,xOffset:k,yOffset:5},d);ta.util.link.popup(b,f,j)}catch(c){ta.util.error.record(c,"ta.util.link - popCustom",b,j)}},popPhoto:function(a,d,c){try{Cookie.write("PhotoPop","1",{domain:cookieDomain});var f=Object.merge({name:"media",width:782,height:820},c);ta.util.link.popup(a,d,f)}catch(b){ta.util.error.record(b,"ta.util.link - popPhoto",a,f)}},popup:function(o,a,k){try{var g=Object.merge({name:false,width:950,height:610,xOffset:false,yOffset:false,noScroll:0,aHref:false,fullOptions:true,ensureReferrer:false,isAsdf:false},k);new Event(o).preventDefault();var f=false,b="",m=false;var c=1;if(ta.has("ta.popups.popupIndex")&&typeof ta.retrieve("ta.popups.popupIndex")!="undefined"){c=ta.retrieve("ta.popups.popupIndex")}if(!g.aHref){g.aHref=a.href}if(g.isAsdf&&g.aHref){if(ta.util.ASDF.asdfDcd){g.aHref=ta.util.ASDF.asdfDcd(g.aHref).replace(/&amp;/g,"&")}}if(g.aHref&&g.aHref.indexOf("p=HotelsCom")>-1){g.width=Math.max(g.width,960);try{g.height=Math.max(g.height,window.getHeight(),600)}catch(h){g.height=Math.max(g.height,600)}}if(g.width){b+=",width="+g.width}if(g.height){b+=",height="+g.height}if(g.xOffset){b+=",screenX="+g.xOffset+",left="+g.xOffset}if(g.yOffset){b+=",screenY="+g.yOffset+",top="+g.yOffset}if(!Browser.chrome){g.noScroll=1}if(g.fullOptions){var j=1;if(ta.browser.isIE9orHigher()){j=0}b="toolbar=1,resizable=1,menubar="+j+",location=1,status=1,scrollbars="+g.noScroll+b}else{b="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+g.noScroll+b}if(!g.name){g.name="p"+(c++)}ta.store("ta.popups.popupIndex",c);if(g.ensureReferrer&&Browser&&Browser.ie){try{m=new Element("a",{target:g.name,href:g.aHref});m.inject(ta.id(document.body),"bottom");f=window.open("",g.name,b);m.click();m.destroy()}catch(d){ta.util.error.record(d,"ta.util.link - pop ensure referrer",o,g)}}else{try{f=window.open(g.aHref,g.name,b)}catch(h){ta.util.error.record(h,"ta.util.link - popping window",o,{href:g.aHref,name:g.name,args:b})}}if(typeof f!="undefined"&&f!==null){try{f.opener=self;f.focus()}catch(d){}}}catch(l){ta.util.error.record(l,"ta.util.link - popup",o,g)}},directionsPop:function(a,c,b,d){if(d){new Request({url:"/ActionRecord?action="+d}).send()}if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","directions_click")}ta.util.link.popup(a,c,b)},remTAPD:function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})},phacRadio:function(a,c,b){if(!ta.has("phacRadioClicked")){ta.store("phacRadioClicked",true);new Request({url:"/ActionRecord?action=HotelReviewSearchTypeChangedTo"+c.value}).send()}showHidePhac(b)},targetBlank:function(a,d,c){try{var f=Object.merge({aHref:false,isAsdf:false},c);if(f.isAsdf&&f.aHref){if(ta.util.ASDF.asdfDcd){f.aHref=ta.util.ASDF.asdfDcd(f.aHref).replace(/&amp;/g,"&")}}window.open(f.aHref,"_blank")}catch(b){ta.util.error.record(b,"ta.util.link - targetBlank",a,f)}}};(function(a){a.util.localstorage={};a.util.localstorage.canUseLocalStore=function(){try{if(window.localStorage){var c="taLsTest";localStorage.setItem(c,"1");var b=localStorage.getItem(c);return(b=="1")}}catch(d){return false}}}(ta));(function(c){c.util||(c.util={});var a=["success","failure","always","progress"];var g={resolved:["success","always"],rejected:["failure","always"]};var j=function(){};for(var f=0;f<a.length;f++){(function(k){j.prototype[k]=function(m,l){return b(this,k,l?m.bind(l):m)}}(a[f]))}c.util.Deferred=function(){var k="pending";var m=new j();m.queue=[];m.args=null;m.status=function(){return k};var l={notify:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}var p=Array.prototype.slice.call(arguments);var r,q,o;for(q=0,o=m.queue.length;q<o;q++){r=m.queue[q];if(r.hook=="progress"){r.callback.apply(null,p)}}return m},resolve:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}k="resolved";m.args=Array.prototype.slice.call(arguments);return h(m)},reject:function(){if(d(k)){throw new Error("Promise has already been fulfilled.")}k="rejected";m.args=Array.prototype.slice.call(arguments);return h(m)},promise:function(){return m}};return l};var d=function(k){return k=="resolved"||k=="rejected"};var b=function(l,k,m){l.queue.push({hook:k,callback:m});return h(l)};var h=function(m){var l,k;while(d(m.status())&&(l=m.queue.shift())){if(~g[m.status()].indexOf(l.hook)){k=l.callback.apply(null,m.args);if(k instanceof j){k.queue=k.queue.concat(m.queue);m=k}}}return m}}(ta));ta.util.decoder={base64Decoder:function(h){h=h.replace(/\-/g,"+").replace(/\_/g,"/");if(h.length%4!==0){var j=4-h.length%4;for(var g=0;g<j;g++){h=h+"="}}var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="",s,q,o="",r,p,l,k="";for(var f=0;f<h.length;f+=4){r=d.indexOf(h.charAt(f));p=d.indexOf(h.charAt(f+1));l=d.indexOf(h.charAt(f+2));k=d.indexOf(h.charAt(f+3));if(r==-1||p==-1||l==-1&&k==-1){ta.util.error.record(null,"Facebook signed request contains invalid base64 letter",null,{code:h});return}s=(r<<2)|(p>>4);q=((p&15)<<4)|(l>>2);o=((l&3)<<6)|k;a=a+String.fromCharCode(s);if(l!=64){a=a+String.fromCharCode(q)}if(k!=64){a=a+String.fromCharCode(o)}s=q=o="";r=p=l=k=""}return unescape(a)}};ta.util.files={reset:function(a){if(Browser.ie){a.clone(false,true).replaces(a)}else{a.value=""}},upload:function(c,f,h){function b(l,j){var m;try{m=document.createElement("<"+l+' name="'+j+'">')}catch(k){m=document.createElement(l);m.setAttribute("name",j)}return m}var g="upload_iframe_"+(Math.random()+"").split(".")[1];var d=b("iframe",g);d.setAttribute("id",g);d.setAttribute("src","about:blank");d.setAttribute("width","0");d.setAttribute("height","0");d.setAttribute("border","0");d.setAttribute("style","width:0; height:0; border:none; display:none; ");document.body.appendChild(d);c.target=g;function a(){ta.id(d).removeEvent("load",a);var j=d.contentWindow.document;h(j);setTimeout(function(){d.parentNode.removeChild(d)},250)}ta.id(d).addEvent("load",a);c.submit()}};ta.util.replace={img:function(b,a){try{b.src=ta.retrieve(a).src}catch(c){}}};try{(function(a){a.util||(a.util={});a.util.imageServer=function(c){var b=(typeof(CDNHOST)==="string"&&CDNHOST)||(typeof(cdnhost)==="string"&&cdnhost);if(b&&c){if(!/^\//.test(c)){c="/"+c}c=b+c}return c}})(ta)}catch(e){ta.util.error.record(e,"cannot do ta.util.imageServer",null,{path:path})}ta.common.search={langSelect:function(b,a){if(a.form.elements.q.value.length>0){a.form.submit()}},clearOnFocus:function(b,a){if(a.value==a.defaultValue){a.value="";a.removeClass("focusClear")}},defaultOnBlur:function(b,a){if(a.value==""){a.addClass("focusClear");a.value=a.defaultValue}},validate:function(b,a){if(a.q.value==""||$(a.q).hasClass("focusClear")){return false}setOneTimeCookie("SRCHACT","NEW");return true},recordAndValidate:function(d,b){if(ta.common.search.validate(d,b)){var c=ta.retrieve("typeahead.startTime")||"unknown";var a=typeof modelGeoId!="undefined"&&modelGeoId;var f=ta.retrieve("typeahead.source")||"unknown";new Request({method:"GET",data:{action:"RECORD",eventType:"search_bttn",startTime:c,source:f,global:(!a||pageServlet=="Search")},onSuccess:function(g){b.submit()},onFailure:function(g){b.submit()},url:"/TypeAheadJson"}).send()}return false},selectLang:function(b,d){try{var p=function(r){var q=r.match(/([\d.]+)px/);if(q){return parseFloat(q)}return 0};var g=ta.id("SEARCH_LANG_SELECT_POPUP");if(!g){return false}if(!g.hasClass("hidden")){var f=ta.id("SEARCH_LANG_SELECT_INPUT");var j=ta.id("SEARCH_LANG_SELECTED");if(f){var h=d.id.match(/lang_(.+)/);if(h){var c=h[1];if("all"==c){f.value=""}else{f.value=c}}if(j){j.set("html",ta.id(d).get("html"))}}g.addClass("hidden");if(j&&!ta.common.search.widthfixed){var k=ta.common.search.width;var o=p(j.getStyle("width"));var a=Math.max(k,o);console.log("check width old "+k+" new "+o);if(k!=o){j.setStyle("width",a+"px");ta.common.search.widthfixed=true}}}else{g.removeClass("hidden");var j=ta.id("SEARCH_LANG_SELECTED");if(j&&!ta.common.search.widthfixed){ta.common.search.width=p(j.getStyle("width"))}}}catch(l){ta.util.error.record(l,"select search lang")}},reviews:function(c,b){new Request({url:"/ActionRecord?action=SearchReviews"}).send();if(b&&b.getElement){var a=b.getElement(".searchTestText");if(a){alert(a.innerHTML)}}else{alert("Coming Soon!")}return false},selectOption:function(b,d){var r=function(m){do{m=m.getParent()}while(m&&m.nodeName!=="FORM");return m};var c=ta.id(d);var j=ta.id(r(c));try{var q=function(t){var s=t.match(/([\d.]+)px/);if(s){return parseFloat(s)}return 0};var h=j.getElement(".SEARCH_SELECT_POPUP");if(!h){return false}if(!h.hasClass("hidden")){h.addClass("hidden");var f=j.getElement(".SEARCH_SELECT_INPUT");var k=j.getElement(".SEARCH_SELECTED");if(f){var g=c.hasClass("lang_all");if(g){f.value=1}else{f.value=2}if(k){k.set("html",c.get("html"))}}if(k){var l=ta.common.search.width;var p=q(k.getStyle("width"));var a=Math.max(l,p);k.setStyle("width",a+"px")}}else{h.removeClass("hidden");var k=j.getElement(".SEARCH_SELECTED");if(k){ta.common.search.width=q(k.getStyle("width"))}}}catch(o){ta.util.error.record(o,"select search lang")}}};ta.common.flyout={intlPopup:function(d,b){d.stop();b.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var c="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){c+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){c+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){c+="&geo="+modelGeoId}if(window.flagsSettings){for(var a=0;a<flagsSettings.length;a++){c+="&"+flagsSettings[a]+"=true"}}if(window.pageFeature){c+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:c},b);return false},showRecentLocationSaveOverlay:function(){setPID(3832);new Request({url:"/RecentlyViewedAjax",onSuccess:function(a){if(!a.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(a,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},submitRecentLocationEmail:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4470);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},submitRecentLocationSave:function(){var a=ta.retrieve("overlays.current");if($("rvEmailSend")){$("rvEmailSend").hide()}if($("rvEmailProgress")){$("rvEmailProgress").show()}setPID(4469);new Request({url:"/RecentlyViewedAjax",onSuccess:function(b){a.hide();if(!b.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(b,{style:"dg s4 RecentlyViewedOverlay"})}},data:$("rvEmailForm"),evalScripts:true}).send()},showEmailHotelOverlay:function(b,c,a){new Request({url:"/ActionRecord?excludeFromVS=false&action=BusinessListingsEmail&d="+b}).send();new Asset.css(emailHotelCSS);new Request({url:"/EmailHotel",onSuccess:function(d){ta.run("ta.overlays.showInLightbox",{},d,{style:"dg s4"});if(ta.has("emailOwnerShowCaptcha")){ta.t4b.emailhotel.showRecaptcha()}},data:{detail:b,isOfferEmail:c,overrideOfferEmail:a},evalScripts:true,method:"get"}).send()},rvInquiryPrivacy:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("rvPrivacyBox").innerHTML},a)},rvClearDefault:function(c,a){var b=$(c);if(b&&b.value==a){b.value="";b.removeClass("rvDefault")}},BLSpecialOffersUrl:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:false,activate:ta.overlays.ACTIVATE_HOVER,content:$("blLinkMsg").innerHTML},a)},destinationsPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/destinationsFly.html?lt=evt"},a)},funStuffPopup:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:"/vpages/funStuffFly.html?lt=evt"},a)},bestValue:function(b,a){b.stop();a.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,remoteContent:"/vpages/bestValueFly.html?log=false"},a);return false},starAttribution:function(b,a){b.stop();a.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},a);return false},amenities:function(d,b,a,c){if(d){d.stop()}b.onclick=null;if(typeof(amenityOverlayCss)!="undefined"&&!ta.retrieve("ta.amenityOverlayCss")){ta.store("ta.amenityOverlayCss",Asset.css(amenityOverlayCss))}if(a&&a>0){setPID(a);new Request({url:"/ActionRecord?excludeFromVS=false&action=HRAmenitiesFlyout"}).send()}if(c){ta.store("amenities.suppressLinks",true)}ta.run("ta.overlays.Factory.createAmenitiesLightbox",{},b);return false}};ta.common.sendmessage={getMessageCode:function(){var f=new Date().getTime();var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ123456";var g=[];for(var a=0;a<32;a++){g[a]=((f&(1<<a))!=0)?1:0}var c=[[],[],[],[],[],[]];for(var a=0;a<30;a++){c[a%(c.length)].push(g[g.length-1-a])}var d="";for(var a=0;a<c.length;a++){d+=b.substr(parseInt(c[a].reverse().join(""),2),1)}return d},communityLightbox:function(f,d){if(!communityEnabled){window.callback_communityLightboxEnable=function(){communityEnabled=true;var h=ta.retrieve("overlays.sendmessage");if(h){h.hide()}ta.common.sendmessage.communityLightbox(f,d)};var a=new StringBuffer();a.append('<p id="inviteStatusField" style="display: none; color: red;"></p>');a.append("<p>"+JS_mem_travelnet_friends_disabledM2M+".</p>");a.append('<p><a href="javascript:void(0)" onclick="ta.common.sendmessage.enableCommunity(window[\'callback_communityLightboxEnable\'], true); return false;">'+JS_common_Clickhere+"</a> "+JS_mem_travelnet_friends_turnOn+".</p>");var g=ta.overlays.showInLightbox(a.toString(),{backdrop:ta.overlays.BACKDROP_NEVER,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});g.container.setStyle("z-index","9998");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){g.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",g);return}if(d){var b=function(h){var j=ta.overlays.showInLightbox(h,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});j.container.setStyle("z-index","9998");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){j.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",j);var k=window[d];if(k&&typeOf(k)=="function"){k()}}}else{var b=function(h){var j=ta.overlays.showInLightbox(h,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});j.container.setStyle("z-index","9998");if($("vrWideOverview")&&ta.has("vrShowCaptcha")){j.closeBtn.addEvent("click",function(){ta.vr.showRecaptcha()})}ta.store("overlays.sendmessage",j)}}var c={url:f,onSuccess:b,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:communityLightbox")};new Request(c).send()},enableCommunity:function(c,a){var b=c;if(!a){b=function(d){ta.common.sendmessage.enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:enableCommunity")}).send()},enableCommunityResponse:function(res,callback){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){document.getElementById("inviteStatusField").innerHTML=data.ERROR;document.getElementById("inviteStatusField").style.display="block"}}else{document.getElementById("inviteStatusField").innerHTML=JS_community_on;document.getElementById("inviteStatusField").style.display="block"}},submitSendMessage:function(j,b){j.stop();b.onclick=null;var a=b.className.match(/LSO_(\w+)/)[1];$("LsoId").value=footprintGetWithSet(a);$("screenWidth").value=screen.width;$("screenHeight").value=screen.height;if(!b.className.match(/\bform_(\w+)\b/)){return}var f=$(RegExp.$1);var d={url:b.href,data:f,evalScripts:true,onFailure:ta.util.error.ajaxFailure.partial("SendMessage:submitSendMessage")};var h=window["callback_"+f.name];if(b.className.match(/method_(\w+)\b/)){d.method=RegExp["$1"]}if(b.className.match(/\btgt_(\w+)\b/)){d.update=RegExp["$1"]}else{d.onComplete=function(m,k){var l=ta.overlays.showInLightbox(m,{backdrop:ta.overlays.BACKDROP_NEVER,permanent:true,onHide:ta.common.sendmessage.cancel.bind(this),noScroll:$("vrWideOverview")});ta.store("overlays.sendmessage",l);if(h&&typeOf(h)=="function"){h()}}}var c=window["validate"+f.id];if(c&&typeOf(c)=="function"&&c.apply(f)==false){return}if(b.className.match(/\bevalScripts\b/)){d.evalScripts=true}var g=ta.retrieve("overlays.sendmessage");if(g&&g.options&&g.options.permanent){g.options.permanent=false}new Request(d).send()},cancel:function(a){if(a){return}var b=ta.retrieve("overlays.sendmessage");if(b){ta.remove("overlays.sendmessage")}if(ta.has("community.needsReload")){window.location.reload()}},closeSendMessage:function(c,a){if(c&&c.stop){c.stop()}if(a){a.onclick=null}var b=ta.retrieve("overlays.sendmessage");if(b){b.hide(c)}if($("vrWideOverview")&&ta.has("vrShowCaptcha")){ta.vr.showRecaptcha()}}};ta.servlet.Inspiration={sortPopularity:function(b,a){sort("popularity")},sortAlphabetical:function(b,a){sort("alphabetical")}};ta.keep("facebook.onAvail",function(){FB.Event.subscribe("edge.create",function(d,g){try{var h=false;if(g&&g.dom){h=$(g.dom)}var a="";var c="";if(h){c=h.getAttribute("href");if(h.className){var b=false;if(b=h.className.match(/track_(\w+)/)){a=b[1]}if(h.hasClass("expanded")){a+="_expanded"}}}new Request({url:"/ActionRecordPlus?action=LIKE&from="+a+"&url="+c}).send()}catch(f){ta.util.error.record(f,"FB like review tracking error")}})});ta.servlet.Reviews={expandCount:0,extraAdAdded:false,PAGING_HEIGHT:1000,expandReview:function(q,d,c){var a=0;if(ta.retrieve("expand_"+c)){return}ta.store("expand_"+c,true);a++;var b=ta.id(c);var p=new Event(q);try{a++;if(!b){ta.util.error.record(null,"expandReview - no container",p,{revId:c});return}var k,m,h=false;if(b.getElement){k=b.getElement(".dyn_full_review");m=b.getElement(".basic_review");h=b.getElement(".revBotContent")}if(!m||!m.hasClass){ta.util.error.record(null,"expandReview - no basic_rev",p,{revId:c});return}a++;var j=m.hasClass("first");if(h&&h.getElement){var g=h.getElement(".fb_like_button")}var l=m.getElement(".helpful");a++;if(k){k.setStyle("display","block");if(g){ta.servlet.Reviews.injectFBLikeIntoFull(g,k)}if(ta.servlet.Reviews.translationRatings.contains(expandedReviewId)){ta.servlet.Reviews.injectTranslationRating(m,k)}m.setStyle("display","none");ta.remove("expand_"+c)}else{a++;ta.servlet.Reviews.expandCount++;var o=m.getElement(".partnerRvw span.linkItem");a++;if(o){o.getElement("img.textArrow_more").setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(o)}a++;new Request({url:"/SingleUserReview-g"+modelGeoId+"-d"+modelLocId+"?review="+c+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount,onSuccess:function(u,v){try{var t=0;k=new Element("div");k.addClass("dyn_full_review");k.set("html",u);k.inject(m,"after");t++;var w=k.getElement(".collapse");if(w){w.addEvent("click",function(){ta.servlet.Reviews.collapseReview(b)})}t++;if(j){k.getElement(".basic_review").addClass("first")}t++;setupTranslationRatingSlider(k);t++;if(typeof processLinks!=="undefined"){processLinks(k)}t++;ta.servlet.Reviews.fixMTHelpfulUrl(k,c);if(m){var A=m.getElement("img.anim_loop");A.dispose()}t++;if(o){var s=o.getElement("img.textArrow_more");if(typeof(s)!="undefined"&&s!=null){s.setStyle("display","inline")}}t++;ta.servlet.Reviews.refreshSidebarAds();t++;injectAdsTargeted(k);t++;var y=ta.retrieve("facebook.data.handlers.FRIEND_NAMES");var r=ta.retrieve("facebook.data.handlers.HIGHLIGHT_FRIENDS");if(y&&typeof(y)=="function"){y()}if(r&&typeof(y)=="function"){r({expanded:true})}if(g){ta.servlet.Reviews.injectFBLikeIntoFull(g,k)}if(l){helpfulVotingKey=l.id.match(/(helpful\w+)_\w+/);if(helpfulVotingKey){helpfulVotingKey=helpfulVotingKey[1];if(ta.retrieve(helpfulVotingKey)){var C=k.getElement(".helpful");if(C){C.innerHTML=l.innerHTML}}}}t++}catch(z){ta.util.error.record(z,"expandReview - post AJAX",null,{postProg:t})}if(m&&m.setStyle){m.setStyle("display","none")}if(h&&h.setStyle){h.setStyle("display","none")}ta.remove("expand_"+c);var B=ta.retrieve("ta.servlet.Reviews.callback");if(B!=null){B()}},evalScripts:true}).send()}}catch(f){ta.util.error.record(f,"expandReview",p,{revId:c,prog:a});ta.remove("expand_"+c)}},expandReviews:function(j,m,k,u,s){if(ta.retrieve("expand_"+k)){return}ta.store("expand_"+k,true);var p=ta.id(k);var r=new Event(j);try{if(!p){ta.util.error.record(null,"expandReviews - no container",r,{revId:k});return}var l,v,C=false;if(p.getElement){l=p.getElement(".dyn_full_review");v=p.getElement(".basic_review");C=p.getElement(".revBotContent")}if(!v||!v.hasClass){ta.util.error.record(null,"expandReviews - no basic_rev",r,{revId:k});return}if(l){ta.servlet.Reviews.showExpandedReview(k,true);ta.remove("expand_"+k)}else{ta.servlet.Reviews.expandCount++;var w=v.getElement(".partnerRvw span.moreLink");if(w){var d=w.getParent().getElement("img.textArrow_more");if(d){d.setStyle("display","none");new Asset.image(CDNHOST+"/img2/spinner.gif",{"class":"anim_loop"}).inject(w,"after")}}var B=$$("#REVIEWS .reviewSelector");var a;for(var y=0;y<B.length;y++){if(B[y].id==k){a=B.slice(y)}}var o=[];if(a&&a.length>0){for(var y=0;y<a.length;y++){var t=a[y].id;if(t&&t.indexOf("review_")===0){var z=a[y].getElement(".dyn_full_review");if(!z){var h=a[y].getElement(".basic_review");if(h){o[o.length]=t.split("_")[1]}else{ta.util.error.record(null,"expandReviews - basic_review content missing",null,{revId:t},"WARN")}}}}}if(o.length>0){var q=o[0];var c=0;if(u){c=u}var g=o.join(",");var b="";var A="";if(ta.servlet.Reviews.expandCount==1&&o.length>2){A=o[2];b="&extraadtarget="+A;ta.servlet.Reviews.extraAdAdded=true}new Request({url:"/ExpandedUserReviews-g"+modelGeoId+"-d"+modelLocId+"?target="+q+"&context="+c+"&reviews="+g+"&servlet="+pageServlet+"&expand="+ta.servlet.Reviews.expandCount+"&extraad="+ta.servlet.Reviews.extraAdAdded+b,trackEvent:{module:"Reviews",action:"expand"},onSuccess:function(K,G){try{var L=[];var D=new Element("div");D.set("html",K);var S=D.getChildren();var J=[];for(var R=0;R<S.length;R++){var H=S[R];var N=H.id.split("_")[2];var U=ta.id("review_"+N);if(U&&U.getElement){J.push(U.getProperty("id"));var Q=U.getElement(".basic_review");if(Q){L.push(N);H.erase("id").addClass(Q.className.replace("basic_review","dyn_full_review")).inject(Q,"after").hide();var W=H.getChildren()[0];if(W){W.removeClass("review")}var M=H.getElement(".collapse");if(M){M.addEvent("click",ta.servlet.Reviews.getCollapseCallback(U))}setupTranslationRatingSlider(H);if(typeof processLinks!=="undefined"){processLinks(H)}if(ta.servlet.Reviews.translationRatings.contains(N)){ta.servlet.Reviews.injectTranslationRating(Q,H)}ta.servlet.Reviews.fixMTHelpfulUrl(H,"review_"+N);if(N===q){var E=Q.getElement("img.anim_loop");if(E){E.dispose()}ta.servlet.Reviews.refreshSidebarAds();injectAdsTargeted(H);var P=Q.getElement(".partnerRvw span.moreLink");if(P){var F=P.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}}if(ta.servlet.Reviews.expandCount==1&&(N===A)){injectAdsTargeted(H)}}}}var I=true;for(var R=0;R<L.length;R++){if(R==1){I=false}var O="review_"+L[R];ta.servlet.Reviews.showExpandedReview(O,I)}if(lazyImgs!=null){window.setupLazyLoad()}}catch(X){ta.util.error.record(X,"expandReviews - post AJAX",null,{});var E=v.getElement("img.anim_loop");if(E){E.dispose()}var P=v.getElement(".partnerRvw span.moreLink");if(P){var F=P.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}}if(Browser.ie&&Browser.version<8){var T=function(){for(var Y=0;Y<J.length;++Y){var Z=ta.id(J[Y]);if(Z!==null){Z.addClass("dummy")}}};setTimeout(T,0)}ta.remove("expand_"+k);if(ta.retrieve("isDaoDao")&&ta.retrieve("member_info_redesign")){var V=ta.retrieve("memberTravelMapInstance");if(V){V.getExtendGeos()}}},onFailure:function(D,E){ta.util.error.record(null,"ExpandedUserReviews ajax call failed",null,{reviewIds:g},"WARN");var G=v.getElement("img.anim_loop");if(G){G.dispose()}var H=v.getElement(".partnerRvw span.moreLink");if(H){var F=H.getParent().getElement("img.textArrow_more");if(typeof(F)!="undefined"&&F!=null){F.setStyle("display","inline")}}},evalScripts:true}).send()}}}catch(f){ta.util.error.record(f,"expandReviews",r,{revId:k});ta.remove("expand_"+k)}},getCollapseCallback:function(a){return function(){ta.servlet.Reviews.collapseReview(a)}},showExpandedReview:function(a,b){try{if(typeof(a)==="undefined"){ta.util.error.record(null,"showExpandedReview - reviewId is undefined");return}var f=ta.id(a);if(f){var j,l,g=false;if(f.getElement){j=f.getElement(".dyn_full_review");l=f.getElement(".basic_review");g=f.getElement(".revBotContent")}else{ta.util.error.record(null,"showExpandedReview - recContainer missing getElement attribute",null,{revId:a});return}if(!l){ta.util.error.record(null,"showExpandedReview - basic_rev is null",null,{revId:a});return}if(!l.hasClass){ta.util.error.record(null,"showExpandedReview - basic_rev missing hasClass attribute",null,{revId:a});return}if(g&&g.getElement){var d=g.getElement(".fb_like_button")}var k=l.getElement(".helpful");if(!j){ta.util.error.record(null,"showExpandedReview - no full");return}if(k){var h=k.id.match(/(helpful\w+)_\w+/);if(h){h=h[1];if(ta.retrieve(h)){var m=j.getElement(".helpful");if(m){m.innerHTML=k.innerHTML}}}}if(d){ta.servlet.Reviews.injectFBLikeIntoFull(d,j)}j.show();l.hide()}else{ta.util.error.record(null,"showExpandedReview - revContainer is null",null,{revId:a});return}}catch(c){ta.util.error.record(c,"showExpandedReview")}},fixMTHelpfulUrl:function(c,a){var d=c.getElement("input[name=returnTo]");if(d){var b=document.location.href;if(b.indexOf("#")>=0){b=b.substring(0,b.indexOf("#"))}d.value=b+"#mtreview_"+a}},injectFBLikeIntoFull:function(c,a){try{if(c){var f=c.getFirst();if(f){f.addClass("expanded")}var b=a.getElement(".helpful");if(b){c.inject(b,"after")}}}catch(d){ta.util.error.record(d,"expandReview - like button")}},injectTranslationRating:function(c,b){if(c&&b){var a=c.getElement(".translation"),d=b.getElement(".translation");if(a&&d){d.set("html",a.get("html"))}}},translationRatings:[],refreshSidebarAds:function(){if(ta.retrieve("did_ad_refresh")){return}ta.store("did_ad_refresh",true);var a=Math.floor(Math.random()*99999999);document.getElements("div.sidebar div.adServer iframe").each(function(b){if(b&&b.cloneNode){var c=b.cloneNode(false);if(b.src.indexOf("refreshOrd")>-1){c.src=b.src.replace(/refreshOrd=\d+/,"refreshOrd="+a)}else{c.src=b.src+";refreshOrd="+a}b.parentNode.replaceChild(c,b)}else{if(b){ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var is not a dom elemnt"})}else{ta.util.error.record(null,"refreshSidebarAds",null,{revId:reviewId,msg:"iframe var was null"})}}})},collapseReview:function(a){try{a=ta.id(a);var f=a.getElement(".dyn_full_review");var c=a.getElement(".basic_review");var d=a.getElement(".revBotContent");var b=f.getElement(".fb_like_button");if(c&&c.setStyle){c.setStyle("display","block")}if(d&&d.setStyle){d.setStyle("display","block")}if(b){var j=b.getFirst();if(j){j.addClass("expanded")}if(d){b.inject(d,"inside")}}var h=a.id.replace("review_","");if(ta.servlet.Reviews.translationRatings.contains(h)){ta.servlet.Reviews.injectTranslationRating(f,c)}f.setStyle("display","none")}catch(g){ta.util.error.record(g,"collapseReview")}},findLink:function(b,a){if(/\bt(r[\d]+)\b/.test(a.className)){window.location=$(RegExp.$1).href}},mtSubmitOnClick:function(b,a){if(a.value==="true"){ta.util.cookie.setPIDCookie(25173)}else{if(a.value==="false"){ta.util.cookie.setPIDCookie(25172)}}a.form.submit()},rateMTReview:function(a,d){var c=ta.id(d.form);var j=c.getElement("input[name=translateRating]:checked");if(j){var f=j.value;var g=c.elements.userId.value;var b=c.elements.reviewId.value;ta.servlet.Reviews.translationRatings.push(b);var h=c.action+"?at=true&rateValue="+b+","+g+","+f;new Request({url:h}).send();var k=c.getElement(".thanks").innerHTML;c.getElement(".translationRatingForm").innerHTML=k}},popSocialShare:function(b,a){if(b&&b.href){var c="toolbar=1,location=1,directories=1,status=1,menubar=1,resizable=1,copyhistory=1,scrollbars=1,width=800,height=400,left=40,top=40,screenx=40,screeny=40";window.open(b.href,"SocialShare",c)}new Request({url:"/ActionRecord?action=shareOn"+a}).send();return false},helpfulVoteHandler:function(b,a){new Event(b).preventDefault();var c=a.className.match(/\btgt_(\w+)\b/);if(!c){return}c=c[1];new Request({url:a.href,onSuccess:function(d,g){var h=ta.id(c+"_expanded");var f=ta.id(c+"_collapsed");if(h){h.innerHTML=d}if(f){f.innerHTML=d;ta.store(c,true)}}}).send()},helpfulVoteHandlerOb:function(b,a,c){new Event(b).preventDefault();var d=a.className.match(/\btgt_(\w+)\b/);if(!d){return}d=d[1];c=ta.util.ASDF.asdfDcd(c);new Request({url:c,onSuccess:function(f,h){var j=ta.id(d+"_expanded");var g=ta.id(d+"_collapsed");if(j){j.innerHTML=f}if(g){g.innerHTML=f;ta.store(d,true)}}}).send()},recordUnattached:function(b,a){new Request({url:"/ActionRecord?action=START_UNATTACHED_RVW_SEARCH"}).send();a.removePropertyEvent("keyup","ta.servlet.Reviews.recordUnattached")},changeSearchType:function(f,b){if(window.searchType){$$("span."+window.searchType.id).hide()}window.searchType=b;$$("span."+b.id).setStyle("display","inline");if(b.id!="type_rental"){switch(b.id){case"type_hotel":ta.store("tpAhdType","hotel");break;case"type_attraction":ta.store("tpAhdType","attr");break;case"type_restaurant":ta.store("tpAhdType","eat");break;case"type_location":ta.store("tpAhdType","geo");break}if($("SRCH_BOX_VR")){$("SRCH_BOX_VR").hide()}if($("SRCH_RSLT_VR")){$("SRCH_RSLT_VR").hide()}if($("MAIN_COL")){$("MAIN_COL").hide()}if($("POST_PHOTOS_FORM")){$("POST_PHOTOS_FORM").hide()}$("SRCH_BOX").show();$("UR_SELECT").show();var c=ta.id("query");var a=c.retrieve("typeAhead");if(a){a.changeUrl("/TypeAheadJson?action=SINGLELOCTYPE&types="+ta.retrieve("tpAhdType")+"&global=true");a.query();a.updateChoices()}if(c.value.length>0){searchByType()}c.focus();c.select()}else{$("SRCH_BOX_VR").show();$("SRCH_BOX").hide();$("UR_SELECT").hide();var d=$("reviewGeo");d.focus();d.select()}},storePlaceTypeId:function(b,a){if(a.id!="type_rental"){ta.store("placeTypeToShow",a.id);switch(a.id){case"type_hotel":ta.store("placeTypeIdAsString","10023");break;case"type_attraction":ta.store("placeTypeIdAsString","10021");break;case"type_restaurant":ta.store("placeTypeIdAsString","10022");break}}},showAddNewLocLink:function(d,c){var b=ta.id("ADD_NEW_LOCATION_TEXT").getChildren();for(var a=0;a<b.length;a++){if(b[a].hasClass(ta.retrieve("placeTypeToShow"))){b[a].show()}else{b[a].hide()}}},geoOnlySearchOnFocus:function(b,a){ta.run("ta.widgets.typeahead.factory.global_mutable",{},b,a,"GEOGRAPHICONLY","ta.widgets.typeahead.events.revealPOIAndSaveGeo",{minLength:0,noSearchPrompt:true});a.removePropertyEvent("focus","ta.servlet.Reviews.geoOnlySearchOnFocus")},fetchGeoResults:function(b,a){ta.id("NARROWING_WIDGET").hide();ta.id("NO_RESULTS_RETURNED").hide();ta.id("NARROW_BOX").show();ta.id("PICK_A_POI_LOADING").show();new Request({url:"/WriteAReviewTypeahead",data:{action:"FETCHCHILDREN",geo:ta.retrieve("selectedGeoId"),type:ta.retrieve("placeTypeIdAsString")},method:"get",onSuccess:function(d,f){var c=JSON.parse(d);if(c.length>0){ta.run("ta.servlet.Reviews.writeGeosToFilterBox",{},c);ta.id("PICK_A_POI_LOADING").hide();ta.id("NARROWING_WIDGET").show()}else{ta.id("PICK_A_POI_LOADING").hide();ta.id("NO_RESULTS_RETURNED").show()}ta.call("ta.servlet.Reviews.showAddNewLocLink",b,a);ta.ReviewTracking.trackPage("/WAR_LIST_LOADED");if(ta.retrieve("filterHasBeenFocused")===undefined){setTimeout(function(){ta.id("FILTER_HINT").show()},1000)}else{ta.id("FILTER_HINT").hide()}}}).send()},writeGeosToFilterBox:function(c){var h=ta.id("ALL_GEO_RESULTS");if(h){h.destroy()}var a=new Element("div",{id:"ALL_GEO_RESULTS"});ta.id("NARROWING_WIDGET").adopt(a);for(var g=0;g<c.length;g++){var j=c[g].id;var b=c[g].name;var f=c[g].address;var k=new Element("div",{"class":"filterableMenuElement","data-gid":j,"data-gname":b.toLowerCase(),"data-gaddress":f.toLowerCase(),styles:{display:"block"},events:{click:function(){var m="/UserReviewEdit-d"+this.get("data-gid");ta.ReviewTracking.trackPage("/WAR_POI_SELECTED");window.open(m,"_self")}}});var l=new Element("span",{"class":"geoNameSpan",html:b,styles:{display:"block"}});k.adopt(l);var d=new Element("span",{"class":"geoAddressSpan",html:f,styles:{display:"block"}});k.adopt(d);a.adopt(k)}},poiSelectActions:function(b,a){ta.call("ta.servlet.Reviews.storePlaceTypeId",b,a);ta.ReviewTracking.trackPage("/WAR_LIST_POI_TYPE");ta.call("ta.servlet.Reviews.fetchGeoResults",b,a);ta.id("GEO_NARROW_WAR").show();ta.id("POI_SELECT_HINT").hide();ta.store("poiSelectHasBeenFocused",true)},restartPOIProcess:function(c,a){ta.id("NARROWING_WIDGET").hide();ta.store("tpAhdType",undefined);ta.store("placeTypeToShow",undefined);var b=ta.id("FILTER_GEO_TEXT_BOX");b.addClass("focusClear");b.value=b.defaultValue;ta.call("ta.servlet.Reviews.showAddNewLocLink",c,a);ta.id("NARROW_BOX").hide();ta.id("type_hotel").checked="";ta.id("type_attraction").checked="";ta.id("type_restaurant").checked=""},filterNarrowingWidget:function(f,c){var a=ta.id("ALL_GEO_RESULTS");var b=a.getChildren();if(b.length==0){return}var d=ta.id("FILTER_GEO_TEXT_BOX").get("value").toLowerCase();Array.each(b,function(j,g){var h=j.get("data-gname");var k=j.get("data-gaddress");if(h.contains(d)||(k.lastIndexOf(",")!=-1&&k.substr(0,k.lastIndexOf(",")).contains(d))){j.show()}else{j.hide()}})},unattachedSearchOnFocus:function(c,a){var b=ta.retrieve("tpAhdType");ta.run("ta.widgets.typeahead.factory.global_mutable",{},c,a,"SINGLELOCTYPE","ta.widgets.typeahead.events.onSelectUnattached",{xargs:"&types="+b});a.removePropertyEvent("focus","ta.servlet.Reviews.unattachedSearchOnFocus")},ratingFlyoutScroll:function(b){try{var c=b.getScroll().y,a=b.getScrollSize().y;if(b.retrieve("canFetchMore",true)&&c>a-ta.servlet.Reviews.PAGING_HEIGHT){b.store("canFetchMore",false);ta.servlet.Reviews.fetchRatingPage(b)}}catch(d){ta.util.error.record(d,"ratingFlyoutScroll")}},fetchRatingPage:function(b){var a=b.getElement(".ratingVal").innerHTML,c=b.getElement(".locId").innerHTML,f=b.getElement(".revId"),d=f.innerHTML;if(d!=0){new Request({url:"/RatingPagingAjax",data:{locId:c,ratingVal:a,revId:d},method:"get",onSuccess:function(g,h){f.destroy();b.innerHTML+=g;b.store("canFetchMore",true)}}).send()}}};ta.servlet.Location={distanceUnitsCookieName:"TAdistanceCookie",showMi:function(){$$("#NEARBY .milesOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .distanceMiles").show();$$("#NEARBY .distanceKm").hide();Cookie.write(this.distanceUnitsCookieName,0)},showKm:function(){$$("#NEARBY .kmOption").each(function(b,a){b.checked=true});$$("#NEARBY .milesLabel").each(function(b,a){$(b).removeClass("selected")});$$("#NEARBY .kmLabel").each(function(b,a){$(b).addClass("selected")});$$("#NEARBY .distanceMiles").hide();$$("#NEARBY .distanceKm").show();Cookie.write(this.distanceUnitsCookieName,1)},reportClosedVote:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?action=geocodeclosed&id="+c,onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})}}).send()}},reportGeoCode:function(d,c,f,b,a){if(f&&f>0){f=encodeURIComponent(f);new Request({method:"get",url:"/ReportIAP?action=geocodebad&id="+f,onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"mg s4",delayedPosition:true})}}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,f)}},reportCorrectAddr:function(c,g,m,q,d,k,o,r){if(m&&m>0){m=encodeURIComponent(m);var j=document.getElementById("street").value;var l=document.getElementById("city").value;var b=document.getElementById("state").value;var f=document.getElementById("zip").value;var h=document.getElementById("country").value;var p=document.getElementById("phone").value;var a=document.getElementById("website").value;if(q==j&&d==l&&k==f&&o==p&&r==a){new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=false&id="+m,onSuccess:function(s){ta.overlays.showInLightbox(s,{style:"mg s4",delayedPosition:true})}}).send()}else{j=encodeURIComponent(j);l=encodeURIComponent(l);b=encodeURIComponent(b);f=encodeURIComponent(f);h=encodeURIComponent(h);p=encodeURIComponent(p);a=encodeURIComponent(a);new Request({method:"post",url:"/ReportIAP?action=geocodecorrect&updated=true&id="+m+"&street="+j+"&city="+l+"&state="+b+"&zip="+f+"&country="+h+"&phoneNumber="+p+"&webSite="+a,onSuccess:function(s){ta.overlays.showInLightbox(s,{style:"mg s4",delayedPosition:true})}}).send()}}},reportGeoCodeDialog:function(d,c,f,b,a){if(typeof(incorrectLocation)!="undefined"&&!this.incorrectLocationLink){this.incorrectLocationLink=Asset.css(incorrectLocation)}if(f&&f>0){f=encodeURIComponent(f);new Request({method:"get",url:"/ReportIAP?id="+f+"&action=geocodedialog",onSuccess:function(g){ta.overlays.showInLightbox(g,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,f)}},reportGeoCodeDialogGetListed:function(d,c,g,b,a,j,h,f){if(g&&g>0){if(f){window.location.href=f}else{new Request({url:"/GetListedUpdate"+j+"?id="+g,onSuccess:function(l){var k=ta.overlays.showInLightbox(l,{style:"glnew_update mg s3",delayedPosition:true,title:h,attachCloseEvent:false,permanent:true});k.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()})},evalScripts:true}).send()}}if(ta.trackEventOnPage&&b&&a){ta.trackEventOnPage(b,a,g)}},reportClosedVoteNew:function(d,c,g,b,a,f){if(g&&g>0){new Request({method:"post",url:"/"+f+"?action=closedareyousure&id="+g,onSuccess:function(h){ta.overlays.showInLightbox(h,{style:"glnew_update_areyousure mg s4",delayedPosition:true,isChild:true,showCloseButton:false})},evalScripts:true}).send()}},recordClosedVote:function(d,c,g,b,a,f){if(g&&g>0){new Request({method:"post",url:"/"+f+"?action=voteclosed&id="+g,onSuccess:function(h){ta.overlays.showInLightbox(h,{style:"mg s4",delayedPosition:true,showCloseButton:false})},evalScripts:true}).send()}},requestListingWithLightbox:function(d,c,b,f){var a={style:"glnew_lightbox",closeButtonClass:"roundOuterClose",delayedPosition:true,attachCloseEvent:false,permanent:true,showCloseButton:true};new Request({method:"post",url:"/GetListedLightbox?placetype="+b,onSuccess:function(h){var g=ta.overlays.showInLightbox(h,Object.merge(a,{title:f}));g.closeBtn.addEvent("click",function(){ta.GetListedNew.closeOverlay()})},evalScripts:true}).send()},showReportForm:function(b,a,c){if(c&&c>0){c=encodeURIComponent(c);new Request({method:"get",url:"/ReportIAP?id="+c+"&action=geocodeform",onSuccess:function(d){ta.overlays.showInLightbox(d,{style:"mg s4",delayedPosition:true})},evalScripts:true}).send()}},setTrackPID:function(c,b,a){if(a==10022){ta.util.cookie.setPIDCookie(17138)}else{if(a==10021){ta.util.cookie.setPIDCookie(17137)}}},closeLightbox:function(){var a=ta.retrieve("overlays.current");if(a){a.hide()}},activateReportButton:function(){var a=ta.id("REPORT_LOCATION").getElements(".button")[0];a.removeClass("inactive");a.removeProperty("disabled")}};ta.servlet.Popup={index:0,open:function(a,b,c,r,m,l,g,q){try{if(isNaN(parseInt(c))){c=600}else{c=parseInt(c)}if(isNaN(parseInt(r))){r=400}else{r=parseInt(r)}if(isNaN(parseInt(m))){m=0}else{m=parseInt(m)}if(isNaN(parseInt(l))){l=0}else{l=parseInt(l)}if(a.indexOf("p=HotelsCom")>-1){c=Math.max(c,960);r=Math.max(r,window.getHeight(),600)}if(Browser.chrome){g=true}var f=1;if(g){f=0}var k=1;if(ta.browser.isIE9orHigher()){var k=0}var j=false;if(b&&typeof b=="string"){j=b}if(!j){var s=ta.servlet.Popup.index++;j="TripPop"+s}var d="";if(q){d="toolbar=1,resizable=1,location=1,status=1"}else{k=0;d="toolbar=0,resizable=1,location=0,status=0"}d+=",menubar="+k;d+=",scrollbars="+f;d+=",width="+c;d+=",height="+r;d+=",screenX="+m+",left="+m;d+=",screenY="+l+",top="+l;var o=window.open(a,j,d);if(o!=null){try{o.focus();o.opener=self}catch(p){}return o}}catch(h){ta.util.error.record(h,"Popup.open",null,{name:b,width:c,height:r,x:m,y:l,noScroll:g,allOptions:q})}},openSizedPopup:function(f,b,d){new Event(f).preventDefault();var c=600;var a=400;if(sz=b.className.match(/sz(\d+)x(\d+)/)){c=sz[1];a=sz[2]}ta.servlet.Popup.open(b.href,"photoTPW",c,a,false,false,((typeof d!="undefined")?d:true),true)},checkrates:function(b,a){b.preventDefault();if(a.get("tag")!="a"){a=a.getParent("a")}ta.servlet.Popup.open(a.href,"cr",245,610,5,5);if(ta.trackEventOnPage){ta.trackEventOnPage("map_pin_overlay","check_rates_click")}},sponsorCheckRates:function(d,b){d.preventDefault();if(b.get("tag")!="span"){b=b.getParent("span")}var a=b.className.match(/id_(\d+)/)[1];var c="/HotelDateSearch?d="+a+"&fromPop=false&sponsid="+ta.retrieve("sponsor.id")+"&area=QC_Button_Map&from=HACSearchButton&returnTo=__2F__GMapsLocationController&sponsdet=mapsHacBottom";ta.servlet.Popup.open(c,"cr",245,610,5,5)},termsPopup:function(b,a){popup.apply(a,[b,"terms",300,300,30,25]);return false},openInParent:function(f,d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}if(!a){return true}var b="";if(d.get("tag")=="form"){b=d.action+"?"+d.toQueryString()}else{if(d.get("tag")=="a"){b=d.href}else{d=d.getParent("a");b=d.href}}if(b!=""){if(f){f.preventDefault()}a.opener.location=b;if(!(typeof c!="undefined"&&c)){a.close()}else{window.blur()}}},openInParentOrSelf:function(d,c){var a=false;if(window.top&&window.top.opener){a=window.top}else{if(window.opener){a=window}}var b="";if(c.get("tag")=="form"){b=c.action+"?"+c.toQueryString()}else{if(c.get("tag")=="a"){b=c.href}else{c=c.getParent("a");b=c.href}}if(b!=""){if(d){d.preventDefault()}if(!a||(typeof a.opener=="undefined")||!a.opener||(typeof a.opener.closed=="undefined")||a.opener.closed){window.location=b}else{a.opener.location=b;a.close()}}},photoGallery:function(a,d){try{if(!d){return false}if(!d.get||!d.getParentBySelector){d=$(d)}if(!d.get||!d.getParentBySelector){ta.util.error.record(j,"photoGallery - elmt not wrapped");return false}if(d.get("tag")!="a"){d=d.getParentBySelector("a")}}catch(j){ta.util.error.record(j,"photoGallery - get anchor elmt");return false}var b="";var c="1";if(d.className){b=d.className.match(/u_([^ ]*)/)[1];c=d.className.match(/#([0-9]+)/)[1]}try{if(typeof cookieDomain=="undefined"){var g=window.location.hostname.split("."),f=0,l;while(g[f]&&g[f]!="tripadvisor"){f++}l=g.slice(f).join(".");if(l){cookieDomain="."+l}}Cookie.write("PhotoPop",c,{domain:cookieDomain})}catch(j){ta.util.error.record(j,"photoGallery - cookie set")}try{var k="";if(b){k=ta.servlet.Popup.open(b,"media",780,800)}else{}try{if(k&&k.showImage){k.showImage(c)}}catch(j){}}catch(j){ta.util.error.record(j,"photoGallery - pop window")}return false},openAIMLink:function(d,c){new Event(d).preventDefault();var b;if(c.get("tag")=="span"&&c.hasClass("fkASDF")){b=c.className.match(/u_([^ ]*)/)[1]}else{if(c.getParent("div.fkASDF")){b=c.getParent("div.fkASDF").className.match(/u_([^ ]*)/)[1]}else{if(c.get("tag")=="a"){b=c.href}else{if(c.getParent().get("tag")=="a"){b=c.getParent().href}else{return}}}}var a=c.className.match(/win(.+)/);if(a&&a.length>1){a=a[1]}else{a=null}ta.store("commerce.AIMWindow",ta.servlet.Popup.open(b,a,980,800,240,5,false,true));try{if(ta.has("checkrates.lpl_check_rates")&&c.href&&c.href.match(/LocationPhotosLightbox/)){ta.id("MEDIA_GALLERY").hide()}}catch(f){ta.util.error.record(f,"LPL photoGallery - could not hide photo gallery")}},openProviderWindow:function(b,a){new Event(b).preventDefault();ta.servlet.Popup.open(a.href,"photoTPW",1260,922,false,false,true,true)}};ta.servlet.Hotel={detailsTabClicked:function(b,a){showTab(locationId,"tabDetails")},photosTabClicked:function(b,a){showTab(locationId,"tabPhotos")},mapTabClicked:function(b,a){showTab(locationId,"tabMap")},ratingsTabClicked:function(b,a){showTab(locationId,"tabRatings")},setPid:function(a){ta.util.cookie.setPIDCookie(a)},setConceptCookie:function(){if(ta.has("topconcepts.lastconcept")){var a=ta.retrieve("topconcepts.lastconcept");Cookie.write("CONCEPT",a,{domain:cookieDomain,time:5})}return true},voteRecorded:false,recordVote:function(b,h,f,c,a){if(a.checked&&!ta.servlet.Hotel.voteRecorded){ta.servlet.Hotel.voteRecorded=true;new Request({url:"/ActionRecord-g"+b+"-d"+h+"?action=TopConceptsHelpful_"+f}).send();var d=$("preVote");var g=$("postVote");if(d&&g){d.style.display="none";g.style.display="inline"}else{ta.util.error.record(null,"recordVote - cannot find voting spans")}}return true},isHotelsServlet:function(a){if(ta.has("is_hotels_serv")){return ta.retrieve("is_hotels_serv")}var b=ta.id("PAGE");if(b&&typeof b!="undefined"){if(b.hasClass("hotels_like")){ta.store("is_hotels_serv",true);return true}else{if(b.hasClass("non_hotels_like")){ta.store("is_hotels_serv",false);return false}}}if(typeof a!="undefined"){return a}return false},selectLanguage:function(d,b,f){var c=ta.id("LANG_FORM");var a=ta.id("filterLang");if(c&&a){ta.setEvtCookie("Reviews_Controls","language_sort","",0,window.location.href);a.value=f;c.submit()}}};ta.widgets.calendar={multiDateFormatter:function(g,h,f,c,d){var b={cname:"",contents:g.getDate()};var a="";if(!f){a="invalid"}else{if(g.getTime()==this.today.getTime()){if(this.newInDate&&g.getTime()==this.newInDate.getTime()){a="today inDate"}else{if(!h){a="today disabled"}else{a="today"}}}else{if(this.newInDate&&g.getTime()==this.newInDate.getTime()){a=d.inDateClass}}}b.cname=a;return b},calendarMultiSelect:function(h,g,a,f,b){try{ta.id(b).getParent(".overlay").overlay.calendar.multiSelect(h,ta.util.date.create(g,a,f),b);if(ta.has("checkrates.date_picker_on_classic")&&(Browser.ie||Browser.chrome)){ta.popups.PopUtil.attemptHoldingWindow(ta.commerce.checkrates.getPropIdFromCRElement(ta.id(b).getParent(".overlay").overlay.calendar.inputElement))}}catch(c){ta.util.error.record(c,"calendarMultiSelect issue")}},calendarMouseOver:function(g,f,a,c,b){ta.id(b).getParent(".overlay").overlay.calendar.dayOver(g,ta.util.date.create(f,a,c),b)},calendarPrev:function(c,b){var a=ta.id(b);if(a&&a.hasClass("sprite-date_picker-btnLeftInactive")){return}if(ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnRightInactive")){return}a.getParent(".overlay").overlay.calendar.prev()},calendarNext:function(c,b){var a=ta.id(b);if(a&&a.hasClass("sprite-date_picker-btnRightInactive")){return}if(ta.util.i18n.isRtl()&&a&&a.hasClass("sprite-date_picker-btnLeftInactive")){return}a.getParent(".overlay").overlay.calendar.next()},adultsOver:function(c,b){var a=document.getElements(".date_picker_adults_option");if(a){Array.each(a,function(d){ta.id(d).removeClass("adults_selected")})}ta.id(b).addClass("adults_selected")},removeMetaCalendarFromSync:function(c){if(!ta.has("metaDatePickerEnabled")){return}var b="avail.data."+c+"._met";var a=ta.retrieve("avail.data.objects");if(a){a.erase(b)}ta.store("avail.data.objects",a);ta.remove(b)},getCalendarObjectKey:function(d,b,a){var c="avail.data";if(a){c=c+"."+a}c=c+"."+d;if(b){c=c+"."+b}return c},trackCalendarObject:function(c){var a=ta.widgets.calendar.getCalendarObjectKey(c.locId,c.ext,c.calendar.options.pickerOption);ta.store(a,c);var b=ta.retrieve("avail.data.objects");if(!b){b=[]}b.include(a);ta.store("avail.data.objects",b)},trackCalendarFlyout:function(d,c,f){var g="date.picker.calendarflyout";var b=ta.retrieve(g);if(!b){b=[]}var a=new Object();a.elmt=d;a.overlay=c;a.overlaySrc=f;b.push(a);ta.store(g,b)},clearCalendarFlyouts:function(){var b="date.picker.calendarflyout";var a=ta.retrieve(b);if(a){a.each(function(c){var f=c.elmt;var d=c.overlay;var g=c.overlaySrc;if(f&&d&&g){f.removeEvent("mouseenter",d.showWithDelay);f.removeEvent("mouseleave",d.hideWithDelay);f.removeEvent("mouseenter",d.show);f.removeEvent("mouseleave",d.hide);f.removeEvent("click",d._pin);f.adopt(g)}})}},getDateBefore:function(b){var a=new Date(b.getTime());a.setDate(a.getDate()-1);return a},getDateAfter:function(b){var a=new Date(b.getTime());a.setDate(a.getDate()+1);return a},setPageInDate:function(a){if(a&&a.getDate){ta.store("date.picker.pageInDate",a)}if(ta.has("date.picker.pageOutDate")){ta.store("meta.page_dates",true)}},setPageOutDate:function(a){if(a&&a.getDate){ta.store("date.picker.pageOutDate",a)}if(ta.has("date.picker.pageInDate")){ta.store("meta.page_dates",true)}ta.widgets.calendar.updateCalendarPropertiesOnDateSet()},setTimeoutPageDates:function(){var b=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout"));if(b){ta.widgets.calendar.setPageInDate(b)}var a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"));if(a){ta.widgets.calendar.setPageOutDate(a)}},clearPageDates:function(){ta.remove("date.picker.pageInDate");ta.remove("date.picker.pageOutDate");ta.remove("multiDP.inDate");ta.remove("multiDP.outDate");ta.remove("meta.page_dates");ta.remove("meta.session_dates");if(ta.isMetaHotelsRequest()){ta.store("dates.datesCleared",true)}},clearPageInDate:function(b,a){ta.remove("date.picker.pageInDate");ta.remove("multiDP.inDate");ta.remove("meta.page_dates")},clearPageOutDate:function(c,a){var b=document.getElement(".hover_table.results");if(ta.isBCHoverTable()&&b){b.hide()}ta.remove("date.picker.pageOutDate");ta.remove("multiDP.outDate");ta.remove("meta.page_dates")},updateCalendarPropertiesOnDateSet:function(){var a=ta.retrieve("avail.data.objects");if(a){Array.each(a,function(c){var b=ta.retrieve(c);if(b&&b.calendar){b.calendar.setPermanent(false)}})}},setPageAdultsCount:function(a){if(a){ta.store("date.picker.adultsCount",a)}},getPageInDate:function(){if(ta.has("date.picker.pageInDate")){return ta.retrieve("date.picker.pageInDate")}if(ta.has("multiDP.inDate")){var a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDate"));if(a){ta.widgets.calendar.setPageInDate(a)}return a}return false},getPageOutDate:function(){if(ta.has("date.picker.pageOutDate")){var b=ta.retrieve("date.picker.pageOutDate");if(!ta.widgets.calendar.isValidStayLength(b)){ta.widgets.calendar.clearPageDates();return false}return b}if(ta.has("multiDP.outDate")){var a=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDate"));if(a){ta.widgets.calendar.setPageOutDate(a)}if(!ta.widgets.calendar.isValidStayLength(a)){ta.widgets.calendar.clearPageDates();return false}return a}return false},isValidStayLength:function(a){var b=ta.widgets.calendar.getPageInDate();if(!b||!a){return true}var c=a-b;c=Math.round(c/1000/60/60/24);if(c>31){return false}return true},getPageAdultsCount:function(){if(ta.has("date.picker.adultsCount")){return ta.retrieve("date.picker.adultsCount")}if(ta.has("multiDP.adultsCount")){ta.store("date.picker.adultsCount",ta.retrieve("multiDP.adultsCount"));return ta.retrieve("multiDP.adultsCount")}return"2"},getCheckRatesData:function(){var d=ta.widgets.calendar.getPageInDate();var b=ta.widgets.calendar.getPageOutDate();var c=ta.widgets.calendar.getPageAdultsCount();if(!d||!b||!d.getMonth||!b.getMonth){return false}var a={inMonth:(d.getMonth()+1)+" "+d.getFullYear(),inDay:d.getDate(),outMonth:(b.getMonth()+1)+" "+b.getFullYear(),outDay:b.getDate(),adults:c};return a},_parseDatePickerDate:function(c){try{if(c&&c.split&&c.split(" ").length>1){var a=c.split(" ");var b=new Date();ta.util.date.normalize(b);b.setFullYear(a[0]);b.setDate(1);b.setMonth(parseInt(a[1],10)-1);b.setDate(a[2]);return b}}catch(d){return false}},hasPageDates:function(){if(!ta.has("metaDatePickerEnabled")){return false}if(ta.has("meta.page_dates")){return true}ta.widgets.calendar.getPageInDate();ta.widgets.calendar.getPageOutDate();return ta.has("meta.page_dates")},oneDayMill:(24*60*60*1000),updateDateWidgetDisplay:function(a){if(!a){return}ta.id(a).removeClass("date_picker_error");var c=ta.widgets.calendar.getPageInDate();var b=ta.widgets.calendar.getPageOutDate();if(ta.has("hotels.wipeDatesTwoEnabled")){if(!c&&!b&&ta.has("multiDP.inDateTimeout")){c=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout"));b=ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"));ta.widgets.calendar.showAllPriceButtons(true)}}ta.widgets.calendar.updateDateDisplay(a,c,b);var d=document.getElements(".adults");if(d){d.each(function(f){ta.widgets.calendar.updateAdultsDisplay(f)})}},showAllPriceButtons:function(a){var b=document.getElements(".showPriceButton");if(b){a?b.addClass("showPriceButtonShow").removeClass("showPriceButtonHide"):b.addClass("showPriceButtonHide").removeClass("showPriceButtonShow")}},getPageInCalendarField:function(b,a){return ta.id("date_picker_in_"+b+a)},getPageOutCalendarField:function(b,a){return ta.id("date_picker_out_"+b+a)},getErrorDates:function(){var c="no dates";try{var a=ta.retrieve("multiDP.v5")?ta.widgets.calendar.getDatePickerFormat("classic"):ta.widgets.calendar.getDatePickerFormat("meta");if(ta.widgets.calendar.hasPageDates()){c=ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageInDate(),a);c=c+" - "+ta.widgets.calendar.dateToString(ta.widgets.calendar.getPageOutDate(),a)}}catch(b){}return c},updateDateDisplay:function(b,c,h){if(c&&h&&c.getTime()>h.getTime()){var d=c;c=h;h=d}var a=ta.retrieve("multiDP.v5")?ta.widgets.calendar.getDatePickerFormat("classic"):ta.widgets.calendar.getDatePickerFormat("meta");if(ta.id(b).getParent(".dual_date")){if(b.id.slice(-4)=="_upt"){b.innerHTML=c?ta.widgets.calendar.dateToString(c,a):ta.retrieve("multiDP.interrupterCheckIn");var g=b.id.replace("date_picker_in","date_picker_out");if(g&&ta.id(g)){ta.id(g).innerHTML=h?ta.widgets.calendar.dateToString(h,a):ta.retrieve("multiDP.interrupterCheckOut")}}else{b.innerHTML=c?ta.widgets.calendar.dateToString(c,a):ta.retrieve("multiDP.checkIn");var g=b.id.replace("date_picker_in","date_picker_out");if(g&&ta.id(g)){ta.id(g).innerHTML=h?ta.widgets.calendar.dateToString(h,a):ta.retrieve("multiDP.checkOut")}}}else{var k=b.innerHTML=ta.retrieve("multiDP.enterDatesText");var f=ta.widgets.calendar.getSingleDateFieldDatesText(c,h,a);if(f){k=f}b.innerHTML=k;var j=ta.id(b).getParent();if(j){var l=j.getElement(".date_picker_calendar_nights");ta.widgets.calendar.updateNightsDisplay(l,c,h)}}},getSingleDateFieldDatesText:function(d,b,a){var c="";var f=ta.retrieve("multiDP.dateSeparator")||" - ";if(d){c=ta.widgets.calendar.dateToString(d,a)+f;if(b){c=c+ta.widgets.calendar.dateToString(b,a)}}return c},updateNightsDisplay:function(d,c,a){if(!d){return}if(!a){d.innerHTML="";return}var b=ta.widgets.calendar.getNumberOfNightsFromDates(c,a);if(b==1){d.innerHTML=ta.retrieve("multiDP.singleNightText")}else{d.innerHTML=ta.retrieve("multiDP.multiNightsText").replace(/\d+/,b)}},getNumberOfNights:function(){inDate=ta.widgets.calendar.getPageInDate();outDate=ta.widgets.calendar.getPageOutDate();return ta.widgets.calendar.getNumberOfNightsFromDates(inDate,outDate)},getNumberOfNightsFromDates:function(b,a){if(b&&a){return Math.round(Math.abs((b.getTime()-a.getTime())/ta.widgets.calendar.oneDayMill))}else{return 0}},updateAdultsDisplay:function(b){if(!b){return}var a=ta.widgets.calendar.getPageAdultsCount();if(a=="1"){b.innerHTML=ta.retrieve("multiDP.singleAdultsText")}else{b.innerHTML=ta.retrieve("multiDP.multiAdultsText").replace(/\d+/,a)}},syncAllDatePickers:function(){var b=document.getElements(".date_picker.date");if(b){Array.each(b,function(c){if(c&&!ta.id(c).hasClass("out_date")){ta.widgets.calendar.updateDateWidgetDisplay(c)}})}var a=$$(".tablet_date_label");if(a&&ta.widgets.calendar.hasPageDates()){a.addClass("showLabels")}},getDatePickerFormat:function(a){if(a==="classic"&&typeof DATE_PICKER_CLASSIC_FORMAT!="undefined"){return DATE_PICKER_CLASSIC_FORMAT}else{if(typeof DATE_PICKER_META_FORMAT!="undefined"){return DATE_PICKER_META_FORMAT}}if(typeof a!="string"){a="not_a_string"}return""},dateToString:function(f,g){if(!f.getDate||!g){return""}if(g==ta.widgets.calendar.getDatePickerFormat("classic")){var c=new Date(f);if(ta.retrieve("thai_buddhist_era_year")){c.setFullYear(c.getFullYear()+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET)}var a=[];var m="MM";var b="yyyy";var k="dd";var h=c.getDate()+"";if(h&&h.length==1){h="0"+h}var j=(c.getMonth()+1)+"";if(j&&j.length==1){j="0"+j}g=g.replace(m,j).replace(k,h).replace(b,c.getFullYear()).replace(/'/g,"");return g}var a=[];var d=ta.retrieve("multiDP.abbrevMonthList");var o=f.getDay();if(ta.retrieve("multiDP.isMondayFirstDayOfWeek")){o=o-1}if(o==-1){o=6}var l="EEE";var m="MMM";if(g=="EEEE d MMMM"){l="EEEE";m="MMMM"}g=g.replace(l,jsGlobalDaysAbbrev[o]).replace(m,d[f.getMonth()]).replace(/\bd\b/,f.getDate()).replace(/'/g,"");return g},setErrorStyling:function(c){var b=false;try{b=c.className.match(/\bid_(\d+)/)[1]}catch(d){}if(b){var a=false;var f="date_picker_";if(ta.retrieve("ta.meta_single_date_picker")){f="date_picker_in_"}if(!a){a=ta.id(f+b+"_met")}if(!a){a=ta.id(f+b+"_cro")}if(!a){a=ta.id(f+b+"_per")}if(!a){a=ta.id(f+b+"_pop")}if(!a){a=ta.id(f+b+"_pto")}if(!a){a=ta.id(f+b+"_amo")}if(!a&&c.id.slice(-4)=="_upt"){a=ta.id(f+b+"_upt")}if(!a){a=ta.id(f+b)}if(a){setTimeout(function(){a.click()},100)}}},launchInlineMeta:function(a){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE",a)},launchInlineMetaIfNotGeoCheckrates:function(a){if(!ta.id("GEO_CHECK_RATES_BALANCE")){ta.widgets.calendar.launchInlineMeta(a)}},launchDealsMeta:function(a){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE.id_"+a)},launchPCRMeta:function(){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE_per")},launchMetaLightboxUpdate:function(b,a){if(ta.retrieve("hotels.redesignEnabled")){ta.store("hotels.datesChanged",true)}if(/.*_solb/.test(a.id)){window.scrollTo(0,0)}ta.commerce.checkrates.checkRatesClicked(false,a,b,"");ta.commerce.checkrates.changePID()},launchMetaLightboxUpdateWithAjax:function(b,a){ta.store("hotels.shouldIssueAjax",true);ta.commerce.minimeta.ajax.send(true);ta.widgets.calendar.launchMetaLightboxUpdate(b,a)},launchMetaInlineUpdate:function(){var a=ta.id("CHECK_RATE");var b="meta_inline_checkrates";var c=ta.retrieve("metaInlineGeoId");var d=new ta.commerce.CheckRatesData({type:b,evnt:null},c,c,true);ta.commerce.meta.loadInlineMeta(d,c)},justUpdateMetaPlacements:function(){ta.store("suppressInlineToggle",true);ta.widgets.calendar.launchMetaInlineUpdate()},launchPhotosUpdate:function(){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE_pto")},launchPhotoLightboxUpdate:function(a){if(ta.retrieve("hotels.redesignEnabled")){ta.store("hotels.datesChanged",true)}ta.widgets.calendar.launchInlineMeta(a)},launchHotelPhotosUpdate:function(d,b){b=ta.id(b);if(!b){return}var c=b.getParent("#HotelDateSearch");if(c){var a=c.getElement("#CHECK_RATE");if(a){ta.store("hotels.datesChanged",true);ta.widgets.calendar._crBtnOnclick(a)}}},launchAmenityUpdate:function(){ta.widgets.calendar._crBtnOnclick("#CHECK_RATE_amo")},launchCRLBUpdate:function(){ta.commerce.meta.clearStoredMiniData();ta.overlays.Factory.updateMiniMetaPlacements()},_crBtnOnclick:function(b,c){ta.store("meta.calendarCR",true);var a=document.getElement(b);if(a){document.getElement(b).onclick(c)}ta.remove("meta.calendarCR")},closeCalendarWidgets:function(){var b=document.getElements(".date_picker_calendar");if(b){Array.each(b,function(f){if(f&&f.overlay){var d=true;var c=f.overlay.source;if(c&&(c.hasClass("isPreDatesPermanent")||c.getParent(".isPreDatesPermanent"))){d=false}if(d){f.overlay.hide()}}})}var a=document.getElement(".dp.overlay");if(a&&a.overlay){a.overlay.hide()}},getInOutTrackingKey:function(b){var a="avail.data.dateClicked";if(b){return a+".in"}else{return a+".out"}},removeInOutCalendarSelected:function(a){ta.remove(ta.widgets.calendar.getInOutTrackingKey(a))},trackInOutCalendarSelected:function(a){ta.store(ta.widgets.calendar.getInOutTrackingKey(a),true)},inOutCalendarSelected:function(a){return ta.retrieve(ta.widgets.calendar.getInOutTrackingKey(a))},trackCalendarEvent:function(b,c,a,f){try{ta.trackEventOnPage(b,c,a,f,true)}catch(d){}},submitHacSearch:function(d,c){if(ta.has("useHotelsFilterState")){return ta.widgets.calendar.submitHotelsForm(d,c)}var b="";c=ta.id(c);if(c.get("tag")=="form"){var f=c.getElement("input[name=q]");if(f){f.name=""}b=c.action+"?"+c.toQueryString()}else{if(c.get("tag")=="a"){b=c.href}else{c=c.getParent("a");b=c.href}}if(b!=""){if(ta.widgets.calendar.hasPageDates()){if(!b.match(/\?/)){b=b+"?"}var a=ta.widgets.calendar.getCheckRatesData();if(a){b=b+"&"+Object.toQueryString(a)}}if(d){new Event(d).preventDefault()}window.location=b}},clearSessionDates:function(a){new Request({url:"/UpdateSessionDatesAjax?clear=true",onSuccess:function(){ta.widgets.calendar.clearDates();if(a){document.location.href="./"+a}}}).send()},clearAllDatePickers:function(){var c=ta.retrieve("avail.data.objects");if(c){Array.each(c,function(d){var f=ta.retrieve(d);if(f){f.clear()}})}var b=document.getElements(".date_picker.date");if(b){Array.each(b,function(d){ta.widgets.calendar.updateDateWidgetDisplay(d);ta.widgets.calendar.showEnterDates(d)})}if(!ta.retrieve("multiDP.v5")){var a=$$(".tablet_date_label");if(a){a.removeClass("showLabels")}}},showEnterDates:function(a){if(!a){return}if(ta.id(a).getParent(".dual_date")){if(ta.id(a).hasClass("out_date")){a.innerHTML=ta.retrieve("multiDP.checkOut")}else{a.innerHTML=ta.retrieve("multiDP.checkIn")}}else{a.innerHTML=ta.retrieve("multiDP.enterDatesText")}},clearDates:function(){ta.widgets.calendar.clearPageDates();ta.widgets.calendar.clearAllDatePickers();var a=document.getElement(".clearDates");var l=document.getElement(".clearDatesWrapper");var c=document.getElement(".showPriceButton");var b=document.getElement(".change_dates_button");var j=document.getElement(".date_picker_post_dates");var g=document.getElement(".date_picker_pre_dates");var h=document.getElement(".show_prices_button");var d=document.getElement(".hover_table.search");var f=document.getElement(".hover_table.results");var k=ta.id("ANIMATED_DATE_CTA");if(ta.retrieve("animate_date_reformat")){k=ta.id("ANIMATED_DATE_CTA_REFORMAT")}if(g){g.show()}if(j){j.hide()}if(a){a.hide()}if(l){l.hide()}if(b){b.hide()}if(h){h.show()}if(ta.isBCHoverTable()){if(d){d.hide()}if(f){f.hide()}}if(k){ta.servlet.HACSearch.loadAnimatedDateCTA()}if(c){c.hide()}},clearDatesAndRedirect:function(){var a=window.location.hash;var b=false;var c=window.location.href.match(/geo=\d+/g);if(c&&c[0]){b=c[0]}if(!b){c=window.location.href.match(/-g\d+/g);if(c&&c[0]){b="geo="+c[0].substring(2)}}if(b){var d="HACSearch?"+b+a;ta.widgets.calendar.clearSessionDates(d)}},updateSessionDatesOrDoMetaDateSearch:function(a){if(ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.justUpdateSessionDates()}else{ta.servlet.HACSearch.doMetaDateSearch(a)}},datesExist:function(){var b=ta.widgets.calendar.getPageInDate();var a=ta.widgets.calendar.getPageOutDate();return b&&a},datesInRange:function(){var c=ta.widgets.calendar.getPageInDate();var a=ta.widgets.calendar.getPageOutDate();if(!ta.widgets.calendar.datesExist()){return false}var b=Math.round(Math.abs((c.getTime()-a.getTime())/ta.widgets.calendar.oneDayMill));return b>=1&&b<=30},openFirstDatePicker:function(b){new Event(b).stopPropagation();var a=$$(".date_picker_calendar_wrap");if(a&&a.length>0){a[0].click()}ta.trackEventOnPage("price_filter_dates_link","click","")},launchMiniMetaCrossSellUpdate:function(){try{if(typeof(ta.commerce)!="undefined"&&typeof(ta.commerce.meta)!="undefined"&&typeof(ta.commerce.meta.loadMiniMetaCrossSell)!="undefined"){ta.commerce.meta.loadMiniMetaCrossSell(ta.retrieve("meta.baseLocationId"),"MINI_META_CROSS_SELL",false,true)}}catch(a){ta.util.error.record(a,"ta.commerce.checkrates.launchMiniMetaCrossSellUpdate")}},justUpdateSessionDates:function(a){new Request({url:"/UpdateSessionDatesAjax",data:Object.toQueryString(ta.widgets.calendar.getCheckRatesData()),method:"post",onSuccess:function(){if(a&&typeof(a)==="function"){a()}}}).send()},updateSessionDates:function(a,b){new Request({url:"/UpdateSessionDatesAjax",data:b,method:"post",onSuccess:function(){if(a){window.location=a}},onFailure:function(){if(a){window.location=a}}}).send()},redirectToHotelOverview:function(a){if(a){a=JSON.decode(a);window.location=a.url}else{window.location="/Hotels"}},submitHotelsForm:function(d,b){b=ta.id(b);var c=b.toQueryString();if(ta.widgets.calendar.hasPageDates()){var a=ta.widgets.calendar.getCheckRatesData();if(a){c=c+"&"+Object.toQueryString(a)}}new Request({url:"/FilterState",data:c,method:"post",onSuccess:function(f){ta.widgets.calendar.redirectToHotelOverview(f)},onFailure:function(f){ta.widgets.calendar.redirectToHotelOverview(null)}}).send();if(d){new Event(d).preventDefault()}return false},getPlacement:function(f){if(!f||!f.id){return null}var d=/date_picker_[0-9]*_([a-z]*)/;var c=/date_picker_in_[0-9]*_([a-z]*)/;var a=/date_picker_out_[0-9]*_([a-z]*)/;var g=f.id;var b=d.exec(g);if(!b){b=c.exec(g)}if(!b){b=a.exec(g)}if(b){b=b[1]}return b},handleNewDates:function(l,m){if(ta.has("hotels.wipeDatesTwoEnabled")){var g=document.getElement(".showPriceButton");if(m&&!m.getParent(".metaCheckRatesOverlay")&&ta.has("hotels.hasTimeoutDates")&&g&&g.isVisible()&&!ta.retrieve("meta.isFromShowPriceButton")){return}ta.remove("meta.isFromShowPriceButton");if(!ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.setTimeoutPageDates()}ta.widgets.calendar.showAllPriceButtons(false);if(g){g.destroy()}}var d=ta.widgets.calendar.getPlacement(m);if(d=="geo"){ta.widgets.calendar.justUpdateSessionDates();return}if(ta.isBCHoverTable()){if(ta.widgets.calendar.datesInRange()){ta.commerce.meta.beginHoverTableHacQuery()}else{var b=document.getElement(".hover_table.search");var c=document.getElement(".hover_table.results");if(ta.isBCHoverTable()){if(b){b.hide()}if(c){c.hide()}}}}if(d=="pop"){var h=ta.retrieve("meta.baseLocationId");if(h){if(l!=h&&typeof pageServlet!="undefined"&&ta.retrieve("hotels.isAccommodation")&&(pageServlet=="Hotel_Review"||pageServlet=="ShowUserReviews")){ta.commerce.checkrates.checkRatesCheckMore(null,null,l,"checkrates")}l=h}else{if(typeof pageServlet!="undefined"){ta.store("hotels.datesChanged",true);if(ta.retrieve("meta_price_your_stay_redirect")){ta.widgets.calendar.justUpdateSessionDates();var f="property_"+l;var k=ta.id(f);setTimeout(function(){k.click()},250)}else{ta.commerce.checkrates.checkRatesCheckMore(null,null,l,"checkrates")}return}}}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){if(pageServlet=="Hotel_Review"||pageServlet=="ShowUserReviews"){ta.store("meta.isFromDatesChange",true)}}ta.store("hotels.datesChanged",true);if(ta.isMetaHotelsRequest&&!ta.isMetaHotelsRequest()&&!ta.has("meta.widget")){ta.commerce.minimeta&&ta.commerce.minimeta.ajax.send(false,true)}ta.commerce.metajson&&ta.commerce.metajson.refetchAll();if(l&&!ta.has("meta.widget")){var a=new ta.commerce.CheckRatesData({type:"checkrates"},l,l,false);var j=ta.id("MetaPricesTab");if(j&&!j.hasClass("dont_show")&&!ta.id("PROVIDER_BLOCK")){if(!ta.isDisablePriceTabAutoToggle()&&!ta.id("PERSISTENT_CHECK_RATES")){ta.commerce.meta.toggleTab(j,null)}else{ta.commerce.meta.loadInlineMeta(a,l)}}else{ta.commerce.checkrates&&ta.commerce.checkrates.updateMetaLightbox(a)}if(ta.retrieve("checkrates.hotel_flyout_micro_meta")){ta.commerce.checkrates.startScooter()}ta.commerce.meta&&ta.commerce.meta.miniMetaAjaxNoTimer(null,a)}if(document.getElement("span.error_msg")){document.getElement("span.error_msg").hide()}if(ta.has("ta.mini_meta_in_reviews")){ta.store("ta.mmir.newDates",true)}if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")&&ta.retrieve("meta.prof_photo_lb.post_date_close.overlay")){ta.overlays.Factory.tryToHideCROverlayPostDatesClose()}},_setMouseActionOnCalendar:function(c,b,d,f){if(c&&b&&d){var a=null;b.onmouseover=function(){ta.store("open_calendar_on_hover.isMouseInValidArea",true);a=setTimeout(function(){if(!ta.retrieve("open_calendar_on_hover.isCalendarClickOut")){c.click()}else{d.each(function(g){if(g){g.onmouseover=null}})}},f)};b.onmouseout=function(){ta.store("open_calendar_on_hover.isMouseInValidArea",false);clearTimeout(a)}}},openCalendarOnHover:function(){var c=ta.id("CHECK_RATES_CONT");if(c){var d=c.getElement(".meta_date_field.first");var g=c.getElement(".meta_date_field:not(.first)");var f=c.getElement(".date_picker:not(.out_date)");var b=c.getElement(".date_picker.out_date");var a=[d,g];var h=250;this._setMouseActionOnCalendar(f,d,a,h);this._setMouseActionOnCalendar(b,g,a,h)}}};ta.widgets.Calendar=new Class({Binds:["addCustomDayStyleString"],Implements:[Options,Events],options:{selectedDate:null,firstDate:null,lastDate:null,dualCalendar:true,invalidDates:null,useLinks:true,dayNames:false,formatter:null,offsetOther:0,choiceLink:null,prevAction:null,nextAction:null,monthHeadingFormat:"",monthspan:11,indicateTurnoverDays:false,monthChangeDuration:500,postContent:null,prevStyle:false,nextStyle:false,showRange:false,isFirstCal:null},initialize:function(a){this.setOptions(a);if(!this.options.firstDate){this.options.firstDate=new Date()}if(!this.options.lastDate){this.setLastDate(this.options.monthspan)}this.today=new Date();this.selectedDate=this.options.selectedDate;ta.util.date.normalize(this.today);if(this.options.firstDate){ta.util.date.normalize(this.options.firstDate)}if(this.options.lastDate){ta.util.date.normalize(this.options.lastDate)}if(this.selectedDate){ta.util.date.normalize(this.selectedDate)}this.container=new Element("div",{"class":"calendar"});this.addPrevNext();if(this.options.postContent){if(typeof(this.options.postContent)==="function"){this.options.postContent=this.options.postContent()}this.container.adopt(this.options.postContent)}if(this.options.monthHeadingFormat==""&&DATE_FORMAT_MMM_YYYY){this.options.monthHeadingFormat=DATE_FORMAT_MMM_YYYY}},setLastDate:function(b){if(b==null||b<1){b=11}var f=new Date();f.setDate(1);var a=f.getMonth();var c=a+b;f.setFullYear(f.getFullYear()+c/12);f.setMonth(c%12);this.options.lastDate=f},getFirstDate:function(){return this.selectedDate||(this.theOtherCal&&this.theOtherCal.selectedDate)||this.today},update:function(){if(this.currentMonth){this.removeTable(null,this.currentMonth)}if(this.nextMonth){this.removeTable(null,this.nextMonth)}var c=this.getFirstDate();if(ta.retrieve("multiDP.v7")){if(ta.widgets.calendar.getPageInDate()){c=new Date(ta.widgets.calendar.getPageInDate())}else{if(ta.widgets.calendar.getPageOutDate()){c=new Date(ta.widgets.calendar.getPageOutDate());c.setDate(0)}}}if(this.options.firstDate&&c<this.options.firstDate){c=this.options.firstDate}if(this.options.dualCalendar){var g=new Date(c);g.setDate(ta.util.date.DAYS_IN_MONTH[g.getMonth()]);ta.util.date.normalize(g);if(g>=this.options.lastDate){c=new Date(c);if(c.getMonth()==0){c.setFullYear(c.getFullYear()-1,11,1)}else{c.setMonth(c.getMonth()-1,1)}}}this.currentMonth=this.createMonth(c);this.injectMonth(this.currentMonth.elmt,true);if(this.options.dualCalendar){var f=new Date(this.currentMonth.date);var a=f.getDate();var b=f.getMonth()+1;if(a>ta.util.date.DAYS_IN_MONTH[b]){a=ta.util.date.DAYS_IN_MONTH[b]}f.setMonth(b,a);this.nextMonth=this.createMonth(f);this.injectMonth(this.nextMonth.elmt,false)}this.updatePrevNext();return this},injectMonth:function(c,d){if(ta.util.i18n.isRtl()){d=!d}var b=this.container,a="top";if(d&&this.nav){b=this.nav;a="after"}else{if(!d){if(this.options.postContent){b=this.options.postContent;a="before"}else{a="bottom"}}}c.inject(b,a)},reposition:function(){this.currentMonth.elmt.setStyle("left","0px");if(this.options.dualCalendar){if(!ta.util.i18n.isRtl()){this.nextMonth.elmt.setStyle("left",this.currentMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}else{this.nextMonth.elmt.setStyle("left","0px");this.currentMonth.elmt.setStyle("left",this.nextMonth.elmt.getCoordinates().width+this.options.offsetOther+"px")}}return this},updatePrevNext:function(){var b=this.currentMonth.date;var a=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var d=ta.util.date.inSameMonth(b,this.options.firstDate);var c=ta.util.date.inSameMonth(a,this.options.lastDate);getChildByClass(this.container,"prev").style.display=(d?"none":"block");getChildByClass(this.container,"next").style.display=(c?"none":"block")},createPagingElement:function(a,b,c){return'<span class="'+a+'"><a style="display: block;" onclick="'+b+'(event, this);">'+c+"</a></span>"},addPrevNext:function(){if(!(this.options.prevAction&&this.options.nextAction)){return}var a=[],b=this.nav=new Element("div",{"class":"navCal"}).inject(this.container);a.push(this.createPagingElement("prev"+(this.options.prevStyle?" "+this.options.prevStyle:""),this.options.prevAction,"Previous Month"));a.push(this.createPagingElement("next"+(this.options.nextStyle?" "+this.options.nextStyle:""),this.options.nextAction,"Next Month"));b.set("html",a.join(""))},createMonth:function(D){var F={date:D};var p=new Date(D);p.setDate(1);ta.util.date.normalize(p);var r=(p.getDay()-jsGlobalDayOffset+7)%7;var B=new Date(D);B.setDate(0);this.prevDayValid=(this.isInvalidDate(B)?0:1);if(B<this.options.firstDate||B>this.options.lastDate){this.prevDayValid=-1}var b=[];var s=D.getFullYear();var u=D.getMonth();var h=new Date();var v;var C=ta.util.date.inSameMonth(h,D)?h.getDate():-1;var q=-1;if(this.selectedDate&&this.selectedDate.getMonth()==u&&this.selectedDate.getFullYear()==s){q=this.selectedDate.getDate()}var E;if(this.options.showRange&&this.theOtherCal&&this.theOtherCal.selectedDate){E=this.theOtherCal.selectedDate;ta.util.date.normalize(E)}if(this.options.singleSelect){if((ta.retrieve("multiDP.v6")||ta.retrieve("multiDP.v7"))&&this.options.pickerOption=="out"&&ta.widgets.calendar.getPageInDate()){v=new Date(ta.widgets.calendar.getPageInDate());v.setDate(v.getDate()+31)}}var t=s;if(ta.retrieve("thai_buddhist_era_year")){t=t+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}b.push('<table cellspacing="0" cellpadding="0" border="0"><thead><tr><th class="caption" colspan="7">');b.push(this.options.monthHeadingFormat.replace(/MMM/,jsGlobalMonths[u]).replace(/YYYY/,t));b.push("</th></tr><tr>");for(var z=0;z<jsGlobalDaysShort.length;z++){b.push("<th>");b.push(this.options.dayNames?jsGlobalDaysAbbrev[z]:jsGlobalDaysShort[z]);b.push("</th>")}b.push("</tr></thead><tbody><tr>");for(var z=0;z<r;z++){b.push('<td class="other">&nbsp;</td>')}r--;var y=0;var c=ta.util.date.DAYS_IN_MONTH[F.date.getMonth()];if(F.date.getMonth()==1&&F.date.getYear()%4==0){c+=1}var k=c;while(y<c){r=(r+1)%7;y++;p.setDate(y);var A=y;var f=null;var a=!(p<this.options.firstDate||p>this.options.lastDate||(v&&p>v));var w=!this.isInvalidDate(p);var o=this.options.choiceLink;var m=!((this.selectedDate&&this.selectedDate.getTime()<p.getTime())||(E&&E.getTime()<p.getTime()));if(this.options.formatter){this.options.selectedDay=q;this.options.otherDate=E;var g=this.options.formatter.call(this,p,a,w,r,this.options);f=g.cname;A=g.contents;o=g.link||o}else{if(!w){f="invalid"}else{if(y==C){if(y==q||(E&&p.getTime()===E.getTime())){f="today selected "+(m?"start":"end");m=!m;if(this.selectedDate&&E){f+=" rngDt"}}else{if(!a){f="today disabled"}else{f="today"}}}else{if(y==q||(E&&p.getTime()===E.getTime())){f="selected "+(m?"start":"end");m=!m;if(this.selectedDate&&E){f+=" rngDt"}}else{if(this.selectedDate&&E&&((this.selectedDate.getTime()<p.getTime()&&p.getTime()<E.getTime())||(this.selectedDate.getTime()>p.getTime()&&p.getTime()>E.getTime()))){f="rngDt"}}}}}if(this.options.indicateTurnoverDays){if(w){if(this.prevDayValid==0){if(f){f+=" depart"}else{f="depart"}}this.prevDayValid=1}else{if(this.prevDayValid==1){if(f){f+=" arrive"}else{f="arrive"}}this.prevDayValid=0}if(!a){this.prevDayValid=-1}}if(r==0){b.push("</tr><tr>")}if(!a){b.push('<td class="');b.push(f||"disabled");b.push('">');b.push(A||y);b.push("</td>")}else{if(this.options.singleSelect){var j=this.date;if(ta.retrieve("multiDP.v6")&&!ta.widgets.calendar.getPageOutDate()&&ta.widgets.calendar.getPageInDate()){j=ta.widgets.calendar.getPageInDate()}if(j&&j.getDate()==y&&j.getMonth()==u){f=f+" selected"}}var l=this.addCustomDayStyleString(o,s,F,y,p,A);if(l){f+=l}if(f){b.push('<td class="');b.push(f);b.push('">')}else{b.push("<td>")}b.push(this.buildDayAnchorTag(o,s,u,y,A));b.push("</td>")}}while(++r<7){b.push("<td class='other'>&nbsp;</td>")}b.push("</tr></tbody></table>");F.elmt=new Element("div",{"class":"month"}).set("html",b.join(""));return F},addCustomDayStyleString:function(d,b,g,a,f,c){},buildDayAnchorTag:function(g,c,f,b,d){var a=[];if(this.options.useLinks&&g){if(ta.has("checkrates.add_holding_windows")){a.push('<a href="javascript:void(0);" class="no_cpu" onclick="')}else{a.push('<a href="javascript:void(0);" onclick="')}a.push(g);a.push("(event,");a.push(c);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"');a.push(">");a.push(d);a.push("</a>")}else{a.push(d)}return a.join("")},isInvalidDate:function(a){return ta.util.date.inDateSet(a,this.options.invalidDates)},isValid:function(){if(!this.selectedDate){return true}return this.selectedDate.getTime()>=this.options.firstDate.getTime()&&this.selectedDate.getTime()<=this.options.lastDate.getTime()},prev:function(){if(this.animating){return}var o=this.options.dualCalendar;this.animating=true;var j=new Date(this.currentMonth.date);var h=j.getMonth()-1;if(h<0){h=h+12;j.setFullYear(j.getFullYear()-1)}var k=j.getDate();if(k>ta.util.date.DAYS_IN_MONTH[h]){k=ta.util.date.DAYS_IN_MONTH[h]}j.setMonth(h,k);var l=this.currentMonth.elmt.getCoordinates().width;var g=l+(o?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(j);if(!ta.util.i18n.isRtl()){b.elmt.style.left="-"+l+"px"}else{b.elmt.style.left=g+"px"}this.injectMonth(b.elmt,true);var f=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[-l,0]},"1":{left:[0,l+this.options.offsetOther]}};if(o){a["2"]={left:[l+this.options.offsetOther,l*2+this.options.offsetOther]}}}else{a={"0":{left:[0,-l]},"1":{left:[l+this.options.offsetOther,0]}};if(o){a["2"]={left:[l*2+this.options.offsetOther,l+this.options.offsetOther]}}}var c=new Fx.Elements(f,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.nextMonth||this.currentMonth),duration:this.options.monthChangeDuration});if(o){this.nextMonth=this.currentMonth}this.currentMonth=b;this.updatePrevNext();c.start(a)},next:function(){if(this.animating){return}var o=this.options.dualCalendar;this.animating=true;var j=new Date(this.currentMonth.date);var h=j.getMonth()+(o?2:1);if(h>11){h=h-12;j.setFullYear(j.getFullYear()+1)}var k=j.getDate();if(k>ta.util.date.DAYS_IN_MONTH[h]){k=ta.util.date.DAYS_IN_MONTH[h]}j.setMonth(h,k);var l=this.currentMonth.elmt.getCoordinates().width;var g=l+(o?this.nextMonth.elmt.getCoordinates().width:0);var b=this.createMonth(j);if(!ta.util.i18n.isRtl()){b.elmt.style.left=g+"px"}else{b.elmt.style.left="-"+l+"px"}this.injectMonth(b.elmt,false);var f=this.container.getElements("div.month");var a;if(!ta.util.i18n.isRtl()){a={"0":{left:[0,-l]},"1":{left:[l+this.options.offsetOther,0]}};if(o){a["2"]={left:[l*2+this.options.offsetOther,l+this.options.offsetOther]}}}else{a={"0":{left:[-l,0]},"1":{left:[0,l+this.options.offsetOther]}};if(o){a["2"]={left:[l+this.options.offsetOther,l*2+this.options.offsetOther]}}}var c=new Fx.Elements(f,{onComplete:this.doneAnimating.bind(this).partial(Function._,this.currentMonth),duration:this.options.monthChangeDuration});if(o){this.currentMonth=this.nextMonth;this.nextMonth=b}else{this.currentMonth=b}this.updatePrevNext();c.start(a)},removeTable:function(b,a){a.elmt.dispose()},doneAnimating:function(b,a){this.removeTable(b,a);this.animating=false},select:function(a,b){this.selectedDate=b;this.fireEvent("onSelect",[this,a])},clear:function(a){this.selectedDate=null;this.fireEvent("onClear",[this,a])},nearbyMonth:function(b,a){var c=b+a;if(c>11){c-=12}else{if(c<0){c+=12}}return c}});ta.widgets.MultiDateCalendar=new Class({Extends:ta.widgets.Calendar,Implements:[Options,Events],Binds:["onOutDateCalShow","updateDualDateInputStyling","showCalendarOverlay","setPositionElement","hashHack","getCalendarTopOffset","getCalendarLeftOffset","callOnSelect","setPageDates","getPageInDate","getPageOutDate"],options:{dualCalendar:true,dayMouseOver:"ta.widgets.calendar.calendarMouseOver",choiceLink:"ta.widgets.calendar.calendarMultiSelect",prevAction:"ta.widgets.calendar.calendarPrev",nextAction:"ta.widgets.calendar.calendarNext",selectedHoverClass:"rngDt",previousSelectedClass:"prevSel",inDateClass:"inDate",outDateClass:"outDate",selectionStartClass:false,selectionEndClass:false,captureKeyEvents:true,autoShow:false,displayCalendarInOverlay:true,formatter:ta.widgets.calendar.multiDateFormatter,monthChangeDuration:150,submitOnEnter:true,useClassicSkin:false,classicStyling:false},inDate:false,newInDate:false,oldInDate:false,startRangeElem:false,outDate:false,oneSelected:false,monthOffset:0,initialize:function(m,d,g,h){this.parent(m,this.input);this.crId=d;this.setPositionElement();this.onSelect=g.bind(this);this.argArray=h;if(this.options.displayCalendarInOverlay){var c=this.onCalendarOverlayShow.bind(this);var l=this.onCalendarOverlayHide.bind(this);var k=this.onCalendarOverlayShow.bind(this);var o=this.positionElement.getParent(".overlay");if(o){this.parentOverlay=o.overlay}var j=ta.overlays.ACTIVATE_CLICK;if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")&&!ta.retrieve("multiDP.v6")&&!ta.retrieve("multiDP.v7")){j=ta.overlays.ACTIVATE_NEVER}var b=this.getCalendarLeftOffset();var f=this.getCalendarTopOffset();var a="date_picker_calendar";if(this.options.useClassicSkin){a="typeO"}if(this.options.classicStyling){a=a+" classicStyling"}this.calendarOverlay=new ta.overlays.RelativeOverlayBelow({style:a,noPadding:true,autoShow:false,noCpu:true,offsetLeft:b,offsetTop:f,activate:j,onShow:c,onHide:l,onFocus:k,zIndex:202},this.positionElement);ta.id(this.positionElement).getParent().onclick=function(){};ta.id(this.positionElement).getParent().addEvent("click",this.showCalendarOverlay);ta.id(this.positionElement).getParent().addEvent("focus",this.showCalendarOverlay);if(this.outDateField){ta.id(this.outDateField).getParent().onclick=function(){};ta.id(this.outDateField).getParent().addEvent("click",this.onOutDateCalShow);ta.id(this.outDateField).getParent().addEvent("focus",this.onOutDateCalShow)}this.calendarOverlay.inner.adopt(this.container);this.calendarOverlay.calendar=this;if(this.positionElement&&(this.positionElement.hasClass("isPreDatesPermanent")||this.positionElement.getParent(".isPreDatesPermanent"))){this.calendarOverlay.options.permanent=true;this.calendarOverlay.options.pinnable=ta.overlays.PINNABLE_ALWAYS}this.calendarOverlay.container.addEvent("click",function(p){p.stopPropagation()});this.update();this.reposition()}},getCalendarLeftOffset:function(){var a=7;if(ta.util.i18n.isRtl()){a=263}if(ta.isMetaHomepageIntegration2013()){a=1;if(ta.util.i18n.isRtl()){a=189}}return a},getCalendarTopOffset:function(){return 0},setPositionElement:function(){this.inputElement=this.positionElement=ta.id("date_picker_"+this.crId+this.options.ext);if(!this.positionElement){this.inDateField=this.positionElement=ta.id("date_picker_in_"+this.crId+this.options.ext);this.outDateField=ta.id("date_picker_out_"+this.crId+this.options.ext);this.isDualDateFields=true}},initTracking:function(){if(!ta.remove("meta.datepicker_tracked")){var a=ta.id(this.positionElement).get("id");a=a.substring(a.length-3,a.length);if(ta.has("metaUI.openCalLnk")){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN",ta.retrieve("metaUI.openCalLnk"));ta.remove("metaUI.openCalLnk")}else{if(a=="inm"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES_INLINE")}else{if(a=="bin"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES_INLINE_FLEXIBLE")}else{if(a=="met"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES_LIGHTBOX")}else{if(a=="olb"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES_LIGHTBOX_FLEXIBLE")}else{if(a=="som"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES_State-Optimized-Modal_FLEXIBLE")}else{if(a=="cmp"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","footer")}else{if(a=="upt"){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","Interrupter")}else{ta.widgets.calendar.trackCalendarEvent("DATEPICKER","OPEN","DATES")}}}}}}}}}},onOutDateCalShow:function(a){ta.store("ta.calendar.isOutDateTrigger",true);this.calendarOverlay.show(a)},showCalendarOverlay:function(a){if(!this.calendarOverlay){return}if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){this.calendarOverlay.options.activate=ta.overlays.ACTIVATE_CLICK}this.calendarOverlay.show(a)},getPageInDate:function(){if(ta.has("hotels.wipeDatesTwoEnabled")&&!ta.widgets.calendar.getPageInDate()&&ta.retrieve("multiDP.inDateTimeout")){return ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout"))}return ta.widgets.calendar.getPageInDate()},getPageOutDate:function(){if(ta.has("hotels.wipeDatesTwoEnabled")&&!ta.widgets.calendar.getPageOutDate()&&ta.retrieve("multiDP.outDateTimeout")){return ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"))}return ta.widgets.calendar.getPageOutDate()},onCalendarOverlayShow:function(){this.inDate=this.getPageInDate();this.outDate=this.getPageOutDate();this.outDateTrigger=ta.remove("ta.calendar.isOutDateTrigger");this.updateDualDateInputStyling(!this.outDateTrigger,this.outDateTrigger);if(this.calendarOverlay){if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.update();this.reposition();this.clearSelectedDays();this.addPrevSelectedDays();this.monthOffset=0;this.oneSelected=false;this.newInDate=false;this.hoverDay=false;this.resetInDate();var b=ta.id(this.positionElement).getParent();if(!this.isDualDateFields){this.nightsElem=b.getElement(".date_picker_calendar_nights");this.nightsSingleText=b.getElement(".date_picker_nights_single").innerHTML;ta.store("date.picker.singleNightText",this.nightsSingleText);this.nightsMultiText=b.getElement(".date_picker_nights_multi").innerHTML;ta.store("date.picker.multiNightText",this.nightsMultiText)}if(ta.id(this.positionElement).getParent("#PERSISTENT_CHECK_RATES")){var a=ta.id(this.positionElement).getCoordinates().top;if(typeof(isIPad)=="undefined"||!isIPad){a=a-window.getScrollTop()}ta.id(this.calendarOverlay.container).setStyles({position:"fixed",top:a+29,zindex:9997})}if(this.options.captureKeyEvents){try{this.keyEventListener=this.onCalendarOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener)}catch(c){}}}ta.id(this.positionElement).removeClass("date_picker_error");this.positionElement.blur();this.initTracking();if(this.isDualDateFields&&!this.addedClickListeners){this.addedClickListeners=true;this.inDateField.addEvent("click",this.updateSelectedInput.bind(this,true));this.outDateField.addEvent("click",this.updateSelectedInput.bind(this,false))}if(ta.id(this.positionElement)&&ta.id(this.positionElement).getParent("#PERSISTENT_CHECK_RATES_WRAP")){this.pcrClickFunc=this.calendarOverlay.hide.bind(this.calendarOverlay);var d=this;(function(){document.addEvent("click",d.pcrClickFunc)}).delay(10)}},onCalendarOverlayHide:function(a){ta.remove("ta.calendar.isOutDateTrigger");ta.widgets.calendar.syncAllDatePickers();this.updateDualDateInputStyling(false,false);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.options.captureKeyEvents&&this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){this.calendarOverlay.options.activate=ta.overlays.ACTIVATE_NEVER}if(this.pcrClickFunc){document.removeEvent("click",this.pcrClickFunc)}if(ta.retrieve("open_calendar_on_hover_enable")&&!ta.retrieve("open_calendar_on_hover.isMouseInValidArea")){ta.store("open_calendar_on_hover.isCalendarClickOut",true)}},onCalendarOverlayKeyDown:function(a){if(this.options.submitOnEnter&&"enter"===a.key&&ta.isMetaHomepageIntegration2013()){var c=this.positionElement.getParent("form "),b="function"!==typeof this.options.submitOnEnter||this.options.submitOnEnter(a,c);b&&c&&c.submit()}if(a.key=="esc"||ta.isMetaHomepageIntegration2013()&&(a.key=="esc"||a.key=="tab")){this.calendarOverlay.hide()}},resetInDate:function(){if(this.calendarOverlay){var a=ta.id(this.calendarOverlay.container).getElement("."+this.options.inDateClass);if(a){a.removeClass(this.options.inDateClass)}}},setPermanent:function(b){if(this.calendarOverlay){this.calendarOverlay.options.permanent=b;this.calendarOverlay.options.pinnable=(b?ta.overlays.PINNABLE_ALWAYS:ta.overlays.PINNABLE_NEVER);var a=this.positionElement;if(this.positionElement&&!this.positionElement.hasClass("isPreDatesPermanent")){a=this.positionElement.getParent(".isPreDatesPermanent")}if(a){a.removeClass("isPreDatesPermanent")}}},resetStartRangeElem:function(f){if(!this.oneSelected){return}this.startRangeElem=false;this.clearSelectedDays();if(ta.util.i18n.isRtl()){f=!f}f?this.monthOffset++:this.monthOffset--;var b=this.calendarOverlay.container.getElements(".month");if(f){b.shift()}else{b.pop()}b.some(function(h,g){if(h){var j=ta.id(h).getElement("."+this.options.inDateClass);if(j){this.startRangeElem=j;return true}}return false},this);if(!this.startRangeElem){var a=false;if(this.monthOffset>0){var d=0;a=ta.id(b[d]).getElements("td");if(ta.util.i18n.isRtl()){a.reverse()}}else{var c=b.length-1;a=ta.id(b[c]).getElements("td");if(!ta.util.i18n.isRtl()){a.reverse()}}if(a){a.some(function(h,g){if(this.isValidDateElem(h)){this.startRangeElem=h;return true}return false},this)}}},prev:function(){this.parent();this.resetStartRangeElem(false)},next:function(){this.parent();this.resetStartRangeElem(true)},updatePrevNext:function(){var d=this.currentMonth.date;var c=this.options.dualCalendar?this.nextMonth.date:this.currentMonth.date;var h=ta.util.date.inSameMonth(d,this.options.firstDate);var g=ta.util.date.inSameMonth(c,this.options.lastDate);var b=ta.id(getChildByClass(this.container,"prev"));var a=ta.id(getChildByClass(this.container,"next"));if(ta.util.i18n.isRtl()){b=ta.id(getChildByClass(this.container,"next"));a=ta.id(getChildByClass(this.container,"prev"));h=ta.util.date.inSameMonth(c,this.options.lastDate);g=ta.util.date.inSameMonth(d,this.options.firstDate)}var f=this.selectLeftRightButtons();if(h){b.addClass(f.leftInactive).removeClass(f.leftIdle).setStyle("cursor","default")}else{b.addClass(f.leftIdle).removeClass(f.leftInactive).setStyle("cursor","pointer")}if(g){a.addClass(f.rightInactive).removeClass(f.rightIdle).setStyle("cursor","default")}else{a.addClass(f.rightIdle).removeClass(f.rightInactive).setStyle("cursor","pointer")}},selectLeftRightButtons:function(){var a={};if(this.options.useClassicSkin){a.leftIdle="classicLeftBtn";a.leftInactive="";a.rightIdle="classicRightBtn";a.rightInactive=""}else{a.leftIdle="sprite-date_picker-btnLeftIdle";a.leftInactive="sprite-date_picker-btnLeftInactive";a.rightIdle="sprite-date_picker-btnRightIdle";a.rightInactive="sprite-date_picker-btnRightInactive"}return a},createPagingElement:function(a,b,c){return'<span class="'+a+'" onclick="'+b+'(event, this);"></span>'},buildDayAnchorTag:function(g,c,f,b,d){var a=[];if(this.options.useLinks&&g){if(ta.has("checkrates.add_holding_windows")){a.push('<a href="javascript:void(0);" class="no_cpu" onclick="')}else{a.push('<a href="javascript:void(0);" onclick="')}a.push(g);a.push("(event,");a.push(c);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"');if(this.options.dayMouseOver){a.push(' onmouseover="');a.push(this.options.dayMouseOver);a.push("(event,");a.push(c);a.push(",");a.push(f);a.push(",");a.push(b);a.push(',this)"')}a.push(">");a.push(d);a.push("</a>")}else{a.push(d)}return a.join("")},dayOver:function(c,f,b){ta.util.date.normalize(f);if(this.newInDate){var a=f.getTime()<this.newInDate.getTime();this.updateDualDateInputStyling(a,!a)}if(!this.oneSelected){this.updateHoverElem(b);return}this.hoverDay=f;this.updateSelectedDays(f,b);ta.widgets.calendar.updateDateDisplay(this.positionElement,this.newInDate,this.hoverDay)},updateHoverElem:function(a){if(!this.calendarOverlay){return}var b=this.calendarOverlay.container.getElement(".msdp_hover");if(b){b.removeClass("msdp_hover")}if(a&&a.getParent()){a.getParent().addClass("msdp_hover")}},updateSelectedDays:function(c,b){this.clearSelectedDays();var a=this.startRangeElem;this.includeElemInRange(a,this.options.selectedHoverClass);if(c.getTime()>this.newInDate.getTime()){this.updateSelectedDaysHelper(a,b.parentNode,true,this.options.selectedHoverClass);this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionStartClass);this.options.selectionEndClass&&ta.id(b.parentNode).addClass(this.options.selectionEndClass)}else{this.updateSelectedDaysHelper(a,b.parentNode,false,this.options.selectedHoverClass);this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionEndClass);this.options.selectionEndClass&&ta.id(b.parentNode).addClass(this.options.selectionStartClass)}},clearSelectedDays:function(){if(!this.calendarTop){this.calendarTop=this.calendarOverlay.container.getElement(".calendar")}var a=this.calendarTop.getElements("td."+this.options.selectedHoverClass);a.removeClass(this.options.selectedHoverClass);this.options.selectionStartClass&&a.removeClass(this.options.selectionStartClass);this.options.selectionEndClass&&a.removeClass(this.options.selectionEndClass)},addPrevSelectedDays:function(){if(this.inDate&&this.outDate){var a=this.getElemForDate(this.inDate);var b=this.getElemForDate(this.outDate);this.includeElemInRange(a,this.options.previousSelectedClass);this.options.selectionStartClass&&ta.id(a).addClass(this.options.selectionStartClass);this.options.selectionEndClass&&ta.id(b).addClass(this.options.selectionEndClass);this.updateSelectedDaysHelper(a,b,true,this.options.previousSelectedClass)}},getElemForDate:function(d){var c=false;var b=d.getFullYear()+","+d.getMonth()+","+d.getDate();var a=this.calendarOverlay.container.getElements(".month");a.some(function(g,f){var h=ta.id(g).getElements("td");if(h){h.some(function(k,l){var j=k.firstChild;if(j&&j.getAttribute&&j.getAttribute("onmouseover")&&j.getAttribute("onmouseover").toString().search(b)>0){c=k;return true}return false},this)}if(c){return true}return false},this);return c},clear:function(a){this.inDate=null;this.outDate=null;ta.widgets.calendar.clearPageDates();if(this.isDualDateFields){this.inDateField.innerHTML=ta.retrieve("multiDP.enterDatesText");this.outDateField.innerHTML=ta.retrieve("multiDP.enterDatesText")}else{this.positionElement.innerHTML=ta.retrieve("multiDP.enterDatesText")}this.fireEvent("onClear",[this,a]);if(this.calendarOverlay){this.calendarOverlay.hide()}},clearPrevSelectedDays:function(){if(!this.calendarTop){this.calendarTop=this.calendarOverlay.container.getElement(".calendar")}var a=this.calendarTop.getElements("td."+this.options.previousSelectedClass);a.removeClass(this.options.previousSelectedClass);this.options.selectionStartClass&&a.removeClass(this.options.selectionStartClass);this.options.selectionEndClass&&a.removeClass(this.options.selectionEndClass)},updateSelectedDaysHelper:function(f,l,h,j){if(!f||f==l){return}var g="nextSibling";var m="firstChild";if(!h){g="previousSibling";m="lastChild"}var d=false;if(this.isValidDateElem(f[g])){d=f[g]}else{var a=f.parentNode;if(a&&a[g]){d=a[g][m]}else{if(a&&ta.id(a).getParent(".month")){var c=ta.id(a).getParent(".month");if(ta.util.i18n.isRtl()){g=(g=="previousSibling")?"nextSibling":"previousSibling"}var k=c[g];if(!k){return}var b=ta.id(k).getElements("td");if(!h){b.reverse()}b.some(function(p,o){if(this.isValidDateElem(p)){d=p;return true}return false},this)}}}this.includeElemInRange(d,j);this.updateSelectedDaysHelper(d,l,h,j)},includeElemInRange:function(b,a){b.className=b.className+" "+a},isValidDateElem:function(b){if(!b||b.tagName!="TD"){return false}var a=b.className;if(a.match(/other/)||a.match(/disabled/)){return false}return true},isOutDateSelection:function(a){try{if(this.isDualDateFields&&this.outDateTrigger&&ta.widgets.calendar.hasPageDates()&&this.inDate.getTime()-a.getTime()<0){this.newInDate=this.inDate;return true}}catch(b){}return this.oneSelected},updateDualDateInputStyling:function(b,a){if(this.inDateField&&this.outDateField&&this.inDateField.getParent()&&this.outDateField.getParent()){b?this.inDateField.getParent().addClass("dualFieldOn"):this.inDateField.getParent().removeClass("dualFieldOn");a?this.outDateField.getParent().addClass("dualFieldOn"):this.outDateField.getParent().removeClass("dualFieldOn")}},updateSelectedInput:function(a){this.updateDualDateInputStyling(a,!a);this.outDateTrigger=!a},dateRangeToDays:function(h,c){var g=1000;var f=60;var b=60;var d=24;var a=(c-h)/g/f/b/d;return a},trackSelect:function(f){var b=ta.id(this.positionElement).get("id");b=b.substring(b.length-3,b.length);var c="START";var a="DATES";if(b=="upt"){a="Interrupter"}if(f){c="SELECT";if(ta.retrieve("ta.calendar.isPriceOverlayCalendar")){a="PRICE_CALENDAR"}else{if(this.inDate&&this.outDate){var d=ta.widgets.MultiDateCalendar.dateRangeToDays(this.inDate,this.outDate);if(d>=30){a="DATES_OVER_30_DAYS"}}}}if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")&&ta.retrieve("meta.prof_photo_lb.post_date_close.overlay")){a="CalendarLightbox"}ta.widgets.calendar.trackCalendarEvent("DATEPICKER",c,a)},multiSelect:function(b,c,a){ta.util.date.normalize(c);if(this.isOutDateSelection(c)){this.outDateTrigger=false;if(!c||!c.getTime){return}if(c.getTime()==this.newInDate.getTime()){return}if(c.getTime()<this.newInDate.getTime()){this.inDate=c;this.outDate=this.newInDate}else{this.inDate=this.newInDate;this.outDate=c}this.setPageDates(this.inDate,this.outDate);this.newInDate=false;this.oneSelected=false;this.hoverDay=false;if(this.calendarOverlay){this.calendarOverlay.hide()}this.callOnSelect();this.trackSelect(true);this.hashHack();this.removeErrorState();this.fireEvent("onRangeSelect",[this,b]);document.fireEvent("datesChanged")}else{this.selectStartDate(c,a)}this.fireEvent("onSelect",[this,b])},setPageDates:function(b,a){ta.store("multiDP.priorDates",ta.widgets.calendar.hasPageDates());if(b){ta.widgets.calendar.setPageInDate(b)}if(a){ta.widgets.calendar.setPageOutDate(a)}},callOnSelect:function(){if(this.onSelect){this.fireEvent("onChangeDates");if(this.argArray&&this.argArray.length>0){this.onSelect.apply(this,this.argArray)}else{this.onSelect.call(this,this.crId,this.positionElement)}}},removeErrorState:function(){if(ta.id("NO_DATES_ERROR")){ta.id("NO_DATES_ERROR").hide()}if(ta.id("calPnt")){ta.id("calPnt").removeClass("errorState")}var a=ta.find("#CHECK_RATES_CONT .date_picker_calendar_wrap");if(a){a.removeClass("errorState")}},hashHack:function(){var a=ta.id(this.positionElement).get("id");if(a){a=a.substring(a.length-3,a.length);if(a=="olb"||a=="bin"||a=="som"){window.location.hash=" ";window.location.hash="#MetaPricesTab"}}},selectStartDate:function(b,a){this.clearPrevSelectedDays();this.newInDate=b;this.startRangeElem=a.parentNode;this.oneSelected=true;this.updateHoverElem();ta.id(this.startRangeElem).addClass(this.options.inDateClass);ta.widgets.calendar.updateDateDisplay(this.positionElement,this.newInDate,false);if(!this.isDualDateFields){ta.widgets.calendar.updateNightsDisplay(this.nightsElem,this.newInDate,false)}else{this.updateDualDateInputStyling(false,true);this.options.selectionStartClass&&ta.id(this.startRangeElem).addClass(this.options.selectionStartClass)}this.trackSelect(false)},getFirstDate:function(){return this.inDate||this.today},getState:function(){var a={inMonth:(this.inDate.getMonth()+1)+" "+this.inDate.getFullYear(),inDay:this.inDate.getDate(),outMonth:(this.outDate.getMonth()+1)+" "+this.outDate.getFullYear(),outDay:this.outDate.getDate()};return a}});ta.widgets.MultiDateCalendarInline=new Class({Extends:ta.widgets.MultiDateCalendar,initialize:function(b,d,c,f){if(f.getElement(".calendar")){return}var a=f.getParent(".overlay");if(a&&a.overlay){a.addClass("date_picker_calendar");a.overlay.calendar=this}b.displayCalendarInOverlay=false;this.parent(b,d,c);this.calendarTop=f;this.update();f.grab(this.container)}});ta.widgets.SingleDateCalendar=new Class({Extends:ta.widgets.MultiDateCalendar,Implements:[Options,Events],Binds:["onOutDateCalShow","updateInputStyling"],options:{singleSelect:true,pickerOption:"in",autoAdvance:true},initialize:function(b,d,c,a,f){this.isIn=f;this.parent(b,d,c,a);var g=this.onDocumentClick.bind(this);document.addEvent("click",g)},setPositionElement:function(){var a="date_picker_in_";if(!this.isIn){a="date_picker_out_"}this.positionElement=ta.id(a+this.crId+this.options.ext)},updateInputStyling:function(a){a?this.positionElement.getParent().addClass("dualFieldOn"):this.positionElement.getParent().removeClass("dualFieldOn")},addCustomDayStyleString:function(j,h,f,k,d,b){var l="";if(ta.retrieve("multiDP.v7")){var a=this.getPageInDate();var g=this.getPageOutDate();var c="";if(a&&g){c=" inDate_DP7 prevSel";if(d.getTime()>a.getTime()&&d.getTime()<g.getTime()){l=l+" prevSel"}}if(this.getPageInDate()&&f.date.getMonth()==this.getPageInDate().getMonth()&&k==this.getPageInDate().getDate()){l=l+" inDate start"+c}if(this.getPageOutDate()&&f.date.getMonth()==this.getPageOutDate().getMonth()&&k==this.getPageOutDate().getDate()){l=l+" inDate end"+c}}return l},onDocumentClick:function(a){this.closedByDocOrDateClick=true;this.closedByDoc=true},getCalendarLeftOffset:function(){var a=1;if(ta.util.i18n.isRtl()){a=127}if(ta.isMetaHomepageIntegration2013()){a=2;if(ta.util.i18n.isRtl()){a=121}}if(ta.retrieve("ta.calendar.isOutDateTrigger")&&ta.retrieve("ta.calendar.isPriceOverlayCalendar")){a=138}return a},getCalendarTopOffset:function(){if(ta.isMetaHomepageIntegration2013()){return -1}return -4},onCalendarOverlayShow:function(){this.bypassSecondCal=false;this.date=this.isIn?this.getPageInDate():this.getPageOutDate();if(!this.date&&ta.has("hotels.wipeDatesTwoEnabled")&&ta.retrieve("multiDP.inDateTimeout")){this.date=this.isIn?ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.inDateTimeout")):ta.widgets.calendar._parseDatePickerDate(ta.retrieve("multiDP.outDateTimeout"))}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.update();this.reposition();this.closedByDocOrDateClick=false;this.closedByDoc=false;var b=ta.id(this.positionElement).getParent();if(ta.id(this.positionElement).getParent("#PERSISTENT_CHECK_RATES")){var a=ta.id(this.positionElement).getCoordinates().top;if(typeof(isIPad)=="undefined"||!isIPad){a=a-window.getScrollTop()}ta.id(this.calendarOverlay.container).setStyles({position:"fixed",top:a+29,zindex:9997})}if(this.options.captureKeyEvents){try{this.keyEventListener=this.onCalendarOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener)}catch(c){}}ta.id(this.positionElement).removeClass("date_picker_error");this.positionElement.blur();this.initTracking();this.updateInputStyling(true)},onCalendarOverlayHide:function(b){if(this.isSecondCalShown()){this.ensureValidDates()}ta.widgets.calendar.syncAllDatePickers();if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.options.captureKeyEvents&&this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}this.updateInputStyling(false);var f=this.getPageInDate();var d=this.getPageOutDate();var c=f&&f.getDate&&d&&d.getDate;var a=false;if((this.shouldFireOnSelect()||this.bypassSecondCal)&&c){this.fireEvent("onChangeDates");this.callOnSelect();this.trackSelect(true);if(ta.retrieve("ta.calendar.isPriceOverlayCalendar")){a=true}}else{if(!this.closedByDoc){this.trackSelect(false)}}if(this.isSecondCalShown()&&this.closedByDocOrDateClick&&this.resetFireOnSelectCriteria){this.resetFireOnSelectCriteria()}if(ta.retrieve("open_calendar_on_hover_enable")&&!ta.retrieve("open_calendar_on_hover.isMouseInValidArea")){ta.store("open_calendar_on_hover.isCalendarClickOut",true)}if(a){this.parentOverlay.hide()}},getFirstDate:function(){var b=this.getPageInDate();var a=this.getPageOutDate();if(this.isSecondCalShown()){if(!this.isIn&&b){return b}else{if(this.isIn&&a){return a}}}else{if((this.isIn||ta.retrieve("multiDP.v6"))&&b){return b}else{if(!this.isIn&&a){return a}}}return this.today},prev:function(){this.parent();this.resetStartRangeElem(false)},next:function(){this.parent();this.resetStartRangeElem(true)},dayOver:function(b,c,a){ta.util.date.normalize(c);if(!this.oneSelected){this.updateHoverElem(a);return}this.hoverDay=c;this.updateSelectedDays(c,a)},updateHoverElem:function(b){if(!this.calendarOverlay){return}var a="msdp_hover_underline";if(ta.retrieve("multiDP.v7")){a="msdp_hover"}var c=this.calendarOverlay.container.getElement("."+a);if(c){c.removeClass(a)}if(b&&b.getParent()){b.getParent().addClass(a)}},clear:function(b){this.date=null;ta.widgets.calendar.clearPageDates();var a="";if(this.isIn){if(this.options.classicDateFormat&&typeof JS_DateFormat!="undefined"){a=JS_DateFormat}else{a=ta.retrieve("multiDP.checkIn")}}else{if(this.options.classicDateFormat&&typeof JS_DateFormat!="undefined"){a=JS_DateFormat}else{a=ta.retrieve("multiDP.checkOut")}}this.positionElement.innerHTML=a;this.fireEvent("onClear",[this,b]);if(this.calendarOverlay){this.calendarOverlay.hide()}},multiSelect:function(h,j,c){new Event(h).stop();ta.util.date.normalize(j);if(!j||!j.getTime){return}this.date=j;var f=null;var b=null;f=this.getPageInDate();b=this.getPageOutDate();var g=true;this.closedByDocOrDateClick=true;var a=false;if(this.isIn&&b&&j.getTime()>=b.getTime()){f=this.date;b=false;a=true;ta.widgets.calendar.clearPageOutDate(this.locId,this.options.ext)}else{if(!this.isIn&&f&&j.getTime()<(new Date()).getTime()){f=new Date();b=ta.widgets.calendar.getDateAfter(f)}else{if(!this.isIn&&f&&j.getTime()<=f.getTime()){b=this.date;f=false;a=true;ta.widgets.calendar.clearPageInDate(this.locId,this.options.ext)}else{if(this.isIn){f=j}else{if(!this.isIn){b=j;if(f){this.bypassSecondCal=true}}}}}}this.setPageDates(f,b);this.hoverDay=false;if(!this.bypassSecondCal&&ta.retrieve("multiDP.v5")&&((!this.getPageOutDate()||!this.getPageInDate())&&!a)){this.bypassSecondCal=true}if(!this.isSecondCalShown()&&!this.bypassSecondCal){ta.widgets.calendar.trackInOutCalendarSelected(this.isIn);this.focusOtherCalendar()}else{this.hashHack()}if(this.calendarOverlay){this.calendarOverlay.hide()}this.removeErrorState();if(this.getPageInDate()&&this.getPageOutDate()){this.fireEvent("onRangeSelect",[this,h])}document.fireEvent("datesChanged");this.fireEvent("onSelect",[this,h])},focusOtherCalendar:function(){var a;if(this.isIn){a=ta.widgets.calendar.getPageOutCalendarField(this.crId,this.options.ext)}else{a=ta.widgets.calendar.getPageInCalendarField(this.crId,this.options.ext)}if(a){if(a.click){a.click()}else{if(document.createEvent&&a.dispatchEvent){var b=document.createEvent("MouseEvent");b.initEvent("click",true,true);a.dispatchEvent(b)}}}},shouldFireOnSelect:function(){if(!this.onSelect){return false}return this.isSecondCalShown()&&this.calendarOverlay&&this.calendarOverlay.closedByDocClick},isSecondCalShown:function(){if(!this.options.autoAdvance){return true}var a=ta.widgets.calendar.inOutCalendarSelected(!this.isIn);return a},resetFireOnSelectCriteria:function(){ta.widgets.calendar.removeInOutCalendarSelected(this.isIn);ta.widgets.calendar.removeInOutCalendarSelected(!this.isIn)},ensureValidDates:function(){var b=this.getPageInDate();var a=this.getPageOutDate();if(a&&!b){b=ta.widgets.calendar.getDateBefore(a)}if(b&&!a){a=ta.widgets.calendar.getDateAfter(b)}ta.widgets.calendar.setPageInDate(b);ta.widgets.calendar.setPageOutDate(a)}});ta.widgets.tabContainer=function(d,j){var a=d.getElements(".current");if(a.length!=1){throw new Error("You must have exactly one tab with a class of 'current'.")}else{a=a[0]}var g=a.className.match(/tab(\d+)/);if(g!=null&&g.length>=2){var b=Number(g[1])}else{return}if($("HOMEPAGE")&&window.location.hash){var h=window.location.hash.match(/t(\d)/);if(h&&h.length>0){b=parseInt(h[1]);a.removeClass("current");d.getElements(".tab")[b].addClass("current")}}var c=d.getElements(".tabContainerHead .tab");if(c.length==0){return}var f=d.getElements(".tabContainerBody .tabContent");return new TabSet(c,f,{show:b,onActive:function(o,p,l){var q=p.hasClass("xhr");if(q&&!p.hasClass("xhrComplete")){var k=p.getElement("a").href;if(k){var m=p;l.addEvent("onContentReplaced",function(){m.addClass("xhrComplete")});ta.util.element.replaceContent(o,l,k)}}if(p.hasClass("recordAction")){new Request({url:"/ActionRecord?action="+p.id}).send()}p.addClass("current");if(q&&o){o.stop()}},onBackground:function(l,m,k){m.removeClass("current")}})};ta.widgets.Carousel=new Class({Implements:Options,Binds:["shiftLeft","shiftRight"],options:{width:50,height:50,padding:5,num:7,offset:0,horizontal:true},initialize:function(a,b){this.setOptions(b);this.container=a;this.viewport=this.container.getElement(".viewport");this.leftKnob=this.container.getElement(".shiftLeft");this.rightKnob=this.container.getElement(".shiftRight");this.images=this.viewport.getElements("img");this.offset=this.options.offset;if(this.options.horizontal){this.viewport.setStyles({width:this.options.width*this.options.num+this.options.padding*(this.options.num-1),height:this.options.height})}else{this.viewport.setStyles({width:this.options.width+this.options.padding*2,height:this.options.height*this.options.num+this.options.padding*(this.options.num-1)})}this.leftKnob.addEvent("click",this.shiftLeft);this.rightKnob.addEvent("click",this.shiftRight);this.render()},render:function(){var a=this.offset+this.options.num;for(var b=this.images.length-1;b>=0;b--){if(b<this.offset||b>=a){this.images[b].setStyle("left",-999)}else{if(this.options.horizontal){this.images[b].setStyle("left",(this.options.width+this.options.padding)*(b-this.offset))}else{this.images[b].setStyles({top:(this.options.height+this.options.padding)*(b-this.offset),left:0})}}}if(this.offset==0){this.leftKnob.addClass("disabled")}else{this.leftKnob.removeClass("disabled")}if(this.offset==this.images.length-this.options.num){this.rightKnob.addClass("disabled")}else{this.rightKnob.removeClass("disabled")}},shiftLeft:function(){var a=this.offset;this.offset=Math.max(0,this.offset-this.options.num);if(this.offset!=a){this.render()}},shiftRight:function(){var a=this.offset;this.offset=Math.min(this.offset+this.options.num,this.images.length-this.options.num);if(this.offset!=a){this.render()}}});(function(b){b.util.action={record:function a(k,h,f){var g=null;if(b.util.Deferred){g=new b.util.Deferred()}var j=Object.merge({url:"/ActionRecord",data:{action:k},onSuccess:function(l){if(g){g.resolve(l)}},onFailure:function(l){if(g){g.reject(l)}}},h);f&&(j.trackEvent=f);new Request(j).get();if(g){return g.promise()}},recordPlus:function c(k,h,f){var g=null;if(b.util.Deferred){g=new b.util.Deferred()}var j=Object.merge({url:"/ActionRecordPlus",data:{action:k},onSuccess:function(l){if(g){g.resolve(l)}},onFailure:function(l){if(g){g.reject(l)}}},h);f&&(j.trackEvent=f);new Request(j).get();if(g){return g.promise()}},recordPid:function d(f){new Request({url:"/ActionRecord?pid="+f}).send()}}}(ta));(function(){var g=[];var a=3000;function b(m,p){var h=g.length;g.push({name:m,properties:[]});for(var o in p){var j=true;if(h>0){for(var l=0;j&&l<h;l++){if(g[l].properties.indexOf(o)!=-1){j=false}}}if(j){g[h].properties.push(o)}}}b("node",document.createTextNode(""));b("Element",Element.prototype);g[1].properties.push("uid");b("element",document.createElement("div"));b("input",document.createElement("input"));g[3].properties.push("autocomplete");var f={element:"E",number:"N","function":"F",string:"S","boolean":"B",object:"O",collection:"C",whitespace:"W"};function d(j){var h=typeOf(j);return null==j?"_":(f[h]?f[h]:(h=="null"?"!":h))}ta.util.error={types:g,override:false,record:function(z,j,u,w,q){if(ta.has("ta.error.record.inFlight")){return}ta.store("ta.error.record.inFlight",true);var s=false;try{s=document.getElement("body").hasClass("js_logging")}catch(C){}if(!s){return}var p={};var D=false;try{if(u||window.event){u=new Event(u||window.event);D=ta.id(u.target);p.eTarg=this.getSelectorString(D)}}catch(t){}if(typeof(debugCacheKey)!="undefined"){p.key=debugCacheKey}var h=window.pageServlet;if(!h){h="unknown"}p.servlet=h;if(!q||typeof q!="string"){q="ERROR"}p.eLogLevel=q;var F={extraInfoError:"Problem storing extra info"};var E="";var o={};try{var l="";try{l=window.navigator.userAgent}catch(v){}var m="";var k="";if(D){m=D.id;k=D.className}var y=false;try{y=doCookieCheck()}catch(C){}var A="";if(typeof serverPool!="undefined"&&serverPool){A=serverPool}o={TARGET_ID:m,TARGET_CLASS:k,USER_AGENT:l,EXTERNAL_JS:ta.util.error.getScriptSrcs(),CLIENT_POOL:A,COOKIES_ENABLED:y}}catch(B){w=F}p.xInfo=ta.util.error._getExtraInfoString(o,w);try{p.eUrl=window.location.href}catch(t){}var r="No Error";try{if(z){r=z.name+"-"+z.message;r=r.replace(/[\r\n]/g,"")}}catch(t){}p.eMsg=r;try{p.eBlk=ta.util.error.getErrorBlock(j).substring(0,70)}catch(t){}try{if(ta.widgets&&ta.widgets.calendar){p.eDates=ta.widgets.calendar.getErrorDates()}}catch(t){}try{if(ta.has("abMarkerSet")){p.xABSet=ta.retrieve("abMarkerSet")+""}}catch(t){}try{new Request({url:"/JSErrorRecord",data:p}).send()}catch(C){p={eBlk:"JSErrorRecord Error",servlet:h,eLogLevel:"ERROR",eMsg:"no error retrieved"};new Request({url:"/JSErrorRecord",data:p}).send()}if(IS_DEBUG){(window.ERRORS||(window.ERRORS=[])).push(p)}if(ta.util.error.override){if(ta.util.error.override.match(/alert/)){ta.util.error.alert(p)}if(ta.util.error.override.match(/console/)&&console){ta.util.error.console(p)}}ta.remove("ta.error.record.inFlight")},_getExtraInfoString:function(s,h){var o="_extraInfoError_:Problem storing extra info.";var q={};var t="";try{var r=typeOf(h);var k={};if(r==="array"||r==="arguments"){for(var m=0;m<h.length;m++){var j=h[m];var p=typeof j;if(p==="string"||p==="number"||p==="boolean"){k[m]=j}else{k[m]=typeof j}}h=k}q=Object.merge(s,h);t=JSON.encode(q);if(t){if(t.length>a){t=t.substring(0,a)}return t.replace(/[\r\n]/g,"")}}catch(l){}try{q=s;t=JSON.encode(q);if(t){if(t.length>a){t=t.substring(0,a)}return t.replace(/[\r\n]/g,"")}}catch(l){}return o},getErrorBlock:function(h){if(typeof h!="undefined"&&h!==null){return h.toString().replace(/[\r\n]/g,"")}return"null or undefined"},getErrorStack:function(p){var m=p.stack;if(m){var q=m.split("\n");q=q.map(function(u){var t=u.lastIndexOf("/");if(t>0){u=u.substr(t+1)}return u});return q.join()}else{if(arguments&&arguments.callee){var r=[];var j=arguments.callee.caller;j=j.caller;var o=0;while(j&&o++<100){var k=j.toString();var h=k.length;var l=h>75?75:h;var s=k.substring(0,l);s=s.replace(/[\s\'\"]/g,"");s+="::";r.push(s);j=j.caller}return r.join(" ")}}return"none"},getSelectorString:function(j){if(!j){return""}var h=[j];while(typeof j!="undefined"&&j&&typeof j.parentNode!="undefined"){h.push(j=j.parentNode)}h=h.map(function(l){if(l&&l.tagName){var k=l.tagName;if(l.id){k+="#"+l.id}if(l.className){k+="."+l.className}return k}return""});h=h.reverse().join(">");h=h.replace(/\s+/g,".");return h},ajaxFailure:function(k,j,h){ta.util.error.record(null,k,null,Object.merge({status:j.status},h))},alert:function(h){var j="";Object.each(h,function(m,l){j=j+l+": "+m+"\n"});window.alert(j)},console:function(h){if(console){console.error(h)}},getScriptSrcs:function(){var h="";Array.each(document.getElementsByTagName("script"),function(l,j){if(l&&l.src){var k="";if(h!=""){k=","}h=h+k+l.src}});if(h.length>a){h=h.substring(0,a)}return h},describe:function(j){if(null==j){return"_N"}var l=d(j),k=[],o,q;for(var m in j){o=false;for(var h=0;!o&&h<g.length;h++){if(g[h].properties.indexOf(m)!=-1){o=true;if(k.indexOf(g[h].name)==-1){k.push(g[h].name)}}}if(!o){l+=","+m+":"+d(j[m])}}if(k.length>0){l+=","+k.join(",")}return l}};var c=Cookie.read("JS_ERROR_HANDLING");if(c){ta.util.error.override=c}})();ta.util.partials={requestTimeout:1000,maxDataRequests:12,dataRequestCount:0,incompleteDataRegex:/<\!-- incomplete\: ([\w, ]*) -->/,failedDataRegex:/<\!-- failed\: ([\w, ]*) -->/,partialsErrorRegex:/<\!-- error -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,requestPartials:function(h,d,g,k){if(ta.util.partials.dataRequestCount>ta.util.partials.maxDataRequests||h.length==0){ta.util.partials.recordGAEvent();return}ta.util.partials.dataRequestCount++;var f=h;var b=g;var c=k;if(ta.has("fb.partial.extraJS")){ta.retrieve("fb.partial.extraJS").each(function(l){new Asset.javascript(l)})}if(ta.has("fb.partial.extraCSS")){ta.retrieve("fb.partial.extraCSS").each(function(l){new Asset.css(l)})}var a=ta.remove("facebook.authcode.param");var j=Object.merge({parts:h.join(","),requestUrl:ta.retrieve("page.urlSafe")},d);if(a!=null){j=Object.merge(j,{FBAuthCode:a})}new Request({url:"/MultiPartAjax",method:"post",data:j,keepScripts:true,onRequest:function(){Cookie.dispose("FacebookAuthCode")},onSuccess:function(l){ta.util.partials.dataAvailable(d,f,b,c,null,null,l)}}).send()},handlePartialPaging:function(j,f,g){var h=g||{};ta.util.partials.dataRequestCount=0;if(!f||f.href==null){ta.util.error.record(null,"handlePartialPaging elmt.href null:"+f,null,null);return false}/parts=([\w,]+)/.test(f.href);var d=RegExp.$1.split(",");ta.store("partial.event.element",f);ta.store("partial.event.params",g);var c=ta.remove("facebook.authcode.param");var a=Object.merge({requestUrl:ta.retrieve("page.urlSafe")},h);var b=Object.clone(a);if(c!=null){a=Object.merge(a,{FBAuthCode:c})}new Request({url:f.href,method:"post",data:a,keepScripts:true,onSuccess:function(k){ta.store("fb.partial.isHandlePartialPaging",true);ta.util.partials.dataAvailable(b,d,"facebook",false,j,f,k)}}).send();return false},dataAvailable:function(d,k,j,p,r,c,g){if(p){var f=ta.util.partials.dataAvailable.pass([d,k,j,false,r,c,g]);p(f,g,k,d,j,p);return}if(g.match(ta.util.partials.noOauthTokenRegex)){if(ta.remove("fb.partial.isHandlePartialPaging")){ta.support.Facebook.pageDataAvailable(r,c,d,g)}return}if(g.match(ta.util.partials.partialsErrorRegex)){if(ta.has(j+".onPartialsError")){ta.remove(j+".onPartialsError").each(function(s){s()})}return}var o=[];var h=[];if(g.match(ta.util.partials.incompleteDataRegex)){o=RegExp.$1.split(",")}if(g.match(ta.util.partials.failedDataRegex)){h=RegExp.$1.split(",")}if(ta.has(j+".onDataAvail")){ta.remove(j+".onDataAvail").each(function(s){s()})}var q=[];var b=null;var m=/<style[^>]*>([\s\S]*?)<\/style>/gi;while((b=m.exec(g))){q.push(b[1])}if(q.length>0){q=q.join("\n");var l=document.createElement("style");l.type="text/css";document.getElementsByTagName("head")[0].appendChild(l);if(Browser.ie){l.styleSheet.cssText=q}else{l.appendChild(document.createTextNode(q))}}g=g.stripScripts(true);g=g.replace(/<style[^>]*>([\s\S]*?)<\/style>/gi,"");var a=ta.id("PARTIAL_DATA")||new Element("div",{id:"PARTIAL_DATA",styles:{display:"none"}}).inject(document.body);a.innerHTML+=g;setTimeout(function(){ta.util.partials.notifyListeners(k,j,o,h,a,d)},0)},notifyListeners:function(d,f,c,b,a,g){d.each(function(l){var q=f+".data.onAvail."+l;var o=c.contains(l);var k=b.contains(l);var r=ta.remove(q);if(r){for(var p=0,m=r.length;p<m;p++){if(r[p](a,o,k)===false){r[p]=null}}r=r.erase(null);if(o){if(r.length>0){ta.store(q,r)}else{c.erase(l)}}}if(!c.contains(l)&&!k){ta.keep("partials.pageProperties",l)}});var j="partials.data.onPage";var h=ta.remove(j);if(h){h.each(function(k){k()})}if(c.length>0){ta.util.partials.requestPartials.invokeLater(ta.util.partials.requestTimeout,null,[c,g,f])}else{ta.util.partials.recordGAEvent()}},recordGAEvent:function(){var b=ta.remove("partials.pageProperties");if(!b||b.length==0){return}var a="-"+b.sort().join("-")+"-";ta.trackEventOnPage("social","show",a)}};ta.util.partials.handleLightbox=ta.util.partials.handlePartialPaging;ta.support.Facebook={ready:false,queue:[],enqueueForFBReady:function(a){if(ta.support.Facebook.ready){a()}else{ta.support.Facebook.queue.push(a)}},dequeueForFBReady:function(){try{ta.support.Facebook.queue.each(function(b){b()})}catch(a){ta.util.error.record(a,"Error calling dequeueForFBReady")}ta.support.Facebook.queue=[]},ipRevoke:function(a){setTimeout(function(){ta.util.pending.lock("fb.revoke.lb",function(){ta.util.pending.unlock("fb.revoke")})},a)},enqueueForFBAvailable:function(a){if(ta.retrieve("facebook.session.available")){a()}else{ta.keep("facebook.onSessionAvail",a)}},init:function(){if(ta.has("facebook.available")){return}ta.util.pending.multilock("facebook.data.canDisplay",ta.support.Facebook.showData,2);var b=ta.support.Facebook.timing=new ta.support.IPTiming();if(!ta.retrieve("facebook.invalidFBCreds")){ta.support.Facebook.initData(true)}ta.support.Facebook.markAvailable();var a=window.documentDomainChanged?"/fb/channel_mod.html":"/fb/channel.html";var c=ta.retrieve("facebook.appId");var d=true;FB.init({appId:c,status:true,cookie:true,xfbml:true,channelUrl:window.location.protocol+"//"+window.location.hostname+a,frictionlessRequests:true,oauth:d});ta.support.Facebook.ready=true;ta.support.Facebook.dequeueForFBReady();if(!ta.retrieve("facebook.disableLogin")){if(ta.retrieve("facebook.skip.session.check")=="true"){ta.support.Facebook.sessionAvailable()}else{FB.getLoginStatus(ta.support.Facebook.onLoginStatus)}}else{if(!ta.has("facebookuserid")){ta.support.Facebook.sessionUnavailable()}}},transformToAuthResponse:function(c){var a=ta.retrieve("facebook.authFailed");var d=ta.retrieve("facebook.authSuccess");var b=c.authResponse;if(!b){if(a){a()}return null}if(c.status=="connected"){b.uid=ta.store("fb.auth.userId",b.userID);b.token=ta.store("fb.auth.token",b.accessToken);if(d){d()}return b}if(a){a()}return null},onLoginStatus:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){if(ta.has("cached.facebookuid")&&ta.retrieve("cached.facebookuid")!=a.uid){ta.store("facebook.preFailed",true);ta.store("facebook.AuthCode.onAvail.needsReload",function(){window.location.reload()});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}if(ta.retrieve("facebook.invalidFBCreds")&&!ta.retrieve("facebook.signout.process")){ta.store("facebook.AuthCode.onAvail",ta.support.Facebook.sessionAvailable);ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}else{ta.support.Facebook.sessionAvailable()}}else{if(!ta.retrieve("facebook.invalidFBCreds")){ta.store("facebook.preFailed",true);setOneTimeCookie("FacebookAuthCode","NoFBSessionAvailable");new Request({url:"/ActionRecord?action=fb_cached_token_no_session"}).send()}ta.support.Facebook.sessionUnavailable()}},initData:function(a){if(ta.remove("facebook.data.initialRequest.failed")){ta.support.Facebook.loadData({pre:a})}else{ta.util.pending.lock("facebook.data.initialRequest",ta.support.Facebook.loadData.partial({pre:a}))}},loadData:function(b){if(!ta.has("facebook.data.request")){return}ta.support.Facebook.timing.setBeginPartials();var a=ta.retrieve("facebook.data.request");if(!ta.has("facebook.connectBar-counted")&&ta.retrieve("facebook.showWelcomeBar")){if(!b.pre){ta.store("facebook.connectBar-counted",true);FB.api({method:"connect.shouldShowConnectBar"},function(c){if(c==2){a.erase("IP_BAR");a.include("USER_PROFILE_ACTION");ta.merge("facebook.data.params",{bar:"off"})}ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)})}else{ta.store("facebook.data.initialRequest.failed",true)}}else{ta.util.partials.requestPartials(a,Object.merge({},b,ta.retrieve("facebook.data.params")),"facebook",ta.support.Facebook.dataAvailable)}},receiveCode:function(d){var a=ta.retrieve("facebook.AuthCode.onAvail");if(a!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);a()}var c=ta.retrieve("facebook.AuthCode.onAvail.needsReload");if(c!=null){setOneTimeCookie("FacebookAuthCode","ConflictedFBAccount");c()}var b=ta.retrieve("facebook.AuthCode.onAvail.paging");if(b!=null){ta.store("facebook.authcode.param",d);setOneTimeCookie("FacebookAuthCode",d);b()}},getCodeFromOAuthResponse:function(b){var d=ta.support.Facebook.parseFBSignedRequest(b.signedRequest).code;var c=ta.remove("facebook.taServerTime");var a=c-3600;var f=null;if(d&&!isNaN(a)){f=d.split(".")}if(f!=null&&f.length>3&&!isNaN(f[3])&&f[3]<a){ta.util.error.record(null,"Facebook sending up expired Code: ",null,{code:d,serverTime:c})}return d},parseFBSignedRequest:function(c){if(!c){return null}var a=c.split(".",2);var d=a[1];if(d){var b=ta.util.decoder.base64Decoder(d);try{return JSON.decode(b)}catch(f){ta.util.error.record(null,"couldn't parse Facebook SignedRequest to JSON object after decode ",null,{signedRequest:c,decoded:b})}}else{ta.util.error.record(null,"Facebook SignedRequest TA received doesn't contain data",null,{signedRequest:c})}},preemptiveRegex:/<\!-- PREEMPTIVE RESPONSE -->/,noOauthTokenRegex:/<\!-- no Oauth Token -->/,limitOfTry:4,dataAvailable:function(c,a,b,f,d,h){if(a.match(ta.support.Facebook.preemptiveRegex)&&ta.remove("facebook.preFailed")){return}if(a.match(ta.support.Facebook.noOauthTokenRegex)){delete f.pre;var g=ta.util.partials.requestPartials.partial(b,f,d,h);ta.store("facebook.AuthCode.onAvail",g);ta.support.Facebook.tryRegetOauthToken()}ta.store("facebook.data.handler",c);ta.util.pending.unlock("facebook.data.canDisplay")},tryRegetOauthToken:function(){var a=ta.retrieve("fb.noOauthToken.counter");if(a==null){a=0}if(a<ta.support.Facebook.limitOfTry){ta.store("fb.noOauthToken.counter",a+1);FB.getLoginStatus(ta.support.Facebook.checkStatusAndGetCode)}},checkStatusAndGetCode:function(b){var a=ta.support.Facebook.transformToAuthResponse(b);if(a){ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(a))}},pageDataAvailable:function(f,b,d,a){var c=ta.util.partials.handlePartialPaging.partial(f,b,d);ta.store("facebook.AuthCode.onAvail.paging",c);ta.support.Facebook.tryRegetOauthToken()},showData:function(){ta.remove("facebook.data.handler")();ta.support.Facebook.timing.recordEndTimes()},markAvailable:function(){ta.store("facebook.available",true);if(ta.has("facebook.onAvail")){ta.remove("facebook.onAvail").each(function(a){a()})}},sessionAvailable:function(){var a=ta.retrieve("facebook.session.available");ta.store("facebook.session.available",true);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionAvail")){ta.remove("facebook.onSessionAvail").each(function(b){b()})}if(!a){ta.util.pending.unlock("facebook.data.canDisplay")}ta.support.Facebook.initData(false);ta.support.Facebook.havePermission("publish_actions",function(){if(ta.retrieve("facebook.hasPublishActions")!="true"){new Request({url:"/ActionRecordPlus?action=UPDATE_SOCIAL_COOKIE&fbid="+ta.retrieve("fb.auth.userId")+"&value=true"}).send()}},function(){if(ta.retrieve("facebook.hasPublishActions")=="true"){new Request({url:"/ActionRecordPlus?action=UPDATE_SOCIAL_COOKIE&fbid="+ta.retrieve("fb.auth.userId")+"&value=false"}).send()}})},sessionUnavailable:function(){ta.store("facebook.session.available",false);ta.support.Facebook.timing.recordLoadTime();if(ta.has("facebook.onSessionUnavail")){ta.remove("facebook.onSessionUnavail").each(function(a){a()})}$$("#HEAD .FB_login_button").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=FBC_Masthead"}).send()})});$$("#WoF_SigninLander .fbcBtnsmall").forEach(function(a){a.addEvent("click",function(){new Request({url:"/ActionRecord?action=WoF_SigninLander"}).send()})})},havePermission:function(b,d,c){var a=ta.retrieve("facebook.permissions");if(a){if(a.indexOf(b)==-1){return c?c():null}return d?d():null}else{FB.api({method:"users.hasAppPermission",ext_perm:b},function(f){if(f!=0){if(d){d()}}else{if(c){c()}}})}},requirePermission:function(a,c,b){ta.support.Facebook.login([a],c,b)},ifLoggedIn:function(b,a){if(ta.retrieve("facebook.session.available")&&b){b()}else{if(a){a()}}},loginButton:function(b,a){ta.support.Facebook.login()},login:function(o,a,d,c,b,l){var l=!!l;o=Array.from(o||[]);if(b!=null&&b.length>0){ta.store("facebook.flow",b)}else{ta.store("facebook.flow","FBC")}var f=userLoggedIn?"Connect":"Login";var g=f=="Login"?"":ta.retrieve("facebook.isFBC")=="true"?"Upgrade":"New";var k=ta.retrieve("facebook.trackingpid");ta.util.cookie.setPIDCookie(k);ta.util.action.record("FacebookConnect",null,{module:"social",action:f+"Attempt"+g});var p=function(){ta.util.cookie.setPIDCookie(k);ta.util.action.record("FacebookConnect",null,{module:"social",action:f+"Success"+g});var q={action:f,userType:g};if(a){a(q)}};if(!userLoggedIn||!userFbConnected||c){ta.support.Facebook._doLogin(o,p,d,c,l);return}var m=[];for(var j=0;j<o.length;j++){m.push(ta.support.Facebook.havePermission.partial(o[j]))}function h(){if(p){p()}}Function.executeContinuations([ta.support.Facebook.ifLoggedIn].concat(m).concat([h]),ta.support.Facebook._doLogin.partial(o,p,d,l))},_doLogin:function(c,h,a,f,b){var g=["email","user_education_history","friends_education_history","user_events","friends_events","user_hometown","friends_hometown","user_likes","friends_likes","user_location","friends_location","user_work_history","friends_work_history","user_status","friends_status","friends_photos","publish_actions","user_photos"];var d=f;FB.login(function(k){var j=ta.support.Facebook.transformToAuthResponse(k);if(j&&j.token){ta.support.Facebook.havePermission("email",function(){ta.support.Facebook.setResultPID();ta.store("facebook.AuthCode.onAvail",function(){ta.store("facebook.uid",j.uid);ta.support.Facebook.fbcRegistration(d,h,b)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(j))},function(){ta.util.error.record(null,"user did not grant email permission, user fbid is:"+j.uid,null,{},"WARN")})}else{if(a){a()}}},{scope:g.join(",")})},setResultPID:function(){var a=ta.retrieve("facebook.trackingpid");if(a){ta.util.cookie.setPIDCookie(a)}},fbcRegistration:function(b,d,a){var c=!ta.retrieve("facebook.session.available")||!userLoggedIn||!userFbConnected;if(b!=null){c=c||b}if(c){ta.store("facebook.session.available",true);ta.store("registration.action","FB_CONNECT");ta.run("ta.overlays.registration.logAndPost",{},{flow:ta.retrieve("facebook.flow"),noreload:a},"FBC-start",{action:"FB_CONNECT"})}if(d){d()}},loginWithFlow:function(a,b){ta.store("facebook.flow",a);ta.support.Facebook.login(null,null,null,b)},logout:function(){FB.logout(function(){window.location.reload()})},logoutNoRefresh:function(a){FB.logout(function(b){userLoggedIn=false;ta.store("facebook.session.available",false);ta.store("facebook.isFBC",false);if(a){a(b)}})},restart:function(){FB.logout(function(){ta.overlays.registration.post({action:"FB_LOGIN"})})},revoke:function(){FB.api({method:"Auth.revokeAuthorization"})},postWall:function(j,g,l,f,c,p,h,d,m,a,k,o,b){FB.ui({method:"feed",message:j,picture:p,link:g,name:l,to:m,caption:f,description:c,display:a,properties:k,actions:[{name:h,link:d}]},function(q){if(q&&q.post_id){if(o){o(q)}}else{if(q&&!q.post_id){ta.util.error.record(null,"Facebook postWall error response from facebook",null,null)}else{if(b){b(q)}}}})},publishStream:function(f,a,h,j,c,g,b,d){FB.login(function(l){var k=ta.support.Facebook.transformToAuthResponse(l);if(k){if(k.token){new Request({url:"/ActionRecord?action=POSTTOWALL_GRANTED"}).send();ta.support.Facebook.postWall(f,a,h,j,c,g,b,d)}}},{scope:"publish_stream"})},loginRequestSpecificPermission:function(b,c,a){FB.login(function(f){var d=ta.support.Facebook.transformToAuthResponse(f);if(d){if(d.token){ta.store("facebook.AuthCode.onAvail",function(){ta.support.Facebook.fbcRegistration(null,c)});ta.support.Facebook.receiveCode(ta.support.Facebook.getCodeFromOAuthResponse(d))}else{if(a){a()}}}},{scope:b})},loginWithFlowAndRequest:function(b,c,d,a){ta.store("facebook.flow",b);ta.support.Facebook.loginRequestSpecificPermission(c,d,a)},signOutComplete:function(){try{ta.support.Facebook.ifLoggedIn(function(){ta.support.Facebook.logout()},function(){window.location.reload()})}catch(a){ta.util.error.record(a,"signoutAction - fb signout failed");window.location.reload()}},googleClick:function(c,a){new Request({url:"/ActionRecord?action=Google404Test&pid="+a}).send();if(c){c.onclick=null}var b=ta.id("GOOG_SORRY");if(b){b.show()}}};ta.support.IPTiming=new Class({initialize:function(){this.active=ta.has("facebook.iptiming");if(this.active){this.timers=ta.retrieve("facebook.iptiming")}else{}},recordLoadTime:function(){if(this.active){this.sendActionRecord("LoadPage",this.timers.loaded-this.timers.started)}},setBeginPartials:function(){if(this.active&&!this.timers.partials){this.timers.partials=new Date().getTime()}},recordEndTimes:function(){if(this.active){var a=new Date().getTime();this.sendActionRecord("GetPartials",a-this.timers.partials);this.sendActionRecord("LoadAll",a-this.timers.started)}},sent:{},sendActionRecord:function(c,a){if(this.sent[c]){return}this.sent[c]=true;a=Math.round(a/1000);var b;if(a<=10){b=a.toString()}else{if(a>10&&a<=15){b="11-15"}else{if(a>15&&a<=20){b="16-20"}else{b="21+"}}}c+="_";c+=ta.retrieve("facebook.session.available")?"IP_":"NonIP_";c+=b+"_"+this.timers.servletName;if(this.timers.firstPage){c+="_FirstPage"}ta.util.action.record(c)}});(function(a){a.util||(a.util={});var b=function(c){this.constructor=c};a.util.extend=function(h){var d={};var j,k,g,f,c;for(f=1,c=arguments.length;f<c;f++){k=arguments[f];for(g in k){if(k.hasOwnProperty(g)){d[g]=k[g]}}if(k.hasOwnProperty("constructor")){d.constructor=k.constructor}}j=d.hasOwnProperty("constructor")?d.constructor:function(){return h.apply(this,arguments)};b.prototype=h.prototype;j.prototype=new b(j);j.prototype.__super__=h.prototype;for(g in d){j.prototype[g]=d[g]}return j}}(ta));(function(d){d.fb||(d.fb={});var b=new RegExp(["User is already associated","Permissions error"].join("|"));var a=new RegExp(["Timeline is not activated","Requires extended permission","An unexpected error has occurred","An unknown error has occurred","load-error: unknown","Error validating access token","Object at URL.*requires an object of og:type","Could not retrieve data from URL","^unknown error"].join("|"));var c=/Temporarily Blocked/;d.fb.graph={api:function(k,m,l,h){var g=Array.prototype.slice.call(arguments);var f=d.util.Deferred();m||(m="get");l||(l={});h||(h={});h.recordErrors=(h.recordErrors!==false);(function j(o){FB.api(k,m,l,function(q){if(q&&!q.error){f.resolve(q)}else{var r={name:"None",message:"No FB.api response"};var p="ERROR";if(q&&q.error){r.name=q.error.type;r.message=(typeof q.error==="string")?q.error:q.error.message}if(o&&r.message.match("has og:type of '(?:tripadvisortravelmap|civ)")){l.scrape=true;j(false);return}if(a.test(r.message)){p="WARN"}if(h.recordErrors&&!b.test(r.message)){this.recordError(r,{FB_API_ARGS:g,FB_API_RESPONSE:q,FB_AUTH_RESPONSE:FB.getAuthResponse()},p)}f.reject(r)}}.bind(this))}.call(this,true));return f.promise()},remove:function(g,f){f||(f={});f.method="delete";return this.api("/"+g,"delete",f)},recordError:function(h,j,f){var g="ta.fb.graph.api";if(c.test(h.message)){g+=" blocked feature"}if(d.util.error){d.util.error.record(h,g,null,j,f)}return this}}}(ta));(function(a){a.fb.graph.Base=a.util.extend(Object,{constructor:function b(d,c){this.set(d);this.options=c||{};this.connections||(this.connections={})},set:function(d){for(var c in d){d.hasOwnProperty(c)&&(this[c]=d[c])}return this},api:function(c,g,f){if(!(this.id&&this.accessToken)){var d={name:"Missing auth credentials",message:"Facebook Graph object API calls require an id and access token"};a.fb.graph.recordError(d,{FB_ID:this.id,FB_ACCESS_TOKEN:this.accessToken,FB_API_ARGS:arguments},"WARN");return a.util.Deferred().reject(d)}c||(c="");if(/^\//.test(c)){c=c.slice(1)}f||(f={});f.access_token=this.accessToken;return a.fb.graph.api("/"+this.id+"/"+c,g,f)},getClientConnection:function(c){if(!this.connections[c]){this.connections[c]=[];this.connections[c].all=false;this.connections[c].clientCount=0}return this.connections[c]}})}(ta));(function(a){a.fb.graph.mixin||(a.fb.graph.mixin={});var d=true;var c=new RegExp(["Timeline is not activated","Requires extended permission"].join("|"));var b=300;a.fb.graph.mixin.OpenGraph={recordOpenGraph:function(g){var f=this.options.MapAction;if(f){Math.random()>0.2||f.record(g)}return this},getActions:function(f,g){f=this.options.appName+":"+f;var h=this.getClientConnection(f);if(h.all||(!g&&h.length>h.clientCount)){return a.util.Deferred().resolve(h)}return this.api(f,"get",{offset:h.length,limit:b}).success(function(j){Array.prototype.push.apply(h,j.data);if(!j.paging||(j.paging.previous&&!j.paging.next)){h.all=true}return a.util.Deferred(h)})},publishAction:function(g,k,j,h){if(!d||!a.retrieve("feature.ogPublish")){return a.util.Deferred().reject("Publishing open graph actions is disabled.")}var f=this.options.appName;var l=this.options.ref;g=f+":"+g;h||(h={});h[k]="http://"+this.options.hostname+j;if(l){h.ref=l}if(!a.retrieve("feature.openGraphLocationTagging")){delete h.place}var m=this.api(g,"POST",h).success(function(o){var q=this.getClientConnection(g);var p={id:o.id,data:{}};p.data[k]={url:h[k]};q.splice(q.clientCount,0,p);q.clientCount++;this.recordOpenGraph("OpenGraph_"+g)},this).failure(function(o){if(c.test(o.message)){d=false}});return m},publishLocatedAction:function(j,h,g,f){f||(f={});f.place="http://"+this.options.hostname+g;return this.publishAction(j,h,g,f)},deleteActionsByObject:function(h,k,j){var g=this;if(+j!=j){j="http://"+this.options.hostname+j}var l=Array.prototype.each?"each":"forEach";return(function f(m){return g.getActions(h,{next:m}).success(function(t){if(!t.all){return f(true)}var o=a.util.Deferred();var s=[];var r,p,q;for(q=0;q<t.length;q++){r=t[q];p=r.data[k];if(p&&(p.url==j||p.id==j)){s.push(r)}}if(!s.length){return o.resolve()}s[l](function(u){a.fb.graph.api(u.id,"delete").success(function(){s.splice(s.indexOf(u),1);var v=t.indexOf(u);t.splice(v,1);if(v<t.clientCount){t.clientCount--}if(!s.length){o.resolve()}}).failure(function(){o.reject()})});return o.promise()},this)}(false))},scrape:function(f){return a.fb.graph.api("/","post",{id:f,scrape:true})}}}(ta));(function(a){a.fb.graph.User=a.util.extend(a.fb.graph.Base,a.fb.graph.mixin.OpenGraph)}(ta));ta.fb.graph.User.prototype.inviteFriends=(function(b){var d=50;function a(f,g,k,j,h){var l=f.splice(0,d);h||(h=[]);FB.ui({method:"apprequests",message:g||"",title:k||"",new_style_message:true,to:l.join(",")},function(m){if(m&&m.to&&m.to.length){h.push.apply(h,m.to);if(!f.length){a(f,g,k,j,h)}else{j.resolve(h,m)}}else{j.reject(h,m)}})}return function c(g,h,j){var f=b.util.Deferred();a(g,h,j,f);return f.promise()}}(ta));ta.fb.graph.User.prototype.getAppRequests=function(a){if(!a&&this.appRequests){return ta.util.Deferred().resolve(this.appRequests)}return this.api("apprequests").success(function(b){this.appRequests=b},this)};ta.fb.graph.User.prototype.recordAndDeleteAppRequests=function(d,c,g){var a=this;d||(d=[]);if(!c){var b=window.location.search.match(/[?&](?:ref|fb_source)=([^&]*)/);c=b&&b[1]}function f(j){var l=[];var k=0;var h=ta.util.Deferred();j.each(function(o){var m="";ta.fb.graph.api("/"+o,"get").success(function(p){if(p&&p.from&&p.from.id){m=p.from.id}}).always(function(){ta.fb.graph.api("/"+o,"delete",null,{recordErrors:false});l.push((g?g+"_":"")+"AppRequestId_"+o+"_"+m);k++;if(k==j.length){if(a.options.MapAction&&l.length){a.options.MapAction.record(l.join(",")).success(function(){h.resolve()}).failure(function(){h.reject()})}else{h.resolve()}}})});return h.promise()}if(c=="bookmarks"){return this.getAppRequests().success(function(h){h.data.each(function(j){var k=j.id.split("_")[0];~d.indexOf(k)||d.push(k)})}).always(function(){return f(d)})}return f(d)};(function(a){var b=10000;a.fb.graph.TAUser=a.util.extend(a.fb.graph.User,{locationToOgType:function(c){return/^g(?:eo)?|10004/.test(c)?"city":/^a(?:ttraction)?|10021/.test(c)?"attraction":/^e(?:atery)?|10022/.test(c)?"restaurant":/^h(?:otel)?|^lodging|10023/.test(c)?"hotel":null},pin:function(c,g,p){p||(p={});var m=a.util.Deferred();var f=false;var d,j,k,o;if(c){d=this.locationToOgType(c.type);j=c.url}if(!(d&&c.url&&g&&g.length)){return m.reject()}k=!!(this.location&&this.location.latitude&&this.location.longitude);o=!!(this.hometown&&this.hometown.latitude&&this.hometown.longitude);var l=Array.prototype.each?"each":"forEach";var h=0;g[l](function(r){var t=r=="been"?"pin":r;var s={};var u=false;if(t=="pin"){var q={};var v;if(k){q.lat=this.location.latitude;q.lng=this.location.longitude}else{if(o){q.lat=this.hometown.latitude;q.lng=this.hometown.latitude}}v=a.travelmap.util.getDistance(c,q,this.locale);if(v){s.distance=v.value;s.distance_unit=v.unit;s.cur_loc_used=k}}else{if(t=="going"){s.end_time="5000-01-01"}}if(p.suppressFeed||(t=="pin"&&g.length>1)){s.no_feed_story=1}if(p.suppressMap||d!="city"||t=="going"||!c.redistributable||t=="pin"&&g.length>1){u=true}this[u?"publishAction":"publishLocatedAction"](t,d,j,s).failure(function(){f=true}).always(function(){if(++h==g.length){m[f?"reject":"resolve"]()}})},this);return m.promise()},visit:function(f,j,h,d){var c=a.util.Deferred();var g={};var k=j.join(",");g.tags=k;if(h){g["fb:explicitly_shared"]=true}this.publishLocatedAction("visit","city",f,g);return c.promise()},removePin:function(f,l){var c=a.util.Deferred();var d=false;var h,g;if(f){h=this.locationToOgType(f.type);g=f.url}if(!(h&&f.url&&l&&l.length)){return c.reject()}var k=Array.prototype.each?"each":"forEach";var j=0;l[k](function(m){var o=m=="been"?"pin":m;var p={};this.deleteActionsByObject(o,h,g).failure(function(){d=true}).always(function(){if(++j==l.length){c[d?"reject":"resolve"]()}})},this);return c.promise()},removeBadge:function(c){var d=false;var g,f;if(c){var g="badge";var f="/MemberTravelMap?ns=badge&badgeId="+c.id}if(!(g&&f)){return new a.util.Deferred().reject()}return this.deleteActionsByObject("earn",g,f)},rate:function(c){var g="rate";var f="attraction";var d=c.url;return this[c.redistributable?"publishLocatedAction":"publishAction"](g,f,d)},review:function(f,j,c){var h="review";var g="";if(f.indexOf("/Attraction")==0){g="attraction"}else{if(f.indexOf("/Hotel")==0){g="hotel"}else{if(f.indexOf("/Restaurant")==0){g="restaurant"}}}var d={title:j,body:c};d["fb:explicitly_shared"]=true;return this.publishAction(h,g,f,d)},earnBadge:function(c,g,k){var j="earn";var h="badge";var f="/MemberTravelMap?ns=badge&badgeId="+c;var d={};if(g){d["fb:explicitly_shared"]=true}if(k){d.no_feed_story=true}return this.publishAction(j,h,f,d)},endorseFriend:function(d,c){var j="endorse";var h="friend";var g="/MemberTravelMap?ns=friend&serial="+d;var f={city:"http://"+this.options.hostname+c};return this.publishAction(j,h,g,f)},updateMap:function(c){this._needToScrapeMap=true;if(this._intervalID&&!c){return a.util.Deferred().resolve()}this._intervalID||(this._intervalID=window.setInterval(this.scrapeMap.bind(this),b));return this.options.MapAction.getTravelMapMetaData().always(function(d){var j="publish";var h="map";var g="/MemberTravelMap?ns=map&uid="+this.options.guid;var f={};if(d&&d.tmTotalDistance){f={total_distance:Math.round(d.tmTotalDistance),distance_unit:d.tmDistanceUnit}}if(c){f["fb:explicitly_shared"]=true}return this.publishAction(j,h,g,f)},this)},scrapeMap:function(c){if(this._needToScrapeMap||c){this._needToScrapeMap=false;return this.scrape("http://"+this.options.hostname+"/MemberTravelMap?ns=map&uid="+this.options.guid)}return a.util.Deferred().resolve()}})}(ta));ta.common.wisdomoffriends={reloadASAP:function(){window.location.reload()},showWelcome:function(){ta.store("wof.showWelcome",true)}};if(!ta.popups){ta.popups={}}ta.popups.PopUtil={windowType:{CHECK_RATE:0,PROV_WIN:1,HOLDING:2,COMMERCE:3,VFM:4},taPopunderSlots:null,taPopupSlots:null,taHoldingWindowCap:2,taPopWindowSet:[],taWindowCount:0,maxPopunders:4,hwClosed:false,getAndUpWindowCount:function(){return this.taWindowCount++},tryHoldingWindows:function(a,b){try{var g=true;for(var c=0;c<b;c++){var f=this.launchHoldingWindow(a);if(!f.windowObject){g=false}}if(g){return true}}catch(d){ta.util.error.record(d,"try two hw",trigger)}return false},getPopunderSlots:function(){if(this.taPopunderSlots===null){this.taPopunderSlots=new ta.popups.PopunderSlotSet()}return this.taPopunderSlots},getPopupSlots:function(){if(this.taPopupSlots===null){this.taPopupSlots=new ta.popups.PopupSlotSet()}return this.taPopupSlots},createCheckRatesWindow:function(a){return this.buildNewWindow(this.windowType.CHECK_RATE,a)},createHoldingWindow:function(b){var a=this.buildNewWindow(this.windowType.HOLDING,b);if(a&&ta.has("checkrates.belligerent_hw")&&Browser.version>22){ta.store("checkrates.popunder",a)}return a},createVFMWindow:function(a){return this.buildNewWindow(this.windowType.VFM,a)},buildNewWindow:function(b,d){var a=new ta.popups.TAPopWindow(b,d);if(!a){return false}if(!a.errorOpening&&!a.errorMoving&&a.windowObject){try{if(ta.has("checkrates.add_holding_windows")&&d.windowHook&&d.windowHook.location&&d.windowHook.location.href.test(/RuleBasedPopunder/)){this.taPopWindowSet.unshift(a)}else{this.taPopWindowSet[this.taPopWindowSet.length]=a}if(!d.windowHook&&b==this.windowType.HOLDING){this.trackPopunder(d.url,this.numPopundersCheck())}return a}catch(c){ta.util.error.record(c,"Window Popup - could not register new window")}}return false},getHoldingWindowSet:function(){var f=[];for(var b=0;b<this.taPopWindowSet.length;b++){var a=this.taPopWindowSet[b];if(a&&a.type==this.windowType.HOLDING){var c=a.windowObject;if(c&&"closed" in c){if(!c.closed){f[f.length]=a}else{if(ta.has("checkrates.add_holding_windows")&&c.closed){this.hwClosed=true;var d=window.cookieDomain;if(d){Cookie.write("CommercePopunder","SuppressAll",{domain:d,duration:0})}}}}}}return f},attemptHoldingWindowFromGeoCR:function(h,d,b,g){var a=document.getElements("#GEO_CR_LB .popup_hotel_checkbox input");var f=0;for(var c=a.length;c--;){var j=a[c];if(j.checked){f++}}if(this.getHoldingWindowSet().length<f){this.launchHoldingWindow(b)}},attemptHoldingWindowWNumChecked:function(f,b,a,d){var g=new ta.commerce.CheckRatesData({type:d,evnt:f},ta.commerce.checkrates.getPropIdFromCRElement(b),a,true);var c=g.getVendorSet().getCheckedInfo("count");if(this.getHoldingWindowSet().length<(c-1)){this.launchHoldingWindow(a)}},openCloseTab:function(){if(ta.has("popunder.popunder_by_self_closing_tab")){try{var d=document.createElement("a");d.href="http://"+window.location.hostname+"/vpages/tab.html";document.body.appendChild(d);var c=document.createEvent("MouseEvents");c.initMouseEvent("click",false,true,window,0,0,0,0,0,true,false,false,true,0,null);d.dispatchEvent(c);d.parentNode.removeChild(d)}catch(h){ta.util.error.record(h,"self-closing tab blur method failed")}}else{if(ta.has("checkrates.cr_popunder_by_shift_ctrl")&&Browser.version>23){try{var d=document.createElement("a");d.href="about:blank";d.target="popunderwindowhelper";document.body.appendChild(d);var c=document.createEvent("MouseEvents");var f=true;var b=true;if(ta.has("checkrates.date_picker_on_classic")){f=false;b=false}c.initMouseEvent("click",f,b,window,0,0,0,0,0,true,false,false,true,0,null);d.dispatchEvent(c);d.parentNode.removeChild(d);window.open("about:blank","popunderwindowhelper").close()}catch(h){ta.util.error.record(h,"shift-ctrl blur method failed")}}else{var a=ta.retrieve("checkrates.popunder");if(ta.has("checkrates.belligerent_hw")&&a&&Browser.version>22){var g=window.open("about:blank");if(g){g.close()}ta.remove("checkrates.popunder");try{if(a.windowObject&&a.isTAWindow()){a.moveBehindMain(a.windowObject)}}catch(h){ta.util.error.record(h,"holding window blur")}}}}},attemptHoldingWindow:function(a){if(this.useShiftClick()){return}if(ta.has("checkrates.add_holding_windows")){var b=this.numPopundersCheck();if(b>=this.maxPopunders){return}else{this.launchHoldingWindow(a)}}else{if(this.taHoldingWindowCap>this.getHoldingWindowSet().length){this.launchHoldingWindow(a)}}},launchHoldingWindow:function(a){if(!a){return false}var b=ta.retrieve("checkrates.holdingWindowURI");if(ta.has("checkrates.avlb_popup_win")){b="http://"+window.location.hostname+"/AlsoViewedLB?checkRatesType=checkRates&avlbType=popup&d="+a}if(b){ta.store("checkrates.HWtracking","date");var c={url:b};return this.createHoldingWindow(c)}return false},launchAddHoldingWindow:function(b){var a={url:b};return this.createHoldingWindow(a)},popunderReminder:function(b){var a={windowHook:b};this.createHoldingWindow(a)},numPopundersCheck:function(){try{var f=this.getHoldingWindowSet();var b=0;var a=new Cookie("CommercePopunder").readRaw();var d=a?a.match(/\d+/):null;if(!a||!d){b=f.length}else{b=Math.max(f.length,parseInt(d[0]))}return b}catch(c){ta.util.error.record(c,"CommercePopunder - numPopundersCheck")}},trackPopunder:function(j,h){try{if(!h||!j){return}var c="CommerceEnhancedPopunder";if(j.match(/AlsoViewedLB/)){c="AlsoViewedLB"}else{var a=j.match(/RuleBasedPopunder\?Rule=\d+/);if(a){var d=a[0].match(/\d+/);c="RuleBasedPopunder_"+d[0]}}var b="OpenWindow";var g=ta.retrieve("checkrates.HWtracking");if(g){b="OpenWindow_"+g;ta.remove("checkrates.HWtracking")}ta.trackEventOnPage("CommercePopunder",b,c,h,true)}catch(f){ta.util.error.record(f,"CommercePopunder - trackPopunder")}},trackPopup:function(f){try{if(!f){return}var b="DHTMLOverlay";var g=f.match(/RuleBasedPopup/);if(g){var a=f.match(/Rule=\d+/);if(a){var c=a[0].match(/\d+/);b="RuleBasedPopup_"+c[0]}}ta.trackEventOnPage("Popup","OpenPopup",b,1,true)}catch(d){ta.util.error.record(d,"Popup - trackPopup")}},hasMTPU:function(){try{var c=false;var f=this.getHoldingWindowSet();for(var a=f.length;a--;){var b=f[a].windowObject;if(b&&b.location.href.match(/RuleBasedPopunder/)){c=true;break}}return c}catch(d){ta.util.error.record(d,"CommercePopunder - hasMTPU")}},getProviderWindowDims:function(a,d){var b=null;var g=null;var f=null;var c=null;if(a=="hotels.com"){b=975}if(screen.width>=1280){b=1000;g=897;if(!d){f=0;c=0;if(Browser.chrome){g-=50}else{if(Browser.firefox){g-=87}else{if(Browser.ie){b-=12;g-=179}}}}}return{customWidth:b,customHeight:g,widthOffset:f,heightOffset:c}},useShiftClick:function(){if(ta.has("checkrates.chrome_provider_on_shift_click")){var b=this.getProviderWindowDims();var a=66;if(((window.outerHeight>b.customHeight)||(window.outerWidth>b.customWidth))&&((window.outerHeight<(screen.height-a))&&(window.outerWidth<(screen.width-a)))){ta.store("checkrates.use_chrome_provider_on_shift_click",true);return true}}if(!ta.has("checkrates.cr_provider_on_mousedown")){ta.remove("checkrates.use_chrome_provider_on_shift_click")}return false},expandSidebarWindow:function(c,a,b){if(ta.trackEventOnPage){ta.trackEventOnPage("traffic_acquisition_sidebar","any",a,1)}if(b=="true"){window.moveTo(0,0);window.resizeTo(screen.width,screen.height)}document.getElementById("SliderHolder").style.display="none";document.getElementById("PAGE").style.marginLeft="0px"},newWindowFromExitPop:function(b,a){newwindow=window.open(a,"_blank","height="+screen.height+",width="+screen.width+",toolbar=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes");if(window.focus){newwindow.focus()}}};ta.popups.TAPopWindow=new Class({Implements:Options,options:{name:"TAWin",url:"",windowHook:false,customWidth:false,customHeight:false,toolbar:1,location:1,directories:1,status:1,menubar:ta.browser.isIE9orHigher()?0:1,resizable:1,copyhistory:1,scrollbars:1,alwaysRaised:false,alwaysLowered:false,widthOffset:8,heightOffset:164,delayLoad:false},initialize:function(f,d){this.setOptions(d);this.type=f;this.assignSlot();if(this.options.customWidth){this.width=this.options.customWidth}if(this.options.customHeight){this.height=this.options.customHeight}if(this.options.widthOffset!=null){this.widthOffset=this.options.widthOffset}if(this.options.heightOffset!=null){this.heightOffset=this.options.heightOffset}if(this.options.delayLoad){this.delayLoad=this.options.delayLoad}if(this.options.windowHook){this.windowObject=this.options.windowHook;if(!ta.has("checkrates.add_holding_windows")){this.windowObject.refresh()}return true}if(ta.has("checkrates.chrome_dates_entry_holding")){this.options.scrollbars=0}this.url=this.options.url;this.assignWinArgs();try{if(this.type==ta.popups.PopUtil.windowType.HOLDING){ta.util.cookie.setPIDCookie(28962)}if(ta.has("checkrates.use_chrome_provider_on_shift_click")){var c=document.createElement("a");c.href=this.url;document.body.appendChild(c);var b=document.createEvent("MouseEvents");b.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,true,false,0,null);this.windowObject=c.dispatchEvent(b);c.parentNode.removeChild(c)}else{if(this.type==ta.popups.PopUtil.windowType.HOLDING&&ta.has("popunder.popunder_by_self_focus")){window.open("javascript:window.focus()","_self","")}this.windowObject=window.open("","_blank",this.winArgs);var a=this.windowObject;if(a&&this.isTAWindow()){if(!this.delayLoad){a.location=this.url}}}}catch(g){this.errorOpening=g;ta.util.error.record(this.errorOpening,"pop window opening failure",null,{type:this.type,url:this.url})}try{var a=this.windowObject;if(a&&this.isTAWindow()){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.moveBehindMain(a)}}}catch(g){this.errorMoving=g;ta.util.error.record(this.errorMoving,"popunder window moving",null,{type:this.type,url:this.url})}},repurpose:function(d,b,f){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.type=ta.popups.PopUtil.windowType.CHECK_RATE;this.slot.occupied=false;this.assignSlot();this.url=d;if(b){this.width=b;this.options.widthOffset=0}if(f){this.height=f;this.options.heightOffset=0}var a=this.windowObject;if(a&&this.isTAWindow()){try{a.moveTo(0,0);a.resizeTo(this.width+this.options.widthOffset,this.height+this.options.heightOffset);a.moveTo(this.x,this.y);if(!this.delayLoad){a.focus()}if(!this.delayLoad){a.location=this.url}}catch(c){ta.util.error.record(this.errorMoving,"repurpose popunder fail",null,{type:this.type,url:this.url})}}return this}return false},assignWinArgs:function(){this.winArgs="toolbar="+this.options.toolbar;this.winArgs+=",location="+this.options.location;this.winArgs+=",directories="+this.options.directories;this.winArgs+=",status="+this.options.status;this.winArgs+=",menubar="+this.options.menubar;this.winArgs+=",resizable="+this.options.resizable;this.winArgs+=",copyhistory="+this.options.copyhistory;this.winArgs+=",scrollbars="+this.options.scrollbars;this.winArgs+=",width="+this.width;this.winArgs+=",height="+this.height;this.winArgs+=",left="+this.x;this.winArgs+=",top="+this.y;this.winArgs+=",screenx="+this.x;this.winArgs+=",screeny="+this.y;if(this.options.alwaysRaised){this.winArgs+=",alwaysRaised"}if(this.options.alwaysLowered){this.winArgs+=",alwaysLowered"}},assignSlot:function(){if(this.type==ta.popups.PopUtil.windowType.HOLDING){this.slot=ta.popups.PopUtil.getPopunderSlots().getOpenSlot();this.width=this.slot.tw;this.height=this.slot.th;this.x=this.slot.tx;this.y=this.slot.ty}else{this.slot=ta.popups.PopUtil.getPopupSlots().getOpenSlot();this.width=this.slot.w+this.options.widthOffset;this.height=this.slot.h+this.options.heightOffset;this.x=this.slot.x;this.y=this.slot.y}this.slot.occupied=this},moveBehindMain:function(c){if(!ta.has("popunder.popunder_by_self_focus")||ta.has("popunder.popunder_by_self_focus_shift_ctrl")){if(ta.has("checkrates.cr_popunder_by_shift_ctrl")&&Browser.version>23){ta.popups.PopUtil.openCloseTab()}else{if(ta.has("checkrates.chrome_dates_entry_holding")&&!(ta.has("checkrates.belligerent_hw")&&Browser.version>22)){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"holdingWindow - Chrome blur failed")}}}}c.blur();c.opener=self;c.moveTo(this.slot.x,this.slot.y);c.resizeTo(this.slot.w,this.slot.h);if(!this.delayLoad){c.location=this.url}window.focus();if(!document.activeElement.hasClass("globalNav2011_reset")){ta.trackEventOnPage("checkrates","no_focus_on_main",Browser.version,1)}},isTAWindow:function(){var c=true;try{var a=this.windowObject.location;this.windowObject.status="";if(a==null||a==""){c=false}}catch(b){c=false}return c}});ta.popups.Slot=new Class({initialize:function(c,b,d,a){this.x=c;this.y=b;this.w=d;this.h=a;this.occupied=null}});ta.popups.SlotSet=new Class({initialize:function(){this.nW=525;this.nH=460;this.nXI=24;this.nYI=24;this.totalSlots=20;this.slots=[];try{if(screen.width>1024){this.nW=800;this.nH=600;this.nXI=80;this.nYI=40}else{if(screen.width>800){this.nW=620;this.nH=500;this.nXI=60;this.nYI=30}}}catch(a){this.error=a;ta.util.error.record(this.error,"slot set",null,{"slot set":"general"})}},getUsedCount:function(){var b=0;if(this.slots){for(var a=0;a<this.slots.length;a++){if(this.slots[a].occupied&&!this.slots[a].occupied.closed){b++}}}return b},getOpenSlot:function(f){if(!f||f<0||f>this.totalSlots){f=0}var d=function(m){try{var h=false;var k=false;try{k=this.slots[m].occupied}catch(l){}if(!k){h=true}else{try{var g=k.windowObject;if(!g||g.closed){h=true}}catch(l){h=true}}}catch(l){ta.util.error.record(l,"get open slot - get pop slot",null,{totalSlots:this.totalSlots,slotNumber:m})}if(h){this.slots[m].occupied=null;var j=this.slots[m];j.slotPos=m;return j}return false}.bind(this);try{for(var a=f-1;a>=0;a-=1){var c=d(a);if(c){return c}}for(var a=f;a<this.slots.length;a++){var c=d(a);if(c){return c}}}catch(b){ta.util.error.record(b,"get open slot",null,{totalSlots:this.totalSlots})}return false}});ta.popups.PopunderSlot=new Class({Extends:ta.popups.Slot,initialize:function(b,k,d,g,c,a,f,j){this.parent(b,k,d,g);this.tx=c;this.ty=a;this.tw=f;this.th=j}});ta.popups.PopupSlotSet=new Class({Extends:ta.popups.SlotSet,initialize:function(){this.parent();this.nX=500;var b=1160;try{if(screen.width<1660){if(screen.width>1024&&screen.width<1280){b=960}else{if(screen.width<=1024){b=740}}this.nX=screen.width-b}this.nY=!isNaN(window.screenTop)?window.screenTop:!isNaN(window.screenY)?window.screenY:0}catch(c){this.error=c;this.nY=0;ta.util.error.record(this.error,"slot set",null,{"slot set":"popup"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.Slot(this.nX,this.nY,this.nW,this.nH);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});ta.popups.PopunderSlotSet=new Class({Extends:ta.popups.PopupSlotSet,initialize:function(){this.parent();try{this.nX=(window.screenLeft||window.screenX);this.nY=(window.screenTop||window.screenY)}catch(b){this.error=b;this.nX=200;this.nY=200}this.w=1;this.h=1;this.x=5000;this.y=5000;this.totalSlots=4;try{if(Browser.ie7){this.w=250;this.h=100}if(Browser.safari||Browser.chrome){this.w=85;this.h=100}if(typeof(this.nX)=="undefined"){this.nX=0;this.nY=0;this.x=this.nX+window.screen.availWidth-this.w;this.y=this.nY+window.screen.availHeight-this.h}else{this.x=this.nX+window.getWidth()-this.w;this.y=this.nY+window.getHeight()-this.h}if(Browser.ie7){this.y=this.y-95;this.x=this.x+13}else{if(Browser.safari||Browser.chrome){this.y=this.y-16}}}catch(b){this.error=b}if(this.error){ta.util.error.record(this.error,"slot set",null,{"slot set":"popunder"})}for(var a=0;a<this.totalSlots;a++){this.slots[a]=new ta.popups.PopunderSlot(this.nX,this.nY,this.nW,this.nH,this.x,this.y,this.w,this.h);this.nX=this.nX+this.nXI;this.nY=this.nY+this.nYI}}});(function(a){a.mobfull.Interstitial={hiddenNodes:[],monthViews:"ipadPopup_istMonthViews",monthDatestamp:"ipadPopup_istMonthDatestamp",pageViews:"ipadPopup_istPageViews",datestampe:"ipadPopup_istDatestamp",dayViews:"ipadPopup_istDayViews",dayDatestamp:"ipadPopup_istDayDatestamp",totalViews:"ipadPopup_istTotalViews",nvrShw:"ipadIntstNvrShw",intstShown:"ipadIntstShown",testVal:"ipadIntstTest",canUseLocalStore:function(){return a.util.localstorage&&a.util.localstorage.canUseLocalStore()},getViewsInTime:function(h,b,c){var f=null,g=null;try{f=parseInt(localStorage.getItem(b));g=parseInt(localStorage.getItem(h))}catch(d){}if(f===null||isNaN(f)||g===null||isNaN(g)||f<c){return 0}return g},updateMonthlyViews:function(c){try{localStorage.removeItem(this.monthViews);localStorage.removeItem(this.monthDatestamp);localStorage.setItem(this.monthViews,c);localStorage.setItem(this.monthDatestamp,new Date().getTime()/1000)}catch(b){}},getMonthlyViews:function(){return this.getViewsInTime(this.monthViews,this.monthDatestamp,(new Date().getTime()/1000)-2592000)},updatePageview:function(c){try{localStorage.removeItem(this.pageViews);localStorage.removeItem(this.datestamp);localStorage.setItem(this.pageViews,c);localStorage.setItem(this.datestamp,new Date().getTime()/1000)}catch(b){}},getPageviews:function(){return this.getViewsInTime(this.pageViews,this.datestamp,(new Date().getTime()/1000)-1800)},getDailyViews:function(){return this.getViewsInTime(this.dayViews,this.dayDatestamp,(new Date().getTime()/1000)-86400)},updateDailyViews:function(b){try{localStorage.removeItem(this.dayViews);localStorage.removeItem(this.dayDatestamp);localStorage.setItem(this.dayViews,b);localStorage.setItem(this.dayDatestamp,new Date().getTime()/1000)}catch(c){}},getTotalViews:function(){var b=null;try{b=parseInt(localStorage.getItem(this.totalViews))}catch(c){}if(b===null||isNaN(b)){return 0}return b},updateTotalViews:function(c){try{localStorage.removeItem(this.totalViews);localStorage.setItem(this.totalViews,c)}catch(b){}},showInterstitialFirst:function(f,c){var p=false,b=4,g=31,d=2,k=100,h,l,m,o;if(!this.canUseLocalStore()){return false}try{p=localStorage.getItem(this.nvrShw)=="1"}catch(j){}if(p){return}h=this.getTotalViews();l=this.getMonthlyViews();m=this.getDailyViews();o=this.getPageviews();this.updatePageview(o+1);if(o%b==0&&l<g&&m<d&&h<k){this.updateDailyViews(m+1);this.updateMonthlyViews(l+1);this.updateTotalViews(h+1);if(m==0){this.showPromo(f,false)}else{this.showPromo(c,false)}}},showInterstitial:function(b,d){var g=false,f;if(!this.canUseLocalStore()){return false}f=this.getPageviews();try{g=localStorage.getItem(this.nvrShw)==="1"}catch(c){}this.updatePageview(f+1);if(b==null||b==""||g){return}this.showPromo(b,d);try{localStorage.removeItem(this.intstShown);localStorage.setItem(this.intstShown,"1")}catch(c){}},showPromo:function(b,c){new Request({url:"/IpadInterstitial?pd="+b,onSuccess:function(f,h){var d=document.getElementsByTagName("body")[0],j,l,g,m,k;if(!c){for(j in d.childNodes){k=d.childNodes[j];if(typeof(k.style)!=="undefined"&&k.style.hidden!=="none"){k.style.display="none";a.mobfull.Interstitial.hiddenNodes.push(k)}}}else{l=document.createElement("div");l.id="intstShadow";g=document.body.offsetHeight;l.style.height=g+"px";d.appendChild(l)}m=document.createElement("div");m.id="ipadIntstWrap";m.innerHTML=f;d.appendChild(m)},method:"get"}).send()},hideInterstitial:function(g,b){var f=$("intstShadow"),h,d,c;if(f!==null){f.parentNode.removeChild(f)}h=$("ipadIntstWrap");if(h!==null){if(g){new Request({url:"/ActionRecord?action=hideInterstitial"+pageServlet+"&pid="+b}).send()}h.parentNode.removeChild(h);d=a.mobfull.Interstitial.hiddenNodes;for(c in d){if(typeof(d[c].style)!=="undefined"){d[c].style.display=""}}a.mobfull.Interstitial.hiddenNodes=[]}},neverShowInt:function(){this.hideInterstitial(false,null);try{localStorage.removeItem(this.nvrShw);localStorage.setItem(this.nvrShw,"1")}catch(b){}},downloadedApp:function(b){var d=10*365*24*60*60,c=window.location.pathname+window.location.search+window.location.hash;Cookie.write("TAMbDlApp","1",{domain:cookieDomain,time:d});if(b){Cookie.write("TAMnMcid",b,{domain:cookieDomain,time:d})}Cookie.write("TAMsPIU",c,{domain:cookieDomain,time:600})}}}(ta));window.setupLazyLoad=function(){var a=new LazyLoad({range:200},lazyImgs,lazyHtml);return a};var LazyLoad=new Class({Implements:[Options,Events],options:{range:200,fireScroll:true,mode:"vertical"},initialize:function(p,m,q){this.setOptions(p);this.container=window;var b=(this.options.mode=="vertical"?"y":"x");this.containerDimension=this.container.getSize()[b];this.start=0;var l=this.containerDimension+this.options.range;var k=ta.retrieve("ta.commerce.obf");if(k){try{var h=k.given.split("");var f=k.replace.split("");var d=k.token}catch(j){ta.util.error.record(j,"obfuscation object corrupted")}}var o=0;this.htmlBlocks=q.filter(function(t){var s=ta.id(t.id);if(s&&(s.getPosition()[b]>l&&t.scroll)){o++;return true}else{if(s){try{var w=t.data.indexOf(d);if(k&&w==0){var u=t.data.substr(d.length).split("");for(var r=u.length;r--;){var v=u[r];var w=f.indexOf(v);if(w!=-1){u[r]=h[w]}}s.innerHTML=u.join("")}else{s.innerHTML=t.data}}catch(y){ta.util.error.record(y,"lazy html",null,{id:t.id})}return false}else{return false}}},this);var c=0;this.images=m.filter(function(s){var r=ta.id(s.id);if(r){r.oSRC=s.src||s.data;r.priority=s.priority||1000;if((!r.isVisible()||r.getPosition()[b]>l)&&s.scroll){c++;return true}else{ta.queueLazyImg(r);return false}}else{return false}},this);ta.processLazyImages();var a=function(){var r=this.getScroll();if(r>this.start){this.load();this.start=r}this.fireEvent("scroll");if(!this.images.length){this.container.removeEvent("scroll",a);this.fireEvent("complete")}}.bind(this);this.load=function(){this.htmlBlocks=this.htmlBlocks.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){r.innerHTML=s.data;return false}}catch(t){ta.util.error.record(t,"lazy",null,{id:s.id})}return true},this);this.images=this.images.filter(function(s){try{var r=ta.id(s.id);if((r&&r.getPosition&&((this.getScroll()+this.options.range+this.containerDimension)>=r.getPosition()[b]))||(r&&!r.getPosition)){ta.queueLazyImg(r);return false}}catch(t){ta.util.error.record(t,"lazy",null,{src:s.src})}return true},this);ta.processLazyImages()}.bind(this);var g=function(){var r=this.container.getSize()[b];if(r>this.containerDimension){this.containerDimension=r;this.load()}}.bind(this);this.container.addEvent("scroll",a);this.container.addEvent("resize",g);if(this.options.fireScroll){this.container.fireEvent("scroll")}},getScroll:function(){if(this.container&&this.container.getScroll){return this.container.getScroll()[this.options.mode=="vertical"?"y":"x"]}else{return 9000}}});var sTAMGFooterCookieName="hideTAMGFooter";var sFooterDivId="TM_FTR";var hmOngoingHover={};var savedDomain="tripadvisor.com";if(typeof cookieDomain!="undefined"){savedDomain=cookieDomain.substring(1,cookieDomain.length)}function _closeOverlay(){var a=ta.retrieve("overlays.current");if(a){a.hide()}}function setTAMGFooterCookie(d,c){var b=new Date();b.setTime(b.getTime());var f=1000*60*60*24*7;var a=new Date(b.getTime()+(f));document.cookie=sTAMGFooterCookieName+"="+escape(d)+";expires="+a.toGMTString()+";path=/"+((savedDomain)?";domain="+savedDomain:"");hideFooter(c)}function openUrl(b){var a=window.open(b);a.opener=null}function getTAMGFooterCookie(){var f=document.cookie.split(";");var a="";var c="";var d="";var b=false;for(i=0;i<f.length;i++){a=f[i].split("=");c=a[0].replace(/^\s+|\s+$/g,"");if(c==sTAMGFooterCookieName){b=true;if(a.length>1){d=unescape(a[1].replace(/^\s+|\s+$/g,""))}return d;break}a=null;c=""}if(!b){return null}}function hideFooter(b){if(!b){b=sFooterDivId}var a=document.getElementById(b);if(a){a.style.display="none"}}function tamgShowFly(c,d,b,a){hmOngoingHover[d]=true;setTimeout(function(){if(hmOngoingHover[d]){tamgCreateFly(c,b,a)}},250)}function tamgHideFly(a,c,b){var d=b.toElement||b.relatedTarget;while(d&&d!=a){d=d.parentNode}if(d!=a){hmOngoingHover[c]=false;setTimeout(function(){if(hmOngoingHover[c]==false){$$("."+c)[0].hide()}},250)}}function tamgCreateFly(h,k,f){var g=$(h).getElements(".ftrFly")[0];if($(g).getElements("img")[0]){g.show()}else{var l=CDNHOST+"/img2/x.gif";var j="ftrFlyLogo "+k;var d=new Element("img",{"class":j,src:l}).inject(g,"top");d.setProperty("height","25");d.setProperty("width",f);var c=new Element("div",{"class":"triWrap"});var b=new Element("span",{"class":"cssTri"});var a=new Element("span",{"class":"cssTri"});b.inject(a);a.inject(c);c.inject(g,"bottom");g.show()}}function getTAMGFooterViaAjax(d,c,a,b,f){new Request({url:"/TAMGFooterAjax",onSuccess:function(j){ta.id("TAMGFooterHolder").innerHTML=j;var h="RuleBasedFooter_"+f;if(d&&d=="RBF_Meta_Footer"){var g=Cookie.read("minTAMGFooter");ta.trackEventOnPage("meta_footer",(g)?"collapsed":"open","");new Asset.javascript(ta.retrieve("meta_footer_js"),{onLoad:function(){ta.commerce.metafooter.loadPriceData();ta.commerce.metafooter.bindFlyouts();ta.commerce.metafooter.maybeHideCompare()}})}else{ta.trackEventOnPage("Footer","OpenFooter",h,1,true)}},data:{a:"SHOW_FOOTER",dis:d,loc:c,"new":a,serv:b},evalScripts:true,method:"get"}).send()}function getFullDisclaimerText(){new Request({url:"/TAMGFooterAjax",onSuccess:function(b){try{ta.id("PDISCLAIMER").innerHTML=b}catch(a){ta.util.error.record(a,"Fail to find element (id PDISCLAIMER)")}},data:{a:"SHOW_FULL_DISCLAIMER"},evalScripts:true,method:"get"}).send()}ta.servlet.Member={memberBenefitsSubscribe:function(a){ta.servlet.Member.processMOSubscribeRequest(a);return false},memberGuideRequest:function(a){processGuideRequest(a)},memberTOGForm:function(a){processTOGForm(a)},processMOSubscribeRequest:function(a){if(!loggedIn){new Event(a).preventDefault();return false}var d=$("MEMONLY_SUBS_FORM");d.elements.action.value="subscribe";var c={url:"/TravelGuides",data:d,onFailure:function(f){alert(f.status+"\n"+f.responseText)}};c.onSuccess=ta.servlet.Member.subscribeRequestResFunc;var b=window["validate"+d.id];new Event(a).preventDefault();new Request(c).send()},subscribeRequestResFunc:function(a){if(a!=""){for(subtype in subtypes){if(subtyperes[subtype].test(a)){if(subtype=="tw"&&ta.retrieve("tcd.refresh")){window.location.reload()}var h=document.getElementById(subtype+"Optin");h.setAttribute("checked","true");h.setAttribute("disabled","true");var c=document.getElementById(subtype+"OptinLbl");c.innerHTML="<b>"+headings[subtype]+"</b> "+tamg_thanks;var g=document.getElementById("OPTINTEXT");g.style.display="none"}}var l={};for(subtype in subtypes){var d=document.getElementById(formids[subtype]);l[subtype]=d.checked}var j=true;var k=true;for(subtype in l){if(subtyperes[subtype].test(a)){j=false}if(!l[subtype]){k=false}}if(k){var f=document.getElementById("NLSUBMITDIV");f.style.display="none"}if(j){var b=document.getElementById("OPTINTEXT");b.innerHTML='<div class="alert">'+no_selection_error+"</div>";b.style.display="block"}}},addTripWatchLocation:function(event,elmt,updateTxt){var mElmt=new Element(elmt);new Event(event).stop();new Request({url:elmt.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocation"),onSuccess:function(txt,xml){if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){ta.overlays.showInLightbox(data.ERROR);return}else{if(data.ALERT){ta.overlays.showInLightbox(data.ALERT);return}}}var spanElt=new Element("span");spanElt.set("html",updateTxt);mElmt.hide();spanElt.inject(mElmt,"after")}}).send()},addTripWatchLocationReload:function(a){new Request({url:a.href,onFailure:ta.util.error.ajaxFailure.partial("Member:addTripWatchLocationReload"),onSuccess:function(b,c){window.location.reload()}}).send()}};ta.servlet.Tourism={currentGeo:0,currentChildPage:1,bbOfferClicked:function(b,a){b.preventDefault();a=$(a);if(a.get("tag")!="tr"||!a.hasClass("offerRow")){a=a.getParent("tr.offerRow")}offerLink=a.getElement("a");popCommFN=linkMap.js_popComm;popCommFN(offerLink,b)},showGeoDescription:function(b,a){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 dg descriptionLB",content:"<p>"+ta.id("DESCRIPTION_TEXT").innerHTML+"</p>"})},showNextChildPage:function(a){ta.servlet.Tourism.currentChildPage++;ta.servlet.Tourism.showChildPage()},showPreviousChildPage:function(a){ta.servlet.Tourism.currentChildPage--;ta.servlet.Tourism.showChildPage()},showChildPage:function(){if(ta.id("TOURISM_POPULAR_CITIES")){new Request({url:"/TourismChildrenAjax?geo="+ta.servlet.Tourism.currentGeo+"&offset="+(ta.servlet.Tourism.currentChildPage-1),onSuccess:function(a){ta.id("TOURISM_POPULAR_CITIES").innerHTML=a}}).send()}},styleButtonOver:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBack")){ta.id(a.target).removeClass("sprite-hotelStyleBack");ta.id(a.target).addClass("sprite-hotelStyleBackHover")}},styleButtonOut:function(a){if(ta.id(a.target).hasClass("sprite-hotelStyleBackHover")){ta.id(a.target).removeClass("sprite-hotelStyleBackHover");ta.id(a.target).addClass("sprite-hotelStyleBack")}},makeTextFit:function(c,q,s,b){b=b||1;var h=false;var k=ta.select(c);for(var l=0;l<k.length;l++){var f=k[l].getElement(s);var o=k[l].getElement(q);var a=f.getSize();var j=o.getSize();if(a.y<j.y){var r=o.getStyle("font-size");if(r){var d=function(u,t){return(t=="px"&&u>8)||(t=="em"&&u>=0.5)||(t=="pt"&&u>6)||(t=="%"&&u>=50)};var m=r.replace(/[\d\.]/g,"");var g=parseFloat(r)*Math.sqrt(a.y/j.y);if(m=="px"){g=parseInt(g)}if(d(g,m)){o.setStyle("font-size",g+m);h=true}}}}if(h>0&&b<4){var p=this;setTimeout(function(){p.makeTextFit(c,q,s,b+1)},1)}},parseHashParams:function(c){var b={};try{var a=c.indexOf("#");if(a>-1){var g=c.substr(a+1).split("&");for(var f=0;f<g.length;f++){var j=g[f].split("=");var d=j[0];if(d!=null&&d!=""){b[d]=j[1]}}}}catch(h){ta.util.error.record(h,"Error parsing hash params in ta.servlet.Tourism.parseHashParams.")}return b}};ta.widgets.slider={handleSeparation:10,isRtl:function(){return ta.util.i18n.isRtl()},getValue:function(c,b){var a="";if(this.isRtl()){if(c.style.right&&c.style.right.trim()!=""){a=c.style.right}else{a=b.style.left}}else{a=c.style.left}if(a!=""){return a.toFloat()}return 0},resetHooks:function(f){var d=f.hasClass("slider_redesign")?f:f.getElement(".slider_redesign");var c=d.className;var b=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));var a=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));return this.setHooks(f,b,a)},setHooks:function(t,f,h,d,g){var p=t.hasClass("slider_redesign")?t:t.getElement(".slider_redesign");var j=p.className;var r=parseInt(j.match(/steps_(\d+)/)[1]);var m=parseFloat((j.match(/min_(\d+)/)[1]).replace("_","."));if(d&&m!=d){p.removeClass("min_"+m);p.addClass("min_"+d);m=d}var q=parseFloat((j.match(/max_(\d+)/)[1]).replace("_","."));if(g&&q!=g){p.removeClass("max_"+q);p.addClass("max_"+g);q=g}if(f<m){f=m}if(h>q){h=q}var k=parseInt(j.match(/width_(\d+)/)[1])-this.handleSeparation;var c=p.hasClass("maxAllInclusive");var s=k/(r-1);var a=(q-m)/(r-1);var o=(f-m)/a;var u=(h-m)/a;this.updateEnd(p.getElement(".handle-left"),this.isRtl()?u:o,s,true);this.updateEnd(p.getElement(".handle-right"),this.isRtl()?o:u,s,false);this.updateBar(p.getElement(".slider-range"),o,u,s,"set");var b=c&&(h>=q);if(p.id=="priceSelect"){this.priceUpdate(t,f,h,b)}else{if(p.id=="ratingSelect"){this.ratingUpdate(t,f,h,b)}else{if(p.id=="bedroomsSelect"){this.bedroomsUpdate(t,f,h,b)}else{this.simpleUpdate(t,f,h,b)}}}var w=t.getElement(".minMax");var v=w.value;var l=this.updateMinMax(w,o,u,a,r,m);return v!=l},updateMinMax:function(g,h,b,a,c,f){var d=(h<=0?0:h*a+f)+","+(b>=(c-1)?999999:b*a+f);g.value=d;return d},updateEnd:function(d,c,f,b){var a=c*f+(this.isRtl()^b?0:this.handleSeparation);if(this.isRtl()){d.setStyle("right",a+"px");d.setStyle("left","")}else{d.setStyle("left",a+"px");d.setStyle("right","")}return a},updateBar:function(b,h,d,g){if((h>d)){h^=d;d^=h;h^=d}var a=h*g;var c=(d*g+this.handleSeparation)-a;if(c<0){c*=-1}var f=this.isRtl()?"right":"left";if(this.isRtl()){b.setStyle("right",a)}else{b.setStyle("left",a)}b.setStyle("width",c)},initSliderInfo:function(f){var d={};var c=f.className;d.width=parseInt(c.match(/width_(\d+)/)[1])-this.handleSeparation;d.steps=parseInt(c.match(/steps_(\d+)/)[1]);d.min=parseFloat((c.match(/min_(\d+)/)[1]).replace("_","."));d.max=parseFloat((c.match(/max_(\d+)/)[1]).replace("_","."));d.stepSize=(d.max-d.min)/(d.steps-1);d.maxAllInclusive=f.hasClass("maxAllInclusive");d.snapDistance=d.width/(d.steps-1);d.rangeBar=f.getElement(".slider-range");d.minMax=f.getElement(".minMax");d.startMinMax=d.minMax.value;d.singleValue=f.hasClass("singleValue");var g=f.getParent().getElement(".handle-left");var b=f.getParent().getElement(".handle-right");var h=this.getValue(g,b);var a=this.getValue(b,g);if(this.isRtl()){h-=this.handleSeparation}else{a-=this.handleSeparation}d.leftStep=this.getClosestStep(h,d);d.rightStep=this.getClosestStep(a,d);return d},setSliderTarget:function(b,a){if(b.hasClass("handle-left")){a.target=b.getParent().getElement(".handle-left");if(this.isRtl()){a.limits=[a.rightStep+(a.singleValue?0:1),a.steps-1]}else{a.limits=[0,a.rightStep-(a.singleValue?0:1)]}a.isLeftHook=true}else{a.target=b.getParent().getElement(".handle-right");if(this.isRtl()){a.limits=[0,a.leftStep-(a.singleValue?0:1)]}else{a.limits=[a.leftStep+(a.singleValue?0:1),a.steps-1]}a.isLeftHook=false}return a},handleMouseDown:function(f,a){var d=new Event(f);if(d){d.stop();var c=ta.id(d.target);if(c){var b=this.initSliderInfo(c.getParent());b=this.setSliderTarget(c,b);b.snapCallBack=a.bind(this);b.dragHandle=this.handleMouseMove.bind(this);b.upHandle=this.handleMouseUp.bind(this);document.addListener("mousemove",b.dragHandle);document.addListener("mouseup",b.upHandle);document.addListener("touchmove",touchHandler);document.addListener("touchend",touchHandler);b.offset=c.getParent().getCoordinates().left+10+(b.isLeftHook?0:this.handleSeparation);ta.store("slider_info",b)}}},getClosestStep:function(a,b){return Math.round(a/b.snapDistance)},handleMouseMove:function(d){d=new Event(d);var b=ta.retrieve("slider_info");if(b&&b.target){var c=d.page.x-b.offset;var a=this.getClosestStep(c,b);if(this.isRtl()){a=b.steps-a-1}if(a<b.limits[0]){a=b.limits[0]}else{if(b.limits[1]<a){a=b.limits[1]}}this.sliderDrag(d,a,b,c)}d.stop()},sliderDrag:function(d,g,k,j){if(d){d.stop();var a=k.isLeftHook?g:k.leftStep;var h=k.isLeftHook?k.rightStep:g;this.updateEnd(k.target,g,k.snapDistance,k.isLeftHook);this.updateBar(k.rangeBar,a,h,k.snapDistance);this.updateMinMax(k.minMax,a,h,k.stepSize,k.steps,k.min);ta.store("slider_info",k);if(k.snapCallBack){var b=(this.isRtl()?h:a)*k.stepSize+k.min;var f=(this.isRtl()?a:h)*k.stepSize+k.min;var c=k.maxAllInclusive&&(f==(k.steps-1)*k.stepSize+k.min);k.snapCallBack(k.target,b,f,c)}}},handleMouseUp:function(b){b=new Event(b);if(b){b.stop()}var a=ta.remove("slider_info");if(a){document.removeListener("mousemove",a.dragHandle);document.removeListener("mouseup",a.upHandle);document.removeListener("touchmove",touchHandler);document.removeListener("touchend",touchHandler);a.dragHandle=null;a.upHandle=null;if(a.minMax.value!=a.startMinMax){sliderMoved()}}},currencyUpdate:function(){var b=ta.id("l1currency");if(!b){return}var g=ta.retrieve("ta.currencyHash");if(!g){return}var j=g[parseInt(b.value)];var m=ta.id("pricePeriod_w");if((m!=null)&&m.checked){var l=ta.retrieve("ta.weekCurrencyHash");if(l){j=l[parseInt(b.value)]}}var k=ta.id("priceSelect").getParent();var a=k.getElement(".slider_redesign");var h=a.className;var d=currencyCodes[parseInt(k.getElement("select").value)];var c=ta.has("hacform.slider.price.min")?ta.remove("hacform.slider.price.min"):j.selMin;var f=ta.has("hacform.slider.price.max")?ta.remove("hacform.slider.price.max"):j.selMax;a.className=h.replace(/steps_\d+/,"steps_"+j.steps);ta.widgets.slider.setHooks(k,c,f,j.min,j.max)},priceUpdate:function(g,d,b,a){if(!g.hasClass("prcRng")){g=g.getParent(".prcRng")}var h=ta.id("l1currency");var f=currencyCodes[parseInt(h.value)];g.getElement(".s_min").innerHTML=ta.util.currency.formatCurrency(d,f);var c=ta.util.currency.formatCurrency(b,f);if(a){c+="+"}g.getElement(".s_max").innerHTML=c},ratingUpdate:function(h,f,c,b){if(!h.hasClass("tvrRtg")){h=h.getParent(".tvrRtg")}var a=f.toPrecision(2);var j=c.toPrecision(2);h.getElement(".s_min").innerHTML=a;h.getElement(".s_max").innerHTML=j;var d=h.getElement(".sLeft .lmtImg").src;h.getElement(".sLeft .lmtImg").src=d.replace(/\d.\d/,a);var g=h.getElement(".sRight .lmtImg").src;h.getElement(".sRight .lmtImg").src=g.replace(/\d.\d/,j)},bedroomsUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=(c==0?js_filter_studio:c);d.getElement(".s_max").innerHTML=(b==0?js_filter_studio:(b+(a?"+":"")))},simpleUpdate:function(d,c,b,a){if(d.tagName!="FIELDSET"){d=d.getParent("FIELDSET")}d.getElement(".s_min").innerHTML=c;d.getElement(".s_max").innerHTML=b+(a?"+":"")}};function touchHandler(c){var d=c.changedTouches,f=d[0],a="";switch(c.type){case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var b=document.createEvent("MouseEvent");b.initMouseEvent(a,true,true,window,1,f.screenX,f.screenY,f.clientX,f.clientY,false,false,false,false,0,null);f.target.dispatchEvent(b);c.preventDefault()}(function(){var b=new Class({Implements:[Options,Events],URL_SAVE_CONTROLLER:"/SavesAjax",parentName:null,parentFolderId:0,locationId:0,guideId:0,savedItems:{},sessionSavedItems:[],options:{feature_saves_ungating:false,savesTree:null},initialize:function(c){this.setOptions(c);if(this.options.savesTree){this.setSavesTree(this.options.savesTree)}this.addEvent("saveComplete",this.trackSuccessfullSave)},refresh:function(c){this.setOptions(c);if(this.options.savesTree){this.setSavesTree(this.options.savesTree)}},openSavesHoverRegflow:function(c){ta.trackEventOnPage("HoverSave","saveIntent",ta.widgets.Saves.locationId,1,false);ta.store("registration.ga_module","SavesHover");ta.overlays.registration.connect({flow:"SAVES_HOVER"},"SIGNUP")},openMastheadRegflow:function(c){ta.store("registration.ga_module","Masthead");ta.overlays.registration.connect({flow:"MASTHEAD"},"SIGNUP")},trackSuccessfullSave:function(f,c,d){if(!f){return}ta.trackEventOnPage("HoverSave","saveComplete",c,1,false);new Request({url:"/ActionRecord?action=Save_Completed"}).send()},setSavesTree:function(){},getSavesTree:function(c){if(this.options.savesTree&&!c){return this.options.savesTree}else{}},saveCall:function(f,c){var h=this;this.entityType=f;this.locationId=c;for(index in this.sessionSavedItems){if(this.locationId==this.sessionSavedItems[index]){this.showSaved();return}}var g={action:"SAVE_ITEM",entity:this.locationId,type:f};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:g,onSuccess:function(j){var m=false;j=JSON.decode(j);if(!j){return}if(j.error){if(j.error=="DUPITEM"){h.fireEvent("saveComplete",[m,c])}var k={name:"saves save item",message:(j&&j.error?j.error:"Error while calling SAVE_ITEM with locationId: "+c+" and entityType: "+f+".")};ta.util.error.record(k,"saveCall");return}else{m=true}var l=null;if(m&&j.id){itemId=j.id;if(itemId<-3){ta.run("ta.overlays.Factory.openMastheadRegflow")}}h.fireEvent("saveComplete",[m,c,itemId,j.folderid,h.btn]);h.locationId=0;h.btn=null}}).send();return d},unsaveCall:function(g,c){var h=this;var f={action:"DELETE_ITEM",id:g};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(k){var j=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){j=true}else{var l={name:"saves unsave item",message:(k&&k.error?k.error:"Unknown error while deleting : "+g)};ta.util.error.record(l,"unsaveCall")}}h.fireEvent("unsaveComplete",[k,g,c])}}).send();return d},saveGuideCall:function(c){var f=this;var d={action:"SAVE_GUIDE",guideid:c};new Request({url:this.URL_SAVE_CONTROLLER,data:d,onSuccess:function(h){var l=true;var k=null;var g=null;h=JSON.decode(h);if(!h||h&&h.error){l=false;var j={name:"saves save guide",message:(h&&h.error?h.error:"Unknown error while saving guide : "+c)};ta.util.error.record(j,"saveGuideCall")}else{var k=h.folder;var g=h.items}this.guideId=0;f.fireEvent("saveGuideComplete",[l,k,g]);ta.trackEventOnPage("GuideSave","saveComplete",c,1,false);new Request({url:"/ActionRecord?action=Guide_Save_Completed"}).send()}}).send()},getSavesCall:function(d){var f=this;var c={action:"FETCH_ITEMS"};if(!d&&this.options.savesTree){f.fireEvent("retrievedSaves",[this.options.savesTree])}new Request({url:this.URL_SAVE_CONTROLLER,data:c,method:"get",onSuccess:function(g){var j=true;g=JSON.decode(g);if(!g||g&&g.error){j=false;var h={name:"saves get saves",message:(g&&g.error?g.error:"Unknown error while fetching items.")};ta.util.error.record(h,"getSavesCall")}else{f.savedItems=g}f.fireEvent("retrievedSaves",[g])}}).send()},moveCall:function(h,c,f){var j=this;var g={action:"MOVE_ITEM",id:h,folder:c};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:g,onSuccess:function(k){var l=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){l=true}else{var m={name:"saves move item",message:(k&&k.error?k.error:"Unknown error while moving : "+h)};ta.util.error.record(m,"moveCall")}}j.fireEvent("moveComplete",[k,h,c,f])}}).send();return d},addNoteCall:function(g,c,j){var h=this;var f={action:"ADD_NOTE",id:g,note:c};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(k){var m=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){m=true}else{var l={name:"saves add note",message:(k&&k.error?k.error:"Unknown error while adding note to : "+g)};ta.util.error.record(l,"addNoteCall")}}h.fireEvent("addNoteComplete",[k,g,c]);if(typeof j=="function"){j(k,g,c)}}}).send();return d},addFolderNoteCall:function(c,d,j){var h=this;var g={action:"ADD_FOLDER_NOTE",id:c,note:d};var f=new Request({url:this.URL_SAVE_CONTROLLER,data:g,onSuccess:function(k){var m=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){m=true}else{var l={name:"saves add folder note",message:(k&&k.error?k.error:"Unknown error while adding folder note to : "+c)};ta.util.error.record(l,"addFolderNoteCall")}}h.fireEvent("addFolderNoteComplete",[k,c,d]);if(typeof j=="function"){j(k,c,d)}}}).send();return f},createFolderCall:function(c,h){var g=this;var f={action:"CREATE_FOLDER",name:c};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(k){var o=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){o=true}else{var l={name:"saves create folder",message:(k&&k.error?k.error:"Unknown error while creating folder named : "+c)};ta.util.error.record(l,"createFolderCall")}}var j=k.folderid;var m=k.foldername;g.fireEvent("createFolderComplete",[k,j,m]);if(typeof h=="function"){h(k,j,m)}}}).send();return d},deleteFolderCall:function(c,h){var g=this;var f={action:"DELETE_FOLDER",id:c};var d=new Request({url:this.URL_SAVE_CONTROLLER,data:f,onSuccess:function(j){var l=false;if(j!=""){j=JSON.decode(j);if(j&&!j.error){l=true}else{var k={name:"saves delete folder",message:(j&&j.error?j.error:"Unknown error while deleting folder : "+c)};ta.util.error.record(k,"deleteFolderCall")}}g.fireEvent("deleteFolderComplete",[j,c]);if(typeof h=="function"){h(j,c)}}}).send();return d},renameFolderCall:function(c,d,j){var h=this;var g={action:"RENAME_FOLDER",id:c,name:d};var f=new Request({url:this.URL_SAVE_CONTROLLER,data:g,onSuccess:function(k){var m=false;if(k!=""){k=JSON.decode(k);if(k&&!k.error){m=true}else{var l={name:"saves rename folder",message:(k&&k.error?k.error:"Unknown error while renaming folder of : "+c)};ta.util.error.record(l,"renameFolderCall")}}h.fireEvent("renameFolderComplete",[k,c,d]);if(typeof j=="function"){j(k,c,d)}}}).send();return f},refreshLoggedInHoverSaves:function(){if(this.guideId!=0){this.saveGuideCall(this.guideId);return}else{this.saveCall(5,this.locationId);return}}});if(!ta.widgets.Saves){ta.widgets.Saves=new b()}var a=new Class({Implements:[Options,Events],lastBtnClicked:null,options:{feature_saves_ungating:false,isGuidePage:false,listingClass:"listing"},initialize:function(c){var d=this;this.setOptions(c);this.PAGE=ta.id("PAGE");ta.widgets.Saves.addEvent("saveComplete",this.setBtnSavedState.bind(this));ta.widgets.Saves.addEvent("unsaveComplete",this.setBtnUnsavedState.bind(this));ta.widgets.Saves.addEvent("retrievedSaves",this.setAllBtnStates.bind(this));ta.widgets.Saves.addEvent("saveGuideComplete",this.onGuideSaved.bind(this));ta.queueForReady(function(){var f=ta.id("SAVE_ALL_BUTTON");if(f){f.addEvent("click",function(h){var g=this.get("data-guideid");if(g){ta.widgets.Saves.guideId=g;ta.widgets.Saves.btn=this;ta.call("ta.overlays.Factory.openSavesHoverRegflow",h)}h.preventDefault()})}})},refresh:function(){ta.widgets.Saves.getSavesCall()},bindListingEvents:function(){var d=this;var c=$$("."+this.options.listingClass);if(!c||!c.length){return}c.removeEvents("mouseenter").removeEvents("mouseleave").addEvents({mouseenter:function(){d.overHover(this)},mouseleave:function(){d.outHover(this)}})},setBtnSavedState:function(g,l,k,c,d){var h=this.getBtnsByLocationId(l);if(h.length){this.showSaved(h,k)}if(h.length){var f=h[0]}var m=!f?null:f.hasClass("vr")?"vr":f.hasClass("vr_detail")?"vr_detail":null;if(m){var j=m=="vr"?34452:34453;new Request({url:"/ActionRecord?action=VR_HeartSave&pid="+j}).send()}if(this.lastBtnClicked&&l==this.lastBtnClicked.get("data-locationid")){this.showHoverAlert(this.lastBtnClicked)}},setBtnUnsavedState:function(c,g,d){var f=this.getBtnsByLocationId(d);if(f.length){this.showUnsaved(f,g)}},setAllBtnStates:function(c){var f=this;if(!c){c=ta.widgets.Saves?ta.widgets.Saves.savedItems:{}}Object.each(c,function(g,h){var j=f.getBtnsByLocationId(h);if(j&&j.length){f.showSaved(j,g)}});ta.select(".savesHover").each(function(g){f.bindBtnEvents(g)});var d=ta.id("HEADING_GROUP");if(d){d.getElements(".savesContainer, .savesHover").setStyles({visibility:"visible",display:"block"})}if(this.options.isGuidePage){this.setGuideSaveState()}if(!isTabletOnFullSite){this.bindListingEvents()}},setGuideSaveState:function(f){var d=ta.id("GUIDE_DETAIL");if(!d){return}var c=d.getElements(".savesHover");var g=c.filter(".saved");if(f===true||c.length==g.length){ta.id("SAVE_ALL_BUTTON").hide();ta.id("ALL_SAVED_BUTTON").show()}else{if(f===false||c.length!=g.length){ta.id("ALL_SAVED_BUTTON").hide();ta.id("SAVE_ALL_BUTTON").show()}}},onGuideSaved:function(f,d,c){var g=this;if(f){this.setGuideSaveState(true);if(c&&c.length){c.each(function(j,h){var k=g.getBtnsByLocationId(j.entityid);g.showSaved(k,j.id)})}}},bindBtnEvents:function(f){var j=this;var g=f.getParent();var h=g.getElement(".saveOptions");f.removeEvents();if(h){h.getElement(".btn-delete").removeEvents()}if(f.hasClass("saved")){var d=f.get("data-locationid");var c=f.get("data-saveitemid");if(f.hasClass("savesHover-confirm-delete")){f.addEvent("click",function(){if(!h.isDisplayed()){j.showPositionedTip(this)}else{j.hidePositionedTip(h)}});h.getElement(".btn-delete").addEvent("click",function(){ta.widgets.Saves.unsaveCall(c,d);j.hidePositionedTip(h)})}else{f.addEvent("click",function(){ta.widgets.Saves.unsaveCall(c,d)})}}else{f.addEvent("click",function(l){var k=this.get("data-locationid");if(!k){return}ta.widgets.Saves.locationId=k;ta.widgets.Saves.btn=this;j.lastBtnClicked=this;if(j.options.feature_saves_ungating){ta.trackEventOnPage("HoverSave","saveIntent",k,1,false);ta.widgets.Saves.refreshLoggedInHoverSaves()}else{ta.call("ta.overlays.Factory.openSavesHoverRegflow",l)}ta.trackEventOnPage("Saves","HoverButton",k,0)})}},overHover:function(f){f=ta.id(f);if(!f.hasClass("promoted")){if(!ta.isMetaHotels2013()){f.setStyle("background-color","#f1f1f1")}else{f.addClass("hoverShadow");var d=f.getElement(".metaDisclaimer");if(d){d.setStyle("visibility","visible")}}}var c=f.getElement(".savesHover");if(c&&!c.hasClass("saved")&&c.hasClass("invisible")){c.removeClass("invisible")}},outHover:function(f){f=ta.id(f);if(!f.hasClass("promoted")){if(!ta.isMetaHotels2013()){f.setStyle("background-color","#fff")}else{f.removeClass("hoverShadow");var d=f.getElement(".metaDisclaimer");if(d){d.setStyle("visibility","hidden")}}}var c=f.getElement(".savesHover");if(c&&!c.hasClass("vr-heartContainer")&&!c.hasClass("saved")&&!c.hasClass("invisible")){c.addClass("invisible")}},getBtnsByLocationId:function(c){return ta.select(".savesHover-"+c)},showUnsaved:function(g,f){var l=this;if(g){if(g.length){g.each(function(m){l.showUnsaved(m,f)});return}g.removeClass("saved");g.removeProperty("data-saveitemid");this.swapSaveText(g);if(ta.retrieve("fall_2013_hr_top_refresh")){var h=g.getElement(".star_green");if(h){h.removeClass("star_green sprite-star_green").addClass("star_gray sprite-star_gray")}}else{var h=g.getElement(".sprite-suitcase_yellow");if(h){h.removeClass("sprite-suitcase_yellow").addClass("sprite-suitcase_white")}}this.toggleVrSaveIcon(g);var j=g.getElement(".sprite-hoverArrow");if(j){j.hide();var d=g.getElement(".vr_button_silver_border");if(d){d.removeClass("vr_button_silver_border").addClass("vr_button_silver")}}if(this.options.feature_saves_ungating){var k=g.getElement(".sprite-warningicon");var c=g.getElement(".button_2011_grn");if(k){k.addClass("invisible");if(c){c.removeClass("warningicon")}}}this.bindBtnEvents(g)}},showSaved:function(g,f){var l=this;if(g){if(g.length){g.each(function(m){l.showSaved(m,f)});return}g.addClass("saved");g.set("data-saveitemid",f);g.removeClass("invisible");this.swapSaveText(g);if(ta.retrieve("fall_2013_hr_top_refresh")){var h=g.getElement(".star_gray");if(h){h.removeClass("star_gray sprite-star_gray").addClass("star_green sprite-star_green")}}else{var h=g.getElement(".sprite-suitcase_white");if(h){h.removeClass("sprite-suitcase_white").addClass("sprite-suitcase_yellow")}}this.toggleVrSaveIcon(g);var j=g.getElement(".sprite-hoverArrow");if(j){j.show();var d=g.getElement(".vr_button_silver");if(d){d.removeClass("vr_button_silver").addClass("vr_button_silver_border")}}if(this.options.feature_saves_ungating){var k=g.getElement(".sprite-warningicon");var c=g.getElement(".button_2011_grn");if(k){k.removeClass("invisible");if(c){c.addClass("warningicon")}}}this.bindBtnEvents(g)}},toggleVrSaveIcon:function(f){var d=f.getElement(".vr-icon");if(d){var c=function(h,g){if(d.hasClass(g)){d.swapClass(g,h)}else{if(d.hasClass(h)){d.swapClass(h,g)}}};if(f.hasClass("vr-heartContainer")){c("vr-sprite-unsaved","vr-sprite-saved")}else{c("sprite-vr_heart_grey","sprite-vr_heart_color")}}},swapSaveText:function(d){var c;var f;if(d.hasClass("vr-heartContainer")){c=d.getElement(".vr-saved");f=d.getElement(".vr-unsaved")}else{c=d.getElement(".saves-hover-txt-saved");f=d.getElement(".saves-hover-txt")}if(c){this.toggleVisibility(c)}if(f){this.toggleVisibility(f)}},toggleVisibility:function(c){if(c.isVisible()){c.hide()}else{c.show("inline-block")}},hidePositionedTip:function(c){var d=this;if(c){c.hide()}},showPositionedTip:function(d,c){var h=this;var f=d.getParent();var g=f.getElement(".saveOptions");if(!g){if(typeof c=="function"){c()}return}g.show()},showHoverAlert:function(d){var c=d.getParent(".savesWrap");var f=c?c.getElement(".saveAlert"):null;if(!f){return}f.show();this.closeHoverAlert.delay(5000,f,f)},closeHoverAlert:function(c){c=ta.id(c);if(c){c.hide()}},assetsLoaded:function(){ta.id("SAVES").setStyle("top",ta.id("HEADING").getTop()-123);ta.id("SAVES").show()},assetsLoadedHeader:function(){if(ta.id("HEADING_GROUP")){if(ta.isMetaHotelMBP2013()){ta.id("SAVES").setStyle("top",ta.id("HEADING_GROUP").getCoordinates().height-30)}else{if(ta.retrieve("fall_2013_hr_top_refresh")){ta.id("SAVES").setStyle("top",ta.id("HEADING_GROUP").getCoordinates().bottom+24)}else{ta.id("SAVES").setStyle("top",ta.id("HEADING_GROUP").getCoordinates().bottom-154)}}ta.id("SAVES").show()}},loadSavesButton:function(f,h,g,c){var d="false";if(ta.retrieve("fall_2013_hr_top_refresh")){d="true"}if(!ta.retrieve("saves_button_"+f)){ta.store("saves_button_"+f,true);if(ta.id("saves_placeholder_"+f)){new Request({url:"/SavesButtonAjax",onSuccess:function(k){try{if(typeof k!=undefined&&k.trim()!="BAD_REQUEST"){ta.id("saves_placeholder_"+f).innerHTML=k;ta.select(".savesHover-"+f).each(function(l){ta.widgets.SavesButtons.bindBtnEvents(l);l.removeClass("invisible")})}else{ta.util.error.record(null,"Failed to load saves button BAD_REQUEST",null,{DBLE_ID:f},"WARN")}}catch(j){ta.util.error.record(j,"Failed to load saves button",null,{DBLE_ID:f})}},data:{pop:h,del:g,dble:f,head:c,toprefresh:d},evalScripts:true,method:"get"}).send()}}},loadAllSavesButtons:function(){var c="false";if(ta.retrieve("fall_2013_hr_top_refresh")){c="true"}if(!ta.has("SAVES_BUTTONS_LOADED")&&typeof saveLocationsOnPage!="undefined"){ta.store("SAVES_BUTTONS_LOADED",true);window.removeEvent("scroll",ta.widgets.SavesButtons.loadAllSavesButtons);new Request({url:"/SavesButtonAjax",onSuccess:function(g){try{if(typeof g!=undefined&&g.trim()!="BAD_REQUEST"){var f=JSON.decode(g);if(f){f.each(function(j){var h=ta.id("saves_placeholder_"+j.id);if(h){h.innerHTML=j.html}});ta.select(".savesHover").each(function(h){ta.widgets.SavesButtons.bindBtnEvents(h)})}}else{ta.util.error.record(null,"Failed to load saves buttons BAD_REQUEST",null,null,"WARN")}}catch(d){ta.util.error.record(d,"Failed to load saves buttons")}},data:{locations:saveLocationsOnPage.join(),toprefresh:c},evalScripts:true,method:"post"}).send()}}});if(!ta.widgets.SavesButtons){ta.widgets.SavesButtons=new a({})}})();ta.overlays.BACKDROP_NEVER=0;ta.overlays.BACKDROP_ALWAYS=1;ta.overlays.Overlay=new Class({Implements:[Options,Events],Binds:["_hide","show","hide","destroy","hideByClickOnDocument"],options:{requestData:null,showCloseButton:false,noPadding:false,noCpu:false,closeButtonClass:"close",closeLink:"",showArrow:false,arrowClassLeft:null,arrowClassRight:null,arrowClass:"ttarrow",style:"typeO",innerDivClass:"inner",backdrop:ta.overlays.BACKDROP_NEVER,permanent:false,permanent_except_same:false,type:"",isChild:false,remoteContent:null,keepElementInDocument:false,requestMethod:"get",zIndex:1001,positionType:"absolute",draggable:false,draggingClass:"dragging",title:null,onscroll:null,noScroll:false,backdropClickClose:false,offsetRight:0,offsetLeft:0,offsetTop:0,offsetBottom:0,closeOnDocumentClick:false,track:false,positionByOffsets:false},initialize:function(k,c){if(k.noScroll){var b=k.onShow;k.onShow=function(){if(b){b()}ta.find("body").setStyle("overflow","hidden")};var j=k.onClose;k.onClose=function(){if(j){j()}ta.find("body").setStyle("overflow","")}}this.setOptions(k);this.source=ta.id(c);this.visible=false;this.backdropOn=false;this.closedByDocClick=false;this.container=new Element("div",{styles:{position:this.options.positionType,left:"-999em",top:"-999em",fontSize:this.options.fontSize||".75em",zIndex:this.options.zIndex},"class":this.options.style+" overlay"});this.container.store("overlay",this);this.container.overlay=this;ta.store("overlays.current",this);this._useIframeShim=Browser.ie6;if(this.options.title){this.header=new Element("h1",{"class":"title",html:this.options.title}).inject(this.container);if(this.options.draggable){var h=this.options.draggingClass;var d=function(){};if(this._useIframeShim){d=this.positionShim.bind(this)}this.drag=new Drag(this.container,{handle:this.header,preventDefault:true,stopPropagation:true,onSnap:function(l){l.addClass(h)},onDrag:d,onComplete:function(l){l.removeClass(h)}})}}this.inner=new Element("div",{"class":this.options.innerDivClass}).inject(this.container);var g=this;if(g.options.onscroll){g.inner.addEvent("scroll",function(){g.options.onscroll(g.inner)})}if(this._useIframeShim){this.shim=new IframeShim(this.container,{browsers:true})}var f;if(this.options.content){this.inner.setContent(this.options.content)}else{if(this.options.remoteContent){this.loadRemoteContent(this.options.remoteContent)}else{if(this.source&&(f=this.source.getElement(".overlayContents"))){if(f){this.inner.set("html",f.innerHTML);f.dispose();this.runBehaviorOnFirstShow=true}}}}if(this.options.showCloseButton){var a=this.options.closeButtonClass;if(ta.has("checkrates.add_holding_windows")){a+=" no_cpu"}this.closeBtn=new Element("div",{styles:{position:"absolute",fontSize:"92.5%",cursor:"pointer"},html:this.options.closeLink,"class":a,events:{click:(function(){this.fireEvent("onClose",this)}).bind(this)}}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.showArrow){this.arrow=new Element("div",{styles:{position:"absolute"},"class":this.options.arrowClass}).inject(this.container);if(this.header){this.container.addClass("withClose")}else{this.inner.addClass("withClose")}}if(this.options.noPadding){if(this.header){this.container.addClass("noPad")}else{this.inner.addClass("noPad")}}if(this.options.noCpu){if(this.header){this.container.addClass("no_cpu")}else{this.inner.addClass("no_cpu")}}this.container.addEvent("trash",this.destroy)},destroy:function(){this.container.overlay=null;if(this.shim){this.shim.destroy();this.shim=null}},position:function(){if(this.shim){(function(){this.positionShim()}).delay(10,this)}},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top})},show:function(a){if(typeof(overlayCss)!="undefined"&&!ta.retrieve("ta.overlayCssAsset")){ta.store("ta.overlayCssAsset",Asset.css(overlayCss));this._show(a)}else{this._show(a)}},_show:function(d){if(this.visible){return}if(d){new Event(d).preventDefault()}this.closedByDocClick=false;var a=ta.util.URL.parse(this.options.remoteContent);if(typeof crPageServlet!=="undefined"&&a&&a.test(/\/{1}(\w*)$/)){ta.store("crPageServlet_orig",crPageServlet);crPageServlet=RegExp.$1}$$(".overlay").each(function(c){if(c.overlay){if(c.overlay==this){return}if(this.parentOverlay&&c.overlay==this.parentOverlay){return}if(c.overlay.options.permanent){return}if(c.overlay.options.permanent_except_same&&c.overlay.options.type!=this.options.type){return}c.overlay.hide(d)}},this);ta.id(document.body).adopt(this.container);if(this.shim&&this.shim.shim){ta.id(document.body).adopt(this.shim.shim);var b=this.container.getCoordinates();if(b){this.shim.shim.setStyles({display:"block",width:b.width,height:b.height})}}this.position();if(this.options.closeOnDocumentClick){document.addEvent("click",this._hide)}if(this.options.backdrop==ta.overlays.BACKDROP_ALWAYS){this.enableBackdrop()}this.visible=true;this.fireEvent("onShow",this);if(ta.has("overlay.onShow")){ta.remove("overlay.onShow").each(function(c){c.call(this)},this)}return this},_hide:function(b){if(this.options.noScroll){ta.find("body").setStyle("overflow","")}if(!b||this.container.containsEvent(b)){return}if(this.options.pinnable==ta.overlays.PINNABLE_HOVER||this.options.pinnable==ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE){var a=b.target;while(a){if(a==this.source){return}else{a=a.parentElement}}}document.removeEvent("click",this._hide);this.hide(b)},hideByClickOnDocument:function(a){this.closedByDocClick=true;this.hide(a)},hide:function(a){if(window.flyout){window.flyout.hide()}if(this.backdropOn){this.disableBackdrop()}if((this.options.keepElementInDocument&&this.container.style.left=="-999em")||(!this.options.keepElementInDocument&&!this.container.inDocument())){return this}if(this.shim){this.shim.hide().dispose()}this.container.setStyles({left:"-999em",top:"-999em"});if(!this.options.keepElementInDocument){this.container.dispose()}this.visible=false;this.fireEvent("onHide",!a);if(ta.has("crPageServlet_orig")){ta.run("ta.commerce.checkrates.restoreCRPageServlet")}if(this.options.noScroll){ta.find("body").setStyle("overflow","")}return this},configureBackdrop:function(){this.backdrop=new Element("div",{"class":"overlayBG"});this.backdrop.setStyles({position:"absolute",left:0,top:0,width:"100%",height:window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight),backgroundColor:"#000",zIndex:this.options.isChild?"10000":"9997",opacity:0.6});if(this.options.backdropClickClose){this.backdrop.addEvent("click",function(){this.fireEvent("onClose",this);this.hide()}.bind(this))}},updateBackdrop:function(){this.backdrop.setStyles({width:"100%",height:(document.height!==undefined)?document.height:document.body.offsetHeight})},enableBackdrop:function(){try{if(this.backdropOn){return}if(!this.backdrop){this.configureBackdrop()}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}ta.store("overlays.current",this);this.updateBackdrop();if(this.container.inDocument()){this.backdrop.inject(this.container,"before")}else{this.backdrop.inject(document.body)}this.backdropOn=true;this.container.setStyle("z-index",this.options.isChild?"10002":"9998");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #424242")}else{this.container.setStyle("border","5px solid rgba(64,64,64,0.8)")}}}catch(b){ta.util.error.record(b,"Error setting the border property - enableBackdrop")}},disableBackdrop:function(){try{if(!this.backdropOn){return}this.backdrop.dispose();if(ta.retrieve("overlays.current")==this){ta.remove("overlays.current");if(Browser.ie6){$$("select").setStyle("visibility","visible")}}else{if(Browser.ie6&&ta.retrieve("overlays.current")&&!ta.retrieve("overlays.current").backdropOn){$$("select").setStyle("visibility","visible")}}this.backdropOn=false;this.container.setStyle("z-index","1001");if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){if(Browser.ie7||Browser.ie8){this.container.setStyle("border","5px solid #b2b2b2")}else{this.container.setStyle("border","5px solid rgba(128,128,128,0.6)")}}}catch(a){ta.util.error.record(a,"Error unsetting the border property - disableBackdrop")}},loadRemoteContent:function(c,a){var b={url:ta.util.URL.parse(c),method:this.options.requestMethod,data:this.options.requestData,onSuccess:this.loadRemoteSuccess.bind(this),onFailure:this.loadRemoteFailure.bind(this),evalScripts:true};this.options.track&&(b.trackEvent=this.options.track);if(!a){new Asset.image(CDNHOST+"/img2/generic/site/loop.gif",{onload:this.position.bind(this),"class":"anim_loop"}).inject(this.inner)}new Request(b).send();return this},loadRemoteSuccess:function(a){this.cachedWidth=null;this.inner.setContent(a);this.position();if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}this.fireEvent("onLoad",this);this.cachedWidth=this.container.getSize().x;if(this.backdropOn){this.updateBackdrop()}return this},loadRemoteFailure:function(){this.inner.addClass("ajax_failed");this.inner.setStyle("width","383px");this.inner.setStyle("padding","14px 24px 14px 14px");this.inner.set("text",JS_Ajax_failed)}});ta.overlays.getCurrent=function(){var a=$$(".overlay").shift();return a&&a.retrieve("overlay")};ta.overlays.safeCloseCurrent=function(){var a=ta.overlays.getCurrent();return a&&a.hide()};ta.overlays.safeCloseFromDom=function(c){c=ta.id(c);var a=c&&c.getParent(".overlay");var b=a&&a.retrieve("overlay");return b&&b.hide()};ta.overlays.AbsoluteOverlay=new Class({Extends:ta.overlays.Overlay,options:{xOffset:0,yOffset:0,toWindow:true,repositionOnScroll:false,autoShow:true,stayOpen:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();this.parent(a,b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},show:function(a){this.parent(a);if(this.options.repositionOnScroll){window.addEvent("scroll",this.delayedScroll.bind(this))}},hide:function(a){this.parent(a);if(this.options.repositionOnScroll){window.removeEvent("scroll",this.delayedScroll.bind(this))}},delayedScroll:function(){this.position.delay(500,this)},position:function(){this.container.setStyles({left:this.options.xOffset,top:this.options.yOffset+(this.options.toWindow?window.getScrollTop():0)});this.parent()}});ta.overlays.AbsoluteBottomOverlay=new Class({Extends:ta.overlays.Overlay,initialize:function(a,b){this.parent(Object.merge({positionType:"fixed"},a),b);if(this.options.showCloseButton&&!this.options.stayOpen){this.closeBtn.addEvent("click",this.hide)}thisOverlay=this;if(this.options.horizontalScroll){window.addEvent("scroll",function(){var c=window.getScroll().x*-1;thisOverlay.container.setStyle("left",(c))})}},position:function(){this.parent();this.reposition();this.flyIn()},reposition:function(){this.container.setStyles({top:null,left:null});if(!this.options.flyFromRight){if(this.options.horizontalScroll){leftValue=window.getScroll().x*-1}else{leftValue=window.getCoordinates().width/2-this.container.getWidth()/2}this.container.setStyles({bottom:0,left:leftValue})}else{this.container.setStyles({bottom:10,right:10})}},flyIn:function(){if(this.options.flyFromRight){this.container.setStyle("right",-window.getCoordinates().width)}else{this.container.setStyle("bottom",-this.container.getHeight())}var a=new Fx.Tween(this.container,{duration:"1000",transition:"quad:out"});if(this.options.flyFromRight){a.start("right",10)}else{a.start("bottom",0)}},show:function(a){this.parent(a);if(!this.options.flyFromRight){window.addEvent("resize",this.reposition.bind(this))}this.container.removeClass("overlay");this.reposition()}});ta.overlays.CenteredOverlay=new Class({Extends:ta.overlays.Overlay,options:{delayedPosition:false,autoShow:true,attachCloseEvent:true,xOffset:-1,yOffset:-1,absoluteOffset:false,fixed:false},initialize:function(a,b){a=a||{};a.showCloseButton=[a.showCloseButton,true].pick();a.fixed&&(this.options.positionType="fixed");this.parent(a,b);if(this.options.showCloseButton&&this.options.attachCloseEvent){this.closeBtn.addEvent("click",this.hide)}this.options.autoShow&&this.show()},position:function(d){var b=ta.retrieve("ta.overlays.CenteredOverlay.position.iters");if(!b){b=0}var g=this.container.getCoordinates();if(g.height<=14&&b<10){ta.store("ta.overlays.CenteredOverlay.position.iters",b+1);this.position.delay(100,this,true);return}var a=this.options.xOffset;var f=this.options.yOffset;if(a===-1){a=Math.max(5,window.getWidth()-g.width)/2;!this.options.fixed&&(a+=window.getScrollLeft())}else{!this.options.absoluteOffset&&(a-=g.width/2)}if(f===-1){f=Math.max(20,window.getHeight()-g.height)/2;!this.options.fixed&&(f+=window.getScrollTop())}else{!this.options.absoluteOffset&&(f-=g.height/2)}this.container.setStyles({left:a,top:f});this.parent()},positionShim:function(){var a=this.container.getCoordinates();if(!a||!a.left){return}this.shim.shim.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.overlays.showInLightbox=function(a,b){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},b)).loadRemoteSuccess(a)};ta.overlays.loadInLightbox=function(b,a){return new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS},a)).loadRemoteContent(b)};var lightbox={deactivate:function(){var a=ta.retrieve("overlays.current");a&&a.hide()}};ta.overlays.ACTIVATE_NEVER=0;ta.overlays.ACTIVATE_CLICK=1;ta.overlays.ACTIVATE_HOVER=2;ta.overlays.ACTIVATE_FOCUS=3;ta.overlays.ACTIVATE_HOVER_DELAY=4;ta.overlays.ACTIVATE_BOTH=5;ta.overlays.PINNABLE_NEVER=0;ta.overlays.PINNABLE_ALWAYS=1;ta.overlays.PINNABLE_CLICK=2;ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE=3;ta.overlays.PINNABLE_HOVER=4;ta.overlays.BACKDROP_PINNED=2;ta.overlays.RelativeOverlay=new Class({Extends:ta.overlays.Overlay,Binds:["_hide","show","hide","destroy","hideNow","showWithDelay","hideWithDelay","_pin"],options:{activate:ta.overlays.ACTIVATE_NEVER,pinnable:ta.overlays.PINNABLE_NEVER,hoverDelayTime:250,pointArrowToSource:false,autoShow:true},initialize:function(b,c){this.parent(b,c);this.container.addClass("relative");var a=this.source.getParentBySelector(".overlay");if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1);this.parentOverlay=a.overlay}if(this.options.showCloseButton&&this.closeBtn){this.closeBtn.addEvent("click",this.hideNow);if(this.options.smartCloseButton){this.closeBtn.hide()}}switch(this.options.activate){case ta.overlays.ACTIVATE_CLICK:this.source.addEvent("click",this.show);break;case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_FOCUS:this.source.addEvent("focus",this.show);break}switch(this.options.pinnable){case ta.overlays.PINNABLE_CLICK:case ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:this.source.addEvent("click",this._pin);break}var f=this.source.getElement(".overlaySrc");if(f){if(f.get("tag")=="a"){this.loadRemoteContent(f.href)}else{this.loadRemoteContent(f.get("text"));f.dispose()}}else{if(!this.options.content&&this.source.get("tag")=="a"){this.loadRemoteContent(this.source.href)}}var d=ta.id(this.source.id+"_CONTENTS");if(d){this.inner.set("html",d.innerHTML);d.dispose();this.runBehaviorOnFirstShow=true}if(this.options.autoShow){this.show()}else{if(this.options.delayShow){this.showWithDelay()}}},show:function(b){b=b||window.event;if(b){new Event(b).stop()}var a=this.visible;this.parent(b);clearTimeout(this.showTimeout);if((this.options.activate==ta.overlays.ACTIVATE_HOVER||this.options.activate==ta.overlays.ACTIVATE_HOVER_DELAY)&&this.hideTimer){clearTimeout(this.hideTimer);this.hideTimer=null}if(a){return}if(this.runBehaviorOnFirstShow){this.runBehaviorOnFirstShow=false;if(typeof behavior!="undefined"&&behavior&&behavior.apply){behavior.apply(this.inner)}}this.cachedWidth=this.container.getSize().x;switch(this.options.pinnable){case ta.overlays.PINNABLE_HOVER:this._pin();break}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.addEvent("click",this.hideByClickOnDocument.bind(this))}break}return this},hide:function(b){b=b||window.event;if(!this.visible){return}if(window.flyout){window.flyout.hide()}if(b){var a=new Event(b);if(a.target&&a.target.tagName=="option"){return}if(Browser.ie&&a.target&&a.target.tagName=="select"&&this.container.getElements("select").contains(a.target)){return}}switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:case ta.overlays.ACTIVATE_HOVER_DELAY:if(!this.hideTimer){this.hideTimer=this.hide.delay(this.options.hoverDelayTime,this);return}else{clearTimeout(this.hideTimer);this.hideTimer=null}break;case ta.overlays.ACTIVATE_CLICK:case ta.overlays.ACTIVATE_FOCUS:if(b&&this.container.containsEvent(b)){return}if(this.options.pinnable==ta.overlays.PINNABLE_NEVER){document.removeEvent("click",this.hide)}break}return this.hideNow()},hideNow:function(a){if(!this.visible){return this}if(this.backdropOn){this.disableBackdrop()}if(this.shim){this.shim.hide().dispose()}if(!this.options.positionByOffsets){this.container.setStyles({left:"-999em",top:"-999em"}).dispose()}else{this.container.dispose()}this.visible=false;if(this.options.pinnable==ta.overlays.PINNABLE_CLICK||this.options.pinnable==ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE||this.options.pinnable==ta.overlays.PINNABLE_HOVER){this.unpin()}this.fireEvent("onHide",!a);return this},_pin:function(a){this.pin();this.toggleBackdrop(true)},pin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.removeEvent("mouseenter",this.show);this.source.removeEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.removeEvent("mouseenter",this.showWithDelay);this.source.removeEvent("mouseleave",this.hideWithDelay);break}this.container.removeEvent("mouseenter",this.show);this.container.removeEvent("mouseleave",this.hide);this.pinned=true;if(this.options.smartCloseButton&&this.closeBtn){this.closeBtn.show()}return this},toggleBackdrop:function(a){if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.enableBackdrop()}},unpin:function(){this.source=ta.id(this.source);switch(this.options.activate){case ta.overlays.ACTIVATE_HOVER:this.source.addEvent("mouseenter",this.show);this.source.addEvent("mouseleave",this.hide);break;case ta.overlays.ACTIVATE_HOVER_DELAY:this.source.addEvent("mouseenter",this.showWithDelay);this.source.addEvent("mouseleave",this.hideWithDelay);break}this.container.addEvent("mouseenter",this.show);this.container.addEvent("mouseleave",this.hide);if(this.options.backdrop==ta.overlays.BACKDROP_PINNED){this.disableBackdrop()}this.pinned=false;if(this.options.smartCloseButton&&this.closeBtn){this.closeBtn.hide()}return this},showWithDelay:function(a){a=a||window.event;clearTimeout(this.showTimeout);if(this.visible){return this.show(a)}else{this.showTimeout=this.show.delay(300,this)}},hideWithDelay:function(a){a=a||window.event;if(!this.visible){clearTimeout(this.showTimeout)}else{return this.hide(a)}}});ta.overlays.RelativeOverlayHorizontal=new Class({Extends:ta.overlays.RelativeOverlay,options:{arrowHeight:0,arrowLeftForce:0},initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){if(this.options.onRight){this.positionRight()}else{this.positionLeft()}this.parent()},adjustTop:function(f,j){try{this.source=ta.id(this.source);var l=f+this.options.offsetTop;var g=window.getScrollTop()+window.getHeight();var k=document.getElementById("tamgFooter");if(k){if(k.offsetHeight){g=g-k.offsetHeight}else{if(k.clientHeight){g=g-k.clientHeight}}}if(l+j.height>=g){l=g-j.height-1;if((this.crDHTML_BASIC||this.crDHTML_PNG24)&&this.options.showArrow){var b=this.container.getElement(".check_availability");var d=this.container.getElement(".username");if(b||d){var a=b?b:d;var c=a.getCoordinates().height}l=g-j.height+c-9}}return l}catch(h){ta.util.error.record(h,"adjustTop: RelativeOverlayHorizontal")}},positionLeft:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var a=ta.id("PAGE").getCoordinates();var h=this.container.getCoordinates();if(!this.flipped&&d.left-a.left-(this.cachedWidth||h.width)<0){this.flipped=true;this.options.onRight=true;if(this.arrow){this.arrow.className=this.options.arrowClassLeft}this.positionRight();return}if(ta.isDHTMLCRRedesign2012()&&this.container.getElement(".check_availability")){this.positionLeftOrRight(d,b,a,h,"left")}else{var f=this.adjustTop(d.top,h)-b;d.left=d.left-this.options.offsetLeft;this.container.setStyles({left:null,right:window.getWidth()-d.left+(this.options.xoffset||0),top:f});if(this.options.pointArrowToSource&&this.options.arrowHeight){this.setArrowPosition(d,b,a,h,"left",f)}}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},positionRight:function(){try{this.source=ta.id(this.source);var d=this.source.getCoordinates();var b=this.container.getStyle("margin-top").toInt();var h=this.container.getStyle("margin-bottom").toInt();var a=ta.id("PAGE").getCoordinates();var j=this.container.getCoordinates();if(!this.flipped&&a.right-d.right-(this.cachedWidth||j.width)<0){this.flipped=true;this.options.onRight=false;if(this.arrow){this.arrow.className=this.options.arrowClassRight}this.positionLeft();return}d.right=d.right-this.options.offsetRight;if(ta.isDHTMLCRRedesign2012()&&(this.container.getElement(".check_availability")||this.container.getElement(".username"))){this.positionLeftOrRight(d,b,a,j,"right")}else{var f=this.adjustTop(d.top,j)-b;this.container.setStyles({right:null,left:d.right+(this.options.xoffset||0),top:f});if(this.options.pointArrowToSource&&this.options.arrowHeight){this.setArrowPosition(d,b+h,a,j,"right",f)}}}catch(g){ta.util.error.record(g,"positionRight: RelativeOverlayHorizontal")}},setArrowPosition:function(l,f,j,h,a,d){if(a==="left"){this.arrow.setStyle("left",this.options.arrowLeftForce);var k=(d<l.top?l.top-d:0);var b=Math.max(-1,k+(l.height/2).toInt()-(this.options.arrowHeight/2));var g=h.height-this.options.arrowHeight-f-3;this.arrow.setStyle("top",Math.min(b,g))}else{if(a==="right"){ta.util.error.record("setArrowPosition with dir === right is not yet supported.")}}},positionLeftOrRight:function(t,m,B,A,u){try{var d=this.container.getElement(".check_availability");var g=this.container.getElement(".username");if(!ta.retrieve("isDaoDao")){var j=this.adjustTop(t.top,A)}else{var j=t.top}var y=d?d:g;var v=y.getCoordinates().height;var o=16;var l=j-v+o/2;var p=false;if(d){var f=window.getScrollTop();var h=ta.id("PERSISTENT_CHECK_RATES");if(h){f+=h.getCoordinates().height}if((j-0.5*A.height)<f){l=f;if((t.bottom-f)>32){l=f}else{if((t.bottom-f)<=32){l=t.bottom-32}}p=true}}var r=d?l:l+5;if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_BASIC){var b=d?(t.right+13):(t.right-45);if(u=="left"){b=t.left+13}var a=-16}if(this.crDHTML_PNG24){var b=d?(t.right+20):(t.right-45);if(u=="left"){var b=window.getWidth()-t.left+20}var a=d?-21:-24}if(u=="left"){this.container.setStyles({right:b,left:null,top:r})}else{this.container.setStyles({right:null,left:b,top:r})}if(this.arrow){this.arrow.setStyle("display","block");var k=d?16:0;if(p){this.arrow.setStyle("top",(t.bottom-r-32))}else{this.arrow.setStyle("top",v-k)}if(u=="left"){this.arrow.setStyle("left",(A.width-13))}else{this.arrow.setStyle("left",a)}try{t=this.source.getCoordinates();A=this.container.getCoordinates();var w=window.getScrollTop()+window.getHeight();var q=t.top-A.top-o/2;var k=d?0:20;if(j+A.height>=w&&q>0){this.arrow.setStyle("top",q+k);if(t.bottom+o/2>=A.bottom){this.container.setStyle("top",r+o*2);this.arrow.setStyle("top",q-o*2+k)}}else{if(q<=0&&!p){this.container.setStyle("top",r-v+o)}}}catch(z){ta.util.error.record(z,"bottomEdge - Reposition arrow and container: RelativeOverlayHorizontal")}}}catch(z){ta.util.error.record(z,"positionLeftOrRight: RelativeOverlayHorizontal")}}});ta.overlays.RelativeOverlayRight=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:true},a),b)}});ta.overlays.RelativeOverlayLeft=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,initialize:function(a,b){this.parent(Object.merge({onRight:false},a),b)}});ta.overlays.RelativeOverlayVertical=new Class({Extends:ta.overlays.RelativeOverlay,options:{flipPadding:0,allowFlip:true,arrowWidth:0},initialize:function(a,b){if(a.below==null){if(IS_DEBUG){alert("ERROR: Attempting to create Vertical Overlay without specifying direction.")}return}this.parent(a,b)},position:function(){this.options.below?this.positionBelow():this.positionAbove();this.parent()},positionBelow:function(){var p=this.source.getCoordinates();var l=this.container.getCoordinates();var m=this.container.getStyle("margin-left").toInt();var j=this.container.getStyle("margin-right").toInt();var b=this.container;var k=window.getHeight()+window.getScrollTop();var h=p.bottom;if(this.options.offsetTop){h-=this.options.offsetTop}if(this.options.scrollContainer){h-=this.options.scrollContainer.scrollTop}if(this.options.allowFlip&&!this.flipped&&k-l.height-h<0&&p.top-l.height>0){this.options.below=false;this.flipped=true;b.addClass("relAbove").removeClass("relBelow");h=p.top-l.height-this.options.flipPadding;if(this.options.scrollContainer){h-=this.options.scrollContainer.scrollTop}}else{b.addClass("relBelow").removeClass("relAbove")}p.left=p.left-this.options.offsetLeft;var d=this.adjustEdge(p.left-m,l.width);this.container.setStyles({left:d,top:h+(this.options.yoffset||0)});if(this.options.pointArrowToSource&&this.options.arrowWidth){var o=(d<p.left?p.left-d:0);var f=(p.width/2).toInt()-(this.options.arrowWidth/2);var g=o+f;var a=l.width-this.options.arrowWidth-m-j;this.arrow.setStyles({right:"",left:Math.min(g,a)})}},positionAbove:function(){var d=this.source.getCoordinates();var h=this.container.getCoordinates();var g=this.container.getStyle("margin-left").toInt();var a=this.container;var b=window.getScrollTop();var f=d.top-h.height-this.options.flipPadding;if(this.options.offsetTop){f-=this.options.offsetTop}if(this.options.scrollContainer){f-=this.options.scrollContainer.scrollTop}if(this.options.allowFlip&&!this.flipped&&f-b<0){this.options.below=true;this.flipped=true;a.addClass("relBelow").removeClass("relAbove");f=d.bottom;if(this.options.scrollContainer){f-=this.options.scrollContainer.scrollTop}}else{a.addClass("relAbove").removeClass("relBelow")}d.left=d.left-this.options.offsetLeft;if(this.options.positionByOffsets){this.container.setStyles({position:this.options.positionType,top:this.options.offsetTop,right:this.options.offsetRight,bottom:this.options.offsetBottom,left:this.options.offsetLeft})}else{this.container.setStyles({left:this.adjustEdge(d.left-g,h.width),top:f+(this.options.yoffset||0)})}},adjustEdge:function(d,c){var a=ta.id("PAGE").getCoordinates();if(d+c>=a.right){var b=this.container.getStyle("margin-right").toInt();d=a.right-c-b-1}return d},hideNow:function(a){this.parent(a);this.flipped=false}});ta.overlays.RelativeOverlayBelow=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:true},a),b)}});ta.overlays.RelativeOverlayAbove=new Class({Extends:ta.overlays.RelativeOverlayVertical,initialize:function(a,b){this.parent(Object.merge({below:false},a),b)}});ta.overlays.RelativeCalloutHorizontal=new Class({Extends:ta.overlays.RelativeOverlayHorizontal,options:{arrowUp:false,arrowDown:false,shadow:true,offset:null},initialize:function(a,b){if(a.onRight==null){if(IS_DEBUG){alert("ERROR: Attempting to create Horizontal Callout without specifying direction.")}return}if($$("body div.overlay").some(function(c){return c!=b})){return}a.style+=" overlayCallout ";this.parent(a,b);if(this.options.arrowDown){this.container.addClass("calloutDown")}else{if(this.options.arrowUp){this.container.addClass("calloutUp")}else{this.container.addClass(this._isRight(this.options)?" calloutRight":" calloutLeft")}}this._setupShadow(this.options,b);this._setupArrow(this.options,b);this._adjustPosition(this.options,b)},adjustTop:function(b,a){return b},show:function(b){this.parent(b);if(this.source&&this.container){this.source.adopt(this.container)}if(Browser.ie6){var a=this.container;$$("select").each(function(c){if(!a.contains(c)){c.setStyle("visibility","hidden")}else{c.setStyle("visibility","visible")}})}this.addEvent("onHide",this._hide)},_hide:function(a){if(Browser.ie6){$$("select").setStyle("visibility","visible")}},_isRight:function(b){var a=this.flipped||false;if(b.onRight===true){return !a}else{return a}},_setupArrow:function(a,b){var c="arrow ";if(this._isRight(a)){if(a.arrowDown){c+="arrowTL"}else{if(a.arrowUp){c+="arrowBL"}else{c+="arrowL"}}}else{if(a.arrowDown){c+="arrowTR"}else{if(a.arrowUp){c+="arrowBR"}else{c+="arrowR"}}}this.arrow=new Element("div",{"class":c}).inject(this.container)},_setupShadow:function(a,b){if(a.shadow===true){this.shadow=new Element("div",{"class":"shadow"}).adopt(this.inner.getChildren()).inject(this.inner)}},_adjustPosition:function(a,b){if(!a.offset.length||a.offset.length<2){a.offset=[0,0]}var c=this.source.getStyles("height","width");this.container.setStyles({left:parseInt((a.onRight?c.width:"0px").replace("px",""))+parseInt(a.offset[0]),top:parseInt(a.offset[1],0)+(a.arrowDown?45:0)})}});(function(){function c(f){if(!f){return null}if(f.get("tag")=="a"){return f.href}var d=f.getElement("a");if(d){return d.href}d=f.getElement(".overlaySrc");if(d){return d.get("text")}return null}var b={left:ta.overlays.RelativeOverlayLeft,right:ta.overlays.RelativeOverlayRight,above:ta.overlays.RelativeOverlayAbove,below:ta.overlays.RelativeOverlayBelow};function a(m,q,h,r){if(q||window.event){new Event(q||window.event).preventDefault()}var p=m.hyphenate().split("-"),k=p.indexOf("h")>=0,g=p.indexOf("lb")>=0,d=p.indexOf("remote")>=0,o=p.indexOf("click")>=0,f=Object.merge({showCloseButton:true},r),l=null,j;switch(p.shift()){case"rel":l=b[p.shift().toLowerCase()];if(g){f.pinnable=ta.overlays.PINNABLE_ALWAYS}break;case"center":l=ta.overlays.CenteredOverlay;break}if(l===null){return null}if(k){f.activate=ta.overlays.ACTIVATE_HOVER}else{if(o){f.activate=ta.overlays.ACTIVATE_CLICK}}if(g){f.backdrop=ta.overlays.BACKDROP_ALWAYS}if(d){f.remoteContent=c(h)}j=new l(f,h);if(h){h.store("overlay",j)}return j}ta.overlays.Factory={_magic:a,relRightRemoteHLB:function(d,g){g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=c(g);if(h==null){return}var f=new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay rgba_flyout",showCloseButton:true},g)},relRightRemoteHLB_Commerce:function(g,d){if(g||window.event){new Event(g||window.event).preventDefault()}d=ta.id(d);var f=c(d);if(f==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true},d)},relRightRemoteHLB_CommCopy:function(g,d){if(g||window.event){new Event(g||window.event).preventDefault()}d=ta.id(d);var f=c(d);if(f==null){return}d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay rgba_flyout",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowRemoteHLB_Commerce:function(g,d){d=ta.id(d);if(g||window.event){new Event(g||window.event).preventDefault()}var f=c(d);if(f==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true},d)},relBelowRemoteHLB_CommCopy:function(g,d){d=ta.id(d);if(g||window.event){new Event(g||window.event).preventDefault()}var f=c(d);if(f==null){return}d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"commerceOverlay rgba_flyout",showCloseButton:true,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")}},d)},relBelowS4Dg:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,style:"s4 dg",activate:ta.overlays.ACTIVATE_CLICK},d)},relBelowRGBA:function(j,f){if(j){j.stop()}var g="rgba_flyout";var h=true;var d="rgba_arrow";d=d+" rgba_arrow_png24";f.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:g,showArrow:h,arrowClass:d,showCloseButton:true},f)},relBelow:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayBelow({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relAbove:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relRight:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayRight({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relLeft:function(f,d){if(f){f.stop()}d.onclick=null;new ta.overlays.RelativeOverlayLeft({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK},d)},relBelowH_Media:function(f,d){if(f){f.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH_Media:function(f,d){if(f){f.stop()}d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"typeO mediaBox"},d)},relAboveH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER},d)},relAboveTAMGFooter:function(g,d){d.onmouseover=null;var f=ta.id("PAGE");if(f){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 vdg ovrFooter "+d.className},d)}},relRightH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER},d)},relLeftH:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayLeft({activate:ta.overlays.ACTIVATE_HOVER},d)},imageLightbox:function(h,d){d.onclick=null;var f="<div><img src="+d.getAttribute("href")+"></div>";var g=new ta.overlays.CenteredOverlay({showCloseButton:true,backdrop:ta.overlays.BACKDROP_ALWAYS}).loadRemoteSuccess(f);d.addEvent("click",g.show)},relRightRemoteHLB_optionalDelay:function(d,k){k=ta.id(k);if(k.get("tag")!="div"){k=k.getParent()}var l=c(k);if(l==null){return}if(typeof(checkRatesCSS)!="undefined"&&!ta.retrieve("ta.checkRatesCSS")){ta.store("ta.checkRatesCSS",Asset.css(checkRatesCSS))}var h=k.className.match(/noDelayFirst/);var j=k.className.match(/delayOpen/);var g=ta.retrieve("delayedFirst");var m=!j||(h&&!g);var f=new ta.overlays.RelativeOverlayRight({activate:(j?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER),pinnable:ta.overlays.PINNABLE_CLICK,backdrop:ta.overlays.BACKDROP_PINNED,style:"commerceOverlay rgba_flyout",showCloseButton:true,autoShow:m,delayShow:!m,onLoad:function(){ta.commerce.checkrates.updateCRForm("_pop")},onShow:function(){ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(f)}},k);ta.store("delayedFirst",true)},microMetaOverlayFixed:function(m,f,j,d,k,p,h){try{var g=ta.id("hotel_flyout").getSize();var o={positionByOffsets:true,positionType:"fixed",offsetTop:"",offsetRight:(g.x-310),offsetBottom:g.y,offsetLeft:"",pinnable:ta.overlays.PINNABLE_HOVER,closeOnDocumentClick:true,backdrop:ta.overlays.BACKDROP_NEVER};ta.overlays.Factory.microMetaOverlay(m,f,j,d,k,p,h,o)}catch(l){}},microMetaOverlay:function(r,o,v,t,D,E,m,h){try{o.onmouseover=null;o.onclick=null;if(r){r.stop()}var u=new ta.commerce.CheckRatesData({type:"checkrates",evnt:r},v,v,true);var q=u.getVendorSet().getCheckedContentID();var p=u.getVendorSet().getCheckedVendor();var k=ta.retrieve("meta.travelData");k=ta.commerce.checkrates.getTravelDataFromDOM();var j=ta.commerce.checkrates.buildVarMetaHacUrl("MicroMetaAjax",u,q,p,true,null,"QC_Meta_Micro|Button",k);j+="&lowContentID="+t;if(m){j+="&xSellPlacement="+m}var g=o.className.match(/noDelayFirst/);var l=o.className.match(/delayOpen/);var f=ta.retrieve("delayedFirst");var y=!l||(g&&!f);var C="Above Fold Also Viewed";if(ta.id(o).getParent("#MMXS_LIST")){C="State Opt Also Viewed"}else{if(ta.id(o).getParent("#HORIZONTAL_CROSS_SELL_LIST")){C="HorizXSell"}else{if(ta.id(o).getParent("#hotel_flyout")){C="Scooter"}}}if(ta.has("checkrates.meta_dropdown_on_avaf")){j+="&dropdown=true";if(dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")){ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))}var w="rgba_flyout gray dropdownMiniMeta miniMetaLightBox";var s=true;var z=-5;var A=new ta.overlays.RelativeOverlayBelow({style:w,activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_HOVER,showArrow:s,arrowClass:"rgba_gray_arrow_up",offsetTop:-10,offsetLeft:310,allowFlip:false,autoShow:y,delayShow:l,closeOnDocumentClick:true,permanent_except_same:true,type:"avaf_micro_meta",onShow:function(){ta.trackEventOnPage("Meta_Micro_Providers_Displayed",C,D)}},o)}else{if(C=="Scooter"){j+="&from="+C}var d={activate:(E)?ta.overlays.ACTIVATE_CLICK:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:(E)?ta.overlays.PINNABLE_CLICK_WITH_DOC_CLOSE:ta.overlays.PINNABLE_CLICK,backdrop:(E)?ta.overlays.BACKDROP_NEVER:ta.overlays.BACKDROP_PINNED,showCloseButton:!E,closeOnDocumentClick:E,onshow:(E)?function(){ta.trk("Meta_Micro_Providers_Displayed")}:function(){ta.trackEventOnPage("Meta_Micro_Providers_Displayed",C,D)},positionByOffsets:false,positionType:"absolute",offsetTop:0,offsetRight:"",offsetBottom:"",offsetLeft:155};Object.merge(d,h);var A=new ta.overlays.RelativeOverlayBelow({style:"micro_meta_flyout gray",activate:d.activate,pinnable:d.pinnable,backdrop:d.backdrop,autoShow:y,delayShow:l,showCloseButton:d.showCloseButton,closeOnDocumentClick:d.closeOnDocumentClick,closeButtonClass:"roundOuterClose",onShow:d.onshow,positionByOffsets:d.positionByOffsets,positionType:d.positionType,offsetTop:d.offsetTop,offsetRight:d.offsetRight,offsetBottom:d.offsetBottom,offsetLeft:d.offsetLeft},o)}A.loadRemoteContent(j,false);ta.store("delayedFirst",true);if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkMicroMeta(true)}}catch(B){ta.util.error.record(B,"micro meta overlay")}},microMetaExpandedSize:0,microMetaMore:function(f,g){try{ta.commerce.checkrates.actionRecord("MICRO_META_EXPAND_MORE");whichElem=ta.id("micro_meta_remaining_"+g);if(!whichElem){return}whichElem.removeClass("hidden");if(whichElem.getSize().y!=ta.overlays.Factory.microMetaExpandedSize){whichElem.addClass("expanding");ta.overlays.Factory.microMetaExpandedSize=whichElem.getSize().y;whichElem.removeClass("expanding")}whichElem.addClass("show");new Fx.Tween(whichElem,{duration:"long",property:"height"}).start(0,ta.overlays.Factory.microMetaExpandedSize);window.setTimeout(function(){var h=ta.id("micro_meta_more");if(!h){return}h.addClass("invisible")},1000);if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkMicroMeta(false)}}catch(d){ta.util.error.record(d,"Micro meta expand failed.")}},relRightRemoteHLB_optionalDelay_showArrow:function(w,h){try{h=ta.id(h);if(h.get("tag")!="div"){h=h.getParent()}var j=c(h);if(j==null){return}var o=j.match(/-d(\d+)\?/);if(o){o=o[1]}if(ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates()){try{if(w&&w.type=="mouseover"){h.addEvent("click",ta.overlays.Factory.relRightRemoteHLB_optionalDelay_showArrow.bind(this,null,h));return}var g=ta.retrieve("scooterObj");if(g){g.slideOut()}if(o){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(o,h)}return}catch(t){ta.util.error.record(t,"meta session dates parse issue")}}var q=h.className.match(/noDelayFirst/);var v=h.className.match(/delayOpen/);var p=ta.retrieve("delayedFirst");var f=!v||(q&&!p);var s="rgba_flyout";var d=true;var r="rgba_arrow";var u="close";if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){s+=" orange"}if(ta.has("hotels.redesignEnabled")&&(pageServlet==="Hotels"||pageServlet==="HACSearch")){s+=" gray";r="rgba_arrow_gray_lft_png24";u="roundOuterClose"}if(ta.has("daodao_noPop_single_cr_button")){s+=" no_cpu"}if(typeof(dhtml_cr_redesign_basic)!="undefined"&&!this.crDHTML_BASIC){this.crDHTML_BASIC=Asset.css(dhtml_cr_redesign_basic)}if(typeof(dhtml_cr_redesign_png24)!="undefined"&&!this.crDHTML_PNG24){this.crDHTML_PNG24=Asset.css(dhtml_cr_redesign_png24)}if(this.crDHTML_PNG24){if(ta.has("checkrates.dhtml_cr_redesign_png24_orange")){r=r+" rgba_arrow_png24_orange"}else{cr_arrowClass_right=r+" rgba_arrow_png24_right";r=r+" rgba_arrow_png24"}}var l=ta.overlays.BACKDROP_PINNED;if(ta.has("daodao_ror_backdrop_type")){l=ta.retrieve("daodao_ror_backdrop_type")}var k=(v?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER);if(ta.retrieve("daodao_show_cr_flyout_only_on_click")){k=ta.overlays.ACTIVATE_CLICK}var m=new ta.overlays.RelativeOverlayRight({activate:k,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:l,style:s,showArrow:d,arrowClass:r,arrowClassLeft:r,arrowClassRight:cr_arrowClass_right,closeButtonClass:u,showCloseButton:true,autoShow:f,delayShow:!f,smartCloseButton:ta.isMetaHotels2013(),onLoad:function(){if(!ta.has("metaDatePickerEnabled")){ta.commerce.checkrates.updateCRForm("_pop")}},onShow:function(){if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}else{ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(m)}if(document.getElement(".calendarWrap")){ta.widgets.calendar.closeCalendarWidgets();if(y){var y=new Event(y)}ta.overlays.Factory.loadDatePicker(y,h,o,"_pop",ta.servlet.HACSearch.openMetaLBAndUpdateMiniMetaOnPage)}},onHide:function(){ta.widgets.calendar.closeCalendarWidgets()}},h);ta.store("delayedFirst",true)}catch(t){ta.util.error.record(t,"relRightRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_helper:function(u,g,q){try{g=ta.id(g);if(g.get("tag")!="div"){g=g.getParent()}var h=c(g);if(h==null&&ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.clearCalendarFlyouts();h=c(g)}if(h==null){return}var t=g.getElement(".overlaySrc");var m=h.match(/-d(\d+)\?/);if(m){m=m[1]}if(ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates()){try{if(u&&u.type=="mouseover"){g.addEvent("click",ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper.bind(this,null,g,q));return}var f=ta.retrieve("scooterObj");if(f){f.slideOut()}if(m){ta.overlays.Factory.metaCheckRatesOverlay_allProviders(m,g)}return}catch(r){ta.util.error.record(r,"meta session dates parse issue")}}var p=g.className.match(/noDelayFirst/);var s=g.className.match(/delayOpen/);var o=ta.retrieve("delayedFirst");var d=!s||(p&&!o);var k=ta.has("daodao_ror_backdrop_type")?ta.retrieve("daodao_ror_backdrop_type"):ta.overlays.BACKDROP_PINNED;var j=(s?ta.overlays.ACTIVATE_HOVER_DELAY:ta.overlays.ACTIVATE_HOVER);if(ta.retrieve("daodao_show_cr_flyout_only_on_click")){j=ta.overlays.ACTIVATE_CLICK}var l=new ta.overlays.RelativeOverlayLeft({activate:j,pinnable:ta.overlays.PINNABLE_CLICK,backdrop:k,style:"rgba_flyout gray",showArrow:q,arrowClass:"rgba_arrow_gray_rgt_png24",arrowClassLeft:"rgba_arrow_gray_lft_png24",showCloseButton:true,closeButtonClass:"roundOuterClose",autoShow:d,delayShow:!d,smartCloseButton:ta.isMetaHotels2013(),onLoad:function(){if(!ta.has("metaDatePickerEnabled")){ta.commerce.checkrates.updateCRForm("_pop")}},onShow:function(){if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}else{ta.commerce.checkrates.updateCRForm("_pop");ta.overlays.Factory.checkCRLimitsHelper(l)}if(document.getElement(".calendarWrap")){ta.widgets.calendar.closeCalendarWidgets();if(v){var v=new Event(v)}ta.overlays.Factory.loadDatePicker(v,g,m,"_pop",ta.servlet.HACSearch.openMetaLBAndUpdateMiniMetaOnPage);if(this.calendar){this.calendar.reposition()}}},onHide:function(){ta.widgets.calendar.closeCalendarWidgets()}},g);ta.store("delayedFirst",true);ta.widgets.calendar.trackCalendarFlyout(g,l,t)}catch(r){ta.util.error.record(r,"relLeftRemoteHLB_optionalDelay_showArrow: Factory")}},relLeftRemoteHLB_optionalDelay_showArrow:function(d,f){ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper(d,f,true)},hotelsMapCROverlay:function(d,f){ta.overlays.Factory.relLeftRemoteHLB_optionalDelay_helper(d,f,false)},checkCRLimitsHelper:function(f){try{var d=f.container.getElement("#CHECK_RATE_FLYOUT");if(d&&/id_(\d+)/.test(d.className)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(g){ta.util.error.record(g,"crLimits check on show overlay")}},fbFriendOverlay:function(d){d.onclick=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,style:"s2 mg"},d)},photosLB:function(d,k){try{if(d||window.event){new Event(d||window.event).preventDefault()}k=ta.id(k);if(k.get("tag")!="a"){if((k.get("tag")=="span"&&k.hasClass("fkASDF"))||(k.get("tag")=="div"&&k.hasClass("fkASDF"))){k=ta.id(k)}else{k=k.getParent("a")}}var j="";if(k.className){j=k.className.match(/u_([^ ]*)/)[1]}else{if(k.href.match(/\/?LocationPhoto.*/)){j=k.href}}ta.overlays.Factory._mediaLBLoadAssets();var h=ta.retrieve("meta.enabled");var f;if(h){f="QC_Meta_Mini"}if(ta.has("photo.viewer.jsAssetsLoaded")){j=j.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");j=j.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");j=j.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(j.match(/\?/)){j=j+"&small=true"}else{j=j+"?small=true"}}if(h){j=j+"&area="+f;var l=j;try{j=ta.commerce.meta.tracking.updateUrlWithTiming(j,f)}catch(m){ta.util.error.record(m,"problem updating url with timing in Factory.photosLB");j=l}}var g=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.photoLBHelper,k);g.loadRemoteContent(j);ta.store("photo.viewer.lightbox",g);ta.commerce.meta.tracking.resetTimingLockForNavArea(f)}else{ta.util.error.record(null,"photo gallery - no assets to load");ta.overlays.Factory.viewerFallback.delay(2000,this,[null,k])}}catch(m){ta.util.error.record(m,"photo gallery overlay",null,{photoUrl:j});ta.commerce.meta.tracking.resetTimingLockForNavArea(f)}return false},viewerFallback:function(f){var d=ta.remove("photo.viewer.lightbox");if(d){d.hide()}if(f&&f.href&&f.href.match(/LocationPhotos/)){window.location=f.href}else{return ta.servlet.Popup.photoGallery(null,f)}},photoLBCounter:1,photoLBHelper:function(f){var d=ta.retrieve("photo.viewer.initData");if(ta.overlays.Factory.photoLBCounter>16){ta.overlays.Factory.photoLBCounter=1;try{ta.overlays.Factory.viewerFallback.delay(2000,this,f)}catch(g){}return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.photoLBHelper.delay(500)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},mediaLBAutoOpen:function(f){try{ta.overlays.Factory._mediaLBLoadAssets();if(!ta.has("photo.viewer.jsAssetsLoaded")){ta.util.error.record(null,"auto-open media lightbox - no assets to load")}else{f=f.replace(/\/LocationPhotos\-/,"/LocationPhotosLightbox-");f=f.replace(/\/LocationPhotoDirectLink\-/,"/LocationPhotosLightbox-");f=f.replace(/\#/,"?ff=");if(screen.availHeight<768||screen.availWidth<1024){if(f.match(/\?/)){f=f+"&small=true"}else{f=f+"?small=true"}}var d=ta.overlays.Factory._mediaLBCreateOverlay(ta.overlays.Factory.mediaLBAutoOpenHelper,f);d.loadRemoteContent(f);ta.store("photo.viewer.lightbox",d)}}catch(g){ta.util.error.record(g,"ta.overlays.factory.autoOpenMediaLB failed",null,{photoUrl:f})}return false},mediaLBAutoOpenHelper:function(g){var d=ta.retrieve("photo.viewer.initData");var f=16;if(ta.overlays.Factory.photoLBCounter>f){ta.overlays.Factory.photoLBCounter=1;ta.util.error.record(null,"ta.overlays.factory.autoOpenMediaLBHelper is giving up after "+f+" attempts.",null,{photoUrl:g});return}if(!d||!ta.photos.viewer){ta.overlays.Factory.photoLBCounter++;ta.overlays.Factory.mediaLBAutoOpenHelper.delay(500,this,g)}else{ta.overlays.Factory.photoLBCounter=1;ta.photos.viewer.photoViewerInit(d)}},_mediaLBLoadAssets:function(){if(!ta.has("photo.viewer.jsAssetsLoaded")&&typeof cssPhotoViewerAsset!="undefined"&&typeof jsPhotoViewerAsset!="undefined"){ta.store("photo.viewer.jsAssetsLoaded",true);Asset.css(cssPhotoViewerAsset,{media:"screen, print"});if(!ta.photos.viewer){Asset.javascript(jsPhotoViewerAsset)}if(typeof TALSO=="undefined"){Asset.javascript(jsPhotoViewerTALSOAsset)}if(typeof jsPhotosAsset!="undefined"&&!ta.servlet.Photos){Asset.javascript(jsPhotosAsset)}if(!ta.media.jwplayerHelper){Asset.javascript(jsJWPlayerHelperAsset)}}},_mediaLBCreateOverlay:function(f,h){var g={backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",backdropClickClose:true,onLoad:function(){this.position();if(ta.commerce&&ta.commerce.checkrates){ta.commerce.checkrates.updateCRForm("_pto");ta.commerce.checkrates.removePCR()}f(h);if(ta.commerce&&ta.commerce.checkrates){if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.retrieve("photo.viewer.locationId")&&ta.id("CHECK_RATE")&&ta.widgets.calendar.hasPageDates()){ta.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),ta.retrieve("photo.viewer.locationId"),"checkrates")}}},onHide:function(){var j=ta.remove("photo.viewer.lightbox");if(j){j.hide()}ta.run("ta.commerce.checkrates.restoreCRPageServlet");document.removeEvent("keydown",ta.remove("photo.viewer.keydownListener"));if(ta.retrieve("photo.viewer.refreshOnClose")){window.location=window.location}if(ta.has("translationOverlay")){ta.retrieve("translationOverlay").hide()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&ta.isMetaHotelsRequest&&ta.isMetaHotelsRequest()){ta.commerce.minimeta.doMetaDateSearch();ta.remove("hotels.datesChanged")}else{if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){ta.commerce.minimeta.ajax.resetAjaxCall();ta.commerce.minimeta.ajax.send(false,true);ta.remove("hotels.datesChanged")}}ta.widgets.calendar.closeCalendarWidgets()},permanent:true};if(ta.retrieve("checkrates.meta_ui_post_click_prices")){g.onShow=function(){var j=ta.retrieve("meta.baseLocationId");if(j){ta.commerce.meta.updateProvAreaFromLightBox(j)}}}var d=new ta.overlays.CenteredOverlay(g);return d},AccDetail:function(o,f,k,d){if(o){o.stop()}f=f.getParent();var j="http://"+document.domain;var m=location.pathname;if(m.length>0){if(m.charAt(0)=="/"){m=m.substring(1)}var l=m.indexOf("-");if(l>=0){m=m.substring(0,l)}}var h=k;var g=function(p){var q=ta.id("overlay_description").get("text");if(q.length>1000){ta.id("overlay_description").setStyle("height",210)}};if(memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")){ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS))}new ta.overlays.CoverOverlay({yOff:35,onLoad:g,style:"s3 dg rgba_gry",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showCloseButton:true,delayShow:true,requestData:{d:h,tab:"descript",from:m},remoteContent:j+"/LocationTab"},f);return false},memberOverlay:function(g,f,d){ta.overlays.Factory.memberOverlayWOffset(g,f,d,0,0);return false},memberOverlayWOffset:function(v,h,t,r,s){if(v){v.stop()}h.onclick=null;h.onmouseover=null;var q="";var d="";var m="";var o=false;var g=false;var f=true;var p="rgba_arrow_png24";if(h.id&&h.id!=""){var k=h.id.split("-");for(var l=0;l<k.length;l++){var j=k[l];if(j.match(/\bUID_([0-9A-F]+)\b/)){q=RegExp.$1}else{if(j.match(/\bSRC_(\d+)\b/)){d=RegExp.$1}else{if(j.match(/\bCATID_(\d+)\b/)){m=RegExp.$1}else{if(j.match("FUS")){o=true}else{if(j.match("PATT")){g=true}}}}}}}else{ta.util.error.record(err,"memberOverlay - elmt.id check",null,{passedElement:ta.util.error.getSelectorString(h)})}var u="";if(typeof(footprintGet)!="undefined"){u=footprintGet()}if(memoverlayCSS&&!ta.retrieve("ta.memoverlayCSS")){ta.store("ta.memoverlayCSS",new Asset.css(memoverlayCSS))}new ta.overlays.RelativeOverlayRight({style:t||"typeO",activate:ta.overlays.ACTIVATE_HOVER_DELAY,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:f,arrowClass:p,showCloseButton:true,autoShow:false,delayShow:true,offsetRight:s,offsetTop:r,remoteContent:"/MemberOverlay?uid="+q+"&c="+m+"&src="+d+"&fus="+o+"&partner="+g+"&LsoId="+u},h);return false},dropdownMiniMetaOverlayHotel:function(d,g,o,j){var m="hotel_"+j;var h=ta.id(m);if(h){var k=h.getElement(".chevron");if(k){g=k}var l=h.getElement(".dropdownMiniMeta");if(l){l=l.clone();l.set("class","dropdownMiniMeta");var f={offsetLeft:238};if(ta.util.i18n.isRtl()){f={offsetLeft:34}}ta.store("meta.dropdownHotelsActive",m);ta.overlays.Factory.dropdownMiniMetaOverlay(d,g,o,l,f)}}},dropdownMiniMetaOverlayHotelReview:function(g,d,l,k){var m="";var f=true;m=document.getElement(".skv3 .dropdownMiniMeta");if(!m){m=document.getElement(".dropdownMiniMeta")}if(!m){ta.trackEventOnPage("LP_Chevron_Dropdown_No_Data","0");var j=document.getElement(".LowestPrice.minOffer");if(j){j.click();return false}}m=m.clone();m.set("class","dropdownMiniMeta");if(!k){k=22}if(ta.retrieve("pcr_redesign_v1")||ta.retrieve("pcr_redesign_v2")){k=200}var h={offsetLeft:k};ta.overlays.Factory.dropdownMiniMetaOverlay(g,d,l,m,h)},dropdownMiniMetaOverlayComHvy:function(f,d,j){var k="";k=document.getElement(".skv3 .dropdownMiniMeta");if(!k){k=document.getElement(".dropdownMiniMeta")}if(!k){ta.trackEventOnPage("LP_Chevron_Dropdown_No_Data","0");var h=document.getElement(".LowestPrice.minOffer");if(h){h.click();return false}}k=k.clone();k.set("class","dropdownMiniMeta");var g={offsetLeft:-220};ta.overlays.Factory.dropdownMiniMetaOverlay(f,d,j,k,g)},dropdownMiniMetaOverlay:function(f,d,h,j,g){if(dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")){ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))}if(f){f.stop()}if(j){ta.overlays.Factory.createDropdownMiniMetaOverlay(f,d,h,j,g);if(!ta.retrieve("pcr_redesign_v1")&&!ta.retrieve("pcr_redesign_v2")){ta.store("pcr.disabled",true)}if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkChevronLayer(j)}return true}return false},loadDropdownCSS:function(f,d){if(dropdownMetaCSS&&!ta.retrieve("ta.dropdownMetaCSS")){ta.store("ta.dropdownMetaCSS",new Asset.css(dropdownMetaCSS))}},createDropdownMiniMetaOverlay:function(d,j,o,m,g){var f="rgba_flyout gray dropdownMiniMeta";var l=true;var h=-5;switch(ta.commerce.meta.getNavAreaContextFromDom(j)){case"PCR":l=false;f+=" pcrLightBox";h=-45;break;case"Photo_Lightbox":l=false;f+=" photoAmenitiesLightBox";break;case"Amenities_Lightbox":l=false;break;default:f+=" miniMetaLightBox"}if(ta.retrieve("pcr_redesign_v1")){h=-8}if(ta.retrieve("pcr_redesign_v2")){h=-16}var k=0;if(g){if(g.offsetLeft){k=g.offsetLeft}if(g.offsetTop){h=g.offsetTop}}new ta.overlays.RelativeOverlayBelow({style:f,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_CLICK,showArrow:l,showCloseButton:o,closeButtonClass:"roundOuterClose",arrowClass:"rgba_gray_arrow_up",offsetTop:h,offsetLeft:k,allowFlip:false,closeOnDocumentClick:true,content:m},j)},updateDropdownHotels:function(h){var f=document.getElement(".overlay.dropdownMiniMeta .inner");if(!f){return}var d=ta.retrieve("meta.dropdownHotelsActive");if(d){var k=h.getElements(".listing");var g=false;k.each(function(l){if(l.id==d){g=l}});if(g){var j=g.getElement(".dropdownMiniMeta");if(j){j=j.clone();j.set("class","dropdownMiniMeta");f.innerHTML="";f.adopt(j)}}}},createFacebookCTACallout:function(p,g,m,l,j,h,f){try{g.removePropertyEvent("mouseover","ta.overlays.Factory.createFacebookCTACallout")}catch(k){g.onmouseover=function(){}}var o=(Browser.ie7||Browser.ie8)?" ie78":"";var d={activate:ta.overlays.ACTIVATE_HOVER_DELAY,style:"s4 dg rgba_gry update2012 facebookCTAFlyout"+o,showArrow:true,pointArrowToSource:true,showCloseButton:false,delayShow:true,innerDivClass:"inner",hoverDelayTime:0,content:"<div class='onsite_cta_overlay_content'><b>"+m+"</b><br />"+j+"<br /><br /><b>"+l+"</b><br />"+h+"</div>"};new ta.overlays.RelativeOverlayBelow(d,g)},createWARCallout:function(u,k,t,p,o,m,g,l,j,h,f){try{k.removePropertyEvent("mouseover","ta.overlays.Factory.createWARCallout")}catch(r){k.onmouseover=function(){new Request({url:"/ActionRecord?action=WARMessagingCallout"+j}).send()}}var d={activate:ta.overlays.ACTIVATE_HOVER_DELAY,style:"s4 dg rgba_gry update2012",showArrow:true,pointArrowToSource:true,showCloseButton:false,delayShow:true,innerDivClass:"inner",hoverDelayTime:2000,content:'<div class="war_callout_overlay"><p><span class="title">'+t+"</span></p><p>"+p+"</p><p>"+o+"</p><p>"+m+'</p><span class="button ylw"><span class="sprite-button-ylw gradient" onclick="ta.util.cookie.setPIDCookie('+f+"); window.location.href='"+l+"'\">"+g+"</span></span></div>"};if(h==="below"){var s=(Browser.ie7||Browser.ie8)?"rgba_arrow_up_gif19":"rgba_arrow_up_png24";new ta.overlays.RelativeOverlayBelow(Object.merge(d,{arrowClass:s,yoffset:18,arrowWidth:32}),k)}else{var q=(Browser.ie7||Browser.ie8)?"rgba_arrow_rgt_gif19":"rgba_arrow_rgt_png24";new ta.overlays.RelativeOverlayLeft(Object.merge(d,{arrowClass:q,xoffset:18,arrowHeight:32,arrowLeftForce:312}),k)}},tcNavDetailOverlay:function(g,f,d){if(g){g.stop()}new ta.overlays.RelativeOverlayBelow({style:d||"typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:true,content:ta.id("INLINE_NAV_DETAIL").innerHTML},f);return false},amexHotSpotOverlay:function(k,j,d,f,h){if(k){k.stop()}var g;if(ta.has(h)){g=ta.retrieve(h);g.inner.setContent(ta.id(f).innerHTML);g.show()}else{g=new ta.overlays.RelativeOverlayBelow({style:d,activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_NEVER,showArrow:true,arrowClass:"rgba_arrow_png24",showCloseButton:false,content:ta.id(f).innerHTML},j);ta.store(h,g)}return false},createPairedCalendar:function(g,f,d){return ta.overlays.createPairedCalendar(g,f,d)},createPairedCalendarGeo:function(g,f,d){if(g){new Event(g).preventDefault()}new ta.overlays.PairedCalendar(f,{validate:true,onUpdate:ta.commerce.checkrates.showProviders.bind(ta.commerce.checkrates)});ta.commerce.checkrates.geoId=d},_injectAd:function(d){var f=ta.id(d);try{if(f){injectAdsTargeted(f)}}catch(g){ta.util.error.record(g,"AlsoViewedLB: error injecting ad into elemId="+d)}},createDatedPairedCalendar:function(h,f,d){if(!d){d={}}if(h){new Event(h).preventDefault()}f=ta.id(f);var g=f.getParent("form");d.validate=true;d.overlayOptions={onShow:function(){ta.overlays.toggleOffSearchAll(g)}};new ta.overlays.PairedCalendar(f,d);ta.overlays.toggleOffSearchAll(g)},createPairedCalendarWithDefault:function(h,f,d){if(!d){d={}}f=ta.id(f);var g=f.getParent("form");d.validate=true;d.overlayOptions={onShow:function(j){ta.overlays.clearFields(g)},onHide:function(j){ta.overlays.resetFieldsIfBlank(g)}};new ta.overlays.PairedCalendar(f,d);ta.overlays.clearFields(g)},recordVRCrossSell:function(){try{var f=ta.id("VR_CROSS_SELL");if(f){var d=f.innerHTML.indexOf("setPID");var h=f.innerHTML.substr(d+7,5);new Request({url:"/ActionRecord?action=VR_CROSS_SELL_"+h}).send()}}catch(g){ta.util.error.record(g,"VR Cross Sell - ActionRecord failed")}},launchAVLBCompleteFn:function(f){ta.overlays.Factory._loadAVCSS();var d=function(){ta.overlays.Factory._injectAd("ALSO_VIEWED_AD")};var g=function(k){var h="alsoViewedTest avStandalone";if(ta.has("ta.av_cr_leavebehind")){h="av_cr_leavebehind"}if(ta.has("checkrates.p13n_test22_six_recos")){h=h+" v6_green"}else{if(ta.has("ta.avlb_hero_photos")){h="avlb_hero_photos";if(ta.has("checkrates.hero_photos_r2xc3")){h=h+" r2xc3"}}}var j;if(ta.has("checkrates.left_overlay")){j=new ta.overlays.AbsoluteOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:h,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell},null).loadRemoteSuccess(k)}else{j=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:h,onShow:d.delay(100),onLoad:ta.overlays.Factory.recordVRCrossSell}).loadRemoteSuccess(k)}var m=false;if(j.inner){var l=ta.id("emptyAlsoViewed");if(l){m=true}else{ta.store("alsoViewedLB",true)}}else{m=true}if(m){j.hide();ta.store("commerce.pwrOverlay",j)}ta.commerce.checkrates.removePCR();ta.commerce.checkrates.loadPackages(true)};new Request({url:f,onSuccess:g,evalScripts:true}).send()},_loadAVCSS:function(){if(typeof(avlbCss)!="undefined"&&!ta.retrieve("ta.avlbCss")){ta.store("ta.avlbCss",Asset.css(avlbCss))}if(typeof(avlbTestCss)!="undefined"&&!ta.retrieve("ta.avlbTestCss")){ta.store("ta.avlbTestCss",Asset.css(avlbTestCss))}if(typeof(VRCrossSellCss)!="undefined"&&!ta.retrieve("ta.VRCrossSellCss")){ta.store("ta.VRCrossSellCss",Asset.css(VRCrossSellCss))}if(typeof(av_cr_leavebehind)!="undefined"&&!ta.retrieve("ta.av_cr_leavebehind")){ta.store("ta.av_cr_leavebehind",Asset.css(av_cr_leavebehind))}if(typeof(avlb_hero_photos)!="undefined"&&!ta.retrieve("ta.avlb_hero_photos")){ta.store("ta.avlb_hero_photos",Asset.css(avlb_hero_photos))}},_loadChkMoreCSS:function(){ta.overlays.Factory._loadAVCSS();if(typeof(chkMoreCss)!="undefined"&&!ta.retrieve("ta.chkMoreCss")){ta.store("ta.chkMoreCss",Asset.css(chkMoreCss))}if(typeof(chkMoreSpritesCss)!="undefined"&&!ta.retrieve("ta.chkMoreSpriteCss")){ta.store("ta.chkMoreSpriteCss",Asset.css(chkMoreSpritesCss))}},geoCheckratesLBAjax:function(o,f){try{if(!f){f=99999}if(ta.id("GEO_CR_LB")==null){ta.remove("checkrates.geo_cr_skip_ids")}var g=ta.retrieve("checkrates.geo_cr_skip_ids");if(g){g=g.split(",")}else{g=[]}var k=document.getElements("#GEO_CR_LB .popup_hotel_checkbox input");var j=0;var l=[];for(var u=k.length;u--;){var m=k[u];if(m.checked){var p=m.className.match(/id_(\d+)/)[1];l.push(p);var v=ta.retrieve("checkrates.vendors."+p);ta.commerce.checkrates.popOne(v[0],o);j=j+1}}g=g.concat(l.reverse());if(f-j<4){var r=ta.retrieve("overlays.current");r.hide();return}ta.store("checkrates.geo_cr_skip_ids",g.join(","));var t=3;var s=o.maxAllowedWin;if(!s){s=t}if(Browser.chrome||Browser.ie){try{var y=ta.popups.PopUtil.getHoldingWindowSet();if(y.length){s=Math.min((s+y.length),t)}}catch(z){ta.util.error.record(z,"cannot get holding windows array")}}var h=["detail="+o.propId,"nChecked="+s,"sLocIds="+g.join("-")];var d=o.getUserData();var q="http://"+document.domain+"/GeoCheckratesLb?"+h.join("&")+"&"+d;var w=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,style:"geo_cr_lb"},"click");w.loadRemoteContent(q,false)}catch(z){ta.util.error.record(z,"geo cr lb")}},precookedMetaLB:function(j){j=ta.id(j);if(typeof j=="undefined"||!j){ta.util.error.record(null,"precookedMetaLB - elmt is null or undefined");return}var g=j.innerHTML;if(!g){ta.util.error.record(null,"precookedMetaLB - no content");return}g=g.replace("REC_CONT_INLINE","REC_CONT");g=g.replace("PROVIDER_BLOCK_INLINE","PROVIDER_BLOCK");g=g.replace("lA_Inline","lA");g=g.replace("MAYBE_ROWS_INLINE","MAYBE_ROWS");g=g.replace("STATE_OPT_RESPONSE_INLINE","STATE_OPT_RESPONSE");g=g.replace("MAYBE_BUTTONS_INLINE","MAYBE_BUTTONS");g=g.replace("CHANGE_DATES_INLINE","CHANGE_DATES");g=g.replace(/_inm/g,"_met");g=g.replace(/ta\.widgets\.calendar\.launchMetaInlineUpdate/g,"ta.widgets.calendar.launchMetaLightboxUpdate");g=g.replace(/_solbin/g,"_som");g=g.replace(/inline_xsell_see_all_link/g,"State-Optimized-Modal_xsell_see_all_link");g=g.replace(/inline_click/g,"State-Optimized-Modal_click");g=g.replace(/inline_xsell_chevron/g,"State-Optimized-Modal_xsell_chevron");var f="metaCheckRatesOverlay";if(ta.has("stateopt_modal_test")){f=f+" stateoptModal"}var h=new ta.overlays.CenteredOverlay({style:f,backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",content:g},j);ta.store("metaCheckRatesOverlay",h);var m=ta.id("REC_CONT");if(m){m.setStyles({height:"100%",opacity:"1"})}h.show();h.position();var l=h.inner.getElements(".hotelListing").length;var d="Displayed_Lightbox";if(l==0){d="Not_Displayed_Lightbox"}ta.trackEventOnPage("Meta_State-Optimized-Modal_XSell",d,l);var k="chevron_click";if(ta.retrieve("stateoptModal.GA_auto")){k="auto";ta.store("stateoptModal.GA_auto",false)}ta.trackEventOnPage("state_optimized_modal","open",k)},loadSpecialMetaLeaveBehind:function(d,j,h){if(typeof(metaXsellLbCss)!="undefined"&&!ta.retrieve("ta.metaXsellLbCss")){ta.store("ta.metaXsellLbCss",Asset.css(metaXsellLbCss))}var g="metaCheckRatesOverlay";var f=new ta.overlays.CenteredOverlay({style:g,absoluteOffset:true,yOffset:(Math.max(20,window.getHeight()-625)/2)+window.getScrollTop(),xOffset:Math.max(5,window.getWidth()-896)/2,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",content:'<div style="background-color:#EEE;"><img style="padding:150px;display:block;width:79px;margin:auto;" src="/img2/meta_sprites/loadingAnim.gif"></div>'},d);ta.store("metaLeaveBehindOverlay",f);if(ta.retrieve("specialMetaLeaveBehindV2")){ta.commerce.meta.loadBestPriceXsell(j,f.inner,{isMetaLbV2:true,openedVendors:h},null)}else{ta.commerce.meta.loadBestPriceXsell(j,f.inner,{isMetaLeaveBehind:true,openedVendors:h},null)}},loadGeoCrAutoBroadenOverlay:function(d,h){var g=ta.retrieve("gcrab.cssPath");if(g&&!ta.retrieve("gcrab.css")){ta.store("gcrab.css",Asset.css(g))}var f=new ta.overlays.CenteredOverlay({permanent:true,style:"gcrabLb",noPadding:true,absoluteOffset:true,yOffset:(Math.max(20,window.getHeight()-520)/2)+window.getScrollTop(),xOffset:Math.max(5,window.getWidth()-965)/2,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",content:'<div style="background-color:#EEE;"><img style="padding:150px;display:block;width:79px;margin:auto;" src="'+ta.util.imageServer("/img2/meta_sprites/loadingAnim.gif")+'"></div>',onClose:function(){ta.trackEventOnPage("GeoCheckRatesLightBox","unload","CloseButton",0,false)}},d);ta.commerce.meta.loadGeoCrAutoBroadenContents(f,h)},loadCheckMoreOverlay:function(h,d,g){var q=(h.getVendorSet().getCheckedInfo("count")<7);if(ta.has("checkrates.p13n_test22_six_recos")){q=false}var s="";var m=0;var j=0;var p=ta.has("checkrates.check_more_re");var l=ta.has("checkrates.check_more_hero_photos");var r=ta.has("checkrates.doNotAnimateCheckMore");var f=ta.has("checkrates.check_more_re_center_large_hero_photos");var o=ta.has("checkrates.check_more_center_v6");var t=ta.has("checkrates.hero_photos_r2xc3");if(!f&&!t){s="alsoViewedTest check_more_sites"}if(p||l){if(!o){s+=" avlb_hero_photos"}m=5;j=5;if(o){s+=" check_more_center_v6"}else{if(p){s+=" check_more_re"}else{if(l){s+=" check_more_hero_photos"}}}if(t){s+=" r2xc3"}}if(ta.has("checkrates.center_overlay")){var k=new ta.overlays.CenteredOverlay({style:s,backdrop:ta.overlays.BACKDROP_ALWAYS,onLoad:function(){ta.commerce.checkrates.removePCR();if(p||l||r){try{ta.commerce.checkrates.loadPackages(false)}catch(u){ta.util.error.record(u,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},g)}else{var k=new ta.overlays.AbsoluteOverlay({style:s,backdrop:ta.overlays.BACKDROP_ALWAYS,repositionOnScroll:q,xOffset:m,yOffset:j,onLoad:function(){ta.commerce.checkrates.removePCR();if(p||l||r){try{ta.commerce.checkrates.loadPackages(false)}catch(u){ta.util.error.record(u,"hotel packages - loadPackages")}}},onHide:ta.commerce.checkrates.restoreCRPageServlet},g)}ta.overlays.Factory._loadChkMoreCSS();if(h.type=="checkdeals"){k.loadRemoteSuccess=function(u){this.inner.set("html",u);ta.commerce.smartdeals.popBlockerOverlay(k,h,g);this.position()}}if(h.isCheckMore){k.addEvent("onClose",ta.commerce.checkrates.recordClose.bind(ta.commerce.checkrates));if(!r&&!p&&!l){k.addEvent("load",ta.commerce.checkrates.showRemainingCheckMore.bind(ta.commerce.checkrates))}}k.loadRemoteContent(d,false)},loadCheckRatesLBOverlay:function(r,g,k){try{var h={d:k.detail,s:crPageServlet,a:k.area};if(ta.retrieve("checkrates.meta_ui_post_click_prices")){var l="QC_Meta_Mini|Photo_LB";var p;try{p=ta.commerce.meta.tracking.setTimingForNavArea(l);h.metaRequestTiming=p}catch(m){ta.util.error.record(m,"problem locking timing for QC_Meta_Mini|Photo_LB")}}var f=ta.widgets.calendar.getCheckRatesData();if(f){h=Object.merge(h,f)}var q="s3 dg cr_lb_overlay";if(ta.has("checkrates.check_rates_lb_mini_meta")){q=q+" cr_lb_overlay_meta"}if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")){q=q+" lb_overlay_post_date_close"}var d={backdrop:ta.overlays.BACKDROP_ALWAYS,style:q,requestData:h,remoteContent:"http://"+document.domain+"/CheckRatesLB",showCloseButton:true,permanent:true,onLoad:function(){ta.commerce.checkrates.removePCR;ta.commerce.checkrates.updateCRForm("_cro");if((ta.has("checkrates.check_rates_lb_mini_meta")||ta.retrieve("meta.prof_photo_lb.post_date_close.enabled"))&&!f){if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")){ta.trackEventOnPage("DATEPICKER","OPEN","CalendarLightbox")}ta.overlays.Factory.loadDatePicker(r,this,k.detail,"_cro",ta.widgets.calendar.launchCRLBUpdate)}},onHide:function(){if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")&&ta.retrieve("meta.prof_photo_lb.post_date_close.overlay")){ta.remove("meta.prof_photo_lb.post_date_close.overlay")}ta.commerce.checkrates.restoreCRPageServlet}};if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")){d.closeButtonClass="roundOuterClose";d.onClose=function(){ta.trackEventOnPage("CalendarLightbox","unload","CloseButton")}}else{d.closeLink='<div class="close_text">'+overlayCloseTxt+"</div>"}var o=new ta.overlays.CenteredOverlay(d,g);if(typeof(checkRatesLBCss)!="undefined"&&!ta.retrieve("ta.checkRatesLBCss")){ta.store("ta.checkRatesLBCss",Asset.css(checkRatesLBCss))}if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")){ta.store("meta.prof_photo_lb.post_date_close.overlay",o)}}catch(j){ta.util.error.record(j,"check rates leave behind")}},tryToHideCROverlayPostDatesClose:function(){if(ta.retrieve("meta.prof_photo_lb.post_date_close.enabled")&&ta.retrieve("meta.prof_photo_lb.post_date_close.overlay")){var d=ta.retrieve("meta.prof_photo_lb.post_date_close.overlay");if(d){d.hide()}}},loadPCROverlay:function(){try{var g=ta.id("CHECK_RATE");if(!g||(g.getPosition().y==0&&ta.id("COM_HVY_CR_BTN"))){g=ta.id("COM_HVY_CR_BTN")}if(ta.has("meta.isHackathonBC")&&(ta.has("meta.session_dates")||ta.widgets.calendar.hasPageDates())){g=ta.id("MetaRatesContent")}var m=ta.id("PERSISTENT_CHECK_RATES_CONTENT");var o=window.getScroll();if(!m){return}var f=m.hasClass("closeTest");if(!g||!o){m.dispose();return}ta.store("pcr.scrollPoint",g.getPosition().y);if(!o){return}ta.store("pcr.initialYPos",window.getScroll().y);var h=m.get("html");m.dispose();var k="persistentCR";if(ta.retrieve("checkrates.meta_ui_post_click_prices")){if(ta.retrieve("checkrates.pcr_classic_styling_on_meta")){k=k+" classicOnMeta"}else{k=k+" miniMetaPCR"}}var d="sprite-greenX";if(ta.retrieve("pcr_redesign_v1")){d="sprite-greenX rd1"}var j=new ta.overlays.AbsoluteOverlay({toWindow:false,autoShow:false,positionType:"fixed",permanent:true,zIndex:"9996",style:k,content:h,closeButtonClass:d,closeLink:"<div>"+ta.commerce.checkrates.pcrCloseTxt+"</div>",onClose:function(){try{ta.store("pcr.keepHidden",true);Cookie.writeSession("CPCR",1);new Request({url:"/ActionRecord?action=persistent_cr_close"}).send()}catch(p){ta.util.error.record(p,"pcr - onClose")}}});ta.store("pcr.overlay",j);window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);window.addEvent("scroll",ta.commerce.checkrates.positionCheckRates)}catch(l){window.removeEvent("scroll",ta.overlays.Factory.loadPCROverlay);ta.util.error.record(l,"pcr - scroll init");return false}},loadPHACOverlay:function(){try{var g=ta.id("HAC_FORM");var l=ta.id("PERSISTENT_CHECK_RATES_CONTENT");var m=window.getScroll();if(!l){return}if(!g||!m){l.dispose();return}ta.store("pcr.scrollPoint",g.getPosition().y);if(!m){return}ta.store("pcr.initialYPos",window.getScroll().y);var f=l.get("html");l.dispose();var j="persistentCR";var d="<div>"+ta.commerce.checkrates.pcrCloseTxt+"</div>";var o="sprite-greenX";if(ta.has("hac.persistent_hac_translucent")){j+=" translucent";d="<div>"+ta.commerce.checkrates.pcrCloseTxt+'<span class="boldX">X</span></div>';o="closeX"}var h=new ta.overlays.AbsoluteOverlay({toWindow:false,autoShow:false,positionType:"fixed",permanent:true,zIndex:"9996",style:j,content:f,closeButtonClass:o,closeLink:d,onClose:function(){try{ta.store("pcr.keepHidden",true);Cookie.writeSession("CPCR",1);new Request({url:"/ActionRecord?action=persistent_hac_close"}).send()}catch(p){ta.util.error.record(p,"phac - onClose")}}});ta.store("pcr.overlay",h);window.removeEvent("scroll",ta.overlays.Factory.loadPHACOverlay);window.addEvent("scroll",ta.commerce.checkrates.positionCheckRates)}catch(k){window.removeEvent("scroll",ta.overlays.Factory.loadPHACOverlay);ta.util.error.record(k,"phac - scroll init");return false}},tamgShowLightbox:function(g,f,h){var d="tripadvisor.com";if(typeof cookieDomain!="undefined"){d=cookieDomain.substring(1,cookieDomain.length)}new Asset.css(h);new Request({url:"/TAMGFooterAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{style:"s0 TAMG_All"})},data:{a:"SHOW_GROUP_OVERLAY",dom:d},evalScripts:true,method:"get"}).send()},intlPopup:function(l,g){if(l){l.stop()}g.onclick=null;if(flagsUrl==null||flagsUrl==""){flagsUrl=document.location.pathname}var h="/StaticVelocityPage?t=intSitesFly.vm&lt=evt&footerFlagFormat="+footerFlagFormat+"&flagsURL="+encodeURIComponent(flagsUrl);if(document.location.search!=""){h+=encodeURIComponent(document.location.search)}if(document.location.hash!=""){h+=encodeURIComponent(document.location.hash)}if(window.modelGeoId){h+="&geo="+modelGeoId}if(window.flagsSettings){for(var d=0;d<flagsSettings.length;d++){h+="&"+flagsSettings[d]+"=true"}}if(window.pageFeature){h+="&pageFeature="+pageFeature}new Asset.css(flagsFlyoutCSS);var j=ta.retrieve("fall_2013_masthead_refresh");var f=j?"dropMenu_refresh":"typeO";new ta.overlays.RelativeOverlayBelow({showCloseButton:!j,activate:ta.overlays.ACTIVATE_CLICK,remoteContent:h,style:f},g);return false},showRecentLocationEmailOverlay:function(){setPID(3833);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"share_overlay"},evalScripts:true,method:"get"}).send()},expandRecentlyViewed:function(g,f){for(var d=4;d<7;d++){var j=ta.id("recently_viewed_"+d);if(j&&j.hasClass("hidden")){j.removeClass("hidden")}}var h=ta.id("RECENTLY_VIEWED_MORE");if(h){h.addClass("hidden")}},showRecentlyViewedCompareOverLay:function(){ta.util.cookie.setPIDCookie(4898);var f=window.location.protocol+"//"+window.location.hostname+"/CompareHotels?detail=";var d=0;for(d=0;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){f=f+g.get("locid");d+=1;break}}for(;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){f=f+"&compareHotelId="+g.get("locid")}}if(typeof(compareHotelCSS)!="undefined"&&!ta.retrieve("ta.compareHotelCssAsset")){ta.store("ta.compareHotelCssAsset",Asset.css(compareHotelCSS))}new Request({url:f,onSuccess:function(h){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:h})}}).send()},clearRecentLocations:function(){var f=ta.id("RECENTLY_VIEWED_LIST");if(f){var d=f.getNext(".bxDivider");f.dispose();if(d){d.dispose()}}new Request({url:"/RecentlyViewedAjax?a=clear"}).send()},removeParticularLocation:function(d,f,q){var h=ta.id("recently_viewed_"+q);if(h){var p=h.get("locid");h.dispose();new Request({url:"/RecentlyViewedAjax?a=remove&locID="+p}).send();for(;q<7;++q){h=ta.id("recently_viewed_"+q);if(h&&h.hasClass("hidden")){h.removeClass("hidden");break}}for(;q<7;++q){h=ta.id("recently_viewed_"+q);if(h&&h.hasClass("hidden")){return}}var j=ta.id("RECENTLY_VIEWED_MORE");if(j&&!j.hasClass("hidden")){j.addClass("hidden")}var o=$$("li.rv_item");var m=0;var g=false;if(o){m=o.length;for(var k=0;k<m;k++){if(!o[k].hasClass("geoItem")){g=true}}}if(!g){var l=ta.id("RV_SAVE");if(l){l.dispose()}}if(m===0){var h=ta.id("RECENTLY_VIEWED_LIST");if(h){h.dispose()}}else{if(m===1){var h=ta.id("COMPARE_HOTELS");if(h){h.getParent().addClass("hidden")}}}}},showSendMessage:function(s,f){if(s){s.stop()}if(ta.has("overlays.sendmessage.loading")){return}else{ta.store("overlays.sendmessage.loading",true);ta.remove.delay(500,null,"overlays.sendmessage.loading")}if(typeof(privateMsgCSS)!="undefined"&&!ta.retrieve("ta.privateMsgCssAsset")){ta.store("ta.privateMsgCssAsset",Asset.css(privateMsgCSS))}var j=ta.retrieve("overlays.sendmessage");var g="";if(f.get("tag")=="span"&&f.hasClass("fkASDF")){g=f.className.match(/u_([^ ]*)/)[1]}else{g=f.href}if(j&&g.match(/notyou=1/)){window.location="/NewsletterSignOut-e__2F__MemberSignIn"}else{if(j){return}}var q=f.className.match(/\b(callback_ShowRecaptcha)\b/);var l;if(q){new Asset.javascript("http://api.recaptcha.net/js/recaptcha_ajax.js");l="callback_ShowRecaptcha"}var d=f.className.match(/\bpm(\d)([A-F0-9]+)\b/);if(!d){return}var o=parseInt(d[1])==1?"cc":"cm";if(!userLoggedIn||migrationMember){var m=o=="cm"?"m2m_singin_greeting_d99":"";var p=d[2];ta.store("community.needsReload",true);window.loginSuccess=function(){if(!reg_overhaul){hideIFrame()}ta.common.sendmessage.communityLightbox(g,l)};if(reg_overhaul){var k=o=="cm"?"PRIVATE_MESSAGE":"COMPLIMENT_USER";ta.overlays.registration.connect({flow:k})}else{var h=!userLoggedIn?login:migrate;h(["tt",o,"greeting",m,"returnTo",getRelativeURL()])}return}var r=o=="cm"&&typeof(footprintGet)!="undefined"?footprintGet():null;if(r){g+="&LsoId="+r}ta.common.sendmessage.communityLightbox(g,l)},showConnectOverlay:function(g,d,f,j,h){ta.overlays.registration.connect(f,j,h)},showLoginOverlay:function(g,f,h,j,d){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCssAsset")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}ta.overlays.registration.request(h,j,d)},showRoomTipsOverlay:function(h,g,l){try{ta.util.cookie.setPIDCookie(4840);var f="http://"+window.location.hostname+"/AccommodationTips?d="+modelLocId;if(l){f=f+"&filterLang="+l}var j=false;var d=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_NEVER,style:"s3 dg nopadding",permanent:true,zIndex:"9997",showCloseButton:true,remoteContent:f,onLoad:function(){if(d.inner){var m=ta.id("emptyTips");if(m){j=true}}else{j=true}if(j){d.hide()}}},g)}catch(k){ta.util.error.record(k,"showRoomTipsOverlay")}},_loadSummaryCss:function(){if(typeof(conceptsCss)!="undefined"&&!ta.retrieve("ta.conceptsCssAsset")){ta.store("ta.conceptsCssAsset",Asset.css(conceptsCss))}},showReviewSummary:function(o,j,h,d){if(h&&d){ta.overlays.Factory.showSummaryTranslation(o,j,h);return}var k=null;var l=null;var f=null;var m=0;var g=0;if(o){o.stop()}if(j.id&&j.id!=""){k=j.id.replace("concept_","").replace(/_/g," ");ta.store("topconcepts.lastconcept",k);f="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+k;if(h){f+="&autotrans=true"}}else{ta.util.error.record(null,"showReviewSummary - elmt.id check");return}ta.overlays.Factory._loadSummaryCss();l=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding",autoShow:false,permanent:true,showCloseButton:true,remoteContent:f,onLoad:function(p){ta.store("topconcepts.overlay."+k,this);this.show()}},j);j.onclick=l.show;return false},showSummaryTranslation:function(m,h,l){ta.util.cookie.setPIDCookie(16007);if(m){m.stop()}var f="s3 dg nopadding";ta.overlays.Factory._loadSummaryCss();var k="/MachineTranslation?";if(h.id&&h.id!=""){var j;if(h.id.indexOf("trans_")!=-1){j=h.id.replace("trans_","").replace(/_/g," ")}else{j=h.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",j);k+="page=summary&";k+="d="+modelLocId+"&";k+="concept="+j;k+="&sl=en&tl="+l}var d="topconcepts.overlay."+j;var g=ta.retrieve(d);if(g){g.hide()}g=new ta.overlays.CenteredOverlay({style:f,showCloseButton:true,remoteContent:k,onLoad:function(o){ta.store(d,this);this.show()}},h)},toggleConceptSnippetTranslation:function(m,g){var l=null;var j=null;var k=null;var h=null;var d=null;if(m){m.stop()}if(g){ta.util.cookie.setPIDCookie(4111);k=g.id.replace(/[^_]*_(.*)/,"$1");l=ta.id("SUMMARYOVERLAY_"+k);if(l){j=l.getElements(".snippetText");for(var f=0;f<j.length;f++){if(j[f].isDisplayed()){j[f].hide()}else{j[f].show("inline")}}}h=ta.id("trans_"+k);d=ta.id("en_"+k);if(h.hasClass("activeButton")){h.removeClass("activeButton");h.addClass("inactiveButton")}else{h.removeClass("inactiveButton");h.addClass("activeButton")}if(d.hasClass("activeButton")){d.removeClass("activeButton");d.addClass("inactiveButton")}else{d.removeClass("inactiveButton");d.addClass("activeButton")}if(ta.overlays.Factory.storeReviewSummaryContent){ta.overlays.Factory.storeReviewSummaryContent(k.replace(/_/g," "),l.getParent().get("html"))}}},reviewTranslate:function(k,h,f){ta.util.cookie.setPIDCookie(16009);ta.overlays.Factory._loadSummaryCss();var g=ta.has("photo.viewer.lightbox");var j=1001;if(g){j=10001}var d=new ta.overlays.CenteredOverlay({style:"s4 dg",zIndex:j,showCloseButton:true,remoteContent:f,onLoad:function(l){this.show()}});ta.store("translationOverlay",d)},showRefreshedRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}var f="";for(var d=1;d<7;d++){var g=ta.id("recently_viewed_"+d);if(g){if(f==""){f+=g.get("locid")}else{f+="-"+g.get("locid")}}}new Request({url:"/RecentlyViewedAjax",onSuccess:function(h){if(!h.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(h,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"subset_save_overlay",locNums:f},evalScripts:true,method:"get"}).send()},showRecentLocationSaveOverlay:function(){setPID(3832);if(typeof(recentViewedCSS)!="undefined"&&!ta.retrieve("ta.recentViewedCssAsset")){ta.store("ta.recentViewedCssAsset",Asset.css(recentViewedCSS))}new Request({url:"/RecentlyViewedAjax",onSuccess:function(d){if(!d.match("emptyRecentlyViewed")){ta.overlays.showInLightbox(d,{style:"dg s4 RecentlyViewedOverlay"})}},data:{a:"save_overlay"},evalScripts:true,method:"get"}).send()},createIPPinOverlay:function(f,g){var d;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){if(typeof(friendStripMouseoverPageAction)=="undefined"||!friendStripMouseoverPageAction){return}d=setTimeout(function(){new Request({url:"/ActionRecord?action="+friendStripMouseoverPageAction}).send();friendStripMouseoverPageAction=null},400)},onHide:function(){clearTimeout(d)},content:g},f)},createFriendActivityOverlay:function(f,g,h){var d;return new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 mg",onShow:function(){h&&ta.util.pending.lock("friendActivityOverlay.pageAction",function(){d=setTimeout(function(){new Request({url:"/ActionRecord?action="+h}).send()},400)})},onHide:function(){clearTimeout(d)},content:g},f)},createFriendActivityLightbox:function(d){return new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s4 mg friendActivity",content:d})},createCouponAnnouncementOverlayRedirect:function(f,l,d,o,k,g,h,m,j){ta.overlays.Factory.createCouponAnnouncementOverlay(null,null,f,l,d,o,k,g,h,m,j)},createCouponAnnouncementOverlay:function(f,j,k,r,g,t,q,m,l,s,p,h){ta.util.cookie.setPIDCookie(m);Asset.css(q);var d=new Object();d.act=k;if(l!=null){d.act+="-"+l}else{if(window.pageServlet!=null){d.act+="-"+pageServlet}}var o;if(p&&p!="false"){o="amex"}else{o="typeB4 og"}new Request({url:"/CouponAjax?"+(r?"couponId="+r+"&":"")+(g?"announcementId="+g+"&":"")+(s?"locale="+s+"&":"")+(h?"showLocs="+h+"&":"")+"locationId="+t+"&listing=true",data:d,onSuccess:function(v){var u=ta.overlays.showInLightbox(v,{style:o,delayedPosition:true});u.closeBtn.addEvent("click",ta.servlet.blcoupons.closeHandler)},evalScripts:true}).send()},postVideoLogin:function(f,d,g){if(g){ta.util.cookie.setPIDCookie(g)}ta.overlays.registration.connect({flow:"POST_VIDEO"},"SIGNIN")},fbLogin:function(f,d){ta.support.Facebook.login()},createAmenitiesLightbox:function(f){var k=location.pathname;if(k.length>0){if(k.charAt(0)=="/"){k=k.substring(1)}var j=k.indexOf("-");if(j>=0){k=k.substring(0,j)}}var d=f.id;if(d.indexOf("amenity_")==0){locationId=d.substring(8)}var g="http://"+document.domain;var h=false;if(ta.remove("amenities.suppressLinks")){h=true}new ta.overlays.RelativeOverlayBelow({autoShow:true,style:"s3 dg",showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,requestData:{d:locationId,tab:"amenities",from:k,suppressLinks:h},remoteContent:g+"/LocationTab"},f)},amenitiesLightboxViewWithOpen:function(d){ta.setEvtCookie("reviews","clicked","amenities",0,d);var f="ta.overlays.Factory.simulateAmenitiesClick";Cookie.write("ajaxAction",f,{domain:cookieDomain,path:"/"})},simulateAmenitiesClick:function(){var d=document.getElement(".amenityTarget");if(d){d.click()}},travelerPhotosViewWithOpen:function(d){ta.setEvtCookie("reviews","clicked","travelerphotos",0,d);var f="ta.overlays.Factory.simulateTravelerPhotosClick";Cookie.write("ajaxAction",f,{domain:cookieDomain,path:"/"})},simulateTravelerPhotosClick:function(){var d=document.getElement(".travelerPhotosTarget");if(d){d.click()}},reviewButtonClickTracking:function(d){ta.setEvtCookie("reviews","clicked","reviews_tab",0,d)},createAmenitiesLightboxFull:function(p,f,j){if(p){p.stop()}if(typeof(amenityLightboxCss)!="undefined"&&!ta.retrieve("ta.amenityLightboxCss")){ta.store("ta.amenityLightboxCss",Asset.css(amenityLightboxCss))}if(j&&j>0){setPID(j)}var h=f.id;if(h.indexOf("amenity_")==0){locationId=h.substring(8)}ta.setEvtCookie("HotelContactInfo","Amenities",locationId,1,"/LocationTab");var k="http://"+document.domain;var d={backdrop:ta.overlays.BACKDROP_ALWAYS,style:"s3 dg",onLoad:function(){this.position();ta.commerce.checkrates.updateCRForm("_amo");injectAdsTargeted(document.getElement("#AMENITY_LIGHTBOX"));this.position()},showCloseButton:true,permanent:true,requestData:{d:locationId,tab:"amenities_lightbox",from:pageServlet},remoteContent:k+"/LocationTab"};if(ta.retrieve("checkrates.meta_ui_post_click_prices")){var l="QC_Meta_Mini|Amenities_Lightbox";var o;try{o=ta.commerce.meta.tracking.setTimingForNavArea(l)}catch(m){ta.util.error.record(m,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}d.onShow=function(){var q=ta.retrieve("meta.baseLocationId");if(q){try{ta.commerce.meta.tracking.setTimingForNavArea(l)}catch(r){ta.util.error.record(r,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}ta.commerce.meta.updateProvAreaFromLightBox(q)}};if(o){d.requestData={d:locationId,tab:"amenities_lightbox",from:pageServlet,area:l,metaRequestTiming:o}}else{d.requestData={d:locationId,tab:"amenities_lightbox",from:pageServlet,area:l}}}var g=new ta.overlays.CenteredOverlay(d,f);g.show();f.onclick=function(){g.show();ta.common.ads.injectAdsTargeted(document.getElement("#AMENITY_LIGHTBOX"));ta.commerce.checkrates.updateCRForm("_amo")};ta.commerce.meta.tracking.resetTimingLockForNavArea(l);ta.store("ta.amenityLightboxOverlay",g);return false},iapFlyout:function(g,f,d){d.elmt=f;ta.store("iapFlyoutOptions",d);ta.overlays.registration.connect({flow:"IAP_VOTE"})},iapFlyoutHelper:function(j,g,f){f=ta.retrieve("iapFlyoutOptions");var d=ta.retrieve("iapFlyout");if(d){d.hide()}var h=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,permanent:true,remoteContent:"/ReportIAP?action=reportIAP&step=START&contentId="+f.contentId+"&voteContentType="+f.voteContentType,style:"s3 dg iapFlyout"},f.elmt);ta.store("iapFlyout",h)},openSavesRegflow:function(){ta.widgets.Saves.openSavesRegflow()},openSavesHoverRegflow:function(){ta.widgets.Saves.openSavesHoverRegflow()},openMastheadRegflow:function(){ta.widgets.Saves.openMastheadRegflow()},createGuideOverlay:function(){ta.overlays.registration.connect({flow:"DESTINATION_GUIDE"},"SIGNUP")},createPostPhotosOverlay:function(){ta.overlays.registration.connect({flow:"POST_PHOTOS"},"SIGNUP")},relBelowOverlaySolidGreenBorder:function(f,d){d.onmouseover=null;new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"s3 dg"},d)},createDropDown:function(j,f,h){f=ta.id(f);f.onmouseover=null;try{var d=new ta.overlays.RelativeOverlayBelow({content:h,style:"dropMenu",fontSize:"12px",zIndex:202,activate:ta.overlays.ACTIVATE_HOVER,pinnable:ta.overlays.PINNABLE_CLICK,onShow:function(k){f.addClass("tabLinkShown");f.addClass("arwLinkShown");f.getParent().addClass("tabItemShown");f.getElement("img").addClass("sprite-arrow_dropdown_wht_show")},onHide:function(k){f.removeClass("tabLinkShown");f.removeClass("arwLinkShown");f.getParent().removeClass("tabItemShown");f.getElement("img").removeClass("sprite-arrow_dropdown_wht_show");var l=h.getElements(".text");Array.each(l,function(m){var o=m.retrieve("typeAhead");if(o){o.hideChoices()}})}},f)}catch(g){return}d.pinAndSetUnpin=function(k){d.pin();document.addEvent("click",d.unpinAndSetPin)};d.unpinAndSetPin=function(k){k=new Event(k);if(!d.container.containsEvent(k)&&!k.target.hasClass("dropSelect")){d.hide();d.unpin();document.removeEvent("click",d.unpinAndSetPin);d.container.addEvent("click",d.pinAndSetUnpin)}};d.container.addEvent("click",function(k){d.pinAndSetUnpin(k)})},popConditionsOverlay:function(){var d=ta.id("CONDITIONS");if(d){ta.overlays.showInLightbox(d.innerHTML)}},showCompareOverLay:function(d,j,f){var k=window.location.protocol+"//"+window.location.hostname;var h=k+"/CompareHotels?detail="+f;for(var g=0;g<3;g++){var l=ta.id("compare_hotels_"+g);if(l&&l.checked==true){h=h+"&compareHotelId="+l.value}}new Asset.css(compareHotelCSS);new Request({url:h,onSuccess:function(m){new ta.overlays.CenteredOverlay({activate:ta.overlays.ACTIVATE_CLICK,backdrop:ta.overlays.BACKDROP_ALWAYS,style:"compareHotel",content:m})}}).send()},createNeighborhoodOverlay:function(k,h,d){if(ta.has("nbhdOverlay")){if(h){h.onclick=null}ta.retrieve("nbhdOverlay").show();return}var f=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,permanent:true,zIndex:"997",style:"nbhdOverlay typeO",activate:ta.overlays.ACTIVATE_CLICK,pinnable:ta.overlays.PINNABLE_ALWAYS,onShow:function(){if(d){ta.servlet.HACSearch.filter.update()}},onHide:function(){if(d){ta.servlet.HACSearch.filter.update()}}},"NEIGHBORHOOD_OVERLAY");var g=f.inner;var j=ta.id("NEIGHBORHOOD_FORM");if(g&&j){j.inject(g,"top");j.removeClass("hidden");ta.store("neighborhoodOverlayForm",j)}ta.store("nbhdOverlay",f)},createHACProgressOverlay:function(){try{if(ta.has("ta.hac.progress.overlay")){return ta.retrieve("ta.hac.progress.overlay")}var h=ta.id("HAC_PROGRESS_CONTAINER").dispose();var d=h.get("html");var g=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",showCloseButton:false,permanent:true,content:d});ta.store("ta.hac.progress.overlay",g);return g}catch(f){ta.util.error.record(f,"createHACProgressOverlay")}},getFilterWaitOverlay:function(){var f=ta.retrieve("filters.waitDialog");if(!f){var d="mg s1 fatNotice";if(ta.isHotelsRedesign2011()||ta.has("hotels.redesignEnabled")){d=d+" fatNotice_2011"}f=new ta.overlays.CenteredOverlay({style:d,showCloseButton:false,autoShow:false,delayedPosition:true});f.inner.set("html","<b>"+JS_UpdatingYourResults+"</b>");ta.store("filters.waitDialog",f)}return f},showFilterWaitOverlay:function(f){var d=ta.overlays.Factory.getFilterWaitOverlay();if(d){if(f){d.show();d.position(false)}else{d.hide()}}},showUpdatingMessage:function(){var f=ta.overlays.Factory.getFilterWaitOverlay();f.show();if(ta.remove("filter.map")){f.container.setStyles({left:-9999,top:-9999});var g=ta.id(ta.retrieve("maps.container")).getCoordinates();var d=f.container.getCoordinates();f.container.setStyles({left:g.left+(g.width-d.width)/2,top:g.top+(g.height-d.height)/2})}if(ta.remove("filter.lockout")){f.enableBackdrop()}hideBCPromo()},createPhotoUploaderOverlay:function(d){var f=new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s2 dg",innerDivClass:"noPadMarg",attachCloseEvent:true,permanent:true,onLoad:ta.media.uploader.onLoadOverlayHandler,onClose:function(){if(ta.has("tipsOverlay")&&ta.retrieve("tipsOverlay").hide){ta.retrieve("tipsOverlay").hide();ta.remove("tipsOverlay")}}});f.loadRemoteContent(d,true);ta.store("ta.media.uploader.photoUploaderOverlay",f)},createIpDeauthOverlay:function(f,d){new Request({url:"/ActionRecordPlus?action=DEAUTH_IP&id="+f,onSuccess:function(g){new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:false}).loadRemoteSuccess(g);if(d){ta.support.Facebook.ipRevoke(10000)}},onFailure:ta.util.error.ajaxFailure.partial("partials:ip_disable")}).send()},kinderOverlay:function(j,g){try{g.onclick=null;var h={style:"s4 dg kinder",showCloseButton:true,isChild:true,activate:ta.overlays.ACTIVATE_CLICK};var d=document.getElement(".overlay");if(d){h.onShow=function(){var l=d.overlay;if(!l.pinned){l.unpinOnHide=true;l.pin()}},h.onHide=function(){var l=d.overlay;if(l.unpinOnHide){l.unpinOnHide=false;l.unpin()}}}var f=new ta.overlays.RelativeOverlayBelow(h,g)}catch(k){ta.util.error.record(k,"Error: kinderOverlay")}},loadBLSlideshowOverlay:function(h,g,f,d){if(t4bSlideshowCSS&&!ta.retrieve("ta.t4bSlideshowCSS")){ta.store("ta.t4bSlideshowCSS",new Asset.css(t4bSlideshowCSS))}new Request({url:"/BusinessListingsAjax",onSuccess:function(j){ta.overlays.showInLightbox(j,{backdrop:ta.overlays.BACKDROP_ALWAYS,style:"g s10px np"})},data:{act:"slideshow",detail:f,pid:d,flash:(Browser.Plugins.Flash.version>=10)},evalScripts:true,method:"get"}).send()},showPartnerAttributionTip:function(g,d,f){new ta.overlays.RelativeOverlayBelow({showCloseButton:true,style:"s3 dg update2012 rgba_gry partner_attrib",content:f},d)},accountMenuFlyout:function(l,f){f.onmouseover=null;f.onclick=null;try{var k=ta.retrieve("fall_2013_masthead_refresh");var d=k?"dropMenu dropMenu_refresh accountMenuFlyout":"dropMenu accountMenuFlyout";var g=k?ta.overlays.ACTIVATE_CLICK:ta.overlays.ACTIVATE_HOVER;var j=new ta.overlays.RelativeOverlayBelow({activate:g,style:d,onShow:function(){if(!k){this.container.setStyle("margin-left","19px")}},onHide:function(){this.container.setStyle("margin-left","0")}},f);ta.store("accountMenuFlyout",j)}catch(h){ta.util.error.record(h,"Error: ta.overlays.Factory.accountMenuFlyout")}},messageMenuFlyout:function(g,d){if(g){g.stop()}try{new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_CLICK,style:"messageMenuOverlay",innerDivClass:"",content:ta.id("MESSAGE_MENU").innerHTML,offsetLeft:23,offsetTop:2,showCloseButton:false},d)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factor.messageMenuFlyout")}},ratingMenuFlyout:function(h,d){d.onmouseover=null;try{var g=new ta.overlays.RelativeOverlayBelow({activate:ta.overlays.ACTIVATE_HOVER,style:"dropMenu ja_ratingMenuFlyout"},d);ta.store("ratingMenuFlyout",g)}catch(f){ta.util.error.record(f,"Error: ta.overlays.Factory.ratingMenuFlyout")}},bizListingsMenuFlyout:function(j,d){d.onmouseover=null;try{var g=d.getNext("div"),f=ta.retrieve("accountMenuFlyout");if(g){g=g.get("html")}new ta.overlays.RelativeOverlayRight({content:g,zIndex:2000,style:"dropMenu bizListingsMenuFlyout",activate:ta.overlays.ACTIVATE_HOVER,onShow:function(){if(f){f.pin().show();this.container.addEvent("mouseleave",function(k){if(!f.container.containsEvent(k)){f.hide()}})}},onHide:function(){if(f){f.unpin()}}},d)}catch(h){ta.util.error.record(h,"Error: ta.overlays.Factory.bizListingsMenuFlyout")}},createDrop:function(h,d){d.onmouseover=null;try{var f=d.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},h,d,f)}catch(g){ta.util.error.record(g,"Error: ta.overlays.Factory.createDrop")}},createFriendOfFriendOverlay:function(d,f){d.onclick=null;if(f){new ta.overlays.RelativeOverlayAbove({activate:ta.overlays.ACTIVATE_CLICK,style:"s2 mg",showCloseButton:true,content:f},d)}if(lazyImgs!=null){window.setupLazyLoad()}},CLOSE_BTN_RIGHT_OFFSET:15,ratingsFlyout:function(p,d,g,k){if(p){p.stop()}try{var j=d.get("class").match("rating(\\d)")[1];var l=ta.id("ratingsFlyout"+j).get("html");var o=null;var f="";if(g){o=ta.servlet.Reviews.ratingFlyoutScroll}var h="ratingOverlay dg s3 rgba_gry";if(k){f=" fixedHeight";h=h+" overlayWithScroll"}new ta.overlays.RelativeOverlayAbove({showCloseButton:true,activate:ta.overlays.ACTIVATE_CLICK,content:l,innerDivClass:"ratingFlyout inner"+f,style:h,onscroll:o},d);new Request({url:"/ActionRecord?action=ratingsFlyout&pid=4304"}).send()}catch(m){ta.util.error.record(m,"showRatingsFlyout")}},sameGeoActivityOverlay:function(g,d,f){if(!ta.has("sameGeoActivityCSS")){ta.store("sameGeoActivityCSS",new Asset.css(sameGeoActivityCSS))}new ta.overlays.RelativeOverlayBelow({style:"s3 dg rgba_gry sameGeoActivityOverlay",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/SameGeoActivity",requestData:f},d)},openTourismDescription:function(d){ta.servlet.Tourism.showGeoDescription(d)},memberPassportStampOverlay:function(g,d,f){if(!ta.has("passportStampsCSS")){ta.store("passportStampsCSS",new Asset.css(passportStampsCSS))}f.geos=f.geos.join(",");new ta.overlays.RelativeOverlayRight({style:"s3 dg rgba_gry memberPassportStamps",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:true,onLoad:function(){this.show()},remoteContent:"/MemberPassportStamps",requestData:f},d);new Request({url:"/ActionRecord?action="+f.actionRecord}).send()},relRightLocalContent:function(g,d,f){d.onmouseover=null;new ta.overlays.RelativeOverlayRight({activate:ta.overlays.ACTIVATE_HOVER,style:"s2 og",content:ta.id(f).innerHTML},d)},cookieSettingsPanel:function(h,d){if(h){h.stop()}if(d&&d.onclick){d.onclick=null}var f={};f.en=451;f.en_UK=834;f.en_IE=835;f.sv=720;f.no=721;f.da=1199;f.fr=1197;f.de=1201;f.el=1198;f.it=1202;f.es=1200;f.pl=1208;f.nl=1209;f["default"]=451;var g;if(posLocale in f){g="http://info.evidon.com/pub_info/"+f[posLocale]+"?v=1&nt=0"}else{g="http://info.evidon.com/pub_info/"+f["default"]+"?v=1&nt=0"}new ta.overlays.RelativeOverlayBelow({showCloseButton:true,noPadding:true,activate:ta.overlays.ACTIVATE_CLICK,content:new Element("iframe",{src:g,height:562,width:731,styles:{margin:"0"}})},d)},loadMetaHotelsFilter:function(h,d,f,g){ta.hac.filters.loadMetaHotelsFilter(h,d,f,g)},updateMetaHotelsFiltersFromBreadcrumbs:function(d,f){ta.hac.filters.updateMetaHotelsFiltersFromBreadcrumbs(d,f)},closeAllActiveFilters:function(){ta.hac.filters.closeAllActiveFilters()},hideFilterOverlay:function(j,d,f){var g=ta.retrieve("ta.filters.overlaySet");if(g&&g[f]){var h=g[f];if(h.visible){h.hide()}}},simulateDatePickerClick:function(k,f,j,g,h,d){ta.overlays.Factory.loadDatePicker(k,f,j,g,h,d);k.stopPropagation();k.preventDefault();return false},loadDatePicker:function(l,g,k,h,j,d){if(!d){d={}}if(ta.isMetaHomepageIntegration2013()&&k==1){d=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end",postContent:function(){var m=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];m.getElement(".taLnk").addEvent("click",function(){var p=ta.overlays.getCurrent(),q=p&&p.calendar;q&&q.clear();var o=ta.id("SUBMIT_HOTELS");if(o){o.focus()}ta.widgets.calendar.clearSessionDates();ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)});return m},submitOnEnter:ta.pages.home.validate,onSelect:function(o,p){if(!o.oneSelected){var m=ta.id("SUBMIT_HOTELS");m&&m.focus()}}}},d)}else{if(ta.retrieve("checkrates.meta_ui_sk_box_v3")||ta.retrieve("checkrates.date_picker_on_classic")){d=Object.merge({calendarOptions:{selectionStartClass:"start",selectionEndClass:"end"}},d)}}if(!d.calendarOptions){d.calendarOptions={}}if(ta.has("calendar.default.postcontent")&&!d.calendarOptions.postContent){d.calendarOptions.postContent=ta.retrieve("calendar.default.postcontent")}if(ta.retrieve("multiDP.v5")){d.calendarOptions.classicStyling=true}d.calendarOptions.onChangeDates=function(){ta.commerce.meta.tracking.resetAllTimingLocks();ta.commerce.meta.tracking.clearSuppressedAreas();ta.commerce.meta.polling.clearAllPollingInfo();if(ta.isHacMap()){ta.servlet.hotelsMap.map.cleanupOverlays()}};if(ta.has("checkrates.avaf_anti_distraction")){d.calendarOptions.ext=h}d.calendarOptions.onRangeSelect=function(){if(ta.commerce.metajson){ta.commerce.metajson.refetchAll()}if(typeof oxapp!="undefined"&&oxapp&&oxapp.context){var m=oxapp.context.get("TravelDates");if(m){m.save()}}if(ta.has("checkrates.meta_af")&&!(ta.has("checkrates.avaf_anti_distraction")&&!this.options.ext)){ta.commerce.meta.loadMetaAF(k,"AV_ABOVE_FOLD_META",false)}else{if(ta.has("checkrates.avaf_anti_distraction")&&!this.options.ext){var o=ta.id("AV_ABOVE_FOLD_META");if(o){o.destroy()}}}if(ta.retrieve("stateopt_modal_test")){if(!h||h==""){ta.store("worst_hack_ever",true)}ta.commerce.meta.closeStateoptModal()}};if(ta.isMetaHotels2013()){if(ta.retrieve("animate_date_reformat")){var f=ta.id("ANIMATED_DATE_CTA_REFORMAT")}else{var f=ta.id("ANIMATED_DATE_CTA")}if(f){ta.servlet.HACSearch.destroyAnimatedDateCTA()}}ta.overlays.Factory._loadAvailDateWidget(l,k,"calendar",h,j,d);if(ta.retrieve("load_date_picker_buttons")){return false}},trackSkipDatesEvent:function(f,g,d,j){try{ta.trackEventOnPage(f,g,d,j,false)}catch(h){}},loadAdultsField:function(k,f,j,g,h,d){if(!d){d={}}if(!d.calendarOptions){d.calendarOptions={}}ta.overlays.Factory._loadAvailDateWidget(k,j,"adults",g,h,d)},_loadAvailDateWidget:function(o,g,f,d,j,p){var l=false;if(ta.retrieve("multiDP.two_field")){l="in";if(o){var o=new Event(o)}if(o&&o.target&&ta.id(o.target).hasClass&&ta.id(o.target).hasClass("out_date")){l="out"}p.calendarOptions.pickerOption=l}var m=ta.widgets.calendar.getCalendarObjectKey(g,d,l);var h=ta.retrieve(m);if(h&&h.calendar.positionElement&&ta.id(h.calendar.positionElement).getParent("#PAGE")){h.show(f)}else{try{var h=new ta.commerce.AvailDataWidget(o,g,f,d,j,p)}catch(k){ta.util.error.record(k,"load availDateWidget init error")}}},metaCheckRatesOverlay_allProviders:function(j,g){ta.overlays.Factory._recordLBOpen();ta.commerce.meta.clearStoredMiniData();ta.store("metaCheckRatesOverlay",null);if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var h=ta.retrieve("pcr.overlay");if(h&&h.visible){h.hide()}var d={style:"metaCheckRatesOverlay",backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",remoteContent:ta.commerce.checkrates.buildMetaHacUrl_allProviders(j,false,"lb_allProviders",true),onLoad:function(){ta.store("isLightboxOpen",true);try{var m="meta_lb_checkrates";var q=new ta.commerce.CheckRatesData({type:m,evnt:null},j,j,true);ta.store("ta.commerce.MetaHacOverlay.crData."+q.vendorSetId,q);var p=q.getVendorSet().getAllVendorIds();var l=q.getVendorSet().getCheckedVendor();ta.commerce.checkrates.updateMetaProviders(q);var k=document.getElement(".metaCheckRatesOverlay .roundOuterClose");if(k){k.className+=" no_cpu"}}catch(o){ta.util.error.record(o,"meta all providers overlay load issue")}ta.commerce.checkrates.metaHacRequest(q,p,l)},evalScripts:true,onClose:function(){ta.store("isLightboxOpen",false);ta.trackEventOnPage("meta_lightbox","close","");if(m==null){var m=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+j)}if(m&&ta.retrieve("checkrates.meta_ui_post_click_prices")){var t=ta.retrieve("meta.baseLocationId");if(t&&j==t){ta.commerce.meta.updateProvAreaFromLightBox(m.vendorSetId);if(ta.has("metaCheckRatesUpdateDivInline")){ta.commerce.meta.updateInlineMeta(j)}}else{if(t){if(ta.has("ta.meta.navArea")){var q=ta.retrieve("ta.meta.navArea")}var l=ta.id("MetaPricesTab");var o=false;if(l!=null&&l.hasClass("sprite-tab-active")){o=true}var v=ta.id("LOC_PHOTOS");var u=ta.id("AMENITY_LIGHTBOX");var k=false;if(v||u){k=true}var s=false;if(ta.has("metaCheckRatesUpdateDivInline")){if(o){if(!k){ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(t);s=true}else{var m=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+t);if(m!=null){try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(r){ta.util.error.record(r,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(r){ta.util.error.record(r,"problem locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.meta.miniMetaAjax(null,m,1000);s=true;ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline");ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini");ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(t);ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline");ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(r){ta.util.error.record(r,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(r){ta.util.error.record(r,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}}}else{var m=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+t);if(m!=null){ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.meta.miniMetaAjax(null,m,1000);s=true}}}var m=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+t);if(m!=null&&!s){ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.meta.miniMetaAjax(null,m,1000)}ta.commerce.meta.updateNavArea(q)}}}f.destroy();ta.store("metaCheckRatesOverlay",null);ta.widgets.calendar.removeMetaCalendarFromSync(j);ta.widgets.calendar.closeCalendarWidgets();if(!ta.servlet.hotelsMap||!ta.servlet.hotelsMap.isMapOpen()){if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldIssueAjax")){ta.remove("hotels.shouldIssueAjax");ta.commerce.minimeta.ajax.send()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){ta.commerce.minimeta.doMetaDateSearch()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldHideClassicPrices")){var p=document.getElements(".classicPrice");p.each(function(w){w.hide()})}}}};if(ta.retrieve("checkrates.meta_ui_sk_box")||ta.retrieve("checkrates.meta_ui_sk_box_v2")||ta.retrieve("checkrates.meta_ui_sk_box_v3")){d.absoluteOffset=true;d.yOffset=72+window.getScrollTop()}var f=new ta.overlays.CenteredOverlay(d,null);ta.store("metaCheckRatesOverlay",f)},metaCheckRatesOverlay:function(l,k,h,j){ta.overlays.Factory._recordLBOpen();ta.commerce.meta.clearStoredMiniData();ta.store("metaCheckRatesOverlay",null);if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var g=ta.retrieve("pcr.overlay");if(g&&g.visible){g.hide()}var d={style:"metaCheckRatesOverlay",backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",remoteContent:ta.commerce.checkrates.buildMetaHacUrl(l,k,h,false),onLoad:function(){ta.commerce.checkrates.updateMetaProviders(l);ta.commerce.checkrates.metaHacRequest(l,k,h);var m=document.getElement(".metaCheckRatesOverlay .roundOuterClose");if(m){m.className+=" no_cpu"}},evalScripts:true,onClose:function(){var m=this.source&&this.source.getParent(".gcrabLb");ta.trackEventOnPage("meta_lightbox","close","");if(!m){ta.overlays.Factory.updateMiniMetaPlacements(l)}f.destroy();if(!m){ta.store("metaCheckRatesOverlay",null);ta.widgets.calendar.removeMetaCalendarFromSync(l.vendorSetId);ta.widgets.calendar.closeCalendarWidgets();if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldIssueAjax")){ta.remove("hotels.shouldIssueAjax");ta.commerce.minimeta.ajax.send()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&!ta.id("LOC_PHOTOS")){ta.commerce.minimeta.doMetaDateSearch();ta.remove("hotels.datesChanged")}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.shouldHideClassicPrices")){var o=document.getElements(".classicPrice");o.each(function(p){p.hide()})}}}};if(ta.retrieve("checkrates.meta_ui_sk_box")||ta.retrieve("checkrates.meta_ui_sk_box_v2")||ta.retrieve("checkrates.meta_ui_sk_box_v3")){d.absoluteOffset=true;d.yOffset=72+window.getScrollTop()}var f=new ta.overlays.CenteredOverlay(d,j);ta.store("metaCheckRatesOverlay",f)},updateMiniMetaPlacements:function(h){var o=ta.retrieve("meta.baseLocationId");if(!o&&ta.id("LOC_PHOTOS")){var s=ta.id("LOC_PHOTOS").getElement("#CHECK_RATE");if(s&&/id_(\d+)/.test(s.className)){o=RegExp.$1}}if(ta.has("ta.meta.navArea")){var k=ta.retrieve("ta.meta.navArea")}if(o){var g=ta.id("MetaPricesTab");var j=false;if(g!=null&&g.hasClass("sprite-tab-active")){j=true}var t=ta.id("LOC_PHOTOS");var q=ta.id("AMENITY_LIGHTBOX");var f=ta.id("CHECK_RATES_LB");var d=false;if(t||q||f){d=true}var m=false;if(ta.has("metaCheckRatesUpdateDivInline")){if(j){if(d){try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Inline")}catch(l){ta.util.error.record(l,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Inline")}try{ta.commerce.meta.tracking.setTimingForNavArea("QC_Meta_Mini")}catch(l){ta.util.error.record(l,"problem locking timing in Factory.metaCheckRatesOverlay for QC_Meta_Mini")}ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),o,"checkrates");m=true;ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Inline");ta.commerce.meta.tracking.suppressImpressionsForArea("QC_Meta_Mini");ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(o);ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Inline");ta.commerce.meta.tracking.removeSuppressedArea("QC_Meta_Mini");try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Inline")}catch(l){ta.util.error.record(l,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Inline")}try{ta.commerce.meta.tracking.resetTimingLockForNavArea("QC_Meta_Mini")}catch(l){ta.util.error.record(l,"problem un-locking timing in Factory.metaCheckRatesOverlay_allProviders for QC_Meta_Mini")}}else{if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()){ta.commerce.meta.updateNavArea("QC_Meta_Inline");ta.commerce.meta.updateInlineMeta(o);m=true}}}else{if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.widgets.calendar.datesExist()){ta.commerce.meta.updateNavArea("QC_Meta_Mini");ta.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),o,"checkrates");m=true}}}if((ta.retrieve("checkrates.meta_ui_post_click_prices")||t)&&ta.widgets.calendar.datesExist()&&!m){ta.commerce.meta.updateNavArea("QC_Meta_Mini");var p=document.getElementById("CHECK_RATE");if(!ta.retrieve("checkrates.meta_ui_post_click_prices")&&t){p=t.getElement("#CHECK_RATE");if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){var r=t.getParent(".overlay");if(r&&r.overlay){r.overlay.addEvent("onHide",function(){ta.commerce.minimeta.doMetaDateSearch()})}}}ta.commerce.checkrates.checkRatesMiniMeta(null,p,o,"checkrates",true)}}else{if(h){ta.commerce.meta.updateInlineMeta(h.vendorSetId)}}ta.commerce.meta.updateNavArea(k)},createPersistentFilterOverlay:function(){var f=document.getElement(".filterControls");if(!f){return}var d={toWindow:false,autoShow:false,yOffset:-60,permanent:true,showCloseButton:false,style:"persistentFilterOverlay",positionType:"fixed",innerDivClass:f.className,onShow:function(){ta.util.element.moveContent(f,this.inner)},onHide:function(){ta.util.element.moveContent(this.inner,f)}};ta.store("persistentFiltersOverlay",new ta.overlays.AbsoluteOverlay(d));window.addEvent("scroll",ta.servlet.HACSearch.showPersistentFilters)},_recordLBOpen:function(){if(!ta.remove("skipLBGARecord")){var d=ta.remove("meta.lightboxOpener")||(ta.retrieve("meta.calendarCR")?"calendar":"button");ta.trackEventOnPage("meta_lightbox","open",d)}},createTAListingPolicyOverlay:function(g,f,j,h){var k=ta.id(j);if(k!=null){var d=new ta.overlays.CenteredOverlay({style:"s3 dg rgba_gry",backdrop:ta.overlays.BACKDROP_ALWAYS,content:k.get("html"),isChild:h},null)}},greenLeaderTrack:function(l){var k=window.location.href.match(/\/\/.*?\/([^-?]+)/)[1];var j=l.target.className;var d=l.target.id;if(k){var g="GreenLeaders";var h;var f;if(k==="Hotels"||k==="HACSearch"){h="HOTELS"}else{if(k==="Hotel_Review"||k==="ShowUserReviews"){h="HR"}else{if(k==="UserReviewEdit"){h="REVIEW_FORM"}}}if(j.match("seeFullLnk")){f="SEE_ALL"}else{if(j.match("greenLeaderLabelLnk")){f="GREEN_LEADERS_BADGE"}else{if(d.match("ReportIAP")){f="REPORT_PROBLEM"}}}if(g&&h&&f){ta.trackEventOnPage(g,h,f)}}},greenLeaderOverlay:function(k,h,g,j){ta.overlays.Factory.greenLeaderTrack(new Event(k));var d="/GreenLeaderAjax?locationId="+g+"&showSummary="+j;if(ta.retrieve("greenLeaderOverlay")){ta.retrieve("greenLeaderOverlay").loadRemoteContent(d,true)}else{var f=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding rgba_gry",autoShow:false,delayedPosition:true,backdrop:(j?ta.overlays.BACKDROP_ALWAYS:ta.overlays.BACKDROP_NEVER),permanent:true,showCloseButton:true,zIndex:2001,onLoad:function(l){if(ta.retrieve("greenLeaderOverlay")){this.show()}else{this.show.delay(200,this);ta.store("greenLeaderOverlay",this)}}},h);f.loadRemoteContent(d,true)}},metaCompareOverlay:function(l,j,d){var k=ta.commerce.metafooter.getLocations();if(d){var g=-1;for(var h=0;h<k.length;h++){if(k[h]==d){g=0}}if(g>-1){k.splice(g,1)}k.splice(1,0,d)}for(var h=0;h<k.length;h++){ta.commerce.metajson.registerTarget(k[h],"#COMPARE_META_"+k[h],ta.commerce.metafooter.compareUpdater)}var f=new ta.overlays.CenteredOverlay({style:"meta_flyout meta_footer_flyout",autoShow:false,delayedPosition:true,backdrop:ta.overlays.BACKDROP_ALWAYS,backdropClickClose:true,permanent:true,showCloseButton:true,remoteContent:"/MetaCompareAjax?locations="+k,closeButtonClass:"roundOuterClose",onLoad:function(m){this.show.delay(150,this)},onShow:function(){if(ta.widgets.calendar.hasPageDates()){ta.commerce.metajson.refresh(ta.commerce.metafooter.getLocations())}else{var m=ta.find(".meta_footer_flyout .compareHeaderWrap .date_picker_calendar_wrap");m.click()}}},j);if(ta.widgets.calendar.hasPageDates()){ta.trackEventOnPage("meta_lightbox","open","meta_compare-Xsell_footer")}},miniMetaCrossSellMicroOverlay:function(s,h,m,g){try{h.onmouseover=null;h.onclick=null;var k=new ta.commerce.CheckRatesData({type:"checkrates",evnt:s},h,m,true);var j=k.getVendorSet().getCheckedContentID();var u=k.getVendorSet().getCheckedVendor();var t=ta.retrieve("meta.travelData");t=ta.commerce.checkrates.getTravelDataFromDOM();var d=ta.commerce.checkrates.buildVarMetaHacUrl("MicroMetaAjax",k,j,u,true,null,"QC_Meta_Mini|Related_XSell",t);d+="&lowContentID="+g;d+="&drop=true";var p=h.className.match(/noDelayFirst/);var r=h.className.match(/delayOpen/);var o=ta.retrieve("delayedFirst");var f=!r||(p&&!o);var l=new ta.overlays.RelativeOverlayBelow({style:"",allowFlip:false,activate:ta.overlays.ACTIVATE_HOVER_DELAY,autoShow:f,delayShow:r,offsetLeft:0,offsetTop:-20,showCloseButton:false},h);l.loadRemoteContent(d,false);ta.store("delayedFirst",true)}catch(q){ta.util.error.record(q,"ta.overlays.factory.miniMetaCrossSellMicroOverlay")}},helpCenterLB:function(d,g){try{if(d||window.event){new Event(d||window.event).preventDefault()}var f=new ta.overlays.CenteredOverlay({style:"s3 dg help_center",showCloseButton:true,backdropClickClose:true,backdrop:ta.overlays.BACKDROP_ALWAYS,remoteContent:"/uvpages/helpCenterOverlay.html"},g)}catch(h){ta.util.error.record(h,"ta.overlays.factory.helpCenterLB")}return false},travelersScoreDetailsOverlay:function(j,g,d){var h=ta.id(d);if(h!=null){var f=new ta.overlays.RelativeOverlayBelow({style:"rgba_gry",activate:ta.overlays.ACTIVATE_CLICK,showCloseButton:false,offsetLeft:ta.util.i18n.isRtl()?-2:163,offsetTop:-19,content:h.innerHTML},g)}return false},starAttributionOverlay:function(f,d){ta.common.flyout.starAttribution(f,d)},reviewLanguageOverlay:function(g,d){if(!d||!g){return}var f=d.getPrevious(".languageList");if(!f){return}var h=d.getSize().x-16;new ta.overlays.RelativeOverlayBelow({style:"reviewLanguageOverlay",activate:ta.overlays.ACTIVATE_CLICK,delayShow:false,showCloseButton:false,content:f,offsetTop:1,offsetLeft:h},d)}}})();(function(a){Object.append(a,{injectReviewSummaryContentFromConcept:function(c){try{var b=ta.retrieve("topconcepts.rsContent")[c];if(!b){ta.util.error.record(null,"injectReviewSummaryContentFromConcept - no content")}ta.overlays.Factory.injectReviewSummaryContent(b)}catch(d){ta.util.error.record(d,"injectReviewSummaryContentFromConcept")}},injectReviewSummaryContent:function(c){try{var b=ta.retrieve("reviewSummaryOverlay");if(b){b.inner.setContent(c);b.show()}else{ta.util.error.record(null,"injectReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"injectReviewSummaryContent")}},storeReviewSummaryContent:function(d,c){var b=ta.retrieve("topconcepts.rsContent");if(!b){b={}}b[d]=c;ta.store("topconcepts.rsContent",b)},addSummaryBoxContentAndShow:function(d,g){try{var h=ta.retrieve("reviewSummaryOverlay");ta.overlays.Factory.injectReviewSummaryContent(g);var c=null;var l=ta.id("TRAV_SAY_TERMS");if(typeof(l)!=undefined&&l!=null){var b=l.clone(true,false);b.addClass("col1of2");c=new Element("div",{"class":"wrap bx02 rd_concepts"});c.adopt(b)}else{c=ta.id("SUMMARYBOX").clone(true,false)}var k=h.inner;k.getElement(".title").adopt(c);var m="concept_"+d.replace(/ /g,"_");var j=document.getElement(".overlay .rd_concepts ."+m);if(j){j.removeClass("taLnk").removeClass("hvrIE6").addClass("conceptSelected").onClick=""}Array.each(k.getElements(".rd_concepts .snippetText"),function(o){var q=ta.id(o);q.removeClass("snippetText");q.removeClass("sprite-middot");q.removeClass("trip_type_snippet");q.addClass("conceptBullet");var p=q.getElement(".taLnk");if(p){p.setProperty("onclick","ta.util.cookie.setPIDCookie(25223);ta.call('ta.overlays.Factory.showReviewSummaryV2',event, this);")}});ta.overlays.Factory.storeReviewSummaryContent(d,k.get("html"));ta.overlays.Factory.injectReviewSummaryContentFromConcept(d)}catch(f){ta.util.error.record(f,"updateReviewSummaryContent - request.onSuccess")}},updateReviewSummaryContent:function(c,b){try{if(ta.has("reviewSummaryOverlay")&&ta.has("topconcepts.rsContent")&&ta.retrieve("topconcepts.rsContent")[c]){ta.overlays.Factory.injectReviewSummaryContentFromConcept(c);return}if(ta.has("reviewSummaryOverlay")){new Request({url:b,onSuccess:function(f){ta.overlays.Factory.addSummaryBoxContentAndShow(c,f)},evalScripts:true,method:"get"}).send();return}else{ta.util.error.record(null,"updateReviewSummaryContent - no overlay")}}catch(d){ta.util.error.record(d,"updateReviewSummaryContent")}},getReviewSummaryUrl:function(g,f,k,c){ta.store("topconcepts.lastconcept",g);if(typeof modelLocId=="undefined"||typeof modelGeoId=="undefined"){var j=(typeof modelLocId=="undefined")?"undefined":modelLocId;var d=(typeof modelGeoId=="undefined")?"undefined":modelGeoId;ta.util.error.record(null,"getReviewSummaryUrl",null,{locId:j,geoId:d})}if(k&&c){ta.util.cookie.setPIDCookie(16007);var h="/MachineTranslation?";if(f.id){var g;if(f.id.indexOf("trans_")!=-1){g=f.id.replace("trans_","").replace(/_/g," ")}else{g=f.id.replace("concept_","").replace(/_/g," ")}ta.store("topconcepts.lastconcept",g);h+="page=summary&";h+="d="+modelLocId+"&";h+="concept="+g;h+="&sl=en&tl="+k}return h}var b="/HotelSummary?d="+modelLocId+"&geo="+modelGeoId+"&concept="+g;if(k){b+="&autotrans=true"}return b},getReviewSummaryConcept:function(b){try{var c=b.id?b.id:b.className.match("(concept_[a-zA-Z0-9-_]+)")[1];return c.replace("concept_","").replace(/_/g," ")}catch(d){ta.util.error.record(d,"getReviewSummaryConcept",null,{id:b.id,"class":b.className})}return""},showReviewSummaryV2:function(j,f,h,c){if(j){j.stop()}var g=ta.overlays.Factory.getReviewSummaryConcept(f);var b=ta.overlays.Factory.getReviewSummaryUrl(g,f,h,c);if(ta.has("reviewSummaryOverlay")){ta.overlays.Factory.updateReviewSummaryContent(g,b);return}ta.overlays.Factory._loadSummaryCss();var d=new ta.overlays.CenteredOverlay({style:"s3 dg nopadding rgba_gry",autoShow:false,permanent:true,showCloseButton:true,remoteContent:b,onLoad:function(k){try{ta.store("topconcepts.overlay."+g,this);ta.overlays.Factory.addSummaryBoxContentAndShow(g,this.inner.innerHTML);this.show()}catch(l){ta.util.error.record(l,"showReviewSummary - overlay onload")}}},f);ta.store("reviewSummaryOverlay",d)}})})(ta.overlays.Factory);ta.overlays.CalendarOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{showCloseButton:true,activate:ta.overlays.ACTIVATE_FOCUS,style:"typeO ocal",autoShow:false,autoShowCal:false,calendarOptions:null,flipPadding:25,zIndex:202},initialize:function(a,b){this.input=a.getElement("input[type=text]");this.parent(b,this.input);this.input.overlay=this;this.dayField=a.getElement("input.day");this.monthField=a.getElement("input.month");this.source.addEvent("click",this.show);this.icn=a.getElement("span.icn");if(this.icn){this.icn.onclick="";this.icn.addEvent("click",this.show)}var c=a.className.search("first")>=0;this.calendar=new ta.widgets.Calendar(Object.merge({dualCalendar:true,choiceLink:"ta.overlays.calendarSelect",prevAction:"ta.overlays.calendarPrev",nextAction:"ta.overlays.calendarNext",onSelect:this.select.bind(this),onClear:this.clear.bind(this),isFirstCal:c},this.options.calendarOptions));this.inner.adopt(this.calendar.container);this.parentOverlay=a.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}if(this.options.autoShowCal){this.show()}},destroy:function(){this.parent();this.input.overlay=null},show:function(b){this.input.addClass("selected");var a=this.visible;this.parent(b);if(a){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.loadFields();this.calendar.update();this.calendar.reposition();return this},hide:function(a){if(!this.visible){return}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},hideNow:function(a){this.input.removeClass("selected");if(!this.visible){return this}this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}},select:function(a,b){if(b){new Event(b).preventDefault()}this.updateFields();this.hide();this.fireEvent("onSelect",this,!!b)},clear:function(a,b){b&&new Event(b).preventDefault();this.clearFields();this.hide();this.fireEvent("onClear",this)},loadFields:function(){var b=parseInt(this.dayField.value.replace(/^0/,""));var a=this.monthField.value.split(/\//);if(a.length!=2){return}var c=parseInt(a[1]);a=parseInt(a[0].replace(/^0/,""));this.calendar.selectedDate=ta.util.date.create(c,a-1,b);return this},updateFields:function(){if(!this.calendar.selectedDate){this.loadFields()}if(!this.calendar.selectedDate){return}var a=this.calendar.selectedDate.getMonth()+1;if(a<10){a="0"+a}this.dayField.value=this.calendar.selectedDate.getDate();this.monthField.value=a+"/"+this.calendar.selectedDate.getFullYear();var b=this.calendar.selectedDate.getFullYear();if(ta.retrieve("thai_buddhist_era_year")){b=b+ta.util.date.THAI_BUDDHIST_YEAR_OFFSET}this.input.value=formatDate(this.calendar.selectedDate.getDate(),this.calendar.selectedDate.getMonth(),b)},clearFields:function(){if(this.options.calendarOptions&&!this.options.calendarOptions.clearToBlank){this.input.value=JS_DateFormat}else{if(this.input.value==this.input.defaultValue){this.input.value=""}}},clearDateFields:function(){this.calendar.selectedDate=null;this.dayField.value="";this.monthField.value="";this.clearFields()},resetFieldsIfBlank:function(){if(this.input.value==""){this.input.value=this.input.defaultValue}},validate:function(){var b=this.input.value.match(DATE_FORMAT.pattern);if(b){var c=parseInt(b[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(b[DATE_FORMAT.month].replace(/^0/,""));var d=parseInt(b[DATE_FORMAT.year].replace(/^0/,""));if(c>0&&c<32&&a>0&&a<13){if(c<10){c="0"+c}if(a<10){a="0"+a}if(d<100){d+=2000}this.dayField.value=c;this.monthField.value=a+"/"+d;this.loadFields();if(!this.calendar.isValid()){return sInvalidDates}}else{return sInvalidDates}}else{return sInvalidDates}return null}});ta.overlays.createCalendar=function(b,a){new Event(b).preventDefault();a.onfocus="";new ta.overlays.CalendarOverlay($(a).getParent(".cal"),{autoShowCal:true})};ta.overlays.calendarSelect=function(g,f,a,c,b){if(ta.has("checkrates.calendarActionRecord")){ta.util.cookie.removePIDCookie();ta.commerce.checkrates.actionRecord(ta.retrieve("checkrates.calendarActionRecord"))}ta.id(b).getParent(".overlay").overlay.calendar.select(g,ta.util.date.create(f,a,c));if(ta.has("checkrates.meta_calendar_style_on_classic")&&(Browser.ie||Browser.chrome)){ta.popups.PopUtil.attemptHoldingWindow(ta.commerce.checkrates.getPropIdFromCRElement(ta.id(b).getParent(".overlay").overlay.input))}};ta.overlays.calendarPrev=function(b,a){ta.id(a).getParent(".overlay").overlay.calendar.prev()};ta.overlays.calendarNext=function(b,a){ta.id(a).getParent(".overlay").overlay.calendar.next()};ta.overlays.PairedCalendar=new Class({Implements:[Options,Events],options:{validate:false,validateFun:function(){},allowSameDay:false,calendarOptions:null,defaultSpan:1,keepDelta:false,clearDatesId:"clearDates",overlayOptions:{},overlayFirstOptions:null,disallowChars:false,disableInvalidEndDates:false,showCalIfInvalid:false,clearOnRestart:false,allowReverse:false},initialize:function(b,a){this.setOptions(a);b=ta.id(b);this.form=b.get("tag")=="form"?b:b.getParent("form");var c=Object.merge({onSelect:this.adjustRange.bind(this)},this.options.overlayOptions);if(this.options.calendarOptions){c.calendarOptions=this.options.calendarOptions}this.form.getElements(".cal").each(function(d){var g;if(d.hasClass("first")&&this.options.overlayFirstOptions){g=new ta.overlays.CalendarOverlay(d,Object.merge(Object.clone(c),this.options.overlayFirstOptions))}else{g=new ta.overlays.CalendarOverlay(d,c)}g.input.onfocus="";if(this.options.disallowChars){g.input.addEvent("keypress",this.validateInput.bind(this))}if(d.hasClass("first")){this.before=g}else{this.after=g;if(ta.has("isDaoDaoCRRedesign")){var f=this.form.get("qc_area");this.after.qcArea=f;this.before.qcArea=f}}},this);this.after.theOtherCal=this.before;this.before.theOtherCal=this.after;this.after.calendar.theOtherCal=this.before.calendar;this.before.calendar.theOtherCal=this.after.calendar;if(b===this.before.input||b===this.before.icn){this.after.loadFields();if(this.before.options.autoShowCal){this.before.show()}}else{if(b===this.after.input||b===this.after.icn){this.before.loadFields();if(this.after.options.autoShowCal){this.after.show()}}}if(this.form){this.form.calendar=this;if(this.options.validate){this.form.addEvent("submit",this.validate.bind(this));this.errorDiv=this.form.getElement(".error_msg")}}},getOverlayForCalendar:function(a){if(this.before.calendar==a){return this.before}if(this.after.calendar==a){return this.after}return null},adjustRange:function(c){this.requireFullLoad();if(this.form.searchAll){if(this.form.searchAll.type=="checkbox"){this.form.searchAll.checked=false}else{if(this.form.searchAll.type=="hidden"){this.form.searchAll.value="false"}}}var b=ta.id(this.options.clearDatesId);if(b){b.style.visibility="visible"}var h=false;if(this.options.clearOnRestart&&c===this.before){this.after.clearDateFields()}else{if(this.options.allowReverse&&c===this.after&&this.before.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()<this.before.calendar.selectedDate.getTime()){var k=this.before.calendar.selectedDate;this.before.calendar.selectedDate=this.after.calendar.selectedDate;this.after.calendar.selectedDate=k;this.before.updateFields();this.after.updateFields()}else{if(!this.sameDayEnabled()&&!this.options.disableInvalidEndDates&&this.after.calendar.selectedDate&&this.after.calendar.selectedDate.getTime()==this.after.calendar.options.firstDate.getTime()){this.before.calendar.selectedDate=new Date(this.before.calendar.options.firstDate);if(this.options.keepDelta){this.options.defaultSpan=1}var k=new Date(this.after.calendar.options.firstDate);k.setDate(k.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=k;this.before.updateFields();this.after.updateFields()}else{if(c==this.before){if(this.options.keepDelta||!this.isBeforeValid()){var k=new Date(this.before.calendar.selectedDate);k.setDate(k.getDate()+this.options.defaultSpan);this.after.calendar.selectedDate=k;h=true}this.after.updateFields()}else{if(c==this.after){if(!this.isAfterValid()){var k=new Date(this.after.calendar.selectedDate);k.setDate(k.getDate()-this.options.defaultSpan);if(k.getTime()<this.before.calendar.options.firstDate.getTime()){k=new Date(this.before.calendar.options.firstDate.getTime())}this.before.calendar.selectedDate=k}this.before.updateFields()}}}if(this.options.keepDelta&&this.before.calendar.selectedDate){this.options.defaultSpan=ta.util.date.getDaysInRange(this.before.calendar.selectedDate,this.after.calendar.selectedDate)-1;if(this.sameDayEnabled()){if(this.options.defaultSpan<0){this.options.defaultSpan=0}}else{if(this.options.defaultSpan<1){this.options.defaultSpan=1}}}}}this.fireEvent("onUpdate",this);var g=ta.retrieve("calendar.onUpdateCallback");if(g){for(var f=0;f<g.length;f++){if(window[g[f]]){window[g[f]](this,c)}}}this.updateMinStay(this.before.calendar.selectedDate,this.after.calendar.selectedDate);try{var a="before";if(c==this.after){a="after"}ta.commerce.checkrates.triggerAvailCheck.call(this,a);ta.commerce.checkrates.triggerAvailCheck.delay(1500,this,false);ta.store("avail.check.query.complete",true)}catch(j){ta.util.error.record(j,"availability check - paired cal")}if(this.options.disableInvalidEndDates){if(c==this.before){var k=new Date(this.before.calendar.selectedDate);k.setDate(k.getDate()+1);this.after.calendar.options.firstDate=k;if(h){this.after.show()}}}},updateMinStay:function(a,c){var b=ta.id("minStay");if(b&&a&&c){b.disabled=true;b.selectedIndex=this.getMinStayIndex(a,c)}},getMinStayIndex:function(a,c){var b=ta.util.date.getDaysInRange(a,c)-1;if(b<7){return b}else{if(b<28){return 7}else{return 8}}},isOneWay:function(){return this.form.oneWay&&this.form.oneWay.checked},sameDayEnabled:function(){return this.options.allowSameDay||this.isOneWay()},searchAllEnabled:function(){return this.form.searchAll&&(this.form.searchAll.checked||(this.form.searchAll.type=="hidden"&&this.form.searchAll.value=="true"))},updateFields:function(){this.before.updateFields();this.after.updateFields()},clearFields:function(){this.before.clearDateFields();this.after.clearDateFields()},resetFieldsIfBlank:function(){this.before.resetFieldsIfBlank();this.after.resetFieldsIfBlank()},requireFullLoad:function(){if(!this.before.calendar.selectedDate){this.before.loadFields()}if(!this.after.calendar.selectedDate){this.after.loadFields()}},isBeforeValid:function(){this.requireFullLoad();if(!this.after.calendar.selectedDate){return true}return(this.before.calendar.selectedDate<this.after.calendar.selectedDate)||(this.sameDayEnabled()&&this.before.calendar.selectedDate.getTime()<=this.after.calendar.selectedDate.getTime())},isAfterValid:function(){this.requireFullLoad();if(!this.before.calendar.selectedDate){return true}return(this.after.calendar.selectedDate>this.before.calendar.selectedDate)||(this.sameDayEnabled()&&this.after.calendar.selectedDate.getTime()>=this.before.calendar.selectedDate.getTime())},validateInput:function(a){if(a.key.match(/^[a-zA-Z]$/)){a.preventDefault()}},validate:function(g){if(this.searchAllEnabled()){return true}var a=this.before.validate();var b=this.after.validate();var d=true;if(this.isOneWay()){if(a!=null){d=false;this.setError(a)}}else{if(a!=null||b!=null){d=false;this.setError(a||b)}else{if(!this.isAfterValid()){d=false;this.setError(sInvalidDates)}}}if(!d&&g){new Event(g).stop()}if(this.options.showCalIfInvalid){var f;if(a!=null){f=this.before}else{if(b!=null||!d){f=this.after}}if(f){f.input.value="";f.selectedDate=new Date();f.updateFields();f.show()}}if(d&&this.options.validateFun&&typeof this.options.validateFun==="function"){try{return this.options.validateFun(g)}catch(c){ta.util.error.record(c,"post-validation callback function failed in PairedCalendar",g);return d}}else{return d}},setError:function(a){if(!this.errorDiv){return}this.errorDiv.setContent(a).show()},toggleSearchAll:function(){if(this.searchAllEnabled()){this.before.clearFields();this.after.clearFields()}else{this.requireFullLoad();this.before.updateFields();this.after.updateFields()}}});ta.overlays.createSimplePairedCalendar=function(b,a){new Event(b).stop();new ta.overlays.PairedCalendar(a)};ta.overlays.createSpannedPairedCalendar=function(c,a,b){new Event(c).stop();new ta.overlays.PairedCalendar(a,{defaultSpan:b})};ta.overlays.createPairedCalendar=function(h,b,a){if(!a){a={validate:true}}new Event(h).preventDefault();var d;if(ta.isMetaHomepageIntegration2013()||ta.isMetaHotel2013()||ta.isMetaHotels2013()){var g=a.sk3;var f=a.checkMore;var c=a.inline;delete a.sk3;delete a.checkMore;a.clearOnRestart=true;a.allowReverse=true;a.overlayOptions={showCloseButton:false,style:"date_picker_calendar paired",noPadding:true,noCpu:true};a.calendarOptions={prevStyle:"sprite-date_picker-btnLeftIdle",nextStyle:"sprite-date_picker-btnRightIdle",showRange:true};a.onUpdate=function(j){ta.widgets.calendar.setPageInDate(j.before.calendar.selectedDate);ta.widgets.calendar.setPageOutDate(j.after.calendar.selectedDate);if(j.before.calendar.selectedDate&&j.after.calendar.selectedDate){if(g){ta.widgets.calendar.launchMetaLightboxUpdate(g,j.after.input)}else{if(f){ta.commerce.checkrates.checkRatesCheckMore(h,b,f,"checkrates")}else{if(ta.isMetaHotels2013()){ta.servlet.HACSearch.doMetaDateSearch()}else{if(c){ta.widgets.calendar.launchInlineMeta(h)}}}}}};if(a.clearDates){delete a.clearDates;a.calendarOptions.postContent=function(){var j=Elements.from('<div id="SKIP_DATES"><span class="skip_dates_text"><span class="taLnk">'+ta.retrieve("multiDP.skipDates")+"</span></span></div>")[0];j.getElement(".taLnk").addEvent("click",function(){var l=ta.overlays.getCurrent();if(l){l.clearDateFields();l.theOtherCal&&l.theOtherCal.clearDateFields();l.hide()}var k=ta.id("SUBMIT_HOTELS");if(k){k.focus()}ta.widgets.calendar.clearPageDates();ta.widgets.calendar.clearSessionDates();ta.overlays.Factory.trackSkipDatesEvent("Meta_Homepage","Calendar","Skip dates",0)});return j}}d=new ta.overlays.PairedCalendar(b,a);d.before.addEvent("onSelect",function(k,j){d.after.input.focus()})}else{d=new ta.overlays.PairedCalendar(b,a)}return d};ta.overlays.clearFields=function(a){if(a.calendar){a.calendar.clearFields()}};ta.overlays.resetFieldsIfBlank=function(a){if(a.calendar){a.calendar.resetFieldsIfBlank()}};ta.overlays.toggleOffSearchAll=function(a){if(a.calendar&&a.searchAll){if(a.searchAll.type=="checkbox"){a.searchAll.checked=false}else{if(a.searchAll.type=="hidden"){a.searchAll.value="false"}}a.calendar.toggleSearchAll()}};ta.overlays.toggleOnSearchAll=function(a){a=ta.id(a);var b=a.getParent("form");if(!b.calendar){new ta.overlays.PairedCalendar(a,{validate:true,clearDatesId:a})}if(b.calendar&&b.searchAll){if(b.searchAll.type=="checkbox"){b.searchAll.checked=true}else{if(b.searchAll.type=="hidden"){b.searchAll.value="true"}}b.calendar.toggleSearchAll()}};ta.overlays.toggleSearchAll=function(d,b,a){b=ta.id(b);b.onclick="";var c=b.getParent("form");if(!a){a={validate:true}}if(!c.calendar){new ta.overlays.PairedCalendar(b,a)}c.calendar.toggleSearchAll(b);b.addEvent("click",c.calendar.toggleSearchAll.bind(c.calendar))};ta.overlays.clearDates=function(c,a){ta.overlays.toggleOnSearchAll(a);ta.id(a).style.visibility="hidden";var b=ta.id("minStay");if(b!==null){b.disabled=false;b.selectedIndex=0;filtersChanged(c)}};ta.overlays.PermanentOverlay=new Class({Extends:ta.overlays.AbsoluteOverlay,initialize:function(a,b){this.parent(Object.merge({permanent:true},a),b)}});ta.overlays.SkinnyOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,initialize:function(a,b){this.parent(a,b);this.container.setStyle("max-width","120px");if(Browser.ie6){this.shim.setStyle("max-width","120px")}}});ta.overlays.Registration=new Class({Implements:[Options,Events],Binds:["response","failure"],options:{flow:null,url:"/Registration",isOverlay:true,pageTarget:null,responseCallback:null,completeCallback:null,customOverlayOptions:{},noreload:false},initialize:function(a){this.setOptions(a);if(this.options.isOverlay){this.overlay=new ta.overlays.CenteredOverlay(Object.merge({backdrop:ta.overlays.BACKDROP_ALWAYS,autoShow:false,style:"s4 dg",attachCloseEvent:false},this.options.customOverlayOptions));if(this.overlay.closeBtn){this.overlay.closeBtn.addEvent("click",this.cancel.bind(this))}}},getRequestData:function(){var b={flow:this.options.flow};if(ta.has("registration.data")){b=Object.merge(b,ta.retrieve("registration.data"))}if(ta.has("page.geo")){b.geo=ta.retrieve("page.geo")}b.source=pageServlet;b=[b];Array.from(arguments).each(function(c){b.push(c)});if(ta.has("rsa")){b.push({encrypted:ta.retrieve("rsaVersion")});var a=ta.retrieve("rsa");b.forEach(function(c){if(c.pass){try{b.push({epass:a.encrypt(c.pass.value)})}catch(d){ta.util.error.record(d,"Encrypted Signin - encrypting sign-in/sign-up form parameters")}}})}return b},request:function(c,b){ta.store("registration.method","request");var a={url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData(b,{action:c}),onSuccess:this.response,onFailure:this.failure};if(ta.has("registration.ga_module")){a.trackEvent={module:ta.retrieve("registration.ga_module"),action:c+"_Show",context:this.options.flow}}new Request(a).send();return this},post:function(b){var a=this;if(ta.has("registration.ga_module")){ta.trackEventOnPage(ta.retrieve("registration.ga_module"),b.action.value+"_Submit",a.options.flow,1,false)}ta.util.pending.waitFor(function(){return !ta.has("rsaLoading")},function(){if(ta.has("facebook.authcode.param")){b=Object.merge(b,{FBAuthCode:ta.remove("facebook.authcode.param")})}ta.store("registration.method","post");new Request({url:a.options.url,method:"post",evalScripts:true,data:a.getRequestData(b,{noreload:a.options.noreload}),onSuccess:a.response,onFailure:a.failure}).send()},100);return this},cancel:function(){ta.store("registration.method","cancel");new Request({url:this.options.url,method:"get",evalScripts:true,data:this.getRequestData({CANCEL:"y",action:ta.retrieve("registration.action"),noreload:this.options.noreload}),onSuccess:this.response,onFailure:this.failure}).send();return this},log:function(a){new Request({url:this.options.url,method:"get",evalScripts:false,data:this.getRequestData({action:"LOG",pageAction:a})}).send();return this},response:function(a){if(!ta.remove("registration.noop")){if(this.options.isOverlay){this.overlay.loadRemoteSuccess(a);if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{this.options.pageTarget.innerHTML=a}}if(this.options.responseCallback){setTimeout(this.options.responseCallback,1)}if(ta.has("registration.afterUpdate")){ta.remove("registration.afterUpdate").each(function(b){setTimeout(b,1)})}},close:function(){if(this.options.isOverlay){this.overlay.hide()}this.fireEvent("onComplete");if(this.options.completeCallback){this.options.completeCallback()}},failure:function(c){var a=0;var d=ta.remove("registration.method");try{a=c.status}catch(b){}if(a==503){this.overlay.loadRemoteSuccess('<div style="padding:6px;">'+JS_maintenance+"</div>");if(this.overlay.closeBtn){this.overlay.closeBtn.removeEvents("click");this.overlay.closeBtn.addEvent("click",ta.overlays.registration.close)}if(this.overlay.visible){this.overlay.position()}else{this.overlay.show()}}else{if(d=="cancel"){ta.overlays.registration.close()}ta.util.error.ajaxFailure.partial("Registration:"+d)}}});ta.overlays.registration={getInstance:function(a){var b=ta.retrieve("registration.instance");if(!b){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}b=new ta.overlays.Registration(a);ta.store("registration.instance",b)}return b},connect:function(a,d,c){if(typeof(regflowCss)!="undefined"&&!ta.retrieve("ta.regflowCss")){ta.store("ta.regflowCssAsset",Asset.css(regflowCss))}if(ta.has("facebook.available")&&ta.retrieve("facebook.available")){var f={fbAvailable:true}}else{if(ta.has("registration.forceFBAvailable")){var f={fbAvailableForce:ta.remove("registration.forceFBAvailable")}}}var b="SIGNIN";ta.remove("registration.data");ta.overlays.registration.getInstance(a).request(d||b,Object.merge({},c,f))},post:function(b,a){var c=a||window.event;if(c){new Event(c).stop()}ta.overlays.registration.getInstance().post(b)},request:function(c,b,a){if(c=="SIGNUP"||c=="SIGNIN"){b=Object.merge({fbAvailable:ta.has("facebook.available")&&ta.retrieve("facebook.available")},b)}ta.overlays.registration.getInstance(a).request(c,b)},deferredRequest:function(d,b,f,c,a){ta.overlays.registration.getInstance(a).request(f,c,a)},cancel:function(){ta.overlays.registration.getInstance().cancel(false)},log:function(a){ta.overlays.registration.getInstance().log(a)},close:function(){var a=ta.remove("registration.instance");if(a){a.close()}},switchFlow:function(a){ta.overlays.registration.getInstance().options.flow=a},logAndPost:function(a,c,b){ta.overlays.registration.getInstance(a).log(c).post(b)},postSignupForm:function(d,c){var f=c||window.event;if(f){new Event(f).stop()}if(ta.has("checkPasswordReqs")){var a=ta.id("pass");var b=new RegExp("(?=^.{8,}$)(?=.*\\d)(?=.*[A-Z]).*$");if(b.test(a.value)==false){ta.id("passError").show();ta.id("passInfo").hide();return}}ta.overlays.registration.getInstance().post(d)}};ta.servlet.Registration={realNameDone:function(a){if(ta.id("use_real_name")&&ta.id("use_real_name").getProperty("checked")||ta.id("chooseNameFB")){ta.overlays.registration.post(ta.id("RealName"),a)}else{ta.overlays.registration.cancel()}},screenEdit:function(a){ta.id("screen").set("value","");ta.id("screen").focus();ta.id(a).hide()}};ta.overlays.PopoutOverlay=new Class({Extends:ta.overlays.Overlay,options:{backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.placeholder.setStyles({marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.source.setStyles({marginBottom:0,marginTop:0});if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(a){this.sourceCoords=this.source.getCoordinates();this.placeholder.setStyles({width:this.sourceCoords.width,height:this.sourceCoords.height});this.inner.adopt(this.source);this.parent(a)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"})},position:function(){var b=parseInt(this.container.getStyle("borderTopWidth").replace(/px/,""));var a=parseInt(this.container.getStyle("borderLeftWidth").replace(/px/,""));this.container.setStyles({left:this.sourceCoords.left-a,top:this.sourceCoords.top-b,width:this.sourceCoords.width,display:"block"});this.parent()}});ta.overlays.PopoutWithOverlay=new Class({Extends:ta.overlays.Overlay,options:{position:"topleft",edge:"topright",offset:{x:-10,y:0},scrollOffset:-20,backdrop:ta.overlays.BACKDROP_ALWAYS,showCloseButton:true},initialize:function(a,b){this.parent(a,b);this.placeholder=new Element("div").inject(this.source,"before").adopt(this.source);this.popout=new Element("div",{styles:{position:"absolute",zIndex:"10002",fontSize:"0.75em",display:"none"}}).inject(document.body);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}this.show()},show:function(b){this.parent(b);var a=this.source.getCoordinates();this.placeholder.setStyles({width:a.width,height:a.height,marginBottom:this.source.style.marginBottom,marginTop:this.source.style.marginTop});this.popout.setStyles({left:a.left,top:a.top,width:a.width,display:"block"}).adopt(this.source)},hide:function(a){this.parent(a);this.placeholder.adopt(this.source).setStyles({width:"auto",height:"auto"});this.popout.setStyle("display","none")},position:function(){var a=this.source.getCoordinates();this.container.setStyles({left:null,top:a.top+this.options.offset.y,right:window.getWidth()-(a.left+this.options.offset.x)});this.parent();window.scrollTo(0,a.top+this.options.offset.y+this.options.scrollOffset)}});ta.overlays.CoverOverlay=new Class({Extends:ta.overlays.Overlay,options:{autoShow:true,xOff:0,yOff:0},initialize:function(a,b){this.parent(a,b);if(this.options.showCloseButton){this.closeBtn.addEvent("click",this.hide)}if(this.options.autoShow){this.show()}},position:function(){var b=this.source.getCoordinates();var a=this.container.getCoordinates();this.container.setStyles({left:b.left+(b.width/2-a.width/2)+this.options.xOff,top:b.top+(b.height/2-a.height/2)+this.options.yOff})},updateBackdrop:function(){var a=this.source.getCoordinates();this.backdrop.setStyles({left:a.left,top:a.top,width:a.width,height:a.height})}});ta.overlays.SpecialDropDownWithRangeOverLay=new Class({Extends:ta.overlays.RelativeOverlayBelow,options:{onClose:false,onShow:false},initialize:function(a,b){var c="";if(b.id==="vrPriceMinDropDown"||b.id==="vrPriceMaxDropDown"||b.id==="vrPricePeriodDropDown"){c="vrPriceDropDown"}this.parent(Object.merge({below:true,innerDivClass:"",style:c,autoShow:false},a),b);this.container.removeClass("relative");if(a.onClose){this.options.onClose=a.onClose}if(a.onShow){this.options.onShow=a.onShow}},show:function(h){if(this.visible){this.hide();return}try{this.options.onShow()}catch(g){}var b=h.srcElement?h.srcElement:h.target;if(b){this.source=b}var d=ta.select(".overlay");for(var f=0;f<d.length;f++){var c=d[f];if(c.contains(this.source)){var a=c}}if(a){this.container.setStyle("z-index",a.getStyle("z-index")+1)}document.addEvent("click",this.hide);this.parent(h)},hide:function(b){if(this.options.onClose){try{this.options.onClose()}catch(a){}}if(this.options.rangeInputClass){try{if(this.container.getElements("."+this.options.rangeInputClass)[0].contains(b.target)){return}}catch(a){}}document.removeEvent("click",this.hide);this.hideNow()},position:function(){var a=this.source.getPosition();this.container.setStyles({left:a.x+this.options.xOffset?this.options.xOffset:0,top:a.y+this.options.yOffset?this.options.yOffset:0});this.parent()}});ta.overlays.StaticOverlay=new Class({Extends:ta.overlays.RelativeOverlay,initialize:function(a,b){this.parent(Object.merge({autoShow:false},a),b);this.container.removeClass("relative")},position:function(a){this.container.position({position:"center",offset:{x:this.options.offsetX||0,y:this.options.offsetY||0}});this.parent()},hide:function(d){if(d==null){return}var a=d.srcElement?d.srcElement:d.target;if(this.container.contains(a)){return}if(this.options.childrenOverlays){for(var c=0;c<this.options.childrenOverlays.length;c++){var b=this.options.childrenOverlays[c];if(b.container.contains(a)){return}}}this.parent()}});if(!ta.overlays.filters){ta.overlays.filters={}}ta.overlays.filters.CheckboxOverlay=new Class({Extends:ta.overlays.RelativeOverlayBelow,Binds:["nonSourceHide","doOnInit","buildContent"],options:{showCloseButton:false,activate:ta.overlays.ACTIVATE_CLICK,style:"date_picker_calendar",multiSelect:true,autoShow:false,delayShow:true,noPadding:true,keepElementInDocument:true,filterType:"",closeOnSelect:true},initialize:function(c,b){var a=Object.merge(this.options,c);this.input=document.getElement(".hotel_filter_wrap ."+a.filterType);this.parent(a,this.input);this.source.removeEvent("click",this.show);this.setupStandardBehavior();this.doOnInit()},setupStandardBehavior:function(){this.input.overlay=this;if(this.container){this.parentOverlay=this.container.getParent(".overlay");if(this.parentOverlay){this.parentOverlay=this.parentOverlay.overlay;this.options.isChild=true}}},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType)},buildContent:function(b,f){var a=ta.retrieve("hac.data.object");var j=document.createDocumentFragment();if(a&&a.filters){var d=a.filters[f];if(d){var g=document.createElement("ul");var h=d.options.length;g.className="hacFilterItems "+d.hacName;if(h>8){g.className=g.className+" manyItems"}j.appendChild(g);var c=this;Array.each(d.options,function(k){c.addCheckboxItem(d,f,k,g,c,a)})}b.empty().appendChild(j)}},addCheckboxItem:function(h,b,c,f,j,d){var q="";if(j.isItemDisabled(c)){q="disabled"}var s="";if(q!=""){s="disabled=''"}var o=new Element("li");o.className="hacFilterItem";var l="";var a=b=="showUnavailable";if(a){l="showUnavailable"}if(q||a){o.className=o.className+" "+q+" "+l}if(c.value==0&&!a){o.className=o.className+" default"}var k=b;if(!j.isItemDisabled(c)){o.addEvent("click",function(u){(function(){j.dataItemClick.call(j,o,h.hacName,k,ta.hac.filters.getItemValue(c,b))}).delay(10);return false})}if(a){var m=new Element("hr");f.appendChild(m)}f.appendChild(o);var g="";if(a){if(c.value==1){g="checked=checked"}}else{if(j.isCheckboxItemSelected(d.selected,h.hacName,c.value)){g="checked=checked"}}var p=j.getItemDisplayFragment(c,b);var t=h.hacName+"_"+c.value;var r="";if(!a){r="<span class='itemCount'>("+c.count+")</span>"}else{t=h.hacName}o.innerHTML="<input type='checkbox' id='"+t+"' class='"+t+" "+q+"' "+g+" "+q+" /><span class='dataItem "+q+"'>"+p+r+"</span>"},dataItemClick:function(g,b,a,f){var h;if(ta.has("hac.filter.click.timeout")){ta.remove(ta.hac.filters.getHacFilterTimeoutKey());clearTimeout(ta.remove("hac.filter.click.timeout"))}this.fixCheckboxesInFilter(g);h=ta.hac.filters.updateFilterHash(b,this.getFilterSelections(b));var c=ta.has("persistentFilters.showing")?a+"|persistent_bar":a;if(h){try{var d="click";if(g&&g.getElement("input")&&!g.getElement("input").checked){d="unclick"}if(typeof pageServlet!="undefined"&&pageServlet=="Hotels"&&!ta.isMetaHotelsRequest()){ta.setEvtCookie("Meta_HAC_Filter",d,c,f,"/HACSearch")}else{ta.trackEventOnPage("Meta_HAC_Filter",d,c,f)}}catch(k){}var j=this;ta.store("hac.filter.click.timeout",setTimeout(function(){ta.remove("hac.updates.running");if(ta.retrieve("meta.hotels_filter_redesign_ph_3.enabled")){ta.hac.filters.closeAllActiveFilters()}j.updateHACResults.call(j);ta.remove(ta.hac.filters.getHacFilterTimeoutKey())},2000));ta.store(ta.hac.filters.getHacFilterTimeoutKey(),ta.retrieve("hac.filter.changed"))}},updateHACResults:function(){if(this.options&&this.options.closeOnSelect){this.hide()}ta.hac.filters.updateResultsFromFilters()},setCloseOnSelect:function(a){if(this.options&&this.options.closeOnSelect){this.options.closeOnSelect=a}},fixCheckboxesInFilter:function(d){var d=ta.id(d);if(!d||d.hasClass("disabled")){return}if(d.hasClass("hacFilterItem")){d.getElement("input").checked=!d.getElement("input").checked}if(d.hasClass("default")){var f=d.getParent(".hacFilterItems");if(f){Array.each(f.getElements(".hacFilterItem"),function(g){g=ta.id(g);if(!g.hasClass("default")){g.getElement("input").checked=false}else{g.getElement("input").checked=true}})}}else{var b=false;var f=d.getParent(".hacFilterItems");if(!d.getElement("input").checked){var a=f&&document.getElements(".hacFilterItems input:checked");if(!a||!a.length){b=true}}if(f){var c=f.getElement(".default");if(c){c.getElement("input").checked=b}}}},getFilterSelections:function(c){var a=[];if(c=="showUnavailable"){a=document.getElements(".hacFilterItem."+c+" input:checked")}else{if(c){a=document.getElements(".hacFilterItems."+c+" input:checked")}else{a=document.getElements(".hacFilterItems input:checked")}}var b=[];Array.each(a,function(d){if(d.id!=c+"_0"){b.push(d.id)}else{if(c=="showUnavailable"){b.push("showUnavailable")}}});return b},addExpandableItem:function(c,d){var h=document.createDocumentFragment();var f=new Element("li");f.className=c+" expandFilterItem";h.appendChild(f);var g=document.createElement("div");g.className="nameItem sprite-filter-expand";if(ta.has("filterNames."+c)){g.innerHTML=ta.retrieve("filterNames."+c)}else{if(ta.has("hotels.currencies")&&"currencies"==c){g.innerHTML=ta.retrieve("hotels.currencies")[0]}else{g.innerHTML=c}}var b=new Element("div");b.className="toggleItem";f.appendChild(g);f.appendChild(b);var a=this;f.addEvent("click",function(){a.expandableClick.call(a,c,f)});d.appendChild(h)},expandableClick:function(){return},getItemDisplayFragment:function(a,b){return ta.hac.filters.getItemDisplayFragment(a,b,this.isItemDisabled(a))},isCheckboxItemSelected:function(c,a,g){if(!c){return false}var d=a+"_"+g;var b=c.cb;if(g!=0){if(b&&b.contains(d)){return true}}else{var f=false;if(b){Array.each(b,function(h){if(h.indexOf(a)!=-1){f=true}})}if(!f){return true}}return false},isItemDisabled:function(a){if(a&&a.count>0){return false}return true},destroy:function(){this.parent();this.input.overlay=null},nonSourceHide:function(a){if(!this.source.containsEvent(a)){this.hide()}},show:function(g){var d=this.visible;this.parent(g);document.removeEvent("click",this.hide);document.addEvent("click",this.nonSourceHide);if(this.options.filterType!="more"){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType)}if(d){return}if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}if(ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.container){this.container.setStyle("position","fixed")}var c=document.getElement(".hotel_filter."+this.options.filterType);var f=document.getElement(".date_picker_calendar."+this.options.filterType);if(ta.util.i18n.isRtl()){var b=c.getCoordinates().width;var a=f.getCoordinates().width;this.options.offsetLeft=a-b}else{this.options.offsetLeft=0}this.position();return this},hide:function(a){if(!this.visible){return}document.removeEvent("click",this.nonSourceHide);this.parent(a);if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}}});ta.overlays.filters.ClassOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_class"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.RatingOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"traveler_rating"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.PriceOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"price"},initialize:function(b,a){this.parent(b,a)},doOnInit:function(){this.buildContent(this.inner.getElement(".hotelFilterContent"),this.options.filterType);if(ta.has("hotels.currencies")){this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent"))}this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent"))},expandableClick:function(b,c){var a=c.getElement(".toggleItem");if(a&&a.innerHTML!=""){a.innerHTML="";if(ta.id(c).getElement(".nameItem")){ta.id(c).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}}else{this.buildCurrencyContent(c.getElement(".toggleItem"),"currencies");var d=ta.id(c).getParent(".expandFilterItems");if(d){var f=d.getElements("li");if(f){Array.each(f,function(h){h=ta.id(h);var g=h.getElement(".nameItem");if(!h.hasClass("currencies")&&g&&g.hasClass("sprite-filter-collapse")){var j=h.getElement(".toggleItem");if(j){j.innerHTML=""}g.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}}if(ta.id(c).getElement(".nameItem")){ta.id(c).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse")}}},show:function(){this.parent();if(ta.has("hotels.currencies")){this.addExpandableItem("currencies",this.inner.getElement(".hotelFilterContent"));this.addShowUnavailableCheckbox(this.inner.getElement(".hotelFilterContent"))}},nonSourceHide:function(a){if(!this.source.containsEvent(a)&&!this.inner.containsEvent(a)){this.hide()}},addShowUnavailableCheckbox:function(d){if(!ta.retrieve("metaUI.isHotelsAvailabilitySort")){return}var a=ta.retrieve("hac.data.object");if(a&&a.filters){var g={hacName:"showUnavailable"};var f=this;var h=a.selected.showUnavailable;var c=ta.retrieve("filterNames.showUnavailable");var b={label:c,count:1,value:h?1:0};f.addCheckboxItem(g,"showUnavailable",b,d,f,a)}},buildCurrencyContent:function(a){var d="";var h=document.createDocumentFragment();var f=document.createElement("ul");var c=ta.retrieve("hotels.currencies");if(c){var g=c.length;f.className="hacFilterItems currency";if(g>8){f.className=f.className+" manyItems"}h.appendChild(f);var b=this;Array.each(c,function(l,k){var p=new Element("li");p.className="hacFilterItem";p.addEvent("click",function(q){(function(){b.currencyItemClick.call(b,l)}).delay(10);return false});f.appendChild(p);var o="";var m=b.getItemDisplayFragment(l,"currencies");var j="currency_"+l;p.innerHTML="<span class='dataItem'>"+m+"</span>"})}a.innerHTML="";a.appendChild(h)},currencyItemClick:function(a){ta.commerce.meta.clearStoredMiniData();if(a.test(/[A-Z]{3}/)){ta.store("ta.commerce.MetaHacOverlay.currency",a);new Request({url:"/ActionRecord?action=MetaCurrencyPicker"}).send();ta.trackEventOnPage("MetaCurrencyPicker","selected",a,1);ta.hac.filters.changeCurrency()}if(this.hide){this.hide()}},addDateCTA:function(){var a=this.inner.getElement(".hotelFilterContent");a.innerHTML="";var b=ta.id("PRICE_FILTER_NODATES_CTA_TEXT").innerHTML;new Element("div",{html:b,id:"PRICE_FILTER_NODATES_CTA"}).inject(a)},showCalendarLightbox:function(d){var c="Meta_HAC_Filter";var f="open_calendar";var b="price";ta.trackEventOnPage(c,f,b,0,false);var a=ta.retrieve("ta.overlays.filters.PriceOverlay.showCalendarLightbox");if(typeof(a)=="function"){a()}else{this.buildCalendarLightbox(d)}},calendarLightBoxOverlay:null,buildCalendarLightbox:function(f,a){var d;d=ta.id("PriceFilterCalendarOverlayContent");if(!d){return}d.show();var c={style:"priceFilterCalendarOverlay",innerDiv:"skv3",content:d,autoShow:false,backdrop:ta.overlays.BACKDROP_ALWAYS,closeButtonClass:"roundOuterClose",onShow:function(){ta.remove("ta.calendar.isOutDateTrigger");ta.store("ta.calendar.isPriceOverlayCalendar",true);var j=null;var h=document.getElement("date_picker_in_PriceFilterCalendar");setTimeout(function(){ta.overlays.Factory.loadDatePicker(j,h,"PriceFilterCalendar","",ta.servlet.HACSearch.doMetaDateSearch)},100);if(this.calendar){this.calendar.reposition()}},onClose:function(){ta.remove("ta.calendar.isOutDateTrigger");ta.remove("ta.calendar.isPriceOverlayCalendar")}};var g=ta.id("HEADING");var b=new ta.overlays.CenteredOverlay(c,g);ta.store("ta.overlays.filters.PriceOverlay.showCalendarLightbox",function(){b.show()})},buildContent:function(a,b){if(ta.retrieve("meta.hotels_no_prices")&&!ta.widgets.calendar.hasPageDates()){if(ta.isMetaPriceFilterCalendar()){this.showCalendarLightbox(a)}else{this.addDateCTA()}}else{this.parent(a,b)}}});ta.overlays.filters.NeighborhoodOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"neighborhood"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.AmenitiesOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"amenities"},initialize:function(b,a){this.parent(b,a)}});ta.overlays.filters.BrandOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"hotel_brand"},initialize:function(b,a){this.parent(b,a)},getItemDisplayFragment:function(a){if(typeof brandMappings!="undefined"){return"<span class='itemLabel'>"+brandMappings[a.value]+"</span>"}return""}});ta.overlays.filters.MoreOverlay=new Class({Extends:ta.overlays.filters.CheckboxOverlay,options:{filterType:"more",moreOptions:""},initialize:function(b,a){if(b.moreOptions){this.displayFilters=b.moreOptions.split(" ")}this.parent(b,a)},doOnInit:function(){var b=document.createDocumentFragment();var a=new Element("ul");a.className="expandFilterItems more";b.appendChild(a);this.inner.getElement(".hotelFilterContent").innerHTML="";this.inner.getElement(".hotelFilterContent").appendChild(b);moreOvly=this;Array.each(this.displayFilters,function(c){var d=ta.retrieve("hac.data.object");if(d&&d.filters){var f=d.filters[c];if(f&&f.options.length>0){moreOvly.addExpandableItem.call(moreOvly,c,a)}}})},nonSourceHide:function(a){if(!this.source.containsEvent(a)&&!this.inner.containsEvent(a)){this.hide()}},expandableClick:function(c,b){var g=ta.has("persistentFilters.showing")?c+"|persistent_bar":c;var a=b.getElement(".toggleItem");if(a&&a.innerHTML!=""){a.innerHTML="";if(ta.id(b).getElement(".nameItem")){ta.id(b).getElement(".nameItem").removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}ta.trackEventOnPage("Meta_HAC_Filter","close",g)}else{this.buildContent(b.getElement(".toggleItem"),c);var d=ta.id(b).getParent(".expandFilterItems");if(d){var f=d.getElements("li");if(f){Array.each(f,function(j){j=ta.id(j);var h=j.getElement(".nameItem");if(!j.hasClass(c)&&h&&h.hasClass("sprite-filter-collapse")){var k=j.getElement(".toggleItem");if(k){k.innerHTML=""}h.removeClass("sprite-filter-collapse").addClass("sprite-filter-expand")}})}}if(ta.id(b).getElement(".nameItem")){ta.id(b).getElement(".nameItem").removeClass("sprite-filter-expand").addClass("sprite-filter-collapse")}ta.trackEventOnPage("Meta_HAC_Filter","open",g)}}});ta.commerce.HACRoomInfo=new Class({initialize:function(a){this.locId=a;this.offers={}},getRoomDetailKey:function(a){a=""+a;return(a in this.offers)?this.offers[a]["roomDetailKey"]:null},setRoomDetailKey:function(b,a){b=""+b;if(!(b in this.offers)){this.offers[b]={}}this.offers[b]["roomDetailKey"]=a}});ta.commerce.Vendor=new Class({Implements:Options,options:{checkboxID:false,additionalOffer:false,defaultChecked:false,minDaysOut:0,maxDaysOut:0},initialize:function(c,d,f,a,b){this.setOptions(c);this.name=d;this.url=f;this.window=null;this.slot=null;this.opened=false;this.vendorName=a;this.propertyId=b;this.isFlight=false},isChecked:function(){if(ta.retrieve("isMetaCheckboxCheckRates")){return this.isCheckedWithExtension("_met")}else{return this.isCheckedWithExtension()}},isCheckedWithExtension:function(d){if(this.options.checkboxID){if(d){a=ta.id(this.options.checkboxID+d);if(a){return a.checked}}var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(!a){a=ta.id(this.options.checkboxID+"_per")}if(!a){a=ta.id(this.options.checkboxID+"_met")}if(a){try{var b=ta.id(a).getParent("li");if(b&&b.style.display=="none"){return false}}catch(c){ta.util.error.record(c,"cr checkbox hidden check")}return a.checked}}return this.options.defaultChecked&&(this.options.available||ta.retrieve("checkrates.datesChanged"))},isAvailable:function(){if(!this.isOpened()){return true}return false},isOpened:function(){try{if(!this.opened||!this.hasWindow()){return(ta.has("checkrates.cr_provider_on_mousedown")&&ta.retrieve("checkrates.cr_mousedown_provider")==this.name)}}catch(a){}return true},isDefaultChecked:function(){return this.options.defaultChecked},isHidden:function(){var a=ta.id(this.options.checkboxID);if(!a){a=ta.id(this.options.checkboxID+"_pop")}if(!a){a=ta.id(this.options.checkboxID+"_icr")}if(a){try{var b=ta.id(a).getParent("li");if(b){if(b.style.display=="none"){return true}else{if(this.options.hide){if(b.style.display=="block"){return false}else{return true}}}}}catch(c){ta.util.error.record(c,"checkbox hide check")}}return false},hasWindow:function(){if(!this.window||!this.window.windowObject||!("closed" in this.window.windowObject)||this.window.windowObject.closed){return false}return true},addRoomDetailKeyParameters:function(a){var b=a;if(this.getLowestPriceRoomDetailKey()){b+="&rdex="+this.getLowestPriceRoomDetailKey()}return b},getUrl:function(d,a){var k=this.url;if(this.isFlight){k+="&"+d.getFlightData()}else{if(ta.has("metaDatePickerEnabled")&&ta.widgets&&ta.widgets.calendar&&ta.widgets.calendar.hasPageDates()){k+="&"+ta.commerce.checkrates.multiDatePickerUserData();if(d.type=="geocheckrates"){k=ta.commerce.checkrates.addCustomUrlParams(k,"QC_Inline_Geo")}}else{if(d.type!="checkdeals"){var f=d.getUserData();if(!f){f=ta.retrieve("checkrates.avUserData")}k+="&"+f;var j="QC_Inline";var c=a;if(c){var h=false;if(h=c.className.match(/custom_area_(\w+)/)){j=h[1]}}k=ta.commerce.checkrates.addCustomUrlParams(k,j)}else{if(ta.has("photo.viewer.isPhotoLBClick")){k=ta.commerce.checkrates.addCustomUrlParams(k,"QC_Inline")}}}}var c=d.actualTrigger||a;var b=c&&(c.hasClass("msk")?c:c.getParent(".msk"));if(b){var g=b.className.match(/msk[^\s]+/);if(g&&g.length>0){k+="&msk="+g[0].substr(3)}}if(ta.has("metaCacheKey")){k+="&"+ta.retrieve("metaCacheKey")}k=this.addRoomDetailKeyParameters(k);return k},errorString:function(){var a=[];if(this.name){a.push("&name_");a.push(this.name)}if(this.slot){a.push("&slot_full")}if(this.propertyId){a.push("&propId_");a.push(this.propertyId)}var b=a.join("");if(b&&b[0]){return b.slice(1)}return"noInfo"},hasDateLimits:function(){return this.options.minDaysOut>0||this.options.maxDaysOut>0},getContentID:function(){if(this.url){return ta.util.URL.getParameter(this.url,"src")}return false},getLowestPriceRoomDetailKey:function(){var b=this.propertyId;var c=this.getContentID();var a=ta.retrieve("ta.commerce.hacRoomInfo."+b);return a?a.getRoomDetailKey(c):null}});ta.commerce.VendorSet=new Class({Implements:Options,options:{vendorSet:false},initialize:function(b,a){this.setOptions(b);this.vendorSetId=a;if(this.options.vendorSet){this.vendors=this.options.vendorSet}this.vendorsUnchecked=[];this.vendorsDefaultUnchecked=[]},getVendors:function(){if((!this.vendors)||ta.has("checkrates.sponsored_vendors.loc."+this.vendorSetId)){this.vendors=ta.retrieve("checkrates.vendors."+this.vendorSetId)}return this.vendors},getVendorsUnchecked:function(){var c=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<c.length;a++){var b=c[a];if(!b.isChecked()&&!b.isHidden()){this.vendorsUnchecked.push(b)}}return this.vendorsUnchecked},getAllVendorIds:function(){var b=[];var c=this.getVendors();for(var a=0;a<c.length;a++){var d=c[a];b.push(d.getContentID());b.push("__")}if(b.length>0){b.pop()}return b.join("")},getVendorsDefaultUnchecked:function(){try{var d=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var a=0;a<d.length;a++){var c=d[a];if(!c.isChecked()&&!c.isHidden()&&!c.isDefaultChecked()){this.vendorsDefaultUnchecked.push(c)}}return this.vendorsDefaultUnchecked}catch(b){ta.util.error.record(b,"vendorSet - default unchecked")}},setVendorSetDefaultChecked:function(c){var b=this.getVendors();for(var a=0;a<b.length;a++){b[a].options.defaultChecked=c}},getCheckedInfo:function(q){var r=0;var p=0;var b=0;var c=[];var g=[];var k=[];var s=[];var d=[];var a=[];var t=[];try{var o=this.getVendors();for(var f=0;f<o.length;f++){var m=o[f];d.push(m.name);d.push("__");if(m.isChecked()){r++;c.push(m.name);c.push("__");g.push(m.vendorName);g.push("__");t.push(m.getContentID());t.push("__")}else{a.push(m.name);a.push("__")}if(m.window&&m.window.closed){m.window=null}else{if(m.isOpened()){p++;k.push(m.name);k.push("__")}}}var l=ta.retrieve("checkrates.vendors."+this.vendorSetId);for(var f=0;f<l.length;f++){var h=l[f];if(h.isHidden()){b++;s.push(h.name);s.push("__")}}if(c.length>0){c.pop()}if(g.length>0){g.pop()}if(k.length>0){k.pop()}if(s.length>0){s.pop()}if(d.length>0){d.pop()}if(a.length>0){a.pop()}if(t.length>0){t.pop()}if(q=="unavail_set"){return{vendorsAvailable:d.join(""),vendorsOpened:k.join("")}}else{if(q=="unchecked"){return{vendorsUnchecked:a.join("")}}else{if(q=="count"){return r}else{if(q=="tpw_string"){return c.join("")}else{if(q=="tpv_string"){return g.join("")}else{if(q=="open_count"){return p}else{if(q=="check_more"){return{vendorsChecked:c.join(""),vendorsOpened:k.join(""),vendorsHidden:s.join("")}}else{if(q=="now_checking"){return{vendorsChecked:c.join("")}}else{if(q=="checked_content_id"){return t.join("")}}}}}}}}}}catch(j){}return{checked:r,tpw_string:c.join(""),tpv_string:g.join(""),open:p,tpw_open_string:k.join("")}},getCheckedCount:function(){return this.getCheckedInfo("count")},getCheckedString:function(){return this.getCheckedInfo("tpw_string")},getCheckedVendor:function(){return this.getCheckedInfo("tpv_string")},getCheckedContentID:function(){return this.getCheckedInfo("checked_content_id")},oneChecked:function(){var a=this.getCheckedCount();if(a==0){alert(js_0001);return false}return true},getOpenCount:function(){return this.getCheckedInfo("open_count")},storeCheckBoxValues:function(){var a={};this.getVendors().each(function(b){a[b.name]=b.isChecked()});ta.store("checkBoxSet_"+this.vendorSetId,a)},errorString:function(){var a=[];var b=this.getVendors();if(!b||b.length<1){return"empty.vendor.set"}a.push("VSet::");b.each(function(d,c){a.push("V");a.push(c);a.push(":");a.push(d.errorString())});return a.join("")}});ta.commerce.CheckRatesData=new Class({Implements:Options,options:{type:"checkRates",evnt:false},initialize:function(c,b,d,a){this.setOptions(c);this.type=this.options.type;this.vendorSetId=d;this.isCheckMore=a;this.maxAllowedWin=0;this.maxHoldingWin=2;this.useHoldingWin=false;this.cap=3;this.lbDelay=1000;this.providerOnMouseDown=false;this.skipHoldingWin=false;if(ta.has("checkrates.cr_provider_on_mousedown")&&c&&c.evnt&&c.evnt.type=="mousedown"){this.providerOnMouseDown=true}if(Browser.chrome){ta.popups.PopUtil.useShiftClick();if(!ta.has("checkrates.use_chrome_provider_on_shift_click")){if(Browser.version==22){this.maxAllowedWin=2}else{if(Browser.version>22){this.maxAllowedWin=1}}if(ta.has("checkrates.cr_provider_on_mousedown")){this.maxAllowedWin+=1}}}else{if(Browser.ie){this.maxAllowedWin=1}}this.propId=b;if(!this.propId){this.propId=this.vendorSetId}if(this.vendorSetId){this.vendorSet=new ta.commerce.VendorSet({},this.vendorSetId)}},showInfo:function(a){if(this.infoField){this.infoField.addClass("errorSpan");this.infoField.setContent(a).show()}},hideInfo:function(){if(this.infoField){this.infoField.hide();this.infoField.removeClass("errorSpan")}},showErrors:function(g,b){var a=[];if(!ta.retrieve("ta.commerce.CheckRatesData.cssAsset")){ta.store("ta.commerce.CheckRatesData.cssAsset",Asset.css(CDNHOST+"/css2/common/validation_error.css"))}if(b!=null&&b instanceof Array&&b.constructor==Array){a=b}else{a.push(b)}for(var f=0;f<a.length;f++){var d=a[f];if(d){d.addClass("errorInput");var c=ta.id("lbl_"+d.id);if(c){c.addClass("errorLabel")}}}this.showInfo(g)},clearErrors:function(a,c){var b=ta.id("lbl_"+a.id);var d=ta.id("lbl_"+c.id);if(a){a.removeClass("errorInput")}if(c){c.removeClass("errorInput")}if(b){b.removeClass("errorLabel")}if(d){d.removeClass("errorLabel")}},validate:function(){if(!this.propId||!this.vendorSetId||!this.getVendorSet()){try{var a="NoVendSet";if(this.getVendorSet()){a=this.getVendorSet().errorString()}ta.util.error.record(null,"cr data validate",new Event(this.options.evnt),{propId:this.propId,vendorSetId:this.vendorSetId,vendorSet:a})}catch(b){}return false}if(!this.getVendorSet().oneChecked()||!this.validateDates()){return false}return true},getVendorSet:function(){if(this.reorderedVendorSet){return this.reorderedVendorSet}return this.vendorSet},getAvailVendorSet:function(){if(!this.availVendorSet){this.setAvailVendorSet()}return this.availVendorSet},getOriginalVendorSet:function(){return this.vendorSet},validateDates:function(){var b=ta.id("checkIn_"+this.vendorSetId);var c=ta.id("checkOut_"+this.vendorSetId);var a=false;checkInElemPer=ta.id("checkIn_"+this.vendorSetId+"_per");if(checkInElemPer){b=checkInElemPer;c=ta.id("checkOut_"+this.vendorSetId+"_per")}checkInElemPto=ta.id("checkIn_"+this.vendorSetId+"_pto");if(checkInElemPto){b=checkInElemPto;c=ta.id("checkOut_"+this.vendorSetId+"_pto")}checkInElemMeta=ta.id("checkIn_"+this.vendorSetId+"_met");if(checkInElemMeta){b=checkInElemMeta;c=ta.id("checkOut_"+this.vendorSetId+"_met")}if(ta.has("checkrates.date_picker_on_classic")&&!ta.widgets.calendar.datesExist()){this.errorMsg=this.dateErrorCheck(this.inDate);this.showErrors(this.errorMsg,null);return false}else{if(!this.formElem||!b||!c||!b.value||!c.value){if(!b){b=ta.id("checkIn_"+this.vendorSetId+"_pop");c=ta.id("checkOut_"+this.vendorSetId+"_pop")}if(!this.formElem||!b||!c||!b.value||!c.value){return true}}}this.inDate=this.parseDate(b.value);this.outDate=this.parseDate(c.value);this.clearErrors(b,c);this.errorMsg=this.dateErrorCheck(this.inDate);if(this.errorMsg){this.showErrors(this.errorMsg,b);a=true}this.errorMsg=this.dateErrorCheck(this.outDate);if(this.errorMsg){this.showErrors(this.errorMsg,c);a=true}if(this.inDate&&this.outDate&&(this.outDate.getTime()<=this.inDate.getTime())){this.errorMsg=js_0003;this.showErrors(this.errorMsg,[c,b]);a=true}if(window.cookieDomain==".daodao.com"&&a){new Request({url:"/ActionRecord?action=DaodaoInlineCRClick"}).send();var d=ta.retrieve("daodao.checkrate.error.nodate");if(d!=null){}}return !a},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(g<100){g+=2000}d=ta.util.date.create(g,a-1,f)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){if(js_invalid_dates_text_new2){return js_invalid_dates_text_new2}return" "}var b=new Date();ta.util.date.normalize(b);var a=ta.util.date.create(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){if(js_0002){return js_0002}return" "}if(a.getTime()<c.getTime()){if(js_0004){return js_0004}return" "}return false},getMetaUserData:function(g){var b=ta.widgets.calendar.getCheckRatesData();if(b){return b}var a=ta.retrieve("avail.data."+g);if(a){ta.store("avail.data."+g,a);return a.getState()}var d=ta.id("date_picker_"+g);if(!d){d=ta.id("date_picker_"+g+"._met")}if(d){a=new ta.commerce.AvailDataWidget(false,g);if(a&&a.getState){return a.getState()}}var f=ta.retrieve("avail.data.objects");if(f){var c=f[0];if(c&&c.getState){return c.getState()}}return false},getUserData:function(){if(!this.userData){var c=this.vendorSetId;var d=[];if(ta.has("metaDatePickerEnabled")){var a=this.getMetaUserData(c);if(!a){return false}d.push("inMonth="+escape(a.inMonth));d.push("&inDay="+escape(a.inDay));d.push("&outMonth="+escape(a.outMonth));d.push("&outDay="+escape(a.outDay));d.push("&adults="+escape(a.adults));var r=ta.retrieve("checkrates.originAirport");if(r&&r.length==3){d.push("&Orig=");d.push(r)}}else{var p=ta.id("qcInMonth_"+c);if(!p){c=this.vendorSetId+"_pop";p=ta.id("qcInMonth_"+c)}if(!p){return false}var j=ta.id("qcOutMonth_"+c);var g=ta.id("qcInDay_"+c);var s=ta.id("qcOutDay_"+c);var q=ta.id("qcAdults_"+c);var k=p.value.split(/\//);var f=j.value.split(/\//);var l=ta.util.date.create(k[1],k[0]-1,g.value);var h=ta.util.date.create(f[1],f[0]-1,s.value);var b=new Date();ta.util.date.normalize(b);if(l.getTime()<b.getTime()||h.getTime()<b.getTime()){alert(js_0002);return false}var o=ta.util.date.create(b.getFullYear(),b.getMonth(),b.getDate()+330);if(l.getTime()>o.getTime()||h.getTime()>o.getTime()){alert(js_0004);return false}d.push("inMonth=");d.push(k[0]);d.push("%20");d.push(k[1]);d.push("&inDay=");d.push(escape(g.value));d.push("&outMonth=");d.push(f[0]);d.push("%20");d.push(f[1]);d.push("&outDay=");d.push(escape(s.value));d.push("&adults=");d.push(q.selectedIndex+1);var r=ta.retrieve("checkrates.originAirport");if(r&&r.length==3){d.push("&Orig=");d.push(r)}}var m=ta.id("hacPid"+c);if(m==null){m=ta.id("hacPid")}if(m&&m.value){d.push("&pid=");d.push(m.value)}this.userData=d.join("")}return this.userData},getFlightData:function(){var a=this.vendorSetId;var j=ta.id("qcInMonth_"+a);if(!j){a=this.vendorSetId+"_pop";j=ta.id("qcInMonth_"+a)}if(!j){return false}var f=ta.id("qcOutMonth_"+a);var c=ta.id("qcInDay_"+a);var k=ta.id("qcOutDay_"+a);var g=j.value.split(/\//);var d=f.value.split(/\//);var b=[];b.push("date0=");b.push(g[1]);b.push(g[0]);b.push(escape(c.value));b.push("&date1=");b.push(d[1]);b.push(d[0]);b.push(escape(k.value));var h=ta.id("qcFlightOfferPid");if(h&&h.value){b.push("&pid=");b.push(h.value)}return b.join("")},resetVisitedFlags:function(){var c="checkrates.sUserData."+this.vendorSetId;var a=ta.retrieve(c);var b=this.getUserData();if(a&&a!=b){var d=this.getVendorSet().getVendors();for(x=0;x<d.length;x++){d[x].opened=false}}ta.store(c,b)},getCROpenCount:function(b){var a=0;b.each(function(d){var c=d.window;if(d&&d.bOpened&&c&&c.windowObject&&!c.windowObject.closed){a++}});return a},fixPopOrder:function(t){var c=this.getCheckedVendors();var p=ta.popups.PopUtil.getHoldingWindowSet();var m=this.getVendorSet().getOpenCount();var b=p.length+m;var g=this.getVendorSet().getCheckedCount();if((b+1)<g){var a=false;try{a=window.chrome}catch(o){}var l=2;var s=a?true:ta.popups.PopUtil.tryHoldingWindows(this.propId,l);if(ta.has("checkrates.chrome_dates_entry_holding")&&Browser.chrome&&!ta.has("checkrates.use_chrome_provider_on_shift_click")){t=Math.min(t,(p.length+this.maxAllowedWin))}if(s&&t<c.length){var h=c.splice(0,t).reverse();c=h.concat(c)}else{if(s){c=c.reverse()}else{var q=p.length+1;if(ta.has("checkrates.add_holding_windows")){q=Math.min(q,t)}var r=[];for(var f=0;f<q;f++){r.push(c.shift())}for(var d=0;d<r.length;d++){c.unshift(r[d])}}}}else{c=c.reverse()}this.reorderedVendorSet=new ta.commerce.VendorSet({vendorSet:c},this.vendorSetId)},getCheckedVendors:function(){try{var a=this.getVendorSet().getVendors().slice();var b=[];a.map(function(f,d){if(f.isChecked()){b.push(f)}});return b}catch(c){ta.util.error.record(c,"getCheckedVendors")}},setAvailVendorSet:function(){try{var b=[];var h=this.getVendorSet().getVendors();var c=ta.retrieve("availability_check");if(c){for(var a=0;a<h.length;a++){var f=h[a];var g=c.unavailableProviders;if(!g||!g[f.name]){b.push(f)}}this.availVendorSet=new ta.commerce.VendorSet({vendorSet:b},this.vendorSetId)}}catch(d){ta.util.error.record(d,"availability check - crData set vendor set")}},setHWFlags:function(){if(!ta.has("checkrates.use_chrome_provider_on_shift_click")){var b=this.maxAllowedWin;if(this.providerOnMouseDown){this.useHoldingWin=false}else{if(!b){this.useHoldingWin=true}else{var a=this.getCheckedVendors().length;if(this.type=="geoCheckratesLB"){a=ta.retrieve("checkrates.geo_cr_lb_nChecked")}if(a>this.cap&&!this.type=="geoCheckratesLB"){a=this.cap}if(a>=(b+this.maxHoldingWin)){this.useHoldingWin=true}else{if(a==(b+this.maxHoldingWin-1)){this.useHoldingWin=true;if(!ta.has("checkrates.cr_provider_on_mousedown")&&this.type!="geoCheckratesLB"){this.skipHoldingWin=true}}}}}}}});ta.commerce.checkrates={getPropIdFromCRElement:function(b){if(b){var a=null;if(a=b.className.match(/id_(\d+)/)){return a[1]}}return null},updateMetaLightbox:function(j){var g=ta.id("PROVIDER_BLOCK");if(!g){return}var c=g.get("html");var f='<img class="provLoading" src="'+CDNHOST+'/img2/meta_sprites/loadingAnim.gif">';g.getElements(".rightBox").each(function(k){k.setContent(f)});ta.store("ta.commerce.MetaHacOverlay.crData."+j.vendorSetId,j);var h=j.getVendorSet().getAllVendorIds();var b=j.getVendorSet().getCheckedVendor();var a=1000;var d="metaHacRequest_"+a+"_cancel";ta.remove(d);new Request({url:ta.commerce.checkrates.buildMetaHacUrl(j,h,b,true),onSuccess:function(k){g.setContent(k);ta.commerce.checkrates.metaHacRequest(j,h,b,null)},onFailure:function(){g.setContent(c)}}).send()},checkRatesClicked:function(f,b,a,d){var h=new ta.commerce.CheckRatesData({type:d,evnt:f},ta.commerce.checkrates.getPropIdFromCRElement(b),a,false);var c=false;try{c=ta.id(b).getParent(".jp_tcl_col2_top2")}catch(g){}if(!c&&(ta.has("checkrates.meta_ui_sk_box")||ta.has("checkrates.meta_ui_sk_box_v3"))){ta.commerce.checkrates.updateMetaLightbox(h)}else{ta.commerce.checkrates.displayVendors(h,b);ta.widgets.calendar.removeMetaCalendarFromSync(a)}},checkRatesMiniMeta:function(f,c,b,d,a){var g=new ta.commerce.CheckRatesData({type:d,evnt:f},ta.commerce.checkrates.getPropIdFromCRElement(c),b,false);if((ta.retrieve("checkrates.meta_ui_post_click_prices")||a)&&g.validate()){ta.commerce.meta.miniMetaAjax(null,g,1000)}},checkRatesCheckMore:function(f,b,a,d){if("geocheckrates"==d&&!ta.widgets.calendar.hasPageDates()){var c=b.getParent("form"),j=c&&c.getElement(".date_picker_calendar_wrap");if(j){j.click();return}}ta.commerce.checkrates.initCheckMoreData();try{if(ta.retrieve("metaCheckRatesFeatureEnabled")){ta.commerce.checkrates.modifyElmtClassNameForTracking(b);ta.commerce.checkrates.logMetaUITestInfo()}}catch(h){ta.util.error.record(h,"checkRatesCheckMore - modifyElmtClassNameForTracking")}var g=new ta.commerce.CheckRatesData({type:d,evnt:f},ta.commerce.checkrates.getPropIdFromCRElement(b),a,true);if(f&&f.type=="click"&&ta.has("checkrates.use_chrome_provider_on_shift_click")&&ta.has("checkrates.cr_provider_on_mousedown")){ta.remove("checkrates.use_chrome_provider_on_shift_click");return}if(ta.retrieve("isMetaCheckboxCheckRates")){g.getVendorSet().setVendorSetDefaultChecked(false)}if(ta.retrieve("p13n_test44_GeoCRLeaveBehind")&&document.URL.indexOf("/Hotel_Review-")>0&&"geocheckrates"==d){this.launchLeaveBehind("avlb",g,"",b)}else{ta.commerce.checkrates.displayVendors(g,b)}},checkRatesCheckMoreForLBTest:function(d,b,a,c,f,h){if(ta.retrieve("specialMetaLeaveBehind")||ta.retrieve("specialMetaLeaveBehindV2")){try{if(typeof h=="undefined"||!h){h=""}ta.trackEventOnPage("meta_lightbox","open",c,"",false);ta.run("ta.overlays.Factory.loadSpecialMetaLeaveBehind",{},b,a,h)}catch(g){if(ta.retrieve("specialMetaLeaveBehindV2")){ta.util.error.record(g,"checkRatesCheckMoreForLBTestV2: meta leave-behind")}else{ta.util.error.record(g,"checkRatesCheckMoreForLBTest: meta leave-behind")}}}else{ta.store("skipLBGARecord",true);ta.store("metaUITestInfo",{test:"meta_lightbox",placement:"open",type:c,value:f});ta.commerce.checkrates.checkRatesCheckMore(d,b,a,"checkrates")}},checkRatesCreateGeoCrAutoBroadenLb:function(c,b,a){try{if(!ta.widgets.calendar.hasPageDates()){ta.commerce.meta.clickMetaShowPrices(c);return}ta.trackEventOnPage("GeoCheckRates","open","SeeHotels",0,false);ta.run("ta.overlays.Factory.loadGeoCrAutoBroadenOverlay",{},b,a)}catch(d){ta.util.error.record(d,"checkRatesCreateGeoCrAutoBroadenLb cannot track/create lightbox")}},checkRatesCheckMoreMetaCheckbox:function(d,b,a,c){ta.store("isMetaCheckboxCheckRates",true);this.checkRatesCheckMore(d,b,a,c);ta.remove("isMetaCheckboxCheckRates")},checkRatesCheckMoreFromPop:function(d,b,a,c){var f=ta.retrieve("checkrates.vendors."+a);window.opener.ta.commerce.checkrates.checkRatesCheckMoreToMain(d,b,a,c,f)},checkRatesCheckMoreToMain:function(d,b,a,c,f){ta.store("checkrates.vendors."+a,f);this.checkRatesCheckMore(d,b,a,c)},checkRatesGeoCRLB:function(a,c,f){try{var b=c.className.match(/locId_(\d+_\d)/)[1];var d=new ta.commerce.CheckRatesData({type:"geoCheckratesLB",evnt:a},ta.commerce.checkrates.getPropIdFromCRElement(c),b,true,false);if(!d.validate()){return false}d.hideInfo();var j=0;var h=document.getElements("#GEO_CR_LB .popup_hotel_checkbox input");for(var g=h.length;g--;){if(h[g].checked){j++}}ta.store("checkrates.geo_cr_lb_nChecked",j);d.setHWFlags();ta.run("ta.overlays.Factory.geoCheckratesLBAjax",{},d,f)}catch(k){ta.util.error.record(k,"checkRatesGeoCRLB")}},logMetaUITestInfo:function(){if(ta.has("metaUITestInfo")){try{var b=ta.retrieve("metaUITestInfo");if(b.test&&b.placement&&b.type&&b.value){ta.trackEventOnPage(b.test,b.placement,b.type,b.value,false)}}catch(a){ta.util.error.record(a,"error logging meta test info")}ta.remove("metaUITestInfo")}},logMapSponsoredProviderClick:function(c){var b=ta.find(".overlay .skv3");if(b&&b.hasAttribute("data-sponsor")&&c&&pageServlet){var a=b.get("data-sponsor");var d=b.get("data-sponsor-provider");if(c==d){var f=(pageServlet=="LocalMapsRedesign")?"LocalMap":(pageServlet=="HACSearch"||pageServlet=="Hotels")?"HACMap":"FloatingMap";ta.trackEventOnPage(f,"sponsor_cr_sent",a)}}},logLowestPriceTestInfo:function(b,c){var d=b.getParent("div#PROVIDER_BLOCK")||b.getParent("div#PROVIDER_BLOCK_INLINE");if(d){var m=(d.id=="PROVIDER_BLOCK_INLINE")?true:false;var h=(m)?"metaLowestPriceCTAInline":"metaLowestPriceCTA";var f=(m)?"Meta_LP_CTA_Click_Inline":"Meta_LP_CTA_Click";if(ta.has(h)){var k=ta.retrieve(h);if(k.hasOwnProperty("idx")&&k.hasOwnProperty("provider")){try{var j=ta.commerce.checkrates.scrapeMetaProviders(d);var a=null;for(var g=0;g<j.length;g++){if(c==j[g]){a=g}}if(a){ta.trackEventOnPage(f,k.idx,a,0,false)}}catch(l){ta.util.error.record(l,"error logging lowest price click info")}}}}},scrapeMetaProviders:function(h){var d=[];d[0]=-1;try{if(h){var b=h.getElements(".jsPrvdr");for(var a=0;a<b.length;a++){var c=b[a].onclick+"";var g=c.match(/openMetaProvider.*'(\d+)'\)/)[1];if(g){d.push(g)}}}}catch(f){ta.util.error.record(f,"error scraping meta providers")}return d},logBlueChevronLowestPriceTestInfo:function(c,d){var f=c.getParent("#HotelDateSearch");if(f){var b="bcMetaLowestPriceCTA";var g="BlueChevron_LP_CTA_Click";if(ta.has(b)){var l=ta.retrieve(b);if(l.hasOwnProperty("idx")&&l.hasOwnProperty("provider")){try{var j=ta.commerce.checkrates.scrapeBlueChevronProviders(f);var a=null;for(var h=0;h<j.length;h++){if(d==j[h]){a=h}}if(a){ta.trackEventOnPage(g,l.idx,a,0,false)}}catch(k){ta.util.error.record(k,"error logging blue chevron lowest price click info")}}}}},scrapeBlueChevronProviders:function(h){var f=[];f[0]=-1;try{if(h){var c=h.getElements(".offer");for(var b=0;b<c.length;b++){var d=c[b].onclick+"";var a=d.match(/openMetaProvider.*'(\d+)'\)/);if(a){provider=a[1];if(provider){f.push(provider)}}}}}catch(g){ta.util.error.record(g,"error scraping blue chevron providers")}return f},changePID:function(a){var b=ta.id("hacPid");if(b){b.value=a}},checkDealsClicked:function(c,b,a){ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:"checkdeals",evnt:c},ta.commerce.checkrates.getPropIdFromCRElement(b),a,false),b)},checkRatesPhotoOverlayClicked:function(d,b,a,c){if(ta.has("hotels.wipeDatesTwoEnabled")&&!ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.setTimeoutPageDates();ta.widgets.calendar.showAllPriceButtons(false);ta.remove("meta.isFromShowPriceButton")}ta.commerce.checkrates.initCheckMoreData();ta.store("photo.viewer.isPhotoLBClick",true);ta.store("crPageServlet_orig",crPageServlet);crPageServlet="LocationPhotosLightbox";var f=ta.commerce.checkrates.displayVendors(new ta.commerce.CheckRatesData({type:c,evnt:d},ta.commerce.checkrates.getPropIdFromCRElement(b),a,true),b);ta.remove("photo.viewer.isPhotoLBClick");if(ta.photos.viewer){ta.photos.viewer.afterCheckRates(f)}},trackMetaClick:function(d,a,c){var b="CheckRates";var f=1;ta.trackPhysicalCommerce(b,a,f,c);ta.trackAttemptedCommerce(b,a,d,f)},removeProviderCheckboxClick:function(){var b=document.getElements("#META_UI_AVAIL_SECTIONS #META_HAC_ROOM_LIST .chk");var a=document.getElements("#META_UI_AVAIL_SECTIONS #META_HAC_ROOM_LIST .checkbox_ui");b.each(function(c){ta.remove(c.id)});a.each(function(c){ta.remove(c.name)})},restoreCRPageServlet:function(){var a=ta.retrieve("crPageServlet_orig");if(a){crPageServlet=a}},initCheckMoreData:function(){this.checkMoreData={uncheckedProviders:null,alsoViewed:null,VR:null}},displayVendors:function(d,b){var a=document.getElement(".overlay");if(a&&a.overlay&&a.overlay.pin){a.overlay.pin()}if(!d.validate()){return false}d.hideInfo();try{if(ta.commerce.checkrates.showMetaCheckRates()&&d.type!="geocheckrates"){if(b&&b.className.contains("QC_Inline_Geo")){if(d.inDate&&d.outDate){var f="geo="+d.vendorSetId+"&inDay="+d.inDate.getDate()+"&inMonth="+(d.inDate.getMonth()+1)+"/"+d.inDate.getFullYear()+"&outDay="+d.outDate.getDate()+"&outMonth="+(d.outDate.getMonth()+1)+"/"+d.outDate.getFullYear();window.location="/HACSearch?"+f}}else{this.openMetaHacOverlay(d,b)}return}if(ta.commerce.checkrates.showMetaCheckRates()&&d.type=="geocheckrates"){ta.store("parentCheckRatesData",d)}ta.remove("metaCheckRatesBypass");this.popwindows(d,b);ta.commerce.checkrates.providerLoadTestReq(d.vendorSetId);ta.remove("metaCheckBoxCheckRates");if(!ta.has("checkrates.commerce_drop_to_bottom")&&!ta.has("checkrates.is_iPad_web_6")){this.addBoomerangTag(d)}}catch(c){}return true},showMetaCheckRates:function(){var b=ta.retrieve("metaCheckBoxCheckRates");var a=ta.retrieve("meta.isCheapVacationServlet");return ta.retrieve("metaCheckRatesFeatureEnabled")&&!a&&!b},popwindows:function(g,c){try{if(ta.commerce.checkrates.isAvailCheckTest()&&!window.chrome&&!ta.has("avail.check.query.complete")){if(!ta.has("availability_check")){if(!ta.has("commerce.ac.attempts")){ta.store("commerce.ac.attempts",0);ta.commerce.checkrates.triggerAvailCheck(false)}else{ta.store("commerce.ac.attempts",ta.retrieve("commerce.ac.attempts")+1)}if(ta.retrieve("commerce.ac.attempts")<30){ta.commerce.checkrates.popwindows.delay(100,this,[g,c]);return}}ta.remove("commerce.ac.attempts")}}catch(f){ta.util.error.record(f,"availability check - popwindows")}if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}g.resetVisitedFlags();ta.store("checkrates.flightData",g.getFlightData());var a=ta.id("msgbox");if(g.type=="providerWindow"){ta.commerce.commerceHelper.openProviderWindowTest(g,c);if(js_0014&&a){a.hide().empty()}return false}if(js_0005&&a){a.setContent(js_0005).show()}var b=g.getVendorSet().getVendors().length;if(ta.commerce.checkrates.isAvailCheckTest()){var d=g.getAvailVendorSet();if(d&&d.getVendors()){b=d.getCheckedCount();if(isNaN(b)||b>3){b=3}}}else{if(/win_test_(\d+)/.test(ta.id("CHECK_RATE").className)){b=parseInt(RegExp.$1)}else{if(g.type=="alsoViewed"){b=3}}}if(typeof(isIPad)!="undefined"&&isIPad){if(!(typeof(iPadOSVersion)!="undefined"&&iPadOSVersion>=5)){b=1}}if(b>1){g.fixPopOrder(b)}this.popAll(g,b,c);if(a){a.hide().empty()}return true},popAll:function(o,j,k){var a=false;if(/custom_area_(\S+)\s/.test(k.className)){a=RegExp.$1}else{a="QC_Inline"}var q=o.getVendorSet().getVendors();try{if(ta.commerce.checkrates.isAvailCheckTest()){q=o.getAvailVendorSet().getVendors()}}catch(u){}ta.store("checkrates.avUserData",o.getUserData());ta.store("checkrates.avId",o.propId);var g=true;if(ta.has("checkrates.cr_provider_on_mousedown")&&o.options.evnt.type=="click"){g=false}if(g){ta.trackPhysicalCommerce("CheckRates",a,1,o.propId)}o.setHWFlags();var b=0;var l=false;var r=0;var t=q.length;try{if(Browser.chrome&&!ta.has("checkrates.use_chrome_provider_on_shift_click")){var p=ta.popups.PopUtil.getHoldingWindowSet();j=Math.min((o.maxAllowedWin+p.length),j)}}catch(u){ta.util.error.record(u,"chrome - max allowed providers")}if(!ta.has("checkrates.use_chrome_provider_on_shift_click")){if(o.providerOnMouseDown){t=1;ta.store("checkrates.afterMouseDown",true);if(q.length>1){l=true}}else{if(ta.has("checkrates.afterMouseDown")){r=1;b=1;ta.remove("checkrates.afterMouseDown")}}}for(var s=r;s<t;s++){var m=q[s];var f=m.isChecked();if(f&&m.isAvailable()){if((j-1<b)){ta.remove("checkrates.use_chrome_provider_on_shift_click");this.popBlock(o,k);return false}if(ta.has("checkrates.cr_provider_on_mousedown")){if(b==(j-1)&&!ta.has("checkrates.use_chrome_provider_on_shift_click")){o.useHoldingWin=false}if(o.options.evnt.type=="mousedown"){ta.store("checkrates.cr_mousedown_provider",m.name)}}var h=this.popOne(m,o,k);if(!h){this.popBlock(o,k);return false}else{ta.trackAttemptedCommerce("CheckRates",a,m.name,s+1);b++;ta.commerce.checkrates.addClickOutPixels(o.propId,false)}}}ta.remove("checkrates.use_chrome_provider_on_shift_click");if(o.providerOnMouseDown&&l){return true}var c=false;try{c=(window.cookieDomain==".daodao.com"&&(k.hasClass("smartdeals_checkmore")||window.pageServlet!="SmartDeals"))&&serverPool!=null&&serverPool.toLowerCase()==="b"&&j<q.length}catch(d){}if(o.isCheckMore||c){this.popBlock(o,k)}else{if(o.type!="checkdeals"){if(!ta.has("checkrates.commerce_drop_to_bottom")&&!ta.has("checkrates.is_iPad_web_6")){this.launchAVLBTest(o)}else{this.launchLeaveBehind.delay(o.lbDelay,this,["avlb",o,"",k])}}}if(ta.has("pcr.overlay")){ta.retrieve("pcr.overlay").hide()}return true},hideLoading:function(c){var a=document.id(c);if(a){var b=a.getElement(".loading");b.set("styles",{display:"none"})}},showLoading:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"block"});b.set("styles",{display:"none"})}},showArrow:function(d){var a=document.id(d);if(a){var c=a.getElement(".loading");var b=a.getElement(".grn_chevronRgt");c.set("styles",{display:"none"});b.set("styles",{display:"block"})}},getDelaySecs:function(){var a=ta.id("CHECK_MORE_SITES_LB");if(a&&a.hasClass("dont_animate")){return 0}return 2000},showRemainingCheckMore:function(){var b=this.checkMoreData;var f=document.id("UNCHECKED_PROVIDERS");var a=document.id("ALSO_VIEWED_LB");var c=ta.id("VR_CROSS_SELL");var d=this.getDelaySecs();b.uncheckedProviders=f;b.alsoViewed=a;b.VR=c;if(f){this.showUncheckedProviders.delay(d,this)}else{if(a){this.showAlsoViewed.delay(d,this)}else{if(c){this.showVR.delay(d,this)}}}try{this.loadPackages(false)}catch(g){ta.util.error.record(g,"hotel packages - loadPackages")}},loadPackages:function(b){if(this.shouldSendPackagesRequest()){var g=$$(".packages");this.checkMoreData.packages=g;var j=ta.id("PACKAGES_HOTEL_ID");var m=ta.id("PACKAGES_HOTEL_NAME");var r=ta.id("PACKAGES_CHECK_IN_DATE");var d=ta.id("PACKAGES_CHECK_OUT_DATE");var k=ta.id("PACKAGES_ADULTS");var p=ta.id("PACKAGES_GEO");if(j&&m&&r&&d&&k&&p){var l=j.get("value");var q=m.get("value");var c=r.get("value");var o=d.get("value");var h=k.get("value");var f=p.get("value");var a=[];$$("#ALSO_VIEWED_LIST a").each(function(s){var t=/-d([0-9]+)-/.exec(s.href);if(t&&t[1]&&t[1]!=""){a.push(t[1])}});this.fireCallCountEvent(1);setTimeout(function(){new Request({url:"/ExpediaPackagesAjax",onSuccess:function(s){try{ta.commerce.checkrates.handlePackages(s,0)}catch(t){ta.util.error.record(t,"hotel packages - handlePackages")}},onFailure:function(s){ta.util.error.record(s.responseText,"hotel packages - call to /ExpediaPackagesAjax")},data:{hotelId:l,hotelName:q,checkInDate:c,checkOutDate:o,adults:h,geo:f,alsoViewedIds:a.join(","),isAlsoViewed:b},evalScripts:true,method:"get"}).send()},500)}}},shouldSendPackagesRequest:function(){var a=$$(".packages").length>0;return a},hasPackagesReturned:function(){return this.hasPackagesResults()||this.hasPackagesNoResults()},hasPackagesResults:function(){return $$("#QUICK_CHECK_LB_PACKAGES .checking_sites").length>0},hasPackagesNoResults:function(){return ta.id("PACKAGES_NO_RESULTS")!=null},isPackagesShowing:function(){var a=ta.id("QUICK_CHECK_LB_PACKAGES");return a&&a.hasClass("show_section")},hasVRCrossSell:function(){return ta.id("VR_CROSS_SELL")!=null},transitionToPackages:function(){this.showPackages.delay(this.getDelaySecs(),this,true)},fireCallCountEvent:function(a){ta.trackEventOnPage("checkRates","packages","callCount",a,true)},handlePackages:function(a,d){this.checkMoreData.packages.set("html",a);var b=ta.id("PACKAGES_REQUERY_KEY");if(b){var c=b.get("value");if(d<20){this.fireCallCountEvent(d+2);setTimeout(function(){new Request({url:c,onSuccess:function(f){try{ta.commerce.checkrates.handlePackages(f,d+1)}catch(g){ta.util.error.record(g,"hotel packages - handlePackages")}},onFailure:function(f){ta.util.error.record(f.responseText,"hotel packages - requery to /ExpediaPackagesAjax")},evalScripts:true,method:"get"}).send()},1000)}}else{if(!ta.id("CHECK_MORE_SITES_LB")){setTimeout(function(){if(!ta.id("AVLB_HERO_PHOTOS")&&$$("#ALSO_VIEWED_PACKAGES .checking_sites")&&$("ALSO_VIEWED_AD")&&$("ALSO_VIEWED_AD").getSize().x>0){$$("#ALSO_VIEWED_PACKAGES .checking_sites").addClass("withAd")}var g=ta.id("ALSO_VIEWED_PACKAGES");if(g&&!ta.commerce.checkrates.hasPackagesNoResults()){g.show()}else{var f=ta.id("VR_CONTAINER");if(f){f.show()}}},2000)}}},showPackagesLoop:function(a){try{if(this.hasPackagesNoResults()){if(this.hasVRCrossSell()){this.showVR()}return}var b=ta.id("QUICK_CHECK_LB_PACKAGES");if(b&&b.hasClass("show_section")){return}if(this.hasPackagesReturned()&&!this.hasPackagesNoResults()){this.showPackages(false)}else{if(a==0){return}else{this.showPackagesLoop.delay(1000,this,a--)}}}catch(c){ta.util.error.record(c,"hotel packages - showPackagesLoop")}},showPackages:function(b){try{var c=$$(".packages")[0];var a=$$(".packages .checking_sites")[0].getSize().y;c.addClass("show_section");c.removeClass("hide_section");var f=new Fx.Tween(c,{duration:"long",property:"height"});f.start(0,a);if(b){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}catch(d){ta.util.error.record(d,"hotel packages - showPackages");if(b){this.showAlsoViewed()}}},packagesClick:function(){try{var v="ExpediaPackageMeta2";var a=ta.id("hiddenReferrer");var h=ta.id("hiddenOrigin");var k=ta.id("hiddenDestination");var c=ta.id("hiddenPercentageSaved");var g=ta.id("hiddenGeo");var f=a.get("value");var w=h.get("value");var s=k.get("value");var y=g.get("value");var q=parseFloat(c.get("value"));var u=$$(".packages .savings");var l=u&&u.length>0?true:false;var r="Expedia";var j=ta.id("hiddenSource");if(j){r=j.get("value")}var m=ta.id("CHECK_MORE_SITES_LB")!=null;var b="";var o="";if(m&&l){b="QC_AlsoViewed_Packages1a";o="16221"}else{if(m){b="QC_AlsoViewed_Packages1b";o="16222"}else{if(l){b="QC_AlsoViewed_Packages2a";o="16269"}else{b="QC_AlsoViewed_Packages2b";o="16270"}}}if(r=="Orbitz"){b+="ORB"}var d="";if(q<7.5){d=1}else{if(q<10){d=2}else{if(q<12.5){d=3}else{if(q<15){d=4}else{d=5}}}}var p=window.open("about:blank","packages","width=800,height=600,scrollbars=1");ta.trackAttemptedCommerce("packages",b,v,d);new Request.JSONP({url:"/CheapFlightsCommerce",callbackKey:"jsonp",data:{AirProvider:v,from:f,area:b,slot:d,cnt:"1",Orig:w,Dest:s,geo:y,pid:o},onSuccess:function(z){try{var B=ta.id("hiddenDetailsUrl");if(B){var A=B.get("value");if(typeof(z)!="undefined"&&z!=null){if(typeof(z.icmcid)!="undefined"&&z.icmcid){A+="&icmcid="+z.icmcid}if(typeof(z.icmdtl)!="undefined"&&z.icmdtl){A+="&icmdtl="+z.icmdtl}}p.location=A}}catch(C){ta.util.error.record(C,"hotel packages - commerceClickCallback")}},method:"get"}).send()}catch(t){ta.util.error.record(t,"hotel packages - packagesClick")}return false},avafState:0,avafTimer:null,avafMoreExpandedSize:0,avafInit:function(){this.avafState=0;this.avafTimer=null;this.avafMoreExpandedSize=0},avafIn:function(c,a){try{if(ta.commerce.checkrates.avafState!=0){return}if(a==0){ta.commerce.checkrates.avafExpand()}else{ta.commerce.checkrates.avafWait((c)?(c.target||c.srcElement):null,a)}}catch(b){ta.util.error.record(b,"also viewed - avafIn")}},avafWait:function(b,a){try{ta.commerce.checkrates.avafState=1;ta.commerce.checkrates.avafTimer=setTimeout(function(){ta.commerce.checkrates.avafExpand(b)},a)}catch(c){ta.util.error.record(c,"also viewed - avafWait")}},avafOut:function(d){try{if(ta.commerce.checkrates.avafState!=1){return}if(ta.commerce.checkrates.avafTimer==null){return}if(!d){d=window.event}if(!d){return}var a=(d.relatedTarget)?d.relatedTarget:d.toElement;var c=ta.id("ALSO_VIEWED_LIST");while(a&&a!=c&&a.nodeName!="BODY"){a=a.parentNode}if(a==c){return}clearTimeout(ta.commerce.checkrates.avafTimer);ta.commerce.checkrates.avafTimer=null;ta.commerce.checkrates.avafState=0}catch(b){ta.util.error.record(b,"also viewed - avafOut")}},avafExpand:function(b){try{ta.trk("AVAF_HOVER_EXPAND",false,b);ta.commerce.checkrates.avafState=2;var a=ta.id("expand_av_on_hover");if(!a){return}a.removeClass("hidden");a.addClass("expanding");var f=a.getSize().y;a.removeClass("expanding");a.addClass("show");var d=new Fx.Tween(a,{duration:"long",property:"height"});d.start(0,f)}catch(c){ta.util.error.record(c,"also viewed - avafExpand")}},avafMore:function(a,c){try{ta.trk("AVAF_EXPAND_"+(c?"MORE":"LESS"),false,(a)?(a.target||a.srcElement):null);if(c){var b=ta.id("hideableMore");if(!b){return}b.addClass("hidden");b=ta.id("expand_av_on_more");if(!b){return}b.removeClass("hidden");if(ta.commerce.checkrates.avafMoreExpandedSize==0){b.addClass("expanding");ta.commerce.checkrates.avafMoreExpandedSize=b.getSize().y;b.removeClass("expanding")}b.addClass("show");new Fx.Tween(b,{duration:"long",property:"height"}).start(0,ta.commerce.checkrates.avafMoreExpandedSize)}else{var b=ta.id("expand_av_on_more");if(!b){return}new Fx.Tween(b,{duration:"long",property:"height"}).start(b.getSize().y,0).chain(function(){b.removeClass("show");b.addClass("hidden");var f=ta.id("hideableMore");if(!f){return}f.removeClass("hidden")})}}catch(d){ta.util.error.record(d,"also viewed - avafMore")}},animatedShowHide:function(c,h,b){try{var f=ta.id(h);if(!f||!c){return}else{if(b==1){c.addClass("hidden")}var g=0;var a=0;if(f.hasClass("hidden")){f.removeClass("hidden");f.addClass("expanding");a=f.getSize().y;f.removeClass("expanding");f.addClass("show")}else{if(f.hasClass("show")){g=f.getSize().y;a=0}}new Fx.Tween(f,{property:"height",duration:"500"}).start(g,a).chain(function(){if(f.getSize().y==0){f.removeClass("show");f.addClass("hidden");f.setStyle("height","auto")}})}}catch(d){ta.util.error.record(d,"animatedShowHide")}},metaLbProviderHover:function(c,d,b){var a=ta.id("metaFlyout_"+d);if(!a){return}if(b){a.removeClass("hidden")}else{a.addClass("hidden")}},metaLbShowChecker:function(b,c){var a=ta.id("checker_"+c);if(!a){return}a.removeClass("hidden")},metaLbAltDates:function(k,b,h,d,l,a,c){var f,p,g;try{f=ta.util.date.create(k,b-1,h);p=ta.util.date.create(d,l-1,a);ta.widgets.calendar.setPageInDate(f);ta.widgets.calendar.setPageOutDate(p);var o=["inMonth="+b+"%20"+k,"inDay="+h,"outMonth="+l+"%20"+d,"outDay="+a];var m="http://"+document.domain+"/UpdateSessionDatesAjax?"+o.join("&");new Request({url:m,evalScripts:true,onSuccess:function(s){try{ta.widgets.calendar.syncAllDatePickers();ta.widgets.calendar.launchInlineMeta();var q=ta.retrieve("metaLeaveBehindOverlay");if(q){q.fireEvent("onClose",q);q.hide()}if(c){window.setTimeout(function(){window.location=c},800)}}catch(r){ta.util.error.record(r,"MetaLbV2 updates failed.")}}}).send()}catch(j){ta.util.error.record(j,"error constructing meta request with alternate dates")}},removeScooter:function(a){var c=ta.retrieve("scooterObj");if(c){c.removeScooter(c)}var b=ta.id(a);if(!b){return}b.parentNode.removeChild(b)},removeScooterPersistent:function(){try{ta.commerce.checkrates.removeScooter();Cookie.writeSession("SCL",1)}catch(a){}},showUncheckedProviders:function(){var d=this.checkMoreData.uncheckedProviders;var b=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(d){var a=d.getSize().y;d.addClass("show_section");d.removeClass("hide_section");var f=new Fx.Tween(d,{duration:"long",property:"height"});f.start(0,a);if(this.hasPackagesResults()){f.addEvent("complete",this.transitionToPackages.bind(this))}else{if(b&&!c){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}else{f.addEvent("complete",this.transitionToVR.bind(this))}}}},actionRecord:function(a){new Request({url:"/ActionRecord?action="+a}).send()},transitionToAlsoViewed:function(){this.showAlsoViewed.delay(this.getDelaySecs(),this)},showAlsoViewed:function(){var a=this.checkMoreData.alsoViewed;var c=ta.retrieve("vrCrossSellNew");if(a){var b=a.getSize().y;a.addClass("show_section");a.removeClass("hide_section");var f=new Fx.Tween(a,{duration:"long",property:"height"});f.start(0,b);try{if(!this.isPackagesShowing()){if(this.shouldSendPackagesRequest()){f.addEvent("complete",this.showPackagesLoop.bind(this,10))}else{if(!c){f.addEvent("complete",this.transitionToVR.bind(this))}}}}catch(d){ta.util.error.record(d,"hotel packages - shouldSendPackagesRequest")}}},transitionToVR:function(){if(this.checkMoreData.VR){if(screen.height>=768){this.showVR.delay(2000,this)}else{this.actionRecord("VR_CROSS_SELL_SMALL_SCREEN")}}},showVR:function(){var b=this.checkMoreData.VR;var a=this.checkMoreData.alsoViewed;var d=ta.retrieve("vrCrossSellNew");if(b){var c=b.getSize().y;b.addClass("show_section");b.removeClass("hide_section");var f=new Fx.Tween(b,{duration:"long",property:"height"});f.start(0,c);ta.overlays.Factory.recordVRCrossSell();if(a&&d){f.addEvent("complete",this.transitionToAlsoViewed.bind(this))}}},recordClose:function(){if(ta.has("pav.overlay")){ta.retrieve("pav.overlay").hide()}this.actionRecord("CheckMore_Close")},buildURLForQuickCheckData:function(d,p,o,b){var k=d.getUserData();var g="";k=ta.retrieve("checkrates.avUserData");var q=o||d.getVendorSet().getCheckedInfo(p);if(q){g="&vendorsChecked="+q.vendorsChecked+"&vendorsOpened="+q.vendorsOpened+"&vendorsHidden="+q.vendorsHidden;if(ta.commerce.checkrates.isAvailCheckTest()){try{var a=d.getAvailVendorSet().getCheckedInfo("unavail_set");var c=d.getOriginalVendorSet().getCheckedInfo("unchecked");g="&vendorsChecked="+q.vendorsChecked+"&vendorsOpened="+a.vendorsOpened+"&vendorsHidden="+q.vendorsHidden+"&vendorsAvailable="+a.vendorsAvailable+"&vendorsUnchecked="+c.vendorsUnchecked}catch(j){}}}var f=pageServlet;if(crPageServlet){f=crPageServlet}if(!f){f="unknown"}var r="&avLocId=";var h=ta.retrieve("checkrates.avId");if(h){r+=h}else{r+=d.vendorSetId}var m="QC_Button";var l=false;if(l=b.className.match(/custom_area_(\w+)/)){m=l[1]}return"detail="+d.vendorSetId+"&storedUserData="+encodeURIComponent(k)+g+"&a="+m+"&s="+f+"&av=true"+r},removePCR:function(){var a=ta.retrieve("pcr.overlay");if(a){a.hide()}},popBlock:function(h,c){if(ta.has("metaCheckBoxCheckRates")){return}try{if(c.className.match(/custom_area_QC_Inline_Geo/)&&!(crPageServlet=="Hotel_Review"||crPageServlet=="ShowUserReviewsHotels")||c.className.match(/custom_area_QC_AlsoViewed_Popup/)){return}}catch(g){ta.util.error.record(g,"popBlock - could not check criteria")}h.getVendorSet().storeCheckBoxValues();var a=h.getVendorSet().getCheckedInfo("check_more");var b="/CheckMore?"+this.buildURLForQuickCheckData(h,"check_more",a,c);var f=h.getOriginalVendorSet().getVendorsUnchecked();var d=h.getOriginalVendorSet().getVendorsDefaultUnchecked();if(ta.has("checkrates.cr_provider_on_mousedown")){ta.remove("checkrates.cr_mousedown_provider")}if(!ta.has("force_popup_to_check_more")){if(c.hasClass("cmAVTest")&&a&&a.vendorsChecked&&a.vendorsOpened&&a.vendorsChecked==a.vendorsOpened){if(!ta.has("checkrates.commerce_drop_to_bottom")&&!ta.has("checkrates.is_iPad_web_6")){this.launchAVLBTest(h)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["avlb",h,"",c])}return}if(c&&/avLightboxSwap/.test(c.className)){if(!ta.has("checkrates.commerce_drop_to_bottom")&&!ta.has("checkrates.is_iPad_web_6")){this.launchAVLBTest(h)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["avlb",h,"",c])}return}}if(h.type=="checkdeals"){b="ABS:vpages/quickcheckdeals_ie.html"}if(h.type!="geocheckrates"&&pageServlet!="Cheap_Vacations"){if(!ta.has("checkrates.commerce_drop_to_bottom")&&!ta.has("checkrates.is_iPad_web_6")){ta.run("ta.overlays.Factory.loadCheckMoreOverlay",{},h,b,c)}else{this.launchLeaveBehind.delay(h.lbDelay,this,["checkmore",h,b,c])}}},launchLeaveBehind:function(c,d,a,b){if(d.type=="geocheckrates"||pageServlet=="Cheap_Vacations"){return}if(c=="avlb"){this.launchAVLBTest(d)}else{if(c=="checkmore"){ta.run("ta.overlays.Factory.loadCheckMoreOverlay",{},d,a,b)}}this.addBoomerangTag(d)},daodaoPopTPW:function(o,g,u,s){var l=new ta.commerce.CheckRatesData({type:s,evnt:o},ta.commerce.checkrates.getPropIdFromCRElement(g),u,true);if(!l.validate()){return false}var m=l.getVendorSet().getVendors();var c=0;for(var p=0;p<m.length;p++){var j=m[p];if(j.isChecked()&&j.isAvailable()){c=p;j.opened=true;break}}var t=m[c];var q="daodaoTPW";var d=ta.retrieve("daodaoTPW");var k="/DaoDaoTabbedProviderWindow?first="+t.name+"&locId="+u+"&"+l.getUserData();try{if(d!=null){try{d.windowObject=window.open(k,q,"left=0,top=0,width="+screen.width+",height="+screen.height);d.windowObject.focus()}catch(r){ta.util.error.record(r,"daodao pop tpw one - reuse popup");return false}}else{var h=ta.popups.PopUtil.getHoldingWindowSet();var a=screen.width;if(h.length>0){d=h[h.length-1].repurpose(k,a)}else{var f=1;try{if(window.chrome){f=0}}catch(r){}var b={customWidth:a,customHeight:screen.height,name:q,url:k,scrollbars:f,left:0,top:0};d=ta.popups.PopUtil.createCheckRatesWindow(b)}}}catch(r){ta.util.error.record(r,"pop tpw - general");return false}if(d&&d.windowObject){ta.store("daodaoTPW",d);return d}return false},updateInlineFormElementRadio:function(d){var a=d.getElement("input[type=radio]");if(a){var f=a.id.substring(a.id.length-4);if(this.crSyncExtensions.contains(f)){var b=a.id.substring(0,a.id.length-4);var c=ta.id(b);if(c){c.checked=a.checked;var g=$$("#CHECK_RATES_CONT_SYNC form")[0];if(g){var h=g.getElement("#"+b+"_icr");h.checked=c.checked}}}else{var b=a.id;var c=ta.id(b);this.crSyncExtensions.each(function(k){var j=b+k;j=ta.id(j);if(j){j.checked=c.checked}})}}},popOne:function(a,d,c){try{ta.commerce.checkrates._addTagManToDOM(a);if(a.hasWindow()){try{var g=a.window;g.windowObject=window.open(a.getUrl(d,c),g.name,g.winArgs);g.windowObject.focus()}catch(j){ta.util.error.record(j,"pop one - reuse popup");return false}}else{var k=a.name;var l=ta.popups.PopUtil.getProviderWindowDims(k,true);var h=ta.popups.PopUtil.getHoldingWindowSet();if(h.length>0&&d.useHoldingWin){a.window=h[h.length-1].repurpose(a.getUrl(d,c),l.customWidth,l.customHeight);if(d.skipHoldingWin){d.useHoldingWin=false}if(ta.has("checkrates.add_holding_windows")){if(a.window.type==ta.popups.PopUtil.windowType.CHECK_RATE){var f=ta.popups.PopUtil.getHoldingWindowSet().length;var b=window.cookieDomain;if(b){if(f>0){Cookie.write("CommercePopunder","HW"+f,{domain:b,duration:0})}else{Cookie.dispose("CommercePopunder",{domain:b})}}}}}else{var o=1;try{if(window.chrome){o=0}}catch(j){}var l=ta.popups.PopUtil.getProviderWindowDims(k,false);var m={customWidth:l.customWidth,customHeight:l.customHeight,widthOffset:l.widthOffset,heightOffset:l.heightOffset,name:k,url:a.getUrl(d,c),scrollbars:o};a.window=ta.popups.PopUtil.createCheckRatesWindow(m)}}}catch(j){ta.util.error.record(j,"pop one - general");return false}if(a.window&&a.window.windowObject){a.opened=true;return a.window}return false},addBoomerangTag:function(g){var a={};var b=ta.id("checkIn_"+g.vendorSetId);var f=ta.id("checkOut_"+g.vendorSetId);var d=ta.id("qcAdults_"+g.vendorSetId);if(!(b&&f&&d)){b=ta.id("checkIn_"+g.vendorSetId+"_pop");f=ta.id("checkOut_"+g.vendorSetId+"_pop");d=ta.id("qcAdults_"+g.vendorSetId+"_pop")}if(b&&f&&d){a.checkIn=b.value;a.checkOut=f.value;a.adults=d.value}else{return}var c={url:"/HotelCheckRates?Action=AddBoomerangTag",data:a};c.onSuccess=function(k,h){var j=ta.id("BOOMERANGTAG");if(!j){j=new Element("div",{id:"BOOMERANGTAG"});j.inject(document.body)}if(!j){return}j.innerHTML=k};new Request(c).send()},launchAVLBTest:function(c){if(c.type=="geocheckrates"||pageServlet=="Cheap_Vacations"){return}var b=c.propId;if(pageServlet&&b&&window.cookieDomain!=".daodao.com"){var a="http://"+document.domain+"/AlsoViewedLB?d="+b+"&s="+pageServlet+"&"+c.getUserData()+"&checkRatesType=checkRates";if(ta.has("page.geo")){a+="&geo="+ta.retrieve("page.geo")}ta.run("ta.overlays.Factory.launchAVLBCompleteFn",{},a)}},openProviderWindowUrl:function(k,f,b,h){var j=ta.asInt("commerce.provWinNum");j++;ta.store("commerce.provWinNum",j);var a=ta.retrieve("commerce.previousTpwNumbers");var d=a+"_"+j;if(!a){d=j}var g="TAProviderWindow_"+d;k=k+"&otpwn="+d;var l=window.open(k,g,this.getProviderWinArgs(d));l.focus();ta.store("commerce.TPWindow",l);var c=(function(){try{if(l.closed){clearTimeout(c)}else{var o=l.location.href;window.status=o}}catch(m){clearTimeout(c);new Request({url:"/ActionRecord?action=fbProvWin|id_"+f+"|ctrId_"+b+"|cv_"+h}).send()}}).periodical(1500);return l},addCustomUrlParams:function(c,b){var f=new RegExp("(&|\\?)area=[^&]*");c=c.replace(f,"$1area="+b);if(crPageServlet){var a=new RegExp("(&|\\?)from=[^&]*");c=c.replace(a,"$1from=HotelDateSearch_"+crPageServlet)}var d=c;try{c=ta.commerce.meta.tracking.updateUrlWithTiming(c,b)}catch(g){ta.util.error.record(g,"problem updating winUrl with timing in CheckRates.addCustomParams");c=d}return c},checkMoreClickRe:function(f,a,g,s){new Event(f).preventDefault();if(a){var j="QC_Button";var h=false;if(h=a.className.match(/custom_area_(\w+)/)){j=h[1]}var k="";var o=false;if(o=a.className.match(/custom_refer_(\w+)/)){k=o[1]}var m="UNKNOWN";var c=false;if(c=a.search.match(/\?p=(\w+)\W/)){m=c[1]}var b=ta.id(a).hasClass("flightOffer");var l;if(b){l=a.href+"&"+ta.retrieve("checkrates.flightData")}else{var d=ta.retrieve("checkrates.avUserData");l=this.addCustomUrlParams(a.href,j)+"&"+d}var r=1;try{if(window.chrome){r=0}}catch(f){}var p=ta.popups.PopUtil.getProviderWindowDims(g,false);var q={customWidth:p.customWidth,customHeight:p.customHeight,widthOffset:p.widthOffset,heightOffset:p.heightOffset,name:g,url:l,scrollbars:r};ta.trackPhysicalCommerce("CheckMore",j,1,modelLocId);var t=ta.popups.PopUtil.createCheckRatesWindow(q);if(t){ta.trackAttemptedCommerce("CheckMore",j,m,1)}}},checkMoreClick:function(D,s,B,E,g,a){new Event(D).preventDefault();if(s){if(a){ta.commerce.checkrates.showLoading(s.id)}var A="QC_Button";var F=false;if(F=s.className.match(/custom_area_(\w+)/)){A=F[1]}var k=false;if(k=s.className.match(/custom_refer_(\w+)/)){crPageServlet=k[1]}var f=ta.id(s).hasClass("flightOffer");var m;if(f){m=s.href+"&"+ta.retrieve("checkrates.flightData")}else{var q=ta.retrieve("checkrates.avUserData");m=this.addCustomUrlParams(s.href,A)+"&"+q}var p=1;try{if(window.chrome){p=0}}catch(D){}var z=ta.popups.PopUtil.getProviderWindowDims(B,false);var h={customWidth:z.customWidth,customHeight:z.customHeight,widthOffset:z.widthOffset,heightOffset:z.heightOffset,name:B,url:m,scrollbars:p};var l=ta.popups.PopUtil.createCheckRatesWindow(h);if(l&&a){ta.commerce.checkrates.showArrow(s.id)}if(f){ta.id(s).removeClass("sprite-findflights_ylwCnr").addClass("sprite-findflights_ylwCnrChk")}else{ta.id(s).removeClass(E).addClass(g)}if(ta.id(s).getParent("#QUICK_CHECK_LB_PARTNERS")){var G=0;var b=0;var u=document.id("QUICK_CHECK_LB_PARTNERS");var C=u.getElements(".unClickedCount");C.each(function(H){if(ta.id(H).hasClass(E)){G++}if(ta.id(H).hasClass(g)){b++}},this);if(a){if(b>1){var o=document.getElement(".chkOpenedSitesDesc");var y=document.getElement(".oneMoreOpened");ta.id(o).removeClass("hideOne");ta.id(y).addClass("hideOne")}var w=document.getElement(".cs_ps .openedSites");w.innerHTML=b}if(G<1){var v=ta.id("emptyAlsoViewed");if(v){var c=ta.retrieve("overlays.current");if(c){c.hide();ta.remove("overlays.current")}}else{var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.addClass("hideOne")}}return}else{if(G<2){var r=document.getElement(".chkSitesDesc");if(r){r.addClass("hideOne")}var d=document.getElement(".oneMore");if(d){d.removeClass("hideOne")}}else{var j=document.getElement(".cs_ps .opnSites");j.innerHTML=G}}}if(window.cookieDomain==".daodao.com"){if(ta.id(s).getElements("span")[0].hasClass("show-price-org")){ta.id(s).getElements("span")[0].removeClass("show-price-org").addClass("show-price-black")}var t=ta.id(s).getParent("li").getParent("ul").getElements(".show-price-org").length;ta.id("remainingCount").set("html",t)}}},showProviders:function(){if(this.validateDates()){var a=$$("div.geoProviderHidden");if(a){a.removeClass("geoProviderHidden");a.addClass("geoProvider")}var c=ta.id("HotelDateSearch")||ta.id("HotelDateSearch_icr");if(c){var b=c.getElement("span.error_msg_geo");if(b){b.hide()}}}},validateDates:function(){var b=ta.id("checkIn_"+this.geoId)||ta.id("checkIn_"+this.geoId+"_icr");var f=ta.id("checkOut_"+this.geoId)||ta.id("checkOut_"+this.geoId+"_icr");if(!b||!f||!b.value||!f.value){return false}var d=this.parseDate(b.value);var c=this.parseDate(f.value);var a=this.dateErrorCheck(d);var g=this.dateErrorCheck(c);if(a&&g){return true}else{return false}},parseDate:function(b){var d=false;if(DATE_FORMAT&&b){var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(g<100){g+=2000}d=ta.util.date.create(g,a-1,f)}}}return d},dateErrorCheck:function(c){if(!c||isNaN(c)){return false}var b=new Date();ta.util.date.normalize(b);var a=ta.util.date.create(b.getFullYear(),b.getMonth(),b.getDate()+330);if(c.getTime()<b.getTime()){return false}if(a.getTime()<c.getTime()){return false}return true},updateHiddenDateFields:function(g,b){var f=this.parseDate(b.value);var a=this.dateErrorCheck(f);if(a&&typeof(a)=="string"){if(a.replace(/^\s+|\s+$/g,"").length>0){alert(a)}return}if(window.cookieDomain==".daodao.com"){var c=ta.id("HotelDateSearch");if(c&&c.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var d=ta.id(b).overlay;if(d&&d.calendar){d.calendar.select(null,f)}},crSyncExtensions:new Array("_pop","_icr","_pto","_per","_amo","_cro","_met","_imt"),_showSuppressedProviders:function(a){if(ta.retrieve("checkrates.datesChanged")){return}try{var b=ta.id(a);b.getElements(".unavailable").each(function(d){d.removeClass("unavailable");if(d.hasClass("js_ua_checked")){d.getElements("input").set("checked",true)}ta.commerce.checkrates.updateCRFormElement(d)});ta.store("checkrates.datesChanged",true)}catch(c){ta.util.error.record(c,"_showSuppressedProviders")}},findInlineCRLocationId:function(){var f=null;var g=ta.id("HotelDateSearch");if(g){var a=g.getElements("input[type=text]");for(var d=a.length;d--;){var b=a[d];var c=b.id.match(/_(\d+)/);if(c.length){f=c[1];break}}}return f},updateCRCalendar:function(c){if(c.form){ta.commerce.checkrates._showSuppressedProviders(c.form)}try{var b=c.before;var a=b.dayField;if(a&&/qcInDay_(\d+)/.test(a.id)){ta.commerce.checkrates.checkCRLimits(RegExp.$1)}}catch(d){ta.util.error.record(d,"update cal crLimits check")}ta.commerce.checkrates.updateCRFormElement(this);if(ta.id("META_UI_INLINE")){ta.commerce.checkrates.updateCRForm("_imt")}},checkCRLimits:function(g){try{if(!g){return}var d=new Date();var p=document.getElement('input[id*="qcInDay_'+g+'"]').value;var q=document.getElement('input[id*="qcInMonth_'+g+'"]').value;q=q.split("/");d.setDate(p);d.setMonth(q[0]-1);d.setFullYear(q[1]);var o=ta.retrieve("checkrates.vendors."+g);for(var h=0;h<o.length;h++){var m=o[h];if(m.hasDateLimits()){var c='input[id*="'+m.options.checkboxID+'"]';var f=document.getElement(c);if(f){var l=true;var b;var a=m.options.minDaysOut;if(a>0){b=new Date();b.setDate(b.getDate()+a);l=(d>=b)}var k=m.options.maxDaysOut;if(k>0&&l){b=new Date();b.setDate(b.getDate()+k);l=(d<=b)}if(f.getParent("li")){f.getParent("li").style.display=(l?"block":"none")}}}}}catch(j){ta.util.error.record(j,"check crLimits")}},updateCRFormElement:function(f){try{f=ta.id(f);var o=f.get("tag").toLowerCase();if(o=="li"){f=f.getElement("input[type=checkbox]")}var g=f.id.split("_")[0];var j=this.findInlineCRLocationId();var m=g+"_"+j;var d=f.id;var b=d.substring(d.length-4);var r=[m,m+"_icr",m+"_per",m+"_imt"];if(this.crSyncExtensions.contains(b)){for(var h=r.length;h--;){var m=r[h];if(m!=d){var q=ta.id(m);if(q){if(o=="li"&&b!="_pop"){q.checked=f.checked;var p=f.getParent("li");if(p&&!p.hasClass("unavailable")){var c=q.getParent("li");if(c){c.removeClass("unavailable")}}}else{if(o=="select"){q.selectedIndex=f.selectedIndex}else{if(o=="input"){var a=f.form;if(window.cookieDomain==".daodao.com"){if(a.hasClass("show-meta-prices")){ta.run("dd.hotels.halfmeta.showDaoDaoMetaPrices")}}var l=m.substring(m.length-4);if(!this.crSyncExtensions.contains(l)){l=""}this.updateCRFormElement_In(j,f,b,l)}}}}}}}}catch(k){ta.util.error.record(k,"updateCRFormElement")}},updateCRForm:function(a){try{if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers();return}var r=ta.id("HotelDateSearch"+a);var q=ta.id("HotelDateSearch");var f=["select","input[type=checkbox]","input[type=hidden]","input[type=text]"];if(r&&q){for(var l=f.length;l--;){var c=f[l];var t=q.getElements(c);var d=r.getElements(c);for(var h=d.length;h--;){var s=d[h];var p=s.id.split("_")[0];for(var g=t.length;g--;){var o=t[g];if(o.id.contains(p)){if(c=="input[type=checkbox]"){var u=o.getParent("li");if(u&&!u.hasClass("unavailable")){var b=s.getParent("li");if(b){b.removeClass("unavailable")}}}if(c=="select"){s.selectedIndex=o.selectedIndex}else{if(c=="input[type=checkbox]"&&a!="_pop"){s.checked=o.checked}else{if(!s.id.contains("hacPid")){s.value=o.value}}}}}}}}}catch(m){ta.util.error.record(m,"updateCRForm")}},updateCRFormElement_In:function(l,t,o,q){try{var m=t.id.match(/_(\d+)/)[1];var c=ta.id("checkIn_"+l+q);var b=ta.id("checkOut_"+l+q);var p=ta.id("checkIn_"+m+o);var j=ta.id("checkOut_"+m+o);var f=ta.id("qcInDay_"+l+q);var r=ta.id("qcOutDay_"+l+q);var g=ta.id("qcInDay_"+m+o);var d=ta.id("qcOutDay_"+m+o);var h=ta.id("qcInMonth_"+l+q);var u=ta.id("qcOutMonth_"+l+q);var k=ta.id("qcInMonth_"+m+o);var a=ta.id("qcOutMonth_"+m+o);if(c&&p&&b&&j&&f&&g&&r&&d&&h&&k&&u&&a){c.value=p.value;b.value=j.value;f.value=g.value;r.value=d.value;h.value=k.value;u.value=a.value}}catch(s){ta.util.error.record(s,"updateCRFormElement_In")}},availCheck:function(b){var a=ta.id("availability")&&ta.id("availability").value=="1";var d=ta.id(b).getElement(".overlaySrc");if(a&&d){var c=d.innerHTML;d.innerHTML=c.replace(/cid=(\w+_)?&amp;/,"")}},positionCheckRates:function(){try{var o=window.getScroll();var t=false;try{t=window.location.href}catch(m){}if(t){var k=ta.retrieve("pcr.initialUrl");if(!k){k=t;ta.store("pcr.initialUrl",k)}if(k!=t){ta.store("pcr.initialYPos",o.y);ta.store("pcr.initialUrl",t)}}var j=true;var a=ta.retrieve("pcr.initialYPos");if(a&&a>0){j=(Math.abs(a-o.y)>=100)}if(ta.retrieve("pcr.scrollPoint")<=0){var b=ta.id("CHECK_RATE");var q=document.getElement(".postShowMetaCR");var s=ta.id("BIG_ORANGE_CTA");var h=0;if(b){h=b.getPosition().y}if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&q){h=Math.max(h,q.getPosition().y)}if(s){h=Math.max(h,s.getPosition().y)}ta.store("pcr.scrollPoint",h)}var d=o.y>=ta.retrieve("pcr.scrollPoint")&&j;var f=$$(".overlayBG");if(d&&!ta.retrieve("pcr.overlay").visible&&!ta.has("pcr.keepHidden")&&!f.length&&!ta.has("pcr.disabled")){ta.store("pcr.initialYPos",-1);if(typeof(persistentCRCss)!="undefined"&&!ta.retrieve("ta.persCrCssAsset")){ta.store("ta.persCrCssAsset",Asset.css(persistentCRCss))}ta.retrieve("pcr.overlay").show();if(ta.id("PERSISTENT_HAC")){ta.servlet.HACSearch.updateHACFormCal(0,"_per");ta.servlet.HACSearch.updateHACFormAdults(0,"_per")}else{ta.commerce.checkrates.updateCRForm("_per")}if(!ta.id("PERSISTENT_CHECK_RATES_WRAP").hasClass("pcrStatic")){var g=ta.retrieve("pcr.overlay").container;g.setStyle("margin-top",-125);var c=new Fx.Tween(g,{duration:"300",transition:"bounce:out"});if(ta.has("checkrates.urgency_msg_placement_pcr")&&!ta.has("checkrates.urgencyMsgPCRShowing")){c.start("margin-top",-125,0).chain(function(){ta.commerce.checkrates.toggleUrgencyMessage.delay(1000,this,"_pcr")})}else{c.start("margin-top",-125,0)}}var p=ta.id("PERSISTENT_CHECK_RATES_WRAP").getElement(".miniMeta");if(p&&ta.widgets.calendar.datesExist()&&(ta.retrieve("pcr_redesign_v1")||ta.retrieve("pcr_redesign_v2"))){p.addClass("miniMetaHide")}var l=ta.id("PERSISTENT_CHECK_RATES_WRAP").getParent();if(!l.getElement(".drop_gradient")){var r=new Element("div.drop_gradient");r.inject(l,"bottom")}if(!ta.retrieve("pcr.firstShow")){ta.trackEventOnPage("PersistentCheckRates","shown","",1,true);ta.store("pcr.firstShow",true);ta.commerce.meta.updateProvAreaFromLightBox(ta.retrieve("page.location"))}}else{if(!d&&ta.retrieve("pcr.overlay").visible){ta.retrieve("pcr.overlay").hide();ta.widgets.calendar.closeCalendarWidgets()}}}catch(m){window.removeEvent("scroll",ta.commerce.checkrates.positionCheckRates);ta.util.error.record(m,"pcr - positionCheckRates");return false}},_updateSecondaryFormElement_CB:function(){var a=ta.id("CHECK_RATES_CONT");if(a){var b=a.getElements("input.chk");b.each(function(g,d){var f=ta.id(g.id+"_pop");var c=ta.id(g.id+"_per");if(f){f.checked=g.checked}if(c){c.checked=g.checked}})}},availCheckQuery:function(d,b,a,c,g,f){new Request.JSON({url:"/AvailabilityCheckJson",method:"get",data:{checkin:d,checkout:b,adults:a,country:g,geo:f,action:c},onSuccess:function(j,h){if(c&&c=="peek"){ta.store("availability_check",j)}}}).send()},isAvailCheckTest:function(){if(!ta.has("avail.check.test")){var a=ta.id("CHECK_RATES_CONT");if(a&&a.hasClass("avail_check")){ta.store("avail.check.test",true)}else{ta.store("avail.check.test",false)}}return ta.retrieve("avail.check.test")},triggerAvailCheck:function(g){try{if(ta.commerce.checkrates.isAvailCheckTest()){var d=ta.id("CHECK_RATES_CONT");var k=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkIn").value);if(!k){return false}var a=new Date(k.getTime());a.setDate(k.getDate()+2);if(d.getElement("input.checkOut").value.match(/\d+/)){a=ta.commerce.checkrates.normalizeDate(d.getElement("input.checkOut").value);if(!a){return false}}var j="2";var h=d.getElement("select");if(h&&!isNaN(h.value)){j=h.value}var c="0";if(accomIdMatch=d.className.match(/did_(\d+)/)){c=accomIdMatch[1]}var l="191";if(countryIdMatch=d.className.match(/cid_(\d+)/)){l=countryIdMatch[1]}var b="peek";if(g){b="query";if(g=="before"){a.setDate(k.getDate()+2)}}ta.commerce.checkrates.availCheckQuery(ta.commerce.checkrates.tacDateFormat(k),ta.commerce.checkrates.tacDateFormat(a),j,b,l,c)}}catch(f){ta.util.error.record(f,"availability select date click")}},tacDateFormat:function(a){var c=a.getDate();var d=a.getMonth();d=d+"";if(d.length<2){d="0"+d}var b=a.getFullYear();return b+"-"+d+"-"+c},normalizeDate:function(b){if(!b||typeof b!="string"){return false}try{var c=b.match(DATE_FORMAT.pattern);if(c){var f=parseInt(c[DATE_FORMAT.date].replace(/^0/,""));var a=parseInt(c[DATE_FORMAT.month].replace(/^0/,""));var g=parseInt(c[DATE_FORMAT.year].replace(/^0/,""));if(f>0&&f<32&&a>0&&a<13){if(g<100){g+=2000}return ta.util.date.create(g,a-1,f)}else{return false}}else{return false}}catch(d){}return false},availCheckChangeDates:function(){try{document.getElement(".overlay").overlay.hide()}catch(a){ta.util.error.record(a,"availCheckChangeDates")}},openMetaProvider:function(t,h,p,r,l){h=ta.id(h);if(!h||!t){return}if(t.target.src){var a=t.target.src;if(a.contains("expandActive")){var c="ta.commerce.checkrates.isExpanded."+p+"."+r;ta.store(c,true);h.addClass("partnerExpanded").removeClass("partnerCollapsed");return}else{if(a.contains("contract")){var c="ta.commerce.checkrates.isExpanded."+p+"."+r;ta.store(c,false);h.addClass("partnerCollapsed").removeClass("partnerExpanded");return}}}if(r){var o=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+p);var w=false;if(o){w=o.getVendorSet()}else{o=new ta.commerce.CheckRatesData({type:"checkRates",evnt:t},ta.commerce.checkrates.getPropIdFromCRElement(h),p,true);w=o.getVendorSet()}if(o){o.actualTrigger=h}if(w){var s=w.getVendors();for(var u=0;u<s.length;u++){var A=s[u];if(r==A.getContentID()){ta.commerce.checkrates._addTagManToDOM(A);var d=A.getUrl(o,h);var q;if(ta.browser.isIE10Metro()){var z=ta.remove("ta.meta.navArea");if(z=="QC_Meta_Book_Inline"){q="QC_Meta_Metro_Inline"}else{q="QC_Meta_Metro_Lightbox"}}else{q=ta.remove("ta.meta.navArea")||"QC_Meta_Lightbox"}d=ta.commerce.checkrates.addCustomUrlParams(d,q);if(l){d=d+"&m="+l}try{var v=A.name;var m=ta.popups.PopUtil.getProviderWindowDims(v,true);var j=ta.popups.PopUtil.getHoldingWindowSet();if(j.length>0&&o.useHoldingWin){j[j.length-1].repurpose(A.getUrl(o,h),m.customWidth,m.customHeight);if(o.skipHoldingWin){o.useHoldingWin=false}if(ta.has("checkrates.add_holding_windows")){if(A.window.type==ta.popups.PopUtil.windowType.CHECK_RATE){var f=ta.popups.PopUtil.getHoldingWindowSet().length;var k=window.cookieDomain;if(k){if(f>0){Cookie.write("CommercePopunder","HW"+f,{domain:k,duration:0})}else{Cookie.dispose("CommercePopunder",{domain:k})}}}}}else{var g=1;try{if(window.chrome){g=0}}catch(y){}var b={customWidth:m.customWidth,customHeight:m.customHeight,widthOffset:m.widthOffset,heightOffset:m.heightOffset,name:v,url:d,scrollbars:g};ta.popups.PopUtil.createCheckRatesWindow(b)}}catch(y){}ta.commerce.checkrates.trackMetaClick(s[u].name,q,p);ta.commerce.checkrates.logMetaUITestInfo();ta.commerce.checkrates.logLowestPriceTestInfo(h,r);if(q=="QC_Meta_Lightbox"){ta.commerce.checkrates.logMapSponsoredProviderClick(r)}ta.commerce.checkrates.logBlueChevronLowestPriceTestInfo(h,r);ta.commerce.checkrates.addClickOutPixels(p,true);return}}}}},openMetaHacOverlay:function(d,a){if(ta.has("metaDatePickerEnabled")&&!ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.setErrorStyling(a);return}var c=d.getVendorSet().getCheckedContentID();var b=d.getVendorSet().getCheckedVendor();ta.store("ta.commerce.MetaHacOverlay.crData."+d.vendorSetId,d);ta.run("ta.overlays.Factory.metaCheckRatesOverlay",{},d,c,b,a)},multiDatePickerUserData:function(){var d=ta.widgets.calendar.getPageInDate();var b=ta.widgets.calendar.getPageOutDate();var c=ta.widgets.calendar.getPageAdultsCount();if(!d||!(d instanceof Date)||!b||!(b instanceof Date)){return}var a=[];a.push("inMonth=");a.push(d.getMonth()+1);a.push("%20");a.push(d.getFullYear());a.push("&inDay=");a.push(d.getDate());a.push("&outMonth=");a.push(b.getMonth()+1);a.push("%20");a.push(b.getFullYear());a.push("&outDay=");a.push(b.getDate());a.push("&adults=");a.push(c);return a.join("")},_parseDatePickerDate:function(c){if(c&&c.split&&c.split(" ").length>1){var a=c.split(" ");var b=new Date();b.setFullYear(a[0]);b.setMonth(a[1]);b.setDate(a[2]);return b}},buildMiniMetaHacUrl:function(b,a,m,f,h,j,l,k,c,g,d){return ta.commerce.checkrates.buildVarMetaHacUrl("MiniMetaCRAjax",b,a,m,f,h,j,l,k,c,g,d)},buildMetaHacUrl:function(c,b,l,f,g,h,k,j,d){var a=ta.commerce.checkrates.buildVarMetaHacUrl("MetaCheckRatesAjax",c,b,l,f,g,h,k,j,d);if(c&&ta.maps&&ta.maps.mapsponsor){if(typeof c.mapsponsor=="undefined"){c.mapsponsor=ta.maps.mapsponsor.getSponsorForLocation(c.vendorSetId)}if(c.mapsponsor){a+="&mapSponsorship="+c.mapsponsor}}return a},buildVarMetaHacUrl:function(l,y,r,q,u,k,H,m,s,o,h,j){var b=false;if(ta.browser.isIE10Metro()){if(H=="QC_Meta_Book_Inline"){b="QC_Meta_Metro_Inline"}else{b="QC_Meta_Metro_Lightbox"}}else{if(!H){if(ta.has("ta.meta.navArea")){b=ta.retrieve("ta.meta.navArea")}else{b="QC_Meta_Lightbox"}}else{b=H}}var p="";if(ta.has("metaDatePickerEnabled")){p=ta.commerce.checkrates.multiDatePickerUserData()}if(!p){p=y.getUserData();if(!p&&ta.retrieve("parentCheckRatesData")){var d=ta.retrieve("parentCheckRatesData");p=d.getUserData()}if(!ta.has("metaDatePickerEnabled")){if(!m){m=ta.commerce.checkrates.getTravelDataFromDOM()}if(m&&m.sInMonthYear&&m.sOutMonthYear&&m.inDay&&m.outDay&&m.adults){var a=m.sInMonthYear,I=m.sOutMonthYear,g=m.inDay,c=m.outDay,B=m.adults;var A=[];A.push("inMonth=");A.push(a[0]);A.push("%20");A.push(a[1]);A.push("&inDay=");A.push(g);A.push("&outMonth=");A.push(I[0]);A.push("%20");A.push(I[1]);A.push("&outDay=");A.push(c);A.push("&adults=");A.push(B);p=A.join("")}}}if(!p&&y){return"/"+l+"?detail="+y.vendorSetId}else{if(!p&&!y){return +"/"+l+"?detail="}}var w="";if(k){w="&metaVersion="+k}var D="";if(ta.has("meta.baseLocationId")){D="&baseLocId="+ta.retrieve("meta.baseLocationId")}var t="";if(ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click")){t="&seeAllClick=true"}var f="/"+l+"?detail="+y.vendorSetId+"&"+p+"&area="+b+"&checkedContentID="+r+"&checkedContentNames="+q+w+D+t;var z=f;try{f=ta.commerce.meta.tracking.updateUrlWithTiming(f,b)}catch(G){ta.util.error.record(G,"problem updating url with timing in CheckRates.buildVarMetaHacUrl");f=z}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var E=ta.commerce.meta.tracking.getSuppressedAreasAsString();if(E){f+="&suppressImpressionsOnComplete="+E}}if(ta.retrieve("ta.commerce.suppress_commerce_impressions.enabled")){z=f;try{f=ta.commerce.checkrates.checkSuppressCommerceImpressions(f,j);if(!f){f=z}}catch(G){ta.util.error.record(G,"problem updating url with isFirstPageLoad in CheckRates.buildVarMetaHacUrl");f=z}}if(u){f+="&finalRequest=true"}if(s){f+="&numTries="+s}if(h){f+="&loadingTimeoutPassed="+h}if(o){var v=o[0];if(v){f+="&premiumContentId="+v;for(var C=1;C<o.length;C++){v=o[C];f+=","+v}}}var F="ta.commerce.MetaHacOverlay.currency";if(ta.has(F)){f+="&currency="+ta.retrieve(F);ta.remove(F)}return f},checkSuppressCommerceImpressions:function(a,c){if(!a||!c){return}suppressKey=c+"_suppressCommerceImpressionState";var b=ta.commerce.meta.polling.getPollingAttemptForRequest(c);if(b){if(b===1){if(ta.retrieve("meta.isFromDatesChange")){ta.remove("meta.isFromDatesChange");ta.store(suppressKey,true);a+="&isFirstPageLoad=false";return a}}else{if(ta.retrieve(suppressKey)){a+="&isFirstPageLoad=false";return a}}}return a},getTravelDataFromDOM:function(){var p={};if(!ta.widgets.calendar){return null}var b=ta.widgets.calendar.getPageInDate();var h=ta.widgets.calendar.getPageOutDate();var a=ta.widgets.calendar.hasPageDates();if(a&&b&&b.getMonth&&h&&h.getMonth){var j=ta.widgets.calendar.getPageAdultsCount();var d=new Array();d.push(b.getMonth()+1);d.push(b.getFullYear());var o=new Array();o.push(h.getMonth()+1);o.push(h.getFullYear());p.sInMonthYear=d;p.sOutMonthYear=o;p.inDay=b.getDate();p.outDay=h.getDate();p.adults=j}else{var g=ta.id("META_HAC_DATE_SELECTOR");if(!g){g=ta.id("META_HAC_DATE_SELECTOR_met")}if(!g){return null}var k=g.getElement(".chk-in .month"),c=g.getElement(".chk-in .day"),f=g.getElement(".chk-out .month"),m=g.getElement(".chk-out .day"),l=g.getElement(".adults select");if(!k||!c||!f||!m||!l){return null}p.sInMonthYear=k.value.split(/\//);p.sOutMonthYear=f.value.split(/\//);p.inDay=escape(c.value);p.outDay=escape(m.value);p.adults=l.selectedIndex+1}return p},buildMetaHacUrl_allProviders:function(f,r,j,m,C){var c=false;if(ta.browser.isIE10Metro()){if(C=="QC_Meta_Book_Inline"){c="QC_Meta_Metro_Inline"}else{c="QC_Meta_Metro_Lightbox"}}else{c=C||"QC_Meta_Lightbox"}var t="";if(j){t="&metaVersion="+j}var o="";if(ta.has("metaDatePickerEnabled")){o=ta.commerce.checkrates.multiDatePickerUserData()}else{if(!m){var w=ta.id("META_HAC_DATE_SELECTOR_met");if(!w){return}var s=w.getElement(".chk-in .month"),g=w.getElement(".chk-in .day"),A=w.getElement(".chk-out .month"),l=w.getElement(".chk-out .day"),b=w.getElement(".adults select");if(!s||!g||!A||!l||!b){return}var a=s.value.split(/\//),E=A.value.split(/\//),p=ta.util.date.create(a[1],a[0]-1,g.value),D=ta.util.date.create(E[1],E[0]-1,l.value);var v=[];v.push("inMonth=");v.push(a[0]);v.push("%20");v.push(a[1]);v.push("&inDay=");v.push(escape(g.value));v.push("&outMonth=");v.push(E[0]);v.push("%20");v.push(E[1]);v.push("&outDay=");v.push(escape(l.value));v.push("&adults=");v.push(b.selectedIndex+1);o=v.join("")}}var k="false";if(m&&!ta.has("metaDatePickerEnabled")){k="true"}var y="";if(ta.has("meta.baseLocationId")){y="&baseLocId="+ta.retrieve("meta.baseLocationId")}var q="";if(ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")||ta.retrieve("checkrates.hr_bc_see_all_click")){q="&seeAllClick=true"}var h="/MetaCheckRatesAjax?detail="+f+"&"+o+"&area="+c+t+"&returnAllOffers=true&useSessionDates="+k+y+q;var u=h;try{h=ta.commerce.meta.tracking.updateUrlWithTiming(h,c)}catch(B){ta.util.error.record(B,"problem updating url with timing in CheckRates.buildMetaHacUrl_allProviders");h=u}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var z=ta.commerce.meta.tracking.getSuppressedAreasAsString();if(z){h+="&suppressImpressionsOnComplete="+z}}if(r){h+="&finalRequest=true"}if(ta.maps&&ta.maps.mapsponsor){var d=ta.maps.mapsponsor.getSponsorForLocation(f);if(d){h+="&mapSponsorship="+d}}return h},metaHacRequest:function(B,u,t,E,K,y,l){ta.commerce.meta.clearStoredMiniData();var h="metaHacRequest_curCancelKey";var d=13;if(ta.isStateOptMiniMeta()){d=10}var o=ta.retrieve("meta.travelData");var D=false;if(E==null){o=ta.commerce.checkrates.getTravelDataFromDOM();ta.store("meta.travelData",o);E=new Date().getTime();if(ta.commerce.meta&&B&&B.vendorSetId){if(K){ta.commerce.meta.loadBestPriceXsell(B.vendorSetId,"REC_CONT_INLINE",{isInline:true})}else{ta.commerce.meta.loadBestPriceXsell(B.vendorSetId,"REC_CONT",{isInline:false})}}var r=false;if(K){if(ta.has("metaCheckRatesUpdateDivInline")){r=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}}else{if(ta.has("metaCheckRatesUpdateDiv")){r=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}}if(r&&r.removeClass){r.removeClass("hidden")}if(ta.has("metaUI.hrTestComHvy")){var A=ta.id("COMHVY");if(A){A.removeClass("noDates");A.addClass("hasDates")}var J=ta.id("OPEN_CAL_PRNT");if(J){J.empty()}}if(ta.has("metaUI.hrTestComHvy")||ta.isStateOptMiniMeta()){if(ta.has("metaUI.hiddenAV")){var a=ta.retrieve("metaUI.hiddenAV");if(a&&a.removeClass){a.removeClass("hidden")}ta.remove("metaUI.hiddenAV")}}}var j="metaHacRequest_"+E+"_cancel";if(ta.has(h)){var I=ta.retrieve(h);if(I!=j){ta.store(I,true);ta.commerce.meta.polling.removePollingInfoForRequest(I)}}if(K){var g=document.getElement(".meta_rates_content .postShowMetaCR");var s=document.getElement(".meta_rates_content .postShowMetaCRLB");var b=document.getElement(".meta_rates_content .postShowMetaCRLBPCR");if(ta.has("checkrates.mini_meta_by_percent_cpc")&&ta.retrieve("checkrates.mini_meta_by_percent_cpc_see_all_click")){var z=g.getElement(".seeMore.threshold");if(z){var v=g.getElements(".postClickPrice.hide");v.each(function(M,L){M.removeClass("hide")});z.hide()}}ta.commerce.meta.updateProvArea(g,s,b);if(ta.retrieve("stateopt_modal_test")&&ta.retrieve("worst_hack_ever")){var p=document.getElement(".stateoptModalLink");if(p&&p.click){p.click();ta.store("worst_hack_ever",false);ta.store("stateoptModal.GA_auto",true)}}}if(!ta.has(j)){ta.store(j,false);ta.store(h,j)}if(ta.retrieve(j)==true){return}var G=ta.retrieve("metaCheckRatesOverlay");if(!B||(!G&&!K)){return}var C=false;if(G){C=G.inner}if(ta.has("metaCheckRatesUpdateDiv")){C=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(K&&ta.has("metaCheckRatesUpdateDivInline")){C=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}if(!C){return}try{C.innerHTML=ta.commerce.checkrates._setCollapseExpand(B,C.innerHTML);if(ta.retrieve("metaChangeDateClicked")){ta.commerce.checkrates.removeProviderCheckboxClick();ta.remove("metaChangeDateClicked")}if(ta.retrieve("metaAvailSectionsCheckboxEnabled")){ta.commerce.checkrates.restoreProviderCheckboxClick()}var F;if(ta.commerce.meta.polling.isRequestBeingPolled(j)){F=ta.commerce.meta.polling.getPollingAttemptForRequest(j);if(!F||F>d){ta.commerce.meta.polling.removePollingInfoForRequest(j);return}}else{F=1;ta.commerce.meta.polling.setPollingAttemptForRequest(j,F)}if(!C.innerHTML.contains("hacComplete")){var c=false;if(K){c="QC_Meta_Inline"}if(!y){y=1}if(ta.isMetaHotelMBP2013()&&typeof(ta.commerce.meta)!="undefined"){ta.commerce.meta.hideMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}setTimeout(function(){new Request({url:ta.commerce.checkrates.buildMetaHacUrl(B,u,t,true,l,c,o,y),onSuccess:function(L,M){if(ta.retrieve(j)==true){return}if(ta.retrieve("metaCheckRatesOverlay")||ta.retrieve("metaCheckRatesUpdateDivInline")){L=ta.commerce.checkrates._setCollapseExpand(B,L);C.innerHTML=L;if(ta.retrieve("checkrates.meta_ui_sk_box")){ta.commerce.meta.restoreProviderHover()}}if(ta.retrieve("metaChangeDateClicked")){ta.commerce.checkrates.removeProviderCheckboxClick();ta.remove("metaChangeDateClicked")}if(ta.retrieve("metaAvailSectionsCheckboxEnabled")){ta.commerce.checkrates.restoreProviderCheckboxClick()}if((ta.commerce.checkrates.getMetaPricesCount(K)>0||F>9)&&ta.commerce.meta.hacIsBlockingXSell(K)){if(K){ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}}ta.commerce.checkrates.updateMetaProviders(B);ta.store("ta.commerce.checkrates.hacAttempt",F+1);if(ta.retrieve("meta.dropdownMiniMeta")){ta.commerce.checkrates.updateDropdownFlyout(L)}if(ta.retrieve("meta.sponsoredLinks")){ta.commerce.checkrates.updateSponsoredLinks(L)}if(ta.has("meta.isHackathonBC")){if(ta.isStateOptNoAvailOnHREnabled()&&L.contains("showStateOptHRNoAvailability")){ta.commerce.meta.showStateOptHRNoAvailUI(L)}else{if(L.contains("showCarousel")){ta.commerce.meta.loadCarouselXSell(L.contains("anyOfferLoadingOrNotDisplaying"))}else{ta.commerce.meta.hideCarouselXSell()}}if(ta.isBCHoverTable()){ta.commerce.meta.handleHoverTableResponseText(L)}}ta.commerce.meta.polling.incrementPollingAttemptForRequest(j);ta.commerce.checkrates.metaHacRequest(B,u,t,E,K,y+1,l)},evalScripts:true}).send()},ta.commerce.meta.polling.getPollingWaitTimeForRequest(j))}else{try{ta.commerce.meta.polling.removePollingInfoForRequest(j);if(K){ta.commerce.meta.metaInYourMeta("REC_CONT_INLINE",{xsell:false,inline:true})}else{ta.commerce.meta.metaInYourMeta("REC_CONT",{xsell:false,inline:false})}if(G){ta.commerce.meta.storeMiniData(G.inner)}var q=ta.commerce.checkrates._getAvailCount(C);var k;var w="complete";if(K){if(ta.id("COMHVY")){k="Mini-Meta";if(ta.find(".NotShowing .postClickPrice")){w+="_may_be_available"}else{if(ta.find("#HotelDateSearch .price .minCost")){if(ta.find(".strikeHigh")){w+="_available_lp_chevron"}else{w+="_available"}}else{w+="_unavailable"}}}else{k="Metainline"}}else{k="meta_lightbox"}if(C.innerHTML.contains("doneNoAvailability")){ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_EMPTY",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount());if((ta.id("MAYBE_BUTTONS_INLINE")&&K)||(ta.id("MAYBE_BUTTONS")&&!K)&&k!="Mini-Meta"){w+="|may_be_availabile"}else{if(k!="Mini-Meta"){w+="|unavailable"}}}else{ta.widgets.calendar.trackCalendarEvent("DATEPICKER","RESULTS_PRESENT",ta.widgets.calendar.getPageAdultsCount(),ta.widgets.calendar.getPageAdultsCount())}ta.trackEventOnPage(k,w,q.toString());ta.commerce.meta.showLowestPriceCTA(K);if(ta.isStateOptMiniMeta()&&typeof(ta.commerce.meta)!="undefined"){if(C.innerHTML.contains("doneNoAvailability")&&window.modelLocId){ta.commerce.meta.hacAltDates(window.modelLocId,true,null,"MM_ALT_DATES");ta.commerce.meta.loadMiniMetaCrossSell(window.modelLocId,"MMSO_XSELL",false,false)}else{ta.trackEventOnPage("Mini_meta_State-Optimized","display","not_shown")}}if(ta.isMetaHotelMBP2013()&&typeof(ta.commerce.meta)!="undefined"){if(C.innerHTML.contains("hacMiniOfferUnavailable")){ta.commerce.meta.loadMiniMetaCrossSell(ta.retrieve("meta.baseLocationId"),"MINI_META_CROSS_SELL",false,false);ta.commerce.meta.showMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}else{ta.commerce.meta.hideMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}}if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkLightbox()}var m=ta.find(".overlay .skv3");if(m&&m.hasAttribute("data-sponsor")){var f=m.getAttribute("data-sponsor");ta.maps.ads.injectMetaLightBoxAd(f)}if(ta.isBCHoverTable()){ta.commerce.meta.handleHoverTableResponseText(responseText)}}catch(H){ta.util.error.record(H,"ta.commerce.meta.metaHacRequest - failure in complete results block")}}}catch(H){ta.util.error.record(H,"meta HAC - ajax requests")}},getMetaPricesCount:function(a){var c=0;var b=ta.retrieve("metaCheckRatesOverlay");var d=false;if(b){d=b.inner}if(ta.has("metaCheckRatesUpdateDiv")){d=ta.id(ta.retrieve("metaCheckRatesUpdateDiv"))}if(a&&ta.has("metaCheckRatesUpdateDivInline")){d=ta.id(ta.retrieve("metaCheckRatesUpdateDivInline"))}if(!d){return}var f=d.getChildren(".metaProvider .roomPrice");if(f){c=f.length}return c},_getAvailCount:function(c){var a=0;var b=0;c=ta.id(c);var f=c.getChildren(".metaProvider");if(f){a=f.length}var d=c.getChildren(".remainingProviders .available");if(d){b=d.length}return a+b},miniMetaReportLateAvailability:function(){var c=document.getElement("#CHECK_RATES_CONT div.hacMiniComplete");var a=document.getElement("#CHECK_RATES_CONT div.hacMiniCompleteTimeOut");if(c||a){return}var b=document.getElement("div.bc_flags");if(b){b.addClass("hacMiniCompleteTimeOut")}ta.commerce.checkrates.cancelMiniMetaCurrentQuery();ta.commerce.checkrates.gaHacCompleteAndStillLoading()},miniMetaAppearLoaded:function(g,f,c,b,a){var d=document.getElement("#CHECK_RATES_CONT div.hacMiniComplete");if(d){return}ta.commerce.checkrates.cancelMiniMetaCurrentQuery();ta.commerce.checkrates.gaHacCompleteOrTimedOut(b,true);ta.commerce.checkrates.removePremiumsIfLoading();ta.commerce.checkrates.loadingTextLinksToVisitSite();ta.commerce.checkrates.noPremiumOffers();ta.commerce.checkrates.miniMetaHacRequest(g,f,c,new Date().getTime(),a+1,true)},noPremiumOffers:function(){var b=document.getElements("#CHECK_RATES_CONT div.premium");var a=document.getElement(".similarCarousel");if(b.length<1&&!a){ta.commerce.meta.loadCarouselXSell(false)}},loadingTextLinksToVisitSite:function(){var d=document.getElements("#CHECK_RATES_CONT span.textLink");var h=[];var k=[];var a=[];var b=[];var g=0;if(!d){return}for(var f=0;f<d.length;f++){var l=d[f];if(f<3){h.push(l)}var p=l.getElement(".textLinkLoading");var o=l.getElement(".sprite-visitSite");if(l.getElement(".price")){k.push(l)}else{if(p||o){if(p&&o){p.hide();o.show()}a.push(l)}else{b.push(l)}}if(l.hasClass("remaining")){g++}if(f>2){l.dispose()}}var q=d.length-g;var r=[];var j=true;var m=document.getElement("#CHECK_RATES_CONT div.textLinks");var c;if(m){c=m.getElement(".wrap")}if(!c){return}r.push.apply(r,k);r.push.apply(r,a);r.push.apply(r,b);for(f=0;f<r.length;f++){l=r[f];if(f<3){if(j&&l.get("data-contentid")==h[f].get("data-contentid")){l=d[f]}else{j=false;h[f].dispose()}}var s=f%2==0;if(s){l.addClass("odd")}else{l.removeClass("odd")}if(q<1){l.addClass("remaining")}else{l.removeClass("remaining")}q--;if(!j||f>2){l.inject(c,"bottom")}}},removePremiumsIfLoading:function(){var b=document.getElements("#CHECK_RATES_CONT div.premium");for(var a=0;a<b.length;a++){var c=b[a];if(c.getElement(".loading")){c.dispose()}}},cancelMiniMetaCurrentQuery:function(){var a="miniMetaHacRequest_curCancelKey";if(ta.has(a)){var b=ta.retrieve(a);ta.store(b,true);ta.commerce.meta.polling.removePollingInfoForRequest(b)}},updateInterrupter:function(b){var d=0;for(var c=0;c<b.length;c++){if(b[c].hasClass("interrupterContent")){d=b[c];break}}if(d){var a=document.getElement("#MINI_META_IN_REVIEWS");if(a){if(a.getElement(".interrupterContent")){a.getElement(".interrupterContent").destroy()}d.inject(a);ta.widgets.calendar.syncAllDatePickers();if(ta.has("ta.mmir.newDates")&&d.hasClass("loading")){if(ta.has("hac.progress.timer")){ta.remove("hac.progress.timer").stopTimer()}if(document.getElement(".interrupterProgressBar")){ta.store("hac.progress.timer",new ta.hac.RequestTimer({showProgressBar:true,triggerLoadingState:false,triggerListingsLoadState:false,trackProgress:false,progBarContainerSelector:".interrupterProgressBar",forceResults:false}))}ta.remove("ta.mmir.newDates")}else{if(ta.has("hac.progress.timer")&&!d.hasClass("loading")){ta.retrieve("hac.progress.timer").closeProgressBar()}}}}},miniMetaHacRequest:function(q,o,m,r,p,a){if(!p){p=0}if(!a){a=false}var d="miniMetaHacRequest_curCancelKey";var c=13;if(ta.isStateOptMiniMeta()){c=10}var g=ta.retrieve("meta.travelData");if(r==null){g=ta.commerce.checkrates.getTravelDataFromDOM();ta.store("meta.travelData",g);ta.store("ta.commerce.checkrates.hacAttempt",0);r=new Date().getTime()}var f="miniMetaHacRequest_"+r+"_cancel";if(ta.retrieve(f)==true){return}if(ta.has(d)){var u=ta.retrieve(d);if(u!=f){ta.store(u,true);ta.commerce.meta.polling.removePollingInfoForRequest(u)}}if(!ta.has(f)){ta.store(f,false);ta.store(d,f)}var t;if(ta.commerce.meta.polling.isRequestBeingPolled(f)){var t=ta.commerce.meta.polling.getPollingAttemptForRequest(f);if(!t||t>c){ta.commerce.meta.polling.removePollingInfoForRequest(f);return}}else{t=1;ta.commerce.meta.polling.setPollingAttemptForRequest(f,t)}var j=[];if(a){var v=$$("#CHECK_RATES_CONT div.premium");for(var s=0;s<v.length;s++){var b=v[s].get("data-contentid");j.push(parseInt(b))}}var h="miniMetaHacRequest_longTimeoutKey";var l="miniMetaHacRequest_appearLoadedTimeoutKey";if(p<1){var k;if(ta.has(h)){k=ta.retrieve(h);clearTimeout(Number.from(k))}if(ta.has(l)){k=ta.retrieve(l);clearTimeout(Number.from(k))}k=setTimeout(function(){ta.commerce.checkrates.miniMetaReportLateAvailability()},ta.commerce.minimeta.ajax.MINI_META_STOP_LOADING_TIMEOUT);ta.store(h,Number.from(k))}if(ta.isMetaHotelMBP2013()&&typeof(ta.commerce.meta)!="undefined"){ta.commerce.meta.hideMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}new Request({url:ta.commerce.checkrates.buildMiniMetaHacUrl(q,o,m,true,null,"QC_Meta_Mini",g,p,j,a,f),onSuccess:function(J,w){if(ta.retrieve(f)==true){return}var G=new Element("div",{html:J});var U=J.contains("hacMiniComplete");var O=document.getElement(".similarCarousel");var L=Elements.from(J);if(!O||p<1){ta.commerce.meta.updateProvArea(L[0],L[1],L[2]);if(ta.has("ta.mini_meta_in_reviews")){ta.commerce.checkrates.updateInterrupter(L)}}if(ta.retrieve("meta.dropdownMiniMeta")){if(!document.getElement(".dropdownMiniMeta")){var C=document.getElement(".postShowMetaCR");if(C){ta.commerce.checkrates.injectDropdownMiniMeta(J,C)}}ta.commerce.checkrates.updateDropdownFlyout(J)}if(ta.isBCHoverTable()){ta.commerce.meta.handleHoverTableResponseText(J)}if(ta.has("meta.isHackathonBC")&&!a){if(ta.isStateOptNoAvailOnHREnabled()&&J.contains("showStateOptHRNoAvailability")){ta.commerce.meta.showStateOptHRNoAvailUI(J)}else{if(J.contains("showCarousel")){if(!O){ta.commerce.meta.loadCarouselXSell(J.contains("anyOfferLoadingOrNotDisplaying"))}}else{ta.commerce.meta.hideCarouselXSell()}}}if(ta.has("meta.isHackathonBC")&&ta.has("meta.horizontal_xsell_enabled")){ta.commerce.meta.horizontalXSell.updateHorizontalXSell(G,q.vendorSetId)}if(ta.has("meta.isHackathonBC")&&L&&L.length>0){var N=ta.id("META_COMMERCE_BUTTON");var H=L[0];if(N&&H){var S=H.getElement(".price");var R=H.getElement(".offer")?H.getElement(".offer").get("data-contentid"):null;var V=H.getElement(".offer")?H.getElement(".offer").get("data-provider"):null;if(V){var D=H.getElement(".providerLogo");var F=D&&D.getElement("img")?D.getElement("img").get("alt"):null;if(V.contains("Com")&&!F.contains("Com")){V=F}}if(V&&S&&R){var W=document.getElement(".noRequest");if(W){W.removeClass("noRequest")}var Q=N.get("onclick");var M="Meta_Thumbnail";var E=Q.indexOf("this")+7;var B=Q.lastIndexOf(",")-1;var P=Q.substring(E,B);N.removeEvents("click");N.addEvent("click",function(Y){ta.commerce.meta.updateNavArea(M);ta.call("ta.commerce.checkrates.openMetaProvider",Y,this,P,R)});var K=".price";N.getElement(K).innerHTML=S.innerHTML;var y=".provider";N.getElement(y).innerHTML=V}else{var A=document.getElement(".metaClickOnHero");if(A){A.addClass("noRequest")}}}}if(!U&&ta.has("meta.isHackathonBC")&&!ta.isStateOptNoAvailOnHREnabled()&&J.contains("firstRequest")){k=setTimeout(function(){ta.commerce.checkrates.miniMetaAppearLoaded(q,o,m,r,p)},ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT);ta.store(l,Number.from(k))}if(!U){ta.commerce.meta.polling.incrementPollingAttemptForRequest(f);setTimeout(function(){ta.commerce.checkrates.miniMetaHacRequest(q,o,m,r,p+1,a)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(f))}else{if(ta.isMetaHotelMBP2013()&&typeof(ta.commerce.meta)!="undefined"){ta.commerce.meta.polling.removePollingInfoForRequest(f);if(J.contains("hacMiniOfferUnavailable")){ta.commerce.meta.showMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}else{ta.commerce.meta.hideMiniMetaCrossSell("MINI_META_CROSS_SELL_UNAVAIL")}}else{if(ta.has("meta.isHackathonBC")){var z="meta.bc.bestPricesForYourStay";if(J.contains("allNotAvailable")){z="meta.bc.onlinePricesNotAvailable"}ta.commerce.meta.updateHeaderMsg(".metaDatesChosen",ta.retrieve(z));ta.commerce.meta.polling.removePollingInfoForRequest(f);ta.commerce.meta.displayBlueChevronLowestPriceCTA();if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkHR(true)}if(!a){ta.commerce.checkrates.gaHacCompleteOrTimedOut(r,false)}if(ta.isStateOptNoAvailOnHREnabled()&&J.contains("showStateOptHRNoAvailability")){ta.commerce.meta.showStateOptHRNoAvailUI(J)}var T=document.getElement(".similarCarousel");if(a&&T){ta.commerce.checkrates.gaHacCompletedAfterTimeOut(J)}setTimeout(function(){ta.commerce.checkrates.gaHacCompleteAndStillLoading()},1000)}else{if(ta.isStateOptMiniMeta()&&typeof(ta.commerce.meta)!="undefined"){ta.commerce.meta.polling.removePollingInfoForRequest(f);if(J.contains("hacMiniOfferUnavailable")){ta.commerce.meta.hacAltDates(window.modelLocId,true,null,"MM_ALT_DATES");ta.commerce.meta.loadMiniMetaCrossSell(window.modelLocId,"MMSO_XSELL",false,false)}else{ta.trackEventOnPage("Mini_meta_State-Optimized","display","not_shown")}}}}}if(ta.retrieve("meta.sponsoredLinks")){ta.commerce.checkrates.updateSponsoredLinks(J)}if(U&&ta.retrieve("meta_urgency_messaging.enabled")){var I=ta.id("META_URGENCY_MESSAGE");if(I&&I.hasClass("hidden")){var X=35;I.setStyles({height:0,opacity:0});I.removeClass("hidden");new Fx.Tween(I).start("height",0,X).chain(function(){I.setStyle("height","auto");this.start("opacity",0,1)})}}},evalScripts:true}).send()},gaHacCompleteAndStillLoading:function(){var a=ta.commerce.checkrates.getNumOffersStillLoading();if(a>0){ta.trackEventOnPage("HAC","HACError","LoadingAfterHACComplete",a,true)}},gaHacCompleteOrTimedOut:function(h,l){var c=0;var j="unknown";if(l){c=ta.commerce.minimeta.ajax.MINI_META_APPEAR_LOADING_TIMEOUT;var k=ta.commerce.checkrates.getNumOffersStillLoading();var b=document.getElements("#CHECK_RATES_CONT div.premium");var d=document.getElements("#CHECK_RATES_CONT span.textLink");var g=0;if(b){g+=b.length}if(d){g+=d.length}var a=g-k;if(g>0){var f=Math.round((a/g)*10)*10;if(f%10==0&&f>-1&&f<101){j=""+f+"percent"}}}else{c=new Date().getTime()-h;j="100percent"}ta.trackEventOnPage("HAC","HACComplete",j,c,true)},getNumOffersStillLoading:function(){var c=document.getElements("#CHECK_RATES_CONT span.textLinkLoading");var b=document.getElements("#CHECK_RATES_CONT div.loading");var a=0;if(c){a+=c.length}if(b){a+=b.length}return a},gaHacCompletedAfterTimeOut:function(f){var d=Elements.from(f)[0];if(!d){return}var c=d.getElementsByClassName("price");var b=d.getElementsByClassName("priceBlock");var a=0;if(c){a+=c.length}if(b){a+=b.length}ta.trackEventOnPage("HAC","StateCarouselDisplayed","",a,true)},showHideXSellCarousel:function(a){if(ta.isStateOptNoAvailOnHREnabled()&&a.contains("showStateOptHRNoAvailability")){ta.commerce.meta.showStateOptHRNoAvailUI(a)}else{if(a.contains("showCarousel")){ta.commerce.meta.loadCarouselXSell(a.contains("anyOfferLoadingOrNotDisplaying"));ta.store("showHoverTextLinks",true)}else{ta.commerce.meta.hideCarouselXSell()}}},injectDropdownMiniMeta:function(c,a){responseXML=new Element("div",{html:c});var b=responseXML.getElement(".dropdownMiniMeta");if(b){b.inject(a)}},updateDropdownFlyout:function(c){var a=document.getElement(".rgba_flyout.dropdownMiniMeta");if(a){responseXML=new Element("div",{html:c});var b=responseXML.getElement(".dropdownMiniMeta");if(b){var d=a.getElement(".inner");d.innerHTML="";b.set("class","dropdownMiniMeta");d.adopt(b)}ta.commerce.checkrates.setDropdownHoverState()}},updateSponsoredLinks:function(c){var b=ta.id("COMMERCE_TOP");if(b){var d=b.getElement("ul");if(d){responseXML=new Element("div",{html:c});var a=responseXML.getElement(".metaSponsoredLinks");if(a){a.set("class","metaSponsoredLinks");a.replaces(d)}}}},setDropdownHoverState:function(){if(ta.retrieve("dropdownMiniMeta.hover")){ta.commerce.meta.hoverTopOffer()}else{if(ta.retrieve("dropdownMiniMeta.blur")){ta.commerce.meta.blurTopOffer()}}},updateMetaProviders:function(f){var o=f.getVendorSet();var q=o.getVendors();var g=ta.id("META_UI_AVAIL_SECTIONS");for(var h=0;h<q.length;h++){var j=q[h].getContentID();var d=q[h].vendorName;var l=q[h].options.image;var m=ta.id("partner_"+j);if(m&&d){var c="";if(!g&&f.options.type!="meta_inline_checkrates"){if(l){var b="82";c='<div class="partnerImage"><img src="'+CDNHOST+"/img2/"+l+'" alt="'+d+'" width="'+b+'"></div>'}else{c='<div class="partnerName">'+d+"</div>"}}m.innerHTML=c+m.innerHTML.replace(/@@partnerName@@/g,d)}}var r=document.getElement("#CHECK_RATES_CONT ul.provider");var p=document.getElement("#META_HAC_DATE_SELECTOR .providerContainer");if(!p){p=document.getElement("#META_HAC_DATE_SELECTOR_met .providerContainer")}if(r&&r.length>0&&p&&p.length>0){p[0].innerHTML=r[0].outerHTML}var k=document.getElement("#META_UI_AVAIL_SECTIONS .meta_title_div");if(k){var a=document.getElement("#META_UI_AVAIL_SECTIONS .meta_title_replace");k.innerHTML=a.innerHTML}},showMetaDateSelector:function(){var b=ta.id("META_HAC_DATE_SELECTOR"),a=ta.id("META_HAC_ROOM_LIST");if(!b){b=ta.id("META_HAC_DATE_SELECTOR_met")}if(b){if(this.metaTimeout){clearTimeout(this.metaTimeout)}this.checkAllProviders();b.show();if(a){a.hide()}ta.store("ta.commerce.checkrates.hide_room_types",true)}},selectCheckboxForProvider:function(c){if(!c){return}var b=document.getElementById(c);var a=b&&b.getNext(".checkbox_ui");if(b){b.checked=!b.checked;ta.commerce.checkrates.storeProviderCheckboxClick(c)}if(a){a.toggleClass("checked");if(a.hasClass("checked")){a.setProperty("src",CDNHOST+"/img2/ui/checkbox_org_checked.gif")}else{a.setProperty("src",CDNHOST+"/img2/ui/checkbox_org_unchecked.gif")}}},storeProviderCheckboxClick:function(b){var a=document.getElementById(b);ta.store(b,a)},restoreProviderCheckboxClick:function(){var b=document.getElements("#META_UI_AVAIL_SECTIONS #META_HAC_ROOM_LIST .chk");var a=document.getElements("#META_UI_AVAIL_SECTIONS #META_HAC_ROOM_LIST .checkbox_ui");b.each(function(d){var c=ta.retrieve(d.id);if(c){d.checked=c.checked}});a.each(function(d){var c=ta.retrieve(d.name);if(c){if(c.checked){d.addClass("checked");d.setProperty("src",CDNHOST+"/img2/ui/checkbox_org_checked.gif")}else{d.removeClass("checked");d.setProperty("src",CDNHOST+"/img2/ui/checkbox_org_unchecked.gif")}}})},checkAllProviders:function(){var a=document.getElements('.provider input[type="checkbox"]');ta.commerce.checkrates.selectAllCheckBoxes(a)},selectAllCheckBoxes:function(a){a.each(function(b){b.checked=true;ta.commerce.checkrates.storeProviderCheckboxClick(b.id)})},selectAllImgCheckBoxes:function(a){a.each(function(b){b.addClass("checked");b.setProperty("src",CDNHOST+"/img2/ui/checkbox_org_checked.gif")})},modifyElmtClassNameForTracking:function(a){if(a&&/custom_area_QC_Meta[ \t\Z]/.test(a.className)){if(ta.browser.isIE10Metro()){a.className=a.className.replace("QC_Meta","QC_Meta_Metro")}else{a.className=a.className.replace("QC_Meta","QC_Meta_Lightbox")}}},_setCollapseExpand:function(b,j){var m=b.getVendorSet().getVendors();var g=0;for(var f=0;f<m.length;f++){var l=m[f];var d=l.propertyId;var a=l.getContentID();var k="ta.commerce.checkrates.isExpanded."+d+"."+a;var c=ta.retrieve(k);if(d&&a){var h="collapseExpand_"+d+"_"+a;if(c){j=j.replace(h,"partnerExpanded")}else{j=j.replace(h,"partnerCollapsed")}}}return j},changeMetaDates:function(c,b){var a=ta.id("META_HAC_DATE_SELECTOR_met");if(a){a.setStyle("display","block");b.destroy()}if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}},partnerHoverOn:function(c,b){var a=b;while(a&&!a.hasClass("partner")){a=a.parent}if(a){a.addClass("partnerHvr")}},partnerHoverOff:function(c,b){var a=b;while(a&&!a.hasClass("partner")){a=a.parent}if(a){a.removeClass("partnerHvr")}},toggleUrgencyMessage:function(o){try{if(!o){o=""}var c=ta.id("URGENCY_MESSAGE"+o);if(!c){return}var d=false;var m=false;var j=false;var k=false;var a="";var f="";var b=false;if(c.hasClass("slide_in")){var p=document.getElement("#HotelDateSearch .provider");b=document.getElement("#BODYCON .col.balance");if(p&&b){var h=p.getCoordinates();var l=b.getCoordinates();c.style.top=(h.top-l.top)+"px";c.style.left=(l.width+7)+"px";b.style.position="relative";k=h.left-l.left+70}a="slide_in";b.addClass("hide_x_overflow")}else{if(c.hasClass("middle")){var p=document.getElement("#HotelDateSearch .provider");if(p){var h=p.getCoordinates();var b=ta.id("PAGE");c.style.top=h.top+"px";c.style.left=(h.left+70)+"px"}a="middle"}else{if(o=="_pcr"){var p=document.getElement("#PERSISTENT_CHECK_RATES .fl");if(p){var b=document.getElement("#PERSISTENT_CHECK_RATES");var h=p.getCoordinates(b);c.style.top=h.top+"px";c.style.left=(h.right+10)+"px"}a="pcr"}else{if(c.hasClass("top_right")){var b=document.getElement("#HEAD .masthead");a="top_right"}else{if(c.hasClass("bottom_right")){a="bottom_right"}}}}}if(b){b.grab(c.dispose())}if(c.hasClass("anim_left")){m="left";j=c.style.left;d=new Fx.Tween(c,{transition:"quad:out",duration:"1500"});f="left"}else{if(c.hasClass("anim_height")){m="height";j=0;k=c.getSize().y;d=new Fx.Tween(c,{transition:"quad:out",duration:"500"});c.style.height="0px";f="height"}else{if(c.hasClass("anim_opacity")){m="opacity";j=0;k=1;d=new Fx.Tween(c,{transition:"bounce:out",duration:"250"});c.addClass("opacity_0");f="opacity"}}}c.removeClass("hide_section");if(ta.has("checkrates.urgency_msg_once")){d.start(m,j,k);if(o=="_pcr"){ta.store("checkrates.urgencyMsgPCRShowing",true)}else{d.chain(function(){this.start.delay(6000,this,[m,k,j])});if(c.hasClass("slide_in")){d.chain(function(){c.addClass("hide_section");if(b.hasClass("hide_x_overflow")){b.removeClass("hide_x_overflow")}})}}}else{d.start(m,j,k).chain(function(){this.start.delay(6000,this,[m,k,j])},function(){this.start.delay(4000,this,[m,k,j])},function(){this.start.delay(6000,this,[m,k,j])})}ta.trackEventOnPage("UrgencyMessage",f,a,1,true)}catch(g){ta.util.error.record(g,"urgency messaging")}},providerLoadTestReq:function(a){if(ta.retrieve("checkrates.meta_provider_load_test")){new Request({url:"/ProviderLoadTestAjax",data:{detail:a}}).send()}},_addTagManToDOM:function(b){if(b.options.trackClick){var a=new Element("img",{src:b.options.trackClick,height:1,width:1,styles:{position:"absolute",bottom:0,left:0}});document.body.appendChild(a)}},addClickOutPixels:function(d,b){try{if(ta.has("remarketing.clickoutpixels")&&ta.has("remarketing.clickouturl")){var a=ta.retrieve("remarketing.clickouturl");if(a){if(b){a+="&isMetaCheckRates=true"}a=a.replace("replaceTxt",d)}ta.store("ads.monikerClickOutUrl",a);ta.common.ads.loadClickOutMonikers()}}catch(c){ta.util.error.record(c,"click out monikers failure (meta="+b+")")}},displayRemainingProviders:function(d){try{var c=ta.id("CHECK_RATES_CONT");var b=c.getElements("li");for(var a=b.length;a--;){b[a].removeClass("hide")}d.hide();ta.store("checkrates.mini_meta_by_percent_cpc_see_all_click",true)}catch(f){ta.util.error.record(f,"displayRemainingProviders")}},addMetaHacRoomInfoToOffer:function(d,c,b){if(!b||!c||!d){return}var a=ta.retrieve("ta.commerce.hacRoomInfo."+c)||new ta.commerce.HACRoomInfo(c);a.setRoomDetailKey(d,b);ta.store("ta.commerce.hacRoomInfo."+c,a)},startScooter:function(){try{if(typeof ta!="undefined"&&ta.p13n&&ta.p13n.Scooter){var a=ta.retrieve("scooterObj");if(a&&a!="undefined"){a.removeScooter(a);ta.remove("scooterObj")}var a=new ta.p13n.Scooter();if(a){if(ta.retrieve("checkrates.hotel_flyout_micro_meta")&&a.getScooterContent){a.getScooterContent(a)}else{if(a.getScooterContentNonAjax){a.getScooterContentNonAjax(a)}}ta.store("scooterObj",a);ta.trackEventOnPage("scooter","Displayed",null,0,true)}}}catch(b){ta.util.error.record(b,"startScooter failed")}},getTravelDataForURL:function(){try{var d=[];var j=ta.retrieve("meta.travelData");j=ta.commerce.checkrates.getTravelDataFromDOM();if(j&&j.sInMonthYear&&j.sOutMonthYear&&j.inDay&&j.outDay&&j.adults){var g=j.sInMonthYear,c=j.sOutMonthYear,b=j.inDay,a=j.outDay,f=j.adults;d.push("inMonth=");d.push(g[0]);d.push("%20");d.push(g[1]);d.push("&inDay=");d.push(b);d.push("&outMonth=");d.push(c[0]);d.push("%20");d.push(c[1]);d.push("&outDay=");d.push(a);d.push("&adults=");d.push(f)}return d.join("")}catch(h){ta.util.error.record(h,"getTravelDataForURL")}}};ta.queueForLoad(function(){var c=false;try{c=window.location.href}catch(b){}if(c){var a=ta.retrieve("pcr.initialUrl");if(!a){a=c;ta.store("pcr.initialUrl",a)}}if(ta.commerce.checkrates.showMetaCheckRates()){ta.commerce.checkrates.checkAllProviders()}},"pcr.inititalUrl and metro check all providers");ta.commerce.meta={toggleTab:function(c,d,a){if(c&&ta.id(c).hasClass("selected")&&a){return}var b=ta.id(c);var g=false;if(b.hasClass("tab0")){g=document.getElement(".meta_inline_tabs .tab1");document.getElement(".meta_review_content").show();document.getElement(".meta_rates_content").hide();ta.remove("pcr.disabled");if(a){ta.trackEventOnPage("MetaInline","reviews_tab_click","")}else{ta.trackEventOnPage("MetaInline","reviews_tab","")}}else{if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}var f=c.className.match(/locId_(\d+)/)[1];var h=true;ta.commerce.checkrates.geoId=f;if(!b.hasClass("dont_show")){ta.store("pcr.disabled",true);if(ta.retrieve("pcr.overlay")){ta.retrieve("pcr.overlay").hide()}}ta.commerce.checkrates.updateCRForm("_imt");g=document.getElement(".meta_inline_tabs .tab0");b=document.getElement(".meta_inline_tabs .tab1");if(!b.hasClass("dont_show")){document.getElement(".meta_review_content").hide();document.getElement(".meta_rates_content").show()}if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}ta.commerce.meta.updateInlineMeta(f,d);ta.trackEventOnPage("MetaInline","prices_tab","");if(a){ta.trackEventOnPage("MetaInline","prices_tab_click","")}}if(!b.hasClass("dont_show")){ta.id(g).removeClass("sprite-tab-active");ta.id(g).addClass("sprite-tab-idle");ta.id(b).addClass("sprite-tab-active");ta.id(b).removeClass("sprite-tab-idle");ta.id(b).addClass("selected");ta.id(g).removeClass("selected")}},updateInlineMeta:function(d,b){if(!ta.widgets.calendar.hasPageDates()){ta.commerce.meta.popInlineDatePicker(b,d);return}var a=ta.id("CHECK_RATE");if(!a){return}var c=new ta.commerce.CheckRatesData({type:"meta_inline_checkrates",evnt:b},d,d,true);ta.commerce.checkrates.checkAllProviders();ta.commerce.meta.loadInlineMeta(c,d)},popInlineDatePicker:function(c,d){if(!d){return}var a;var b="_inm";if(c&&c.target&&c.target.getParent("#CHECK_RATES_CONT")){a=ta.id("date_picker_"+d)}a=a||ta.id("date_picker_"+d+b);if(a){var f=a.getParent(".date_picker_calendar_wrap");if(f&&f.onclick){f.onclick(c,f,d,b);f.fireEvent("click",c,f,d,b);(function(){try{ta.retrieve("avail.data."+d+b).calendar.calendarOverlay.position()}catch(g){}}).delay(200)}}},clickMetaShowPrices:function(d){if(!ta.widgets.calendar.hasPageDates()){ta.widgets.calendar.setErrorStyling(new Event(d).target);return}var a=document.getElement(".cr_lb_overlay");if(a&&a.overlay){a.overlay.hide()}var b=ta.id("CHECK_RATE");var c="meta_inline_checkrates";var h=ta.id("MetaPricesTab");if(h){var g=h.className.match(/locId_(\d+)/)[1];var f=new ta.commerce.CheckRatesData({type:c,evnt:d},g,g,true);if(f.validateDates()){if(ta.retrieve("meta.trackShowPriceButton")){ta.trackEventOnPage("DATEPICKER","SearchButton","");ta.store("meta.trackShowPriceButton",false)}if(ta.isDisablePriceTabAutoToggle()||ta.retrieve("suppressInlineToggle")){if(ta.has("metaDatePickerEnabled")){ta.widgets.calendar.syncAllDatePickers()}ta.commerce.checkrates.updateCRForm("_imt");ta.commerce.meta.updateInlineMeta(g,d);ta.store("suppressInlineToggle",false)}else{ta.commerce.meta.toggleTab(h,d)}}}},loadInlineMeta:function(c,b){var a="lb_allProviders";if(ta.has("meta.isHackathonBC")){a="lb_allProviders_bc_meta"}if(ta.has("checkrates.mini_meta_by_percent_cpc")){ta.store("checkrates.mini_meta_by_percent_cpc_see_all_click",false)}new Request({url:ta.commerce.checkrates.buildMetaHacUrl_allProviders(b,false,a,true,"QC_Meta_Inline"),onSuccess:function(f,g){if(ta.has("meta.isHackathonBC")&&f.contains("hacMiniComplete")){ta.commerce.checkrates.showHideXSellCarousel(f)}var d=ta.id("MetaRatesContent");if(!d){return}f=ta.commerce.checkrates._setCollapseExpand(c,f);d.innerHTML=f;ta.commerce.checkrates.metaTimeout=setTimeout(function(){var j=c.getVendorSet().getAllVendorIds();var h=c.getVendorSet().getCheckedVendor();ta.commerce.checkrates.metaHacRequest(c,j,h,null,true,0,a)},10)},evalScripts:true}).send()},showLowestPriceCTA:function(h){var b=(h)?"metaLowestPriceCTAInline":"metaLowestPriceCTA";if(ta.has(b)){var g=true;if(h){var l=document.getElement(".meta_rates_content");g=l&&l.style.display=="block"}if(g){var c=ta.retrieve(b);if(c.hasOwnProperty("idx")){var j=(h)?"Meta_LP_CTA_Display_Inline":"Meta_LP_CTA_Display";var f=(c.idx==0)?"Not_Displayed":"Displayed";var k=c.idx+"";ta.trackEventOnPage(j,f,k)}var d=(h)?"LP_CTA_INLINE":"LP_CTA";var a=ta.id(d);if(a){(function(){a.fade("in")}).delay(1000)}}}},enterDatesClick:function(b,c){var a=ta.id("CHECK_RATE");var d="meta_inline_checkrates";var g=a.className.match(/id_(\d+)/)[1];var f=new ta.commerce.CheckRatesData({type:d,evnt:b},g,g,true);document.write("ENTER DATES CLICK");if(ta.commerce.meta.validateInlineMetaDates(f)){ta.commerce.meta.toggleTab(ta.id("MetaPricesTab"))}},validateInlineMetaDates:function(b){if(ta.has("metaDatePickerEnabled")){return true}var g=b.vendorSetId;var d=ta.id("checkIn_"+g+"_imt");var j=ta.id("checkOut_"+g+"_imt");var k=false;var a=ta.id("HotelDateSearch_imt");if(!a||!d||!j||!d.value||!j.value){return true}var c=b.parseDate(d.value);var h=b.parseDate(j.value);ta.commerce.meta.clearErrors(g,"_imt");ta.commerce.meta.hideInfo(a);var f=b.dateErrorCheck(c);if(f){ta.commerce.meta.showErrors(f,d,a);k=true}f=b.dateErrorCheck(h);if(f){ta.commerce.meta.showErrors(f,j,a);k=true}if(c&&h&&(h.getTime()<=c.getTime())){f=js_0003;ta.commerce.meta.showErrors(f,[j,d],a);k=true}b.clearErrors(ta.id("checkIn_"+g),ta.id("checkOut_"+g));b.hideInfo();return !k},showErrors:function(h,b,g){var a=[];if(!ta.retrieve("ta.commerce.CheckRatesData.cssAsset")){ta.store("ta.commerce.CheckRatesData.cssAsset",Asset.css(CDNHOST+"/css2/common/validation_error.css"))}if(b instanceof Array&&b.constructor==Array){a=b}else{a.push(b)}for(var f=0;f<a.length;f++){var d=a[f];if(d){d.addClass("errorInput");var c=ta.id("lbl_"+d.id);if(c){c.addClass("errorLabel")}}}ta.commerce.meta.showInfo(h,g)},clearErrors:function(g,c){var a=ta.id("checkIn_"+g+c);var d=ta.id("checkOut_"+g+c);if(!a){return false}var b=ta.id("lbl_"+a.id);var f=ta.id("lbl_"+d.id);if(a){a.removeClass("errorInput")}if(d){d.removeClass("errorInput")}if(b){b.removeClass("errorLabel")}if(f){f.removeClass("errorLabel")}},showInfo:function(c,a){var b=a.getElement("span.error_msg");if(b){b.addClass("errorSpan");b.setContent(c).show()}},hideInfo:function(a){var b=a.getElement("span.error_msg");if(b){b.hide();b.removeClass("errorSpan")}},changeMetaDates:function(c,b){var a=ta.id("META_HAC_DATE_SELECTOR_imt");if(a){a.setStyle("display","block")}b.destroy()},hideMetaDates:function(){var a=document.getElement("#META_HAC_ROOM_LIST_INLINE .headerReplace");if(a){var b=document.getElement("#META_HAC_ROOM_LIST_INLINE .roomDisplayAndChange");b.innerHTML=a.innerHTML;a.destroy()}},chevronHover:function(f,c,b,d){if(c){b=b||"sprite-bookBtnOrangeIdleSmallOver";d=d||"sprite-bookBtnOrangeIdleSmall";var a=ta.id(c).getElement("."+d);if(a){a.removeClass(d);a.addClass(b)}}},chevronBlur:function(f,c,b,d){if(c){b=b||"sprite-bookBtnOrangeIdleSmallOver";d=d||"sprite-bookBtnOrangeIdleSmall";var a=ta.id(c).getElement("."+b);if(a){a.removeClass(b);a.addClass(d)}}},hoverTopOffer:function(){var a=document.getElement(".rgba_gray_arrow_up");if(a){a.removeClass("rgba_gray_arrow_up");a.addClass("rgba_yellow_arrow_up")}},blurTopOffer:function(){var a=document.getElement(".rgba_yellow_arrow_up");if(a){a.removeClass("rgba_yellow_arrow_up");a.addClass("rgba_gray_arrow_up")}},hoverBookBtn:function(a){var a=ta.id(a);if(a.hasClass("sprite-bookBtnOrangeIdle")){a.removeClass("sprite-bookBtnOrangeIdle");a.addClass("sprite-bookBtnOrangeOver")}if(a.hasClass("sprite-bookBtnGreyIdle")){a.removeClass("sprite-bookBtnGreyIdle");a.addClass("sprite-bookBtnGreyOver")}if(a.hasClass("sprite-bookIdle")){a.removeClass("sprite-bookIdle");a.addClass("sprite-bookOver")}if(a.hasClass("sprite-goIdle")){a.removeClass("sprite-goIdle");a.addClass("sprite-goOver")}if(a.hasClass("sprite-selectIdle")){a.removeClass("sprite-selectIdle");a.addClass("sprite-selectOver")}if(a.hasClass("sprite-bookSmallIdle")){a.removeClass("sprite-bookSmallIdle");a.addClass("sprite-bookSmallOver")}if(a.hasClass("sprite-goSmallIdle")){a.removeClass("sprite-goSmallIdle");a.addClass("sprite-goSmallOver")}if(a.hasClass("sprite-selectSmallIdle")){a.removeClass("sprite-selectSmallIdle");a.addClass("sprite-selectSmallOver")}if(a.hasClass("sprite-goBtnGrey")){a.removeClass("sprite-goBtnGrey");a.addClass("sprite-goBtnGreyOver")}if(a.hasClass("sprite-goBtnOrange")){a.removeClass("sprite-goBtnOrange");a.addClass("sprite-goBtnOrangeOver")}if(a.hasClass("sprite-chevronOrangeIdle35")){a.removeClass("sprite-chevronOrangeIdle35");a.addClass("sprite-chevronOrangeOver35")}if(a.hasClass("sprite-chevronGreyIdle27")){a.removeClass("sprite-chevronGreyIdle27");a.addClass("sprite-chevronGreyOver27")}if(a.hasClass("sprite-chevronIdle_ylw")){a.removeClass("sprite-chevronIdle_ylw");a.addClass("sprite-chevronHover_ylw")}},blurBookBtn:function(a){var a=ta.id(a);if(a.hasClass("sprite-bookBtnOrangeOver")){a.removeClass("sprite-bookBtnOrangeOver");a.addClass("sprite-bookBtnOrangeIdle")}if(a.hasClass("sprite-bookBtnGreyOver")){a.removeClass("sprite-bookBtnGreyOver");a.addClass("sprite-bookBtnGreyIdle")}if(a.hasClass("sprite-bookOver")){a.removeClass("sprite-bookOver");a.addClass("sprite-bookIdle")}if(a.hasClass("sprite-goOver")){a.removeClass("sprite-goOver");a.addClass("sprite-goIdle")}if(a.hasClass("sprite-selectOver")){a.removeClass("sprite-selectOver");a.addClass("sprite-selectIdle")}if(a.hasClass("sprite-bookSmallOver")){a.removeClass("sprite-bookSmallOver");a.addClass("sprite-bookSmallIdle")}if(a.hasClass("sprite-goSmallOver")){a.removeClass("sprite-goSmallOver");a.addClass("sprite-goSmallIdle")}if(a.hasClass("sprite-selectSmallOver")){a.removeClass("sprite-selectSmallOver");a.addClass("sprite-selectSmallIdle")}if(a.hasClass("sprite-goBtnGreyOver")){a.removeClass("sprite-goBtnGreyOver");a.addClass("sprite-goBtnGrey")}if(a.hasClass("sprite-goBtnOrangeOver")){a.removeClass("sprite-goBtnOrangeOver");a.addClass("sprite-goBtnOrange")}if(a.hasClass("sprite-chevronOrangeOver35")){a.removeClass("sprite-chevronOrangeOver35");a.addClass("sprite-chevronOrangeIdle35")}if(a.hasClass("sprite-chevronGreyOver27")){a.removeClass("sprite-chevronGreyOver27");a.addClass("sprite-chevronGreyIdle27")}if(a.hasClass("sprite-chevronHover_ylw")){a.removeClass("sprite-chevronHover_ylw");a.addClass("sprite-chevronIdle_ylw")}},hoverSmallBookBtn:function(b){var a=ta.id(b).getElement(".bookBtn");if(a==null){return}if(a.hasClass("sprite-bookBtnOrangeIdleSmall")){a.removeClass("sprite-bookBtnOrangeIdleSmall");a.addClass("sprite-bookBtnOrangeIdleSmallOver")}if(a.hasClass("sprite-bookSmallIdle")){a.removeClass("sprite-bookSmallIdle");a.addClass("sprite-bookSmallOver")}if(a.hasClass("sprite-goSmallIdle")){a.removeClass("sprite-goSmallIdle");a.addClass("sprite-goSmallOver")}if(a.hasClass("sprite-selectSmallIdle")){a.removeClass("sprite-selectSmallIdle");a.addClass("sprite-selectSmallOver")}},blurSmallBookBtn:function(b){var a=ta.id(b).getElement(".bookBtn");if(a==null){return}if(a.hasClass("sprite-bookBtnOrangeIdleSmallOver")){a.removeClass("sprite-bookBtnOrangeIdleSmallOver");a.addClass("sprite-bookBtnOrangeIdleSmall")}if(a.hasClass("sprite-bookSmallOver")){a.removeClass("sprite-bookSmallOver");a.addClass("sprite-bookSmallIdle")}if(a.hasClass("sprite-goSmallOver")){a.removeClass("sprite-goSmallOver");a.addClass("sprite-goSmallIdle")}if(a.hasClass("sprite-selectSmallOver")){a.removeClass("sprite-selectSmallOver");a.addClass("sprite-selectSmallIdle")}},providerHoverOn:function(b,j,h){var g=ta.id(b);g.addClass("partnerHvr");var a=g.getElement(".price_overlay");if(a){var f=g.getElement(".perNight");var d=f.getCoordinates().width+29;a.addClass("show");if(ta.util.i18n.isRtl()){a.setStyles({position:"absolute",left:d,zindex:"101"})}else{a.setStyles({position:"absolute",right:d,zindex:"101"})}}var c=b.getElement(".bookBtn");if(c){ta.commerce.meta.hoverBookBtn(c)}ta.store("meta.hoverProvider",j);ta.store("meta.hoverProviderPosn",h)},providerHoverOff:function(b,c){var f=ta.id(b);f.removeClass("partnerHvr");var a=f.getElement(".price_overlay");if(a){a.removeClass("show")}var d=b.getElement(".bookBtn");if(d){ta.commerce.meta.blurBookBtn(d)}ta.remove("meta.hoverProvider")},restoreProviderHover:function(){var a=ta.retrieve("meta.hoverProvider");var f=ta.retrieve("meta.hoverProviderPosn");if(a&&f){var d=ta.id("PROVIDER_BLOCK");if(d){var c=d.getElements(".metaProvider");var b=d.getElement(".provider_"+a);if(c&&b&&b.hasClass("order_"+f)){c.each(function(g){ta.commerce.meta.providerHoverOff(g)});ta.commerce.meta.providerHoverOn(b,a,f)}}}},updateNavArea:function(a){var b=ta.retrieve("ta.meta.navArea");if(!b||b.indexOf(a)<0){ta.store("ta.meta.navArea",a)}},getNavAreaContextFromDom:function(b,a){b=ta.id(b);if(b.getParent(".persistentCR")){return(a)?"|PCR":"PCR"}else{if(b.getParent(".photosOverlay")){return(a)?"|Photo_Lightbox":"Photo_Lightbox"}else{if(b.getParent(".amenities_lightbox")){return(a)?"|Amenities_Lightbox":"Amenities_Lightbox"}else{if(b.getParent("#CHECK_RATES_LB")){return(a)?"|Photo_LB":"Photo_LB"}else{return}}}}},updateNavAreaFromParts:function(b,a,c){b=b?b:"";a=a?a:"";c=c?c:"";var d=[b,a,c].join("|").replace("||","|").replace(/(\|$)/g,"");ta.commerce.meta.updateNavArea(d)},updateNavAreaMini:function(b,c,a){c=ta.id(c);var d=ta.commerce.meta.getNavAreaContextFromDom(c);d=d?"|"+d:"";ta.commerce.meta.updateNavAreaFromParts(b,d,a)},updateNavAreaMiniLPChevron:function(b){var d=document.getElementById("LOC_PHOTOS");var a=document.getElementById("AMENITY_LIGHTBOX");var c=document.getElementById("PERSISTENT_CHECK_RATES");if(d){ta.commerce.meta.updateNavArea(b+"|Photo_Lightbox|LP_Chevron")}else{if(a){ta.commerce.meta.updateNavArea(b+"|Amenities_Lightbox|LP_Chevron")}else{if(c){ta.commerce.meta.updateNavArea(b+"|PCR|LP_Chevron")}else{ta.commerce.meta.updateNavArea(b+"|LP_Chevron")}}}},loadBestPriceXsell:function(u,y,g,f){try{if(ta.retrieve("checkrates.one_second_xsell")!=true){return}var w=g&&g.isInline;var t=g&&g.isModalPrefetch;var q="";var h="";var z=false;var b=false;if(g&&g.isMetaLeaveBehind){z=true;q="leavebehind";if(g.openedVendors){h=g.openedVendors}}if(g&&g.isMetaLbV2){b=true;q="metalbv2";if(g.openedVendors){h=g.openedVendors}}var v=1000;var a="loadBestPriceXsell_numTries";var k="loadBestPriceXsell_curCancelKey";if(w){a="loadBestPriceXsellInline_numTries";k="loadBestPriceXsellInline_curCancelKey"}var D="meta.xsellTravelData";if(w){D="meta.xsellTravelDataInline"}var l=ta.retrieve(D);if(f==null){f=new Date().getTime();ta.store(a,0);l=ta.commerce.checkrates.getTravelDataFromDOM();ta.store(D,l);var m=ta.id(y);if(m&&!z&&!b){m.innerHTML="";m.setStyle("height",0);m.setStyle("opacity","0");var s=ta.retrieve("metaCheckRatesOverlay");s=ta.id(s);if(!w&&s&&s.container&&s.container.getPosition){window.scrollTo(0,s.container.getPosition().y)}}if(w){ta.store("stateoptModal.prefetch",false);ta.commerce.meta.metaInYourMeta_resetInline()}else{ta.commerce.meta.metaInYourMeta_resetLB()}}var j="loadBestPriceXsell_"+f+"_cancel";if(w){j="loadBestPriceXsellInline_"+f+"_cancel"}if(ta.retrieve(j)){return}if(ta.has(k)){var C=ta.retrieve(k);if(C!=j){ta.store(C,true)}}if(!ta.has(j)){ta.store(j,false);ta.store(k,j)}var o=ta.retrieve(a);var F=o+1;ta.store(a,F);if(!l||!l.adults||!l.inDay||!l.outDay||!l.sInMonthYear||!l.sOutMonthYear){return}var E="";if(typeof(pageServlet)!=undefined&&pageServlet){E=pageServlet}var p={detail:u,adults:l.adults,inMonth:l.sInMonthYear[0]+" "+l.sInMonthYear[1],inDay:l.inDay,outMonth:l.sOutMonthYear[0]+" "+l.sOutMonthYear[1],outDay:l.outDay,"try":ta.retrieve(a),reqNum:g.secondTry?"2":"1",type:q,isInlineRequest:w?"1":"0",openedVendors:h,origServlet:E};var d=Object.toQueryString(p);if(!d||!d.trim()){ta.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell  - toQueryString failure",null,p);return}var c=ta.retrieve("ta.meta.navArea");var r;try{r=ta.commerce.meta.tracking.setTimingForNavArea(c)}catch(B){ta.util.error.record(B,"problem locking timing in ta.commerce.meta.loadBestPriceXsell")}if(r){p.metaRequestTiming=r}if(ta.commerce.meta.tracking.hasAnySuppressedAreas()){var A=ta.commerce.meta.tracking.getSuppressedAreasAsString();if(A){p.suppressImpressionsOnComplete=A}}if(t){ta.store("modalPrefetchOutstanding",true)}new Request({url:"/MetaBestPriceCrossSellAjax?"+d,evalScripts:true,onSuccess:function(I,K){if(t){ta.store("modalPrefetchOutstanding",false)}if(ta.retrieve(j)){return}var H=I.contains("xsellHacStatusReady")||I.contains("xsellHacStatusSOL")||g.secondTry;if(z||b){H=H&&(I.contains("hacComplete")||g.secondTry)}if(!H){setTimeout(function(){XsellOptions={secondTry:true,xsell:true,isInline:w,isMetaLeaveBehind:z,isModalPrefetch:t,isHrRedesignTest:false,isMetaLbV2:b,openedVendors:h};ta.commerce.meta.loadBestPriceXsell(u,y,XsellOptions,f)},v)}else{var J=ta.id(y);if(J){if(z||b){J.setStyle("height",311);J.setStyle("overflow","hidden")}else{if(!t){J.setStyle("height",0);J.setStyle("opacity","0")}}J.innerHTML=I;if(z||b){var G=ta.retrieve("metaLeaveBehindOverlay");if(G&&!ta.id("META_PRICE_XSELL")&&!ta.id("MAYBE_BUTTONS")&&!ta.id("META_PRICE_XSELL_NOT_AVAIL")){G.fireEvent("onClose",G);G.hide()}else{var L=ta.id("META_LEAVE_BEHIND");if(!L){L=ta.id("META_LEAVE_BEHIND_NOT_AVAIL")}ta.commerce.meta.revealBestPriceXsell(J,L,w,(z|b))}}else{ta.commerce.meta.metaInYourMeta(y,{xsell:true,inline:w,isModalPrefetch:t})}}ta.store(a,0)}},onFailure:function(){ta.store(a,0);if(t){ta.store("modalPrefetchOutstanding",false)}ta.util.error.record(null,"ta.commerce.meta.loadBestPriceXsell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(B){ta.util.error.record(B,"ta.commerce.meta.loadBestPriceXsell")}},loadGeoCrAutoBroadenContents:function(g,j){var q=5;var f=1000;var d=3;var c="QC_Meta_Mini|GeoCheckRatesLightBox";try{var a=function(){k=false};var o=function(){g.fireEvent("close",g);g.hide()};var k=true;var m=ta.id(g.inner);if(!m){throw new Exception("Cannot find parent: "+g)}var r=ta.commerce.meta.tracking.setTimingForNavArea(c);g.addEvent("close",a);var p={d:j,area:c,metaRequestTiming:r};var h=0;var b=function(){if(!k){return}++h;p.attempt=h;new Request({url:"/GeoCrAutoBroadenAjax",data:p,method:"get",evalScripts:true,onSuccess:function(s,v){try{if(!k){return}var t=Elements.from(s,true);var u=t.getElement(".progress").filter(function(z){return z})[0];if(!u){ta.util.error.record(null,"geo check rate malform response missing progress",null,p);o()}else{if(/\btourismUrl-(\S+)\b/.exec(u.className)){var w=RegExp.$1;ta.setEvtCookie("GeoCheckRatesLightBox","unload","Redirect",0,"/Tourism");document.location.href=w}else{m.setStyles({overflow:"hidden",height:520});m.innerHTML="";m.adopt(t);if(!u.hasClass("isHacComplete")&&h<q){setTimeout(b,f)}}}}catch(y){ta.util.error.record(y,"cannot process geo check rate response",null,p);o()}},onFailure:function(){ta.util.error.record(null,"geo check rate request failed",null,p);o()}}).send()};b()}catch(l){ta.util.error.record(l,"cannot send geo check rate initial request");if(o){o()}}},xSellResponses:{lb_hac:false,lb_xsell:false,inline_hac:false,inline_xsell:false},metaInYourMeta_resetLB:function(){ta.commerce.meta.xSellResponses.lb_hac=false;ta.commerce.meta.xSellResponses.lb_xsell=false},metaInYourMeta_resetInline:function(){ta.commerce.meta.xSellResponses.inline_hac=false;ta.commerce.meta.xSellResponses.inline_xsell=false},hacIsBlockingXSell:function(a){var b=ta.commerce.meta.xSellResponses;if(a){return b.inline_xsell}else{return b.lb_xsell}},metaInYourMeta_renderToDiv:function(f,c,o){if(ta.retrieve("stateopt_modal_test")){o=true}var m="STATE_OPT_RESPONSE";var j="MAYBE_BUTTONS";var h="MAYBE_ROWS";var k="CHANGE_DATES";if(c){m+="_INLINE";j+="_INLINE";h+="_INLINE";k+="_INLINE"}var g=ta.id(f);var d=ta.id(m);var b=ta.id(j);var a=ta.id(h);var l=ta.id(k);if(!g||!l||!d){ta.util.error.record(null,"One or more State Opt LB elements is null");return}l.dispose();if(!o&&a){d.getElement(".stepIdentifier").innerHTML="2";a.dispose();a.inject(g.getElement(".noavailHeader"),"after");a.removeClass("hidden")}else{if(b){b.dispose();b.inject(g,"bottom");b.removeClass("hidden")}else{l.getElement(".stepIdentifier").innerHTML="2"}}l.inject(g,"bottom");l.removeClass("hidden")},metaInYourMeta:function(f,q){var c=q&&q.inline;var l=q&&q.isModalPrefetch;var b=q&&q.xsell;var j=ta.commerce.meta.xSellResponses;if(c){if(b){j.inline_xsell=true}else{j.inline_hac=true}}else{if(b){j.lb_xsell=true}else{j.lb_hac=true}}if((c&&j.inline_xsell&&j.inline_hac)||(!c&&j.lb_xsell&&j.lb_hac)||l){var o=ta.id("META_PRICE_XSELL");var m=ta.id("STATE_OPT_RESPONSE");if(c){o=ta.id("META_PRICE_XSELL_INLINE");m=ta.id("STATE_OPT_RESPONSE_INLINE")}if(o&&o.hasClass&&!o.hasClass("hidden")){return}if(m&&m.hasClass&&!m.hasClass("hidden")){return}var p=o;var d=false;var h=ta.commerce.checkrates.getMetaPricesCount(c);if(h==null){h=0}if(h<1&&m){p=m;d="metaCheckRatesUpdateDiv";if(c){d="metaCheckRatesUpdateDivInline"}}var k=ta.id(f);if(k){if(p){ta.commerce.meta.revealBestPriceXsell(k,p,c,false,d,l)}else{var a="lA";if(c){a=a+"_Inline"}var g=ta.id(a);if(g&&g.removeClass){g.removeClass("hidden")}}}}},revealBestPriceXsell:function(a,d,p,s,j,m){if(a){a=ta.id(a)}if(d){d=ta.id(d)}if(!a||!d){ta.util.error.record(null,"revealBestPriceXsell - required elements missing");return}if(d.removeClass){d.removeClass("hidden")}var o=new Fx.Tween(a,{property:"opacity"});if(s){var t=ta.retrieve("metaLeaveBehindOverlay");if(t&&t.container){var q=t.container;if(q.hasClass&&q.hasClass("hidden")&&q.removeClass){q.removeClass("hidden")}ta.commerce.checkrates.removePCR()}}else{var l="META_MINI_META_MAYBE";if(p){l="META_MINI_META_MAYBE_INLINE"}var b=ta.id(l);var f=true;if(b){f=false}if(j){ta.commerce.meta.metaInYourMeta_renderToDiv(d,p,f)}if(!m){var r="Displayed_Lightbox";if(p){r="Displayed_Inline"}var c=d.getElements(".hotelListing").length;if(c==0){c="0";r="Not_"+r}ta.trackEventOnPage("Meta_State-Optimized_XSell",r,c)}}var h=d.getSize().y;var g=new Fx.Tween(a,{property:"height",onComplete:function(){if(!s){o.start(0,1)}}});if(j&&ta.has(j)){var k=ta.id(ta.retrieve(j));if(k&&k.addClass){k.addClass("hidden")}}if(m){ta.commerce.meta.openStateoptModal("prefetch")}g.start(h);var u=ta.retrieve("metaCheckRatesOverlay");if(u&&u.container&&u.closeBtn&&ta.id(window).getScroll().y>u.container.getPosition().y){u.closeBtn.scrollIntoView()}},openStateoptModal:function(b,g){try{if(!b){b="click"}ta.store("stateoptModal."+b,true);var a=ta.retrieve("stateoptModal.prefetch");var f=ta.retrieve("stateoptModal.click");if(a&&f){var d=ta.id("MetaRatesContent");if(d&&d.innerHTML){if(!ta.has("metaCheckRatesCSS")){ta.store("metaCheckRatesCSS",new Asset.css(metaCheckRatesCSS))}ta.commerce.meta.toggleTab(ta.id("ReviewsTab"));ta.run("ta.overlays.Factory.precookedMetaLB",{},d);ta.store("stateoptModal.click",false)}else{ta.util.error.record(null,"openStateoptModal - missing MetaRatesContent")}}else{if(f&&!a&&!ta.retrieve("modalPrefetchOutstanding")){if(g){ta.commerce.meta.loadBestPriceXsell(g,"REC_CONT_INLINE",{xsell:true,isInline:true,isModalPrefetch:true})}else{ta.util.error.record(null,"openStateoptModal - missing locId")}}}}catch(c){ta.util.error.record(c,"openStateoptModal")}},closeStateoptModal:function(){var a=document.getElement(".stateoptModal .roundOuterClose");if(a){if(ta.id("MetaPricesTab")){ta.commerce.meta.toggleTab(ta.id("MetaPricesTab"))}a.click()}},replaceAFWithMetaAF:function(d){try{ta.store("checkrates.meta_progressive_avaf_executed",true);var b=new Element("div",{styles:{},html:d});b.inject(document.body);var g=b.getElementById("PROGRESSIVE_META");if(g){var c=g.getElements(".prog");if(!c){return}var a=ta.id("ALSO_VIEWED_LIST");if(!a){return}a.removeClass("oldVer");a.addClass("metaMicro");c.each(function(k,j){var l=k.id.match(/avaf_meta_id_(\d+)/)[1];var h=ta.id("avaf_id_"+l);if(h){k.clone(true,true).replaces(h)}});b.dispose()}}catch(f){ta.util.error.record(f,"ta.commerce.meta.replaceAFWithMetaAF")}},loadMetaAF:function(f,g,h){try{if(ta.retrieve("checkrates.meta_af")!=true){return}var c="meta_af_last_request";var b=new Date().getTime();ta.store(c,b);var d=1000;var l=ta.commerce.checkrates.getTravelDataFromDOM();if(!l||!l.adults||!l.inDay||!l.outDay||!l.sInMonthYear||!l.sOutMonthYear){return}var k={detail:f,adults:l.adults,inMonth:l.sInMonthYear[0]+" "+l.sInMonthYear[1],inDay:l.inDay,outMonth:l.sOutMonthYear[0]+" "+l.sOutMonthYear[1],outDay:l.outDay,reqNum:h?"2":"1",type:"af"};var a=Object.toQueryString(k);if(!a||!a.trim()){ta.util.error.record(null,"ta.commerce.meta.loadMetaAF - toQueryString failure",null,k);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:k,evalScripts:true,onSuccess:function(r,u){if(ta.retrieve(c)!=b){return}var q=r.contains("xsellHacStatusReady")||r.contains("xsellHacStatusSOL")||h;if(!q){setTimeout(function(){ta.commerce.meta.loadMetaAF(f,g,true)},d)}else{if(ta.has("checkrates.meta_progressive_avaf")&&!ta.has("checkrates.meta_progressive_avaf_executed")){ta.commerce.meta.replaceAFWithMetaAF(r)}else{var t=ta.id(g);if(t){t.setStyle("height",0);t.setStyle("opacity","0");t.innerHTML=r;ta.commerce.checkrates.avafInit();var p=ta.id("ALSO_VIEWED_LIST");if(p){var s=new Fx.Tween(t,{property:"opacity"});var m=p.getSize().y;var o=new Fx.Tween(t,{property:"height",onComplete:function(){t.setStyle("height","auto");s.start(0,1)}});o.start(0,m)}}}if(ta.retrieve("reposition_avaf_gutter")){ta.commerce.meta.repositionGutter()}}},onFailure:function(){ta.util.error.record(null,"ta.commerce.meta.loadMetaAF - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(j){ta.util.error.record(j,"ta.commerce.meta.loadMetaAF")}},updateProvAreaFromLightBox:function(f){var b=ta.retrieve("meta.baseLocationId");if(b&&f==b){var d=ta.retrieve("meta.postShowMetaCR");var c=ta.retrieve("meta.postShowMetaCRLB");var a=ta.retrieve("meta.postShowMetaCRLBPCR");if(d&&c&&a){ta.commerce.meta.updateProvArea(d,c,a);return}}if(ta.widgets.calendar.datesExist()){ta.commerce.checkrates.checkRatesMiniMeta(null,document.getElementById("CHECK_RATE"),b,"checkrates")}},updateProvArea:function(k,p,o){if(p&&p.hasClass("hidden")){p.removeClass("hidden")}if(o&&o.hasClass("hidden")){o.removeClass("hidden")}var f=document.getElement("#CHECK_RATES_CONT.chkRates");var c=document.getElement("#LOC_PHOTOS .chkRates");var g=document.getElement("#AMENITY_LIGHTBOX .chkRates");var h=ta.retrieve("pcr.overlay");var b=document.getElement("#CHECK_RATES_LB .chkRates");var m=document.getElement(".similarCarousel");var l=document.getElement(".premiumTimeout");if(m&&l){var a=f.getElement("div.bc_text_content");if(a){var d=k.getChildren()[1];if(d){var j=d.clone(false);j.innerHTML=d.innerHTML;a.innerHTML="";a.adopt(j)}}}else{ta.commerce.meta.updateCRAreaWithProperMiniMeta(f,k)}ta.commerce.meta.updateCRAreaWithProperMiniMeta(c,o);ta.commerce.meta.updateCRAreaWithProperMiniMeta(g,o);ta.commerce.meta.updateCRAreaWithProperMiniMeta(b,p);ta.commerce.meta.updatePCRAreaWithMiniMeta(h,o);if(ta.has("meta.isHackathonBC")){ta.commerce.meta.alignPriceBlocks();if(ta.has("meta.bc.isRevisedUnavailability")){ta.commerce.meta.truncateProviderNames()}}if(k&&k.getElement(".hacMiniComplete")){ta.commerce.meta.fireGAEvent(k)}},updatePCRAreaWithMiniMeta:function(c,a){if(a==null||c==null){return}var g=c.inner;if(!g){return}ta.commerce.meta.suppressCRArea(g);var d=g.getElement(".postShowMetaCRLBPCR");if(d!=null){d.destroy()}var f=g.getElement("fieldset.miniMetaContainer");var b=a.getElement(".disclaimer");if(b!=null){b.destroy()}ta.commerce.meta.adoptMiniMetaElem(f,a);if(!ta.widgets.calendar.datesInRange()){ta.commerce.meta.showCRArea(g)}},adoptMiniMetaElem:function(c,a){if(c!=null&&(ta.widgets.calendar.datesInRange()||ta.id("COMHVY"))){var d=c.getElement(".disclaimer");if(d!=null&&!d.getParentBySelector("#hover_table_display_area")){d.destroy()}var b=a.clone(false);b.innerHTML=a.innerHTML;c.adopt(b)}else{if(!ta.widgets.calendar.datesInRange()){ta.commerce.meta.showCRArea(c)}}},updateCRAreaWithProperMiniMeta:function(f,a){if(a==null||f==null){}else{ta.commerce.meta.suppressCRArea(f);var b=f.getElement(".metaDatesNotChosen");var d=f.getElement(".metaDatesChosen");if(d&&ta.retrieve("meta.bc.show_title")){if(b){b.addClass("miniMetaHideHdr");b.removeClass("miniMetaShowHdr")}d.addClass("miniMetaShowHdr");d.removeClass("miniMetaHideHdr")}var c=f.getElement(".postShowMetaCR");if(c!=null){c.destroy()}var c=f.getElement(".postShowMetaCRLB");if(c!=null){c.destroy()}var c=f.getElement(".postShowMetaCRLBPCR");if(c!=null){c.destroy()}var g=f.getElement("fieldset");ta.commerce.meta.adoptMiniMetaElem(g,a)}},fireGAEvent:function(d){var a=ta.retrieve("meta.chevronTracking");var c=ta.retrieve("meta.chevronAction");var b=ta.retrieve("meta.chevronLabel");if(a&&c){if(!b){ta.trackEventOnPage(a,c)}else{ta.trackEventOnPage(a,c,b)}}ta.remove("meta.chevronTracking");ta.remove("meta.chevronAction");ta.remove("meta.chevronLabel")},miniMetaAjaxNoTimer:function(a,b){return ta.commerce.meta.miniMetaAjax(a,b,1000)},miniMetaAjax:function(c,f,a){if(c!=null){var g=c.getElement(".hacMiniComplete");if(g!=null){return}}if(f==null){}else{var d=f.getVendorSet().getCheckedContentID();var b=f.getVendorSet().getCheckedVendor();ta.store("ta.commerce.MetaHacOverlay.crData."+f.vendorSetId,f);ta.commerce.checkrates.miniMetaHacRequest(f,d,b)}},suppressCRArea:function(a){var b=a.getElements(".miniMetaShow");Array.each(b,function(c){c.removeClass("miniMetaShow");c.addClass("miniMetaHide");if(ta.id("PERSISTENT_CHECK_RATES_WRAP")&&(ta.retrieve("pcr_redesign_v1")||ta.retrieve("pcr_redesign_v2"))){ta.id("PERSISTENT_CHECK_RATES_WRAP").getElement(".miniMeta").addClass("miniMetaHide")}})},showCRArea:function(a){var c=a.getElement(".postShowMetaCR");if(c!=null){c.destroy()}var b=a.getElements(".miniMetaHide");Array.each(b,function(d){d.removeClass("miniMetaHide");d.addClass("miniMetaShow")})},showCurrencyPicker:function(c,b){var a=document.getElement(".currencies");if(a){c.stop();a.show();document.addEvent("click",ta.commerce.meta.closeCurrencyPicker)}},closeCurrencyPicker:function(b){var a=document.getElement(".currencies");if(a&&!a.containsEvent(b)){b.stop();a.hide();document.removeEvent("click",ta.commerce.meta.closeCurrencyPicker)}},selectCurrency:function(b,d,o,a){try{ta.commerce.meta.clearStoredMiniData();var k=ta.id(b.target);if(!a){if(k&&b.type){if(b.type==="click"){a=k.get("text");var j=k.getParent();if(j){j.hide()}}else{if(b.type==="change"){a=k.value}}}}if(a.test(/[A-Z]{3}/)){ta.store("ta.commerce.MetaHacOverlay.currency",a);new Request({url:"/ActionRecord?action=MetaCurrencyPicker"}).send();ta.trackEventOnPage("MetaCurrencyPicker","selected",a,1);var h=ta.retrieve("ta.commerce.MetaHacOverlay.crData."+o);if(!h){return}if(ta.has("checkrates.meta_ui_sk_box")||ta.has("checkrates.meta_ui_sk_box_v3")){var c=ta.id("PROVIDER_BLOCK");if(!c){c=ta.id("PROVIDER_BLOCK_INLINE")}if(!c){return}var m=c.get("html");var g='<img class="provLoading" src="'+CDNHOST+'/img2/meta_sprites/loadingAnim.gif">';c.getElements(".rightBox").each(function(q){q.setContent(g)});var f=h.getVendorSet().getAllVendorIds();var p=h.getVendorSet().getCheckedVendor();new Request({url:ta.commerce.checkrates.buildMetaHacUrl(h,f,p,true),onSuccess:function(q){c.setContent(q);ta.commerce.meta.storeMiniData(c);if(c.id=="PROVIDER_BLOCK_INLINE"){ta.commerce.meta.updateProvAreaFromLightBox(h.vendorSetId)}if(ta.retrieve("hotels.redesignEnabled")){ta.store("hotels.datesChanged",true)}var r=document.getElement(".selectedCurrency");if(r){r.set("text",a)}},onFailure:function(){c.setContent(m)}}).send()}else{if(ta.id("META_UI_AVAIL_SECTIONS")){ta.commerce.checkrates.displayVendors(h)}}}}catch(l){ta.util.error.record(null,"ta.commerce.meta.selectedCurrency")}},tryAnotherHotelClick:function(){var a=document.getElement(".metaCheckRatesOverlay .roundOuterClose");if(a){a.click()}},clearStoredMiniData:function(){if(ta.retrieve("checkrates.meta_ui_post_click_prices")){ta.store("meta.postShowMetaCRLBPCR",null);ta.store("meta.postShowMetaCR",null);ta.store("meta.postShowMetaCRLB",null)}},storeMiniData:function(b){if(ta.retrieve("checkrates.meta_ui_post_click_prices")){var d=b.getElement(".postShowMetaCR");var a=b.getElement(".postShowMetaCRLBPCR");var c=b.getElement(".postShowMetaCRLB");if(d&&c&&a){ta.store("meta.postShowMetaCRLBPCR",a);ta.store("meta.postShowMetaCR",d);ta.store("meta.postShowMetaCRLB",c)}}},prePriceProviderClicked:function(a){if(a){ta.trackEventOnPage("DATEPICKER","OPEN","provider_link",a);ta.store("meta.datepicker_tracked",true)}},providerButtonClicked:function(a){if(a&&!ta.has("hotels.hasTimeoutDates")){ta.trackEventOnPage("DATEPICKER","OPEN","provider_logo",a);ta.store("meta.datepicker_tracked",true)}},moreSitesLinkClicked:function(a){if(a&&!ta.has("hotels.hasTimeoutDates")){ta.trackEventOnPage("DATEPICKER","OPEN","more_sites_link",a);ta.store("meta.datepicker_tracked",true)}},buildMetaHacParamObj:function(){var b={};try{var a=document.getElement("#HAC_FORM input[name=geo]");if(a&&a.value){b.geo=a.value}if(!b.geo){var h=document.getElement("#SEARCH_LHN input[name=geo]");if(h){b.geo=h.value}}var j=document.getElementById("searchAll");if(j&&j.value!="true"){var f=ta.widgets.calendar.getPageInDate();if(f){b.inDay=f.getDate();b.inMonth=(f.getMonth()+1)+"/"+f.getFullYear()}var d=ta.widgets.calendar.getPageOutDate();if(d){b.outDay=d.getDate();b.outMonth=(d.getMonth()+1)+"/"+d.getFullYear()}var c=ta.widgets.calendar.getPageAdultsCount();if(c!=2){b.adults=c}b.searchAll="false"}}catch(g){ta.util.error.record(g,"buildHACUrlParams")}return Object.toQueryString(b)},getHACCategory:function(){var b=document.getElements(".tab.selected");var c="1";if(b&&b.length&&b.length>0){var a=b[0].className.match(/cat_(\d+)/);if(a){c=a[1]}}return c},buildHACSearchData:function(){var d=ta.widgets.calendar.getPageInDate();var j=ta.widgets.calendar.getPageOutDate();var k=ta.widgets.calendar.getPageAdultsCount();var h=document.getElementsByName("geo")[0].value;var c=false;var l=ta.commerce.meta._padZero;var g=d?l(d.getDate()):null;var b=j?l(j.getDate()):null;var f=d?l(d.getMonth()+1)+"/"+d.getFullYear():null;var m=j?l(j.getMonth()+1)+"/"+j.getFullYear():null;var a={};a.adults=k;a.geo=h;a.searchAll=c;a.inDateOfMonth=g;a.outDateOfMonth=b;a.inMonthYear=f;a.outMonthYear=m;a.category=ta.commerce.meta.getHACCategory();return a},buildMetaHACUrl:function(){var a=ta.commerce.meta.buildHACSearchData();var b="/HACSearch?adults="+a.adults+"&geo="+a.geo+"&searchAll="+a.searchAll;if(a.category){b=b+"&cat="+a.category}if(a.inDateOfMonth){b=b+"&inDay="+a.inDateOfMonth}if(a.outDateOfMonth){b=b+"&outDay="+a.outDateOfMonth}if(a.inMonthYear){b=b+"&inMonth="+a.inMonthYear}if(a.outMonthYear){b=b+"&outMonth="+a.outMonthYear}var c=b+window.location.hash;return c},redirectHACSearch:function(){ta.setEvtCookie("Mini_meta_LP_chevron_display","Clicked","Unavailable","","/HACSearch");window.location=ta.commerce.meta.buildMetaHACUrl()},_padZero:function(a){return String("0"+a).slice(-2)},anchorToOpenTab:function(){if(ta.id("ReviewsTab").hasClass("selected")){ta.commerce.meta.scrollToReviews()}else{if(ta.id("MetaPricesTab").hasClass("selected")){var a=ta.id("ReviewsTab");a.click();ta.commerce.meta.scrollToReviews()}}},scrollToReviews:function(){var a=ta.id("REVIEWS");if(a!=null){a.scrollIntoView(true)}else{ta.util.error.record(null,"couldnt find reviews element on page!")}},getTravelInfo:function(){try{var b=ta.widgets.calendar.getPageInDate();var f=ta.widgets.calendar.getPageOutDate();var j=b.getDate();var k=b.getMonth()+1;var h=b.getFullYear();var c=f.getDate();var g=f.getMonth()+1;var a=f.getFullYear()}catch(d){ta.util.error.record(d,"no travel info")}},multiLocMicroMetaReq:function(t,j){var f="multiLocMicroMetaReq_curCancelKey";var a=13;if(!ta.widgets.calendar.hasPageDates()){return}t=t||new Date().getTime();var g="multiLocMicroMetaReq_"+t+"_cancel";var r=true;if(j==null){r=false;j=1;ta.commerce.meta._clearMultiLocMicroMetaPrices()}else{if(ta.retrieve(g)==true){return}}if(ta.has(f)){var v=ta.retrieve(f);if(v!=g){ta.store(v,true);ta.commerce.meta.polling.removePollingInfoForRequest(v)}}if(!ta.has(g)){ta.store(g,false);ta.store(f,g)}var s=$$("#HACKATHON_RELATED_HOTELS .show_flyout");if(!s){return}var o=[];var k={};s.each(function(y){var z=y.get("data-locid");o.push(z);k[z]=y});var u=ta.widgets.calendar.getPageInDate();var w=ta.widgets.calendar.getPageOutDate();var d=u.getDate();var l=u.getMonth()+1;var p=u.getFullYear();var b=w.getDate();var h=w.getMonth()+1;var q=w.getFullYear();var c=o.join(" ");var m={inDay:d,inMonth:l,inYear:p,outDay:b,outMonth:h,outYear:q,locations:c,finalRequest:r};if(!ta.commerce.meta.polling.isRequestBeingPolled(g)){ta.commerce.meta.polling.setPollingAttemptForRequest(g,0)}new Request({url:"/MultiLocMicroMetaAjax",data:m,onSuccess:function(A,B){if(ta.retrieve(g)==true){return}if(A.contains("hac_complete")){ta.commerce.meta.polling.removePollingInfoForRequest(g);var z=new Element("div");z.innerHTML=A;var y=z.getElements(".prices");y.each(function(F){var G=F.get("data-locid");var C=k[G];if(C){var E=C.getElement(".pricesOuter");var D=E.getElement(".prices");if(D){F.replaces(D)}else{F.inject(E)}}})}else{if(j<a){ta.commerce.meta.polling.incrementPollingAttemptForRequest(g);setTimeout(function(){ta.commerce.meta.multiLocMicroMetaReq(t,j+1)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(g))}}}}).send()},_clearMultiLocMicroMetaPrices:function(){var a=$$("#HACKATHON_RELATED_HOTELS .show_flyout");if(!a){return}a.each(function(b){var c=b.getElement(".pricesOuter").innerHTML=""})},loadMiniMetaCrossSell:function(h,j,k,d){try{if(!(ta.isMetaHotelMBP2013()||ta.isStateOptMiniMeta()||ta.has("metaUI.hrTestComHvy"))){return}var a=ta.id(j);if(!a){return}a.empty();a.addClass("spinner");var f="meta_cs_last_request";var c=new Date().getTime();ta.store(f,c);var g=1000;var o=ta.commerce.checkrates.getTravelDataFromDOM();if(!o||!o.adults||!o.inDay||!o.outDay||!o.sInMonthYear||!o.sOutMonthYear){return}var m={detail:h,adults:o.adults,inMonth:o.sInMonthYear[0]+" "+o.sInMonthYear[1],inDay:o.inDay,outMonth:o.sOutMonthYear[0]+" "+o.sOutMonthYear[1],outDay:o.outDay,reqNum:k?"2":"1",type:"mmcs"};if(ta.isStateOptMiniMeta()){m.type="mini_meta_state_opt"}if(ta.has("metaUI.hrTestComHvy")){m.type="af_hr_test"}var b=Object.toQueryString(m);if(!b||!b.trim()){ta.util.error.record(null,"ta.commerce.meta.loadMiniMetaCrossSell - toQueryString failure",null,m);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:m,evalScripts:true,onSuccess:function(t,v){if(ta.retrieve(f)!=c){return}var r=t.contains("xsellHacStatusReady")||t.contains("xsellHacStatusSOL")||k;if(!r){setTimeout(function(){ta.commerce.meta.loadMiniMetaCrossSell(h,j,true,true)},g);return}else{d=true;var u=ta.id(j);if(u){u.innerHTML=t;u.removeClass("spinner")}}if(d){if(ta.isStateOptMiniMeta()){ta.commerce.meta.showMiniMetaCrossSellCarousel("MMXS_LIST",t)}else{if(ta.has("metaUI.hrTestComHvy")){var q="AV_TGT";var w=ta.id(q);if(w){w.setStyle("height",0);w.setStyle("opacity","0");w.removeClass("hidden");var p=new Fx.Tween(q,{property:"opacity"});var s=new Fx.Tween(q,{property:"height",onComplete:function(){p.start(0,1)}});s.start()}}else{ta.commerce.meta.showMiniMetaCrossSell("MINI_META_CROSS_SELL_NOCOMM")}}}},onFailure:function(){ta.util.error.record(null,"ta.commerce.meta.loadMiniMetaCrossSell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(l){ta.util.error.record(l,"ta.commerce.meta.loadMiniMetaCrossSell")}},showMiniMetaCrossSellCarousel:function(a,f){if(!f.contains(a)){var d=ta.id("MMSO_SEE_ALL");if(d){d.show()}ta.commerce.meta.trackMiniMetaStateOpt("alt_accom_not_shown");return}var c=document.getElement(".sidebar #AV_ABOVE_FOLD_META");if(c){ta.store("metaUI.hiddenAV",c);c.addClass("hidden")}if(!ta.has("metaUI.aniCarouselJS")){new Asset.javascript(jsAniCarouselAsset);ta.store("metaUI.aniCarouselJS",true)}var g=ta.id(a);if(g){var b=new Fx.Morph(g,{duration:300,wait:true});(function(){window.mmxsGallery=new ta.widgets.AniCarousel({listId:a,animation:b,ctrlsElem:ta.id("CAR_CTRLS"),trackingInfo:{Category:"Mini_meta_State-Optimized",Action:"cross-sell_arrow_clicked"}})}).delay(1000)}ta.commerce.meta.trackMiniMetaStateOpt("alt_accom_displayed")},showMiniMetaCrossSell:function(a){try{var c=ta.id("MINI_META_CROSS_SELL");if(c){c.removeClass("hidden")}var f=ta.id(a);if(f){f.removeClass("hidden")}var b=ta.select(".postShowMetaCR");if(b){b.each(function(g){g.addClass("hidden")})}}catch(d){ta.util.error.record(d,"ta.commerce.meta.showMiniMetaCrossSell")}},hideMiniMetaCrossSell:function(a){try{var c=ta.id("MINI_META_CROSS_SELL");if(c){c.addClass("hidden")}var f=ta.id(a);if(f){f.addClass("hidden")}var b=ta.select(".postShowMetaCR");if(b){b.each(function(g){g.removeClass("hidden")})}}catch(d){ta.util.error.record(d,"ta.commerce.meta.hideMiniMetaCrossSell")}},setupPhotoFlyoutEvents:function(b){if(typeof(b)=="undefined"){return}try{var a=ta.id(b);if(a&&!ta.has("tablet.meta_mbp")){a.addEvent("mouseenter",ta.commerce.meta.showMBPPhotoFlyout);a.addEvent("mouseleave",ta.commerce.meta.hideMBPPhotoFlyout)}}catch(c){ta.util.error.record(c,"ta.commerce.meta.setupPhotoFlyoutEvents")}},showMBPPhotoFlyout:function(){try{ta.store("showMBPPhotoFlyout.displaying",true);if(ta.has("showMBPPhotoFlyout.displayed")&&ta.retrieve("showMBPPhotoFlyout.displayed")==true){return}var j=ta.id("TOP_V_COMM_INFO");var c=ta.id("TOP_V_COMM_TAGLINE");var m=ta.id("TOP_V_COMM_ACCOMM_ID");var l=ta.id("TOP_V_COMM_CONT_ID");var f=ta.id("TOP_V_COMM_DETAILS");if(j&&c&&m&&l&&f){var d=ta.id("COMMERCE_FLYOUT");if(d){d.empty();var g=j.get("text")+" "+c.get("text");var b=new Element("div",{html:"<strong>"+j.get("text")+"</strong>","class":"ppn"});var a=new Element("div",{html:"<span>"+c.get("text")+" "+f.get("text")+"</span>","class":"tagline"});d.adopt(b);d.adopt(a);d.removeEvents("click");d.addEvent("click",function(o){ta.commerce.meta.updateNavArea("QC_Meta_Mini|Photo_Flyout")});d.addEvent("click",function(o){ta.call("ta.commerce.checkrates.openMetaProvider",o,this,m.get("text").toInt(),l.get("text").toInt())});var k=new Fx.Tween(d,{property:"right",duration:"short",onComplete:function(){ta.store("showMBPPhotoFlyout.displayed",true)}});(function(){if(ta.has("showMBPPhotoFlyout.displaying")&&ta.retrieve("showMBPPhotoFlyout.displaying")==true){k.start(-220,0)}}).delay(300)}}}catch(h){ta.util.error.record(h,"ta.commerce.meta.showMBPhotoFlyout")}},hideMBPPhotoFlyout:function(){try{ta.store("showMBPPhotoFlyout.displaying",false);if(!ta.has("showMBPPhotoFlyout.displayed")||ta.retrieve("showMBPPhotoFlyout.displayed")==false){return}var c=ta.id("COMMERCE_FLYOUT");if(c){var a=new Fx.Tween(c,{property:"right",duration:"short",onComplete:function(){ta.store("showMBPPhotoFlyout.displayed",false)}});ta.store("showMBPPhotoFlyout.displayed",false);a.start(0,-220)}}catch(b){ta.util.error.record(b,"ta.commerce.meta.hideMBPhotoFlyout")}},scrollToId:function(a){if(typeof(a)=="undefined"||!a||ta.id(a)==null){return}var b=ta.id(a);if(typeof(b.scrollIntoView)=="function"){b.scrollIntoView()}else{window.location.hash=a}},initNoAvailCarousel:function(){try{var a=ta.id("ALSO_VIEWED_LIST");if(!a){return}var f=a.getElement("ul");if(!f){return}var l=f.getElements("li").length;var j=new Fx.Tween(f,{property:"left"});var b=353;var g=1;var k=a.getElement(".prev");var c=a.getElement(".next");if(!c||!k){return}function h(m){if((g===1&&m<0)||(g===l&&m>0)){return}if(m<0){ta.trackEventOnPage("Pager_Arrows","Scroll_Left","Mini_Carousel_Xsell")}else{if(m>0){ta.trackEventOnPage("Pager_Arrows","Scroll_Right","Mini_Carousel_Xsell")}}g+=m;var q=parseInt(f.getStyle("left"));var o=b*m*-1;var p=q+o;j.start(p);var r=a.getElement(".paginator");if(r){if(g===1&&m<0){className="front"}else{if(g===l&&m>0){className="end"}else{className="middle"}}r.className="paginator "+className}}k.addEvent("click",function(){h(-1)});c.addEvent("click",function(){h(1)})}catch(d){ta.util.error.record(d,"ta.commerce.meta.initNoAvailCarousel")}},showRemainingProviders:function(b,a){a=ta.id(a);var c=a.hasClass("interrupterShowMore");if(a){a.destroy()}if(!c){ta.store("checkrates.hr_bc_see_all_click",true)}if(ta.has("tests.bookingcom")&&ta.tests&&ta.tests.bookingcom){ta.tests.bookingcom.chkHR(true)}if(c){document.getElements(".interrupterHidden").removeClass("interrupterHidden");return}document.getElements(".remaining").removeClass("remaining")},hideStateOptHRNoAvailMsg:function(){var a=document.getElement(".error_msg");if(a){a.hide()}},updateStateOptHRNoAvailErrorMsg:function(b){if(!b){return}var c=ta.retrieve(b);var a=document.getElement(".error_msg");if(c&&a){a.addClass("metaUIStateOptHRError");a.innerHTML=c;a.show()}},showStateOptHRNoAvailUI:function(b){try{if(!b||(b&&!b.contains("metaUIStateOptHR"))){return}if(b.contains("metaUIStateOptInvalidDates")){ta.commerce.meta.updateStateOptHRNoAvailErrorMsg("meta.bc.stateOptInvalidDates");return}if(b.contains("hasDisplayUnavailability")){ta.trackEventOnPage("Mini_meta_LP_chevron_display","Not_Displayed","May_Be_Available")}else{ta.trackEventOnPage("Mini_meta_LP_chevron_display","Not_Displayed","Unavailable")}ta.commerce.meta.updateStateOptHRNoAvailErrorMsg("meta.bc.onlinePricesNotAvailable");var d=ta.retrieve("meta.baseLocationId");var a=ta.id("META_UI_STATE_OPT_ALT_DATES_CONTAINER");if(d&&a){a.removeClass("hidden");ta.commerce.meta.hacAltDates(d,true,null,"MM_ALT_DATES")}}catch(c){ta.util.error.record(c,"ta.commerce.meta.showStateOptHRNoAvailUI")}},loadCarouselXSell:function(v){if(ta.retrieve("unavail_maybe_v1")||ta.retrieve("unavail_maybe_v2")){var f=ta.commerce.checkrates.getTravelDataFromDOM();if(f){var g=f.sInMonthYear[0];var h=f.sInMonthYear[1];var c=f.inDay;var d=f.sOutMonthYear[0];var k=f.sOutMonthYear[1];var b=f.outDay;var s=ta.util.date.create(h,g,c);var u=ta.util.date.create(k,d,b);var l=u-s;var o=1000*60*60*24;var w=Math.floor(l/o);if(w>30){var t=ta.retrieve("meta.bc.noConfirmedAvailabilityWithXSell");var q=document.getElement(".error_msg");if(t&&q){q.show();q.innerHTML=t;var m=document.getElement("#CHECK_RATES_CONT.chkRates .metaDatesChosen");if(m){m.addClass("miniMetaHideHdr");m.removeClass("miniMetaShowHdr")}}}}return}try{ta.commerce.meta.hideCarouselXSell();var a=document.getElement("#CHECK_RATES_CONT div.hacUnavailable");if(a){return}var p=ta.retrieve("meta.baseLocationId");var j=ta.id("CHECK_RATES_CONT");var f=ta.commerce.checkrates.getTravelDataFromDOM();if(!j||!p||!f||!f.adults||!f.inDay||!f.outDay||!f.sInMonthYear||!f.sOutMonthYear){return}new Request({url:"/MetaBestPriceCrossSellAjax",data:{detail:p,adults:f.adults,inMonth:f.sInMonthYear[0]+" "+f.sInMonthYear[1],inDay:f.inDay,outMonth:f.sOutMonthYear[0]+" "+f.sOutMonthYear[1],outDay:f.outDay,reqNum:1,type:"meta_carousel"},method:"GET",evalScripts:true,onSuccess:function(F,H){var C=Elements.from(F);var z=document.getElement(".similarCarousel");if(z){return}var D=document.getElements("#CHECK_RATES_CONT span.price");var B=document.getElements("#CHECK_RATES_CONT div.premium");if((D&&D.length>0)||(B&&B.length>0)){return}if(C){var A=C.filter(".similarCarousel");var G;if(v){if(A){G=ta.retrieve("meta.bc.noConfirmedAvailabilityWithXSell")}else{G=ta.retrieve("meta.bc.noConfirmedAvailability")}}else{if(A){G=ta.retrieve("meta.bc.noAvailabilityWithXSell")}else{G=ta.retrieve("meta.bc.noAvailability")}}var J=document.getElement(".error_msg");if(G&&J){J.show();J.innerHTML=G;var I=document.getElement("#CHECK_RATES_CONT.chkRates .metaDatesNotChosen");var E=document.getElement("#CHECK_RATES_CONT.chkRates .metaDatesChosen");if(I){I.addClass("miniMetaHideHdr");I.removeClass("miniMetaShowHdr")}if(E){E.addClass("miniMetaHideHdr");E.removeClass("miniMetaShowHdr")}}var y=document.getElement("div.premium_offers_area");if(A&&y){setTimeout(function(){var K=document.getElement(".similarCarousel");if(K){return}A.inject(y);ta.commerce.meta.initNoAvailCarousel()},100)}}}}).send()}catch(r){ta.util.error.record(r,"ta.commerce.meta.loadCarouselXSell")}},hideCarouselXSell:function(){var a=document.getElement(".similarCarousel");if(a){a.destroy()}var b=document.getElement(".error_msg");if(b){b.empty()}},alignPriceBlocks:function(){var a=41;var g=document.getElements("#HotelDateSearch .postShowMetaCR .priceBlock");var f=g.length;if(g&&f>1&&g[0]){var c=g[0].getSize().x;for(var b=1;b<f;b++){var d=g[b].getSize().x;if(d&&!isNaN(d)&&d>c){c=d}}c-=a;g.setStyle("width",c+"px")}},displayBlueChevronLowestPriceCTA:function(){var b="bcMetaLowestPriceCTA";if(ta.has(b)){var g=ta.retrieve(b);if(g.hasOwnProperty("idx")){var j="BlueChevron_LP_CTA_Display";var d=(g.idx==0)?"Not_Displayed":"Displayed";var k=g.idx+"";ta.trackEventOnPage(j,d,k)}var a=ta.id("BC_LP_CTA");if(a){(function(){a.fade("in")}).delay(700)}var f=ta.id("bc_lp_cta_text");if(f){var c=f.getSize().y;if(c==12){while(f.getSize().y<=c){f.style.width=""+(f.getSize().x-1)+"px"}f.style.width=""+(f.getSize().x+1)+"px"}a.style.left="-"+(f.getSize().x+20)+"px";var h=a.getElement(".bc_lp_cta_triangle");h.style.left=""+(f.getSize().x+10)+"px";f.style.marginTop=""+Math.round((25-f.getSize().y)/2)+"px"}var l=ta.retrieve("fadeBcLpCTAout");if(l&&l==1){(function(){a.fade("out")}).delay(5800)}}},hacAltDates:function(p,q,d,s,t){try{if(typeof(p)=="undefined"||typeof(q)=="undefined"||typeof(d)=="undefined"||!ta.id(s)||!ta.widgets.calendar.hasPageDates()){return}var g="hacAltDatesReq_curCancelKey";var a=5;t=t||new Date().getTime();var h="hacAltDatesReq_"+t+"_cancel";if(!d||d==0){d=1;ta.remove("metaUI.altDatesAvail");ta.remove("metaUI.altHotelsAvail")}else{if(ta.retrieve(h)==true){return}}if(ta.has(g)){var w=ta.retrieve(g);if(w!=h){ta.store(w,true);ta.commerce.meta.polling.removePollingInfoForRequest(w)}}if(!ta.has(h)){ta.store(h,false);ta.store(g,h)}var v=ta.widgets.calendar.getPageInDate();var y=ta.widgets.calendar.getPageOutDate();var r=ta.widgets.calendar.getPageAdultsCount();if(!v||!y||!r){return}var f=v.getDate();var k=v.getMonth()+1;var m=v.getFullYear();var b=y.getDate();var j=y.getMonth()+1;var o=y.getFullYear();var l={inDay:f,inMonth:k+" "+m,outDay:b,outMonth:j+" "+o,adults:r,location:p,initialRequest:q};var c=Object.toQueryString(l);if(!c||!c.trim()){ta.util.error.record(null,"ta.commerce.meta.hacAltDates - toQueryString failure",null,l);return}if(!ta.commerce.meta.polling.isRequestBeingPolled(h)){ta.commerce.meta.polling.setPollingAttemptForRequest(h,0)}new Request({url:"/HACAltDatesAjax",data:l,method:"get",onSuccess:function(N){if(ta.retrieve(h)==true||typeof(N)=="undefined"){return}var O=0;var D=0;var L=ta.id(s);var H=L.getParent();if(!H){return}var A=document.createDocumentFragment();var E=JSON.decode(N);if(E){for(var M=0;M<E.length;M++){var z=E[M];if(z.valid_dates=="true"&&z.available=="true"){O++;D++;if(!ta.has("metaUI.altDatesAvail")){var K=ta.id("MM_ALT_DATES_HDR");var J=ta.retrieve("meta.bc.onlinePricesAvailable");if(K&&J){K.set("text",J)}ta.store("metaUI.altDatesAvail",true)}var G=null;switch(M){case 0:G="day_before";break;case 1:G="day_after";break;case 2:G="week_before";break;case 3:G="week_after";break;default:G="unknown"}var P="ta.trackEventOnPage('DATEPICKER','OPEN','DATES_INLINE_FLEXIBLE','',null);";var I="ta.commerce.meta.requestWithAltDates("+z.check_in_date.replace(/-/g,",")+","+z.check_out_date.replace(/-/g,",")+");";var C="ta.commerce.meta.hideStateOptHRNoAvailMsg();";var B=new Element("li");if(D%2!==0){B.addClass("odd")}var Q=new Element("span",{"class":"taLnk no_cpu",title:z.display_string,onclick:P+I+C}).set("text",z.display_string);B.adopt(Q);A.appendChild(B)}else{if(z.response_complete=="true"){O++}}}if(A.hasChildNodes()){L.empty();L.show().appendChild(A)}if(O<E.length&&d<a){ta.commerce.meta.polling.incrementPollingAttemptForRequest(h);setTimeout(function(){ta.commerce.meta.hacAltDates(p,false,d+1,s,t)},ta.commerce.meta.polling.getPollingWaitTimeForRequest(h))}else{ta.commerce.meta.polling.removePollingInfoForRequest(h);if(ta.has("metaUI.altDatesAvail")){H.getElements(".jsAltDatesFail").each(function(R){R.hide()});H.getElements(".jsAltDatesAvail").each(function(R){R.show()})}else{var F=ta.id("META_UI_STATE_OPT_ALT_DATES_CONTAINER");if(F){F.addClass("hidden")}H.getElements(".jsAltDatesLoading").each(function(R){R.hide()});H.getElements(".jsAltDatesAvail").each(function(R){R.hide()})}}}else{return}}}).send()}catch(u){ta.util.error.record(u,"ta.commerce.meta.hacAltDates")}},trackMiniMetaStateOpt:function(a){ta.trackEventOnPage("Mini_meta_State-Optimized","display",a,0)},requestWithAltDates:function(j,b,g,c,k,a){var d,l,f;try{d=ta.util.date.create(j,b-1,g);l=ta.util.date.create(c,k-1,a);ta.widgets.calendar.setPageInDate(d);ta.widgets.calendar.setPageOutDate(l);ta.widgets.calendar.syncAllDatePickers();ta.widgets.calendar.launchInlineMeta()}catch(h){ta.util.error.record(h,"error constructing meta request with alternate dates")}},repositionGutter:function(){try{var k=ta.id("MAINWRAP");if(ta.id("HEAD")&&ta.id("HEAD").getElement(".masthead")){var l=ta.id("HEAD").getElement(".masthead")}if(ta.id("PAGE")&&ta.id("PAGE").getElement(".crumbs")){var h=ta.id("PAGE").getElement(".crumbs")}var m=ta.id("FOOT");if(k&&l&&h&&m){var a=k.getWidth();var g=90;var o=ta.id("ALSO_VIEWED_LIST");if(o){var f=o.getWidth()}var b=window.getSize().x;if(o&&b<2*f+a&&b>a+g+0.7*f){if(b>f+a+g){var d=(b-f-a-g+3)/2+g-13}else{var d=g-6}var c="0 auto 0 "+d+"px";k.setStyle("margin",c);l.setStyle("margin",c);h.setStyle("margin",c);m.setStyle("margin",c)}else{if(o&&b<=a+g+0.7*f){crossSellContainer=ta.id("AVAF_PLACEHOLDER");if(crossSellContainer&&o){ta.id("AV_ABOVE_FOLD_META").inject(crossSellContainer);o.removeClass("gutterCrossSell");if(o.hasClass("gutterPreDatesWidth")){o.removeClass("gutterPreDatesWidth")}o.addClass("gutterNotWideEnough");ta.id("AV_ABOVE_FOLD_META").removeClass("gutter")}}else{return}}}}catch(j){ta.util.error.record(j,"error repositioning gutter cross sell.")}},repositionGutterNoDates:function(){if(!ta.widgets.calendar.datesExist()){ta.commerce.meta.repositionGutter()}},copyCacheKeyClasses:function(a,d){if(!a||!d){return}var f=a.className.split(/ +/);var b=function(g){return g.slice(0,3)=="msk"};var c=function(g){d.addClass(g)};a.className.split(/ +/).filter(b).forEach(c)},initializeHoverTable:function(){var a=ta.commerce.meta.getHoverTableDisplayArea();if(!a){return false}ta.store("meta.initializedHoverTable",true);var b=ta.commerce.meta.findPostShowMetaCR();ta.commerce.meta.copyCacheKeyClasses(b,a);ta.commerce.meta.startHoverTableSearchTimer();return true},startHoverTableSearchTimer:function(){setTimeout(function(){ta.store("isHoverTableTimerExpired",true);ta.commerce.meta.lockHoverTable(null);ta.commerce.meta.updateHoverTable(null)},2000)},hideHoverTableDisplayArea:function(){var b=ta.commerce.meta.getHoverTableDisplayArea();var a=ta.retrieve("showHoverTextLinks");if(b&&!a){b.hide()}else{if(a){var c=b.getElement("#hover_table_search");if(c){c.hide()}ta.commerce.meta.updateHoverTableTextLinks();ta.commerce.meta.showHoverTableTextLinks();ta.store("showHoverTextLinks",false)}}},setupHoverTable:function(a){if(!ta.retrieve("meta.initializedHoverTable")){if(!ta.commerce.meta.initializeHoverTable()){setTimeout(function(){ta.commerce.meta.setupHoverTable(a)},100);return}}ta.commerce.meta.updateHoverTable(a)},getHoverTableDisplayArea:function(){return document.getElement("#hover_table_display_area")},showHoverTableTextLinks:function(){var c=ta.commerce.meta.getHoverTableDisplayArea();var a=c.getElement(".textLinks");var b=c.getElement(".disclaimer");if(a){a.show()}if(b){b.show()}},hideHoverTableTextLinks:function(){var c=ta.commerce.meta.getHoverTableDisplayArea();var a=c.getElement(".textLinks");var b=c.getElement(".disclaimer");if(a){a.hide()}if(b){b.hide()}},filterTextLinksForHoverTable:function(b){var h=ta.commerce.meta.getHoverTableDisplayArea();if(!h){return}var b=h.getElement(".hover_table.results");if(!b){return}var m=b.getElements(".provider");var d=h.getElements(".textLinks .textLink .providerName");if(!m||!d){return}var g=[];var f=h.getElement(".moreLink");var a;var k=6;var c=d.length-k;if(f==null||ta.retrieve("checkrates.hr_bc_see_all_click")==true||c<2){a=false}else{a=true}var j=true;var l=0;m.each(function(o){g.push(o.innerHTML.trim())});d.each(function(o){var p=o.getParent();if(g.contains(o.innerHTML.trim())){p.hide()}else{if(j){p.addClass("odd")}else{p.removeClass("odd")}j=!j;if(l>2&&a){p.addClass("remaining")}else{p.removeClass("remaining")}l++}});if(f!=null){if(a){f.show()}else{f.hide()}}},beginHoverTableHacQuery:function(){ta.store("isHoverTableTimerExpired",false);ta.commerce.meta.hideCarouselXSell();ta.commerce.meta.hideHoverTableTextLinks();var c=ta.commerce.meta.getHoverTableDisplayArea();if(!c){return}var a=c.getParent().getElement(".error_msg");if(a){a.hide()}c.show();var g=ta.commerce.meta.getHoverTableSearch();if(g){g.show()}ta.commerce.meta.startHoverTableSearchTimer();if(!ta.retrieve("meta.initializedHoverTable")){return false}ta.store("meta.lockedHoverTable",false);ta.remove("meta.lockHoverTableOnUpdate");var c=ta.commerce.meta.getHoverTableDisplayArea();var d=c.getElement(".hover_table.results");if(d){d.destroy()}var f=c.getElement(".textLinks");if(f){f.destroy()}var b=c.getElement(".disclaimer");if(b){b.destroy()}ta.commerce.meta.startHoverTableSearchTimer()},getHoverTableSearch:function(){return document.getElement("#hover_table_search")},updateHoverTableTextLinks:function(){var f=ta.commerce.meta.findPostShowMetaCR();if(!f){return}var a=f.getElement(".textLinks");var d=ta.commerce.meta.getHoverTableDisplayArea();if(!d){return}var b=d.getElement(".textLinks");var c=d.getElement(".disclaimer");if(a){if(b){b.destroy()}if(c){c.grab(a,"before")}else{d.grab(a,"bottom")}a.show()}},setDefaultHoverTableTab:function(b){var c=b.getElement(".default_hover_table_tab");if(c){var a=function(){ta.commerce.meta.showHoverTableContentForTab(c)};b.addEvent("mouseleave",a);a()}},findPostShowMetaCR:function(){return document.getElement(".postShowMetaCR.msk")},getElementFromPostShowMetaCR:function(a){var b=ta.commerce.meta.findPostShowMetaCR();if(b){return b.getElement(a)}else{return null}},getElementsFromPostShowMetaCR:function(a){var b=ta.commerce.meta.findPostShowMetaCR();if(b){return b.getElements(a)}else{return null}},lockHoverTable:function(a){if(ta.retrieve("meta.lockedHoverTable")){return}var h=ta.commerce.meta.findPostShowMetaCR();if(!h){return}var f=h.getElement(".hover_table.results");var d=ta.commerce.meta.getHoverTableDisplayArea();if(!d){return}if(f){var c=f.getElements(".provider").length;if(c<1&&!a){ta.store("meta.lockHoverTableOnUpdate",true);return}ta.commerce.meta.setDefaultHoverTableTab(f);d.grab(f);var b=h.getElement(".disclaimer");if(b){d.grab(b);b.show()}if(c>0||(ta.isBCHoverTable()&&a)){f.show()}}else{ta.store("meta.lockHoverTableOnUpdate",true);return}var g=ta.commerce.meta.getHoverTableSearch();if(g){g.hide()}ta.store("meta.lockedHoverTable",true)},updateHoverTable:function(a){if(!ta.retrieve("meta.lockedHoverTable")&&(a||ta.retrieve("meta.lockHoverTableOnUpdate"))){ta.commerce.meta.lockHoverTable(a)}if(ta.retrieve("meta.lockedHoverTable")){ta.commerce.meta.updateHoverTableTextLinks();ta.commerce.meta.filterTextLinksForHoverTable();ta.commerce.meta.showHoverTableTextLinks()}else{if(a==null){ta.store("showHoverTextLinks",true)}}},showHoverTableContentForTab:function(a){a=ta.id(a);if(!a){return}document.getElements(".hover_table .tab").removeClass("selected");document.getElements(".hover_table .tab .arrow").addClass("hidden");document.getElements(".hover_table.results .content").addClass("hidden");a.addClass("selected");a.getElement(".arrow").removeClass("hidden");a.getElement(".content").removeClass("hidden");return},handleHoverTableResponseText:function(b){var a=new Element("div",{html:b});if(a.getElement(".clearHoverTable")){ta.commerce.meta.hideHoverTableDisplayArea()}else{ta.commerce.meta.setupHoverTable(a.getElement(".hacComplete")!=null)}},truncateProviderNames:function(){var g=document.getElement(".textLink");if(g){var c=g.getSize().x;var f=g.getElement(".price");if(f){var b=f.getSize().x;var a=c-b-28;var d=$$(".textLinks .providerName");if(a>0){Array.each(d,function(h){if(h.getNext(".price")){h.setStyle("width",a)}})}}}},expandProvidersInline:function(b,d){b=ta.id(b);if(!b){return}var a=b.getParent(".metaPriceInfo");if(!a){return}var c=a.getElements(".provider");if(!c){return}c.show();b.hide()},flipHoverClass:function(b,a){if(b){b=ta.id(b);var c=a+"Idle";var d=a+"Over";b&&b.toggleClass(c).toggleClass(d)}},trackHotelRatingsInfoClickInHR:function(a){a.target=a.target||a.srcElement;if(a.target&&a.target.href){ta.setEvtCookie("Ratings_Info","all_hotels","",0,a.target.href)}},animateChevron:function(d,a,b){a=ta.id(a);if(!a){return}if(Browser.name==="ie"&&Browser.version<10){var c=new Fx.Morph(a,{duration:100});if(b==="enter"){c.start({width:382,"margin-left":-191})}else{if(b==="leave"){c.start({width:354,"margin-left":-177})}}}return},animateChevronBig:function(g,b,d){if(!ta.browser.isIElt10()){return}b=ta.id(b);if(!b){return}var a=b.getElement(".priceBlock");if(!a){return}var f=new Fx.Morph(b,{duration:200});var c=null;if(a){c=new Fx.Morph(a,{duration:200})}if(d==="enter"){f.start({width:424,height:72,"margin-left":-212});if(c){c.start({height:70})}}else{if(d==="leave"){f.start({width:354,height:58,"margin-left":-177});if(c){c.start({height:56})}}}},trackInterrupter:function(){if(ta.has("ta.mini_meta_in_reviews")&&!ta.has("ta.mmir.interrupterSeen")){var b=ta.id("MINI_META_IN_REVIEWS");if(b){var d=b.getPosition()}try{var f=window.getScroll();var a=window.getSize();if(d.y>f.y&&d.y<(f.y+a.y)){ta.store("ta.mmir.interrupterSeen",true);if(ta.has("ta.mmir.interrupterReviewNumber")){ta.trackEventOnPage("ReviewInterrupter","displayed",ta.retrieve("ta.mmir.interrupterReviewNumber"))}}}catch(c){}}},updateHeaderMsg:function(b,c){var a=document.getElement(b);if(c&&a){a.innerHTML=c}}};ta.commerce.minimeta={ajax:{MAX_POLL_ATTEMPT:20,ALL_HAC_COMPLETE:"hotelsMeta.allHacComplete",LOCS_ON_PAGE:"hotelsMeta.locsOnPage",ATTEMPT_STORE_KEY:"hotelsMeta.ajaxNum",TIME_EXPIRED:"hotelsMeta.timeExpired",MINI_META_APPEAR_LOADING_TIMEOUT:5000,MINI_META_STOP_LOADING_TIMEOUT:60000,travelData:ta.commerce.checkrates.getTravelDataFromDOM(),send:function(c,a){var b=ta.commerce.minimeta.ajax;setTimeout(function(){new Request({method:"post",url:b.getUrl(),data:b.buildPostData(a),onSuccess:function(d){var f=new Element("div",{html:d});b.updateDOM(f);if(!c&&b.shouldResubmit()){ta.commerce.minimeta.ajax.send()}b.updateAttemptNum()}}).send()},ta.commerce.meta.polling.getPollWaitTimeForPollingAttempt(ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY)))},getUrl:function(){return"/BulkMiniMetaCRAjax"},buildPostData:function(b){var a={};a.area="QC_Meta_Mini";a.returnAllOffers=true;a.detail=ta.commerce.minimeta.ajax._getLocOnPageString(b);a.action="getMiniMetaForLocations";return a},updateDOM:function(d){var a=d.getElement(".isAllHacComplete");if(a||ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true);var c=$$(".metaDisclaimer");if(c&&c.hasClass("hidden")){c.removeClass("hidden")}}var b=document.getElements(".listing");b.each(function(l){var k=l.id;var j=k.substring(k.indexOf("_")+1);var h=d.getElement("."+j);ta.commerce.minimeta.ajax.updateLoadingState(d);if(h){var f=h.getElement(".metaPriceInfo");var g=l.getElement(".metaPriceInfo");ta.commerce.minimeta.ajax._setPrice(f,j);ta.commerce.minimeta.ajax._setAccomType(f,j);f.replaces(g)}})},resetAjaxCall:function(){ta.remove(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE);ta.remove(ta.commerce.minimeta.ajax.LOCS_ON_PAGE);ta.remove(ta.commerce.minimeta.ajax.ATTEMPT_STORE_KEY);ta.remove(ta.commerce.minimeta.ajax.TIME_EXPIRED)},shouldResubmit:function(){if(ta.retrieve(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE)){return false}else{var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a||a<ta.commerce.minimeta.ajax.MAX_POLL_ATTEMPT-1){return true}else{return false}}},updateAttemptNum:function(){var a=ta.retrieve(ta.commerce.minimeta.ATTEMPT_STORE_KEY);if(!a){ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,1)}else{ta.store(ta.commerce.minimeta.ATTEMPT_STORE_KEY,a+1)}},_getLocOnPageString:function(b){listings=document.getElements(".listing");var a="";listings.each(function(d){if(ta.commerce.minimeta.ajax._isHacComplete(d)&&!b){return}var c=d.id;locId=c.substring(c.indexOf("_")+1);a=a+locId+","});if(a==""){ta.store(ta.commerce.minimeta.ajax.ALL_HAC_COMPLETE,true)}return a},_isHacComplete:function(a){return a.getElement(".metaPriceInfo.hacComplete")},_setPrice:function(b,g){var a=b.getElement(".classicPrice");if(a){var d="classicPrice_"+g;var c=ta.retrieve(d);if(ta.retrieve("hotels.shouldHideClassicPrices")){a.hide()}else{if(c&&c!=0){var f=a.getElement(".price");f.set("html",c);a.toggleClass("hidden",false)}else{a.hide()}}}},_setAccomType:function(a,d){var c=a.getElement(".contactStr");if(c){var b="accomType_"+d;var f=ta.retrieve(b);if(!f||f=="T_HOTEL"){c.set("html",ta.retrieve("hotels.contactHotel"))}else{c.set("html",ta.retrieve("hotels.contactAccom"))}}},updateLoadingState:function(b){if(ta.retrieve(ta.commerce.minimeta.ajax.TIME_EXPIRED)){var d=b.getElements(".loading_bubbles_gry");var c=new Element("span",{"class":"sprite-visitSite"});d.each(function(g){c.clone().replaces(g)});var a=b.getElements(".loadingHeader");var f=ta.retrieve("hotels.checkSites");a.each(function(g){g.set("html",f)})}}},storeAccomDetails:function(){var b=document.getElements(".classicPrices");b.each(function(d){ta.store(d.id,d.value)});var a=document.getElements(".accomTypes");a.each(function(d){ta.store(d.id,d.value)});var c=$$(".metaDisclaimer");if(c){c.addClass("hidden")}},doMetaDateSearch:function(d){if(!ta.widgets.calendar.hasPageDates()){var c=document.getElement(".metaDatePicker .date_picker_calendar_wrap");c.fireEvent("click")}else{if(ta.has("hac.filter.changed")){ta.hac.filters.updateResults()}else{if(!ta.retrieve("hotels.datesChanged")){ta.hac.filters.updateResults();ta.servlet.HACSearch.destroyAnimatedDateCTA()}else{var b=ta.hac.filters.buildHACUrlParamString();var a="/HACSearch?"+b+window.location.hash;window.location=a}}}},lowestPriceBookBtnHover:function(b){try{var a=document.getElement(".LowestPrice .bookBtn");if(!a){ta.util.error.record(null,"lowestPriceBookBtnHover - no button for .LowestPrice .bookBtn",null,{out:b});return}if(b){a.className=a.className.replace(/Over\b/,"Idle")}else{a.className=a.className.replace(/Idle\b/,"Over")}}catch(c){ta.util.error.record(c,"lowestPriceBookBtnHover - cannot change button hover appearance",null,{out:b})}}};ta.commerce.AvailDataWidget=new Class({Implements:[Options],options:{calendarOptions:{},argArray:[]},initialize:function(g,d,c,b,f,k){this.setOptions(k);if(g||window.event){g=new Event(g||window.event);if(g){g.stop()}}this.locId=d;this.ext=b;var j=null;if(this.ext){j="date_picker_adults_"+this.locId+this.ext}else{j="date_picker_adults_"+this.locId}this.adultField=ta.id(j);this.options.calendarOptions=Object.merge(this.options.calendarOptions,{ext:this.ext?this.ext:""});if(ta.has("hotels.redesignEnabled")&&document.getElement(".calendarWrap")){this.calendar=new ta.widgets.MultiDateCalendarInline(this.options.calendarOptions,this.locId,f,document.getElement(".calendarWrap"))}else{if(ta.retrieve("multiDP.two_field")){var h=true;if(g&&g.target&&ta.id(g.target).hasClass&&ta.id(g.target).hasClass("out_date")){h=false}this.calendar=new ta.widgets.SingleDateCalendar(this.options.calendarOptions,this.locId,f,this.options.argArray,h)}else{this.calendar=new ta.widgets.MultiDateCalendar(this.options.calendarOptions,this.locId,f,this.options.argArray)}}var a=ta.retrieve("adultFieldsMap");if(!a){a={}}if(this.adultField&&(!a[j]||this.adultField.getParent(".overlay"))){if(!a[j]){this.adultsField=new ta.widgets.AdultsField(this.adultField,this.locId,f,g);a[j]=this.adultsField;ta.store("adultFieldsMap",a)}else{this.adultsField=a[j]}}this.show(c);if(ta.widgets.calendar.trackCalendarObject){ta.widgets.calendar.trackCalendarObject(this)}},show:function(a){if(a=="calendar"&&this.calendar&&this.calendar.calendarOverlay){this.calendar.showCalendarOverlay()}else{if(a=="adults"&&this.adultsField){this.adultsField.adultsOverlay.show()}}if(ta.has("persistentFilters.showing")&&tabletOnFullSite&&this.calendar.calendarOverlay.container){this.calendar.calendarOverlay.container.setStyle("position","fixed")}},clear:function(){if(this.adultField){var a=ta.retrieve("adultFieldsMap");if(a){a[this.adultField.id]=false}ta.widgets.calendar.setPageAdultsCount(2);ta.widgets.calendar.syncAllDatePickers()}this.calendar.clear()},getState:function(d){var b=this.calendar.getState();var a={adults:"2"};if(this.adultsField){a=this.adultsField.getState()}else{if(ta.widgets.calendar.getPageAdultsCount()){a={adults:ta.widgets.calendar.getPageAdultsCount()+""}}}var c=Object.merge(b,a);if(d){return c}return Object.toQueryString(c)}});ta.widgets.AdultsField=new Class({adultsSelRegex:/.*_(\d)\s*$/,adultsExRegex:/.*_\d+_(.*)$/,initialize:function(m,d,h,b){this.adultsField=m;this.crId=d;this.selectionFunction=h;var o=this.adultsField.getParent(".overlay");if(o){this.parentOverlay=o.overlay}var j=ta.overlays.ACTIVATE_CLICK;if(this.parentOverlay&&this.parentOverlay.container&&ta.id(this.parentOverlay.container).hasClass("persistentCR")){j=ta.overlays.ACTIVATE_NEVER}this.guestFieldLabel=this.generateGuestFieldLabel(this.adultsField.id);this.adultsOverlay=new ta.overlays.RelativeOverlayBelow({style:"dp",showCloseButton:false,noPadding:true,autoShow:false,offsetLeft:1,activate:j,onShow:this.onAdultsShow.bind(this),onHide:this.onAdultsHide.bind(this)},this.adultsField);this.adultsField.onclick=function(){};ta.id(this.adultsField).addEvent("click",this.adultsOverlay.show);var l=ta.id(this.adultsOverlay.container).getElement(".adults_pre_selected");try{this.count=ta.retrieve("date.picker.adultsCount");if(!this.count){this.count=this.adultsSelRegex.exec(l.id)[1]}}catch(k){}if(!this.count){this.count="2"}ta.widgets.calendar.setPageAdultsCount(this.count);var a=ta.id(this.adultsOverlay.container).getElements(".option");var f=this.adultSelect.bind(this);var g=this.buildAdultsErrorMsg.bind(this);a.each(function(q,p){elemSelectFunc=function(r){f.pass([p+1,q,r.event])()};ta.id(q).addEvent("click",elemSelectFunc);if(ta.retrieve("open_guest_field.isTest2Enabled")&&(p+1)==a.length){ta.id(q).removeEvent("click",elemSelectFunc);g.pass(q)()}});var c=this.adultsField.clientWidth;if(ta.retrieve("open_guest_field.isTest2Enabled")){c=c+4}c=c+"px";ta.id(this.adultsOverlay.container).setStyles({width:c});this.optionElems=a;if(ta.retrieve("open_guest_field.isNewSelectBehaviorEnabled")){this.defaultCount=2;this.defaultCountElem=a[1];this.preSelectElem=a[this.count-1];if(this.optionElems[this.count-1]){this.optionElems[this.count-1].addClass("adults_pre_selected")}}},generateGuestFieldLabel:function(c){var b=this.adultsExRegex.exec(c);var a=ta.retrieve("open_guest_field.servletName");if(!b){if(!a){return""}else{if(a=="Hotel_Review"){return"Guest_HR"}else{if(a=="Hotels"){return"Guest_Hotels"}else{return""}}}return"Guests"}else{if(b[1]=="pop"){return"Guest_Flyout"}else{if(b[1]=="met"){return"Guests_MetaLightBox"}else{if(b[1]=="pto"){return"Guest_HR_PhotoLightbox"}else{if(b[1]=="amo"){return"Guest_HR_AmenitiesLightbox"}else{return""}}}}}},trackGuestFieldEvent:function(b,a){try{ta.trackEventOnPage("GuestPicker",b,a)}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.trackGuestFieldEvent")}},buildAdultsErrorMsg:function(c){var b=ta.overlays.ACTIVATE_CLICK;this.adultsErrorMsgOverlay=new ta.overlays.RelativeOverlayBelow({style:"dp",showCloseButton:true,autoShow:false,offsetLeft:1,activate:b,onShow:this.onAdultsErrorMsgShow.bind(this),onHide:this.onAdultsErrorMsgHide.bind(this)},c);this.adultsErrorMsgOverlay.parentOverlay=this.parentOverlay;c.onclick=function(){};ta.id(c).addEvent("click",this.adultsErrorMsgOverlay.show);ta.id(this.adultsErrorMsgOverlay.container).setStyles({"z-index":9998});var a=ta.id(this.adultsErrorMsgOverlay.container).getElement(".inner");if(a){a.addClass("date_picker_adults_error_container")}},onAdultsErrorMsgShow:function(){if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}var f=ta.id(this.adultsField).getCoordinates().top;var c=ta.id(this.adultsErrorMsgOverlay.container).offsetTop;var b=ta.id(this.adultsOverlay.container).clientHeight;if(c>=f){ta.id(this.adultsErrorMsgOverlay.container).setStyles({top:f+29})}else{ta.id(this.adultsErrorMsgOverlay.container).setStyles({top:c+b-29})}var g=ta.id(this.adultsOverlay.container).getElements(".option");var a=ta.retrieve("open_guest_field.isTrackingEventEnabled");ta.store("open_guest_field.isTrackingEventEnabled",false);this.adultSelect(this.defaultCount,this.defaultCountElem,"click");ta.store("open_guest_field.isTrackingEventEnabled",a);this.adultsOverlay.hide();var d=this.guestFieldLabel+"|3plus";if(ta.retrieve("open_guest_field.isTrackingEventEnabled")){this.trackGuestFieldEvent("Select",d)}},onAdultsErrorMsgHide:function(){try{if(this.parentOverlay&&!this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}}catch(a){ta.util.error.record(a,"ta.widgets.AdultsField.onAdultsErrorMsgHide")}},onAdultsShow:function(){try{if(this.parentOverlay&&this.parentOverlay.pin&&this.parentOverlay.options.pinnable==ta.overlays.PINNABLE_CLICK){this.tempPin=!this.parentOverlay.pinned;if(this.tempPin){this.parentOverlay.pin()}}this.keyEventListener=this.onAdultsOverlayKeyDown.bind(this);document.addEvent("keydown",this.keyEventListener);this.adultsField.blur();var a=document.getElements(".date_picker_adults_option");if(a){Array.each(a,function(d){ta.id(d).removeClass("adults_selected");ta.id(d).removeClass("adults_pre_selected")})}if(ta.id(this.adultsField).getParent("#PERSISTENT_CHECK_RATES")){var b=ta.id(this.adultsField).getCoordinates().top;if(typeof(isIPad)=="undefined"||!isIPad){b=b-window.getScrollTop()}ta.id(this.adultsOverlay.container).setStyles({position:"fixed",top:b+29,zindex:9997})}this.count=ta.retrieve("date.picker.adultsCount");if(ta.retrieve("open_guest_field.isNewSelectBehaviorEnabled")){this.optionElems[this.count-1].addClass("adults_pre_selected");this.preSelectElem=this.optionElems[this.count-1]}if(ta.retrieve("open_guest_field.isTrackingEventEnabled")){this.trackGuestFieldEvent("Open",this.guestFieldLabel)}}catch(c){ta.util.error.record(c,"ta.widgets.AdultsField.onAdultsShow")}},onAdultsHide:function(){try{if(this.parentOverlay&&this.tempPin){this.tempPin=false;this.parentOverlay.unpin()}if(this.keyEventListener){document.removeEvent("keydown",this.keyEventListener)}}catch(a){}},onAdultsOverlayKeyDown:function(a){if(a.key=="esc"){this.adultsOverlay.hide()}},adultSelect:function(f,d,c){if(ta.retrieve("meta.enabled")){ta.commerce.meta.tracking.resetAllTimingLocks();ta.commerce.meta.tracking.clearSuppressedAreas();ta.commerce.meta.polling.clearAllPollingInfo()}this.updateValue(f,d.innerHTML);this.adultsOverlay.hide();var b=this.guestFieldLabel+"|"+this.count;if(ta.retrieve("open_guest_field.isTrackingEventEnabled")){this.trackGuestFieldEvent("Select",b)}if(!ta.widgets.calendar.hasPageDates()){return}if(this.selectionFunction){if(this.selectionFunction===ta.widgets.calendar.launchInlineMeta){this.selectionFunction.call(this,c)}else{this.selectionFunction.call(this,this.crId,this.adultsField)}}if(ta.commerce.metajson){ta.commerce.metajson.refetchAll()}if(typeof oxapp!="undefined"&&oxapp&&oxapp.context){var a=oxapp.context.get("TravelDates");if(a){a.save()}}if(ta.has("checkrates.meta_af")&&!(ta.has("checkrates.avaf_anti_distraction")&&!this.options.ext)){ta.commerce.meta.loadMetaAF(this.crId,"AV_ABOVE_FOLD_META",false)}else{if(ta.has("checkrates.avaf_anti_distraction")&&!this.options.ext){var g=ta.id("AV_ABOVE_FOLD_META");if(g){g.destroy()}}}if(ta.retrieve("stateopt_modal_test")){ta.commerce.meta.closeStateoptModal()}ta.widgets.calendar.trackCalendarEvent("DATEPICKER","CHANGE","GUESTS",f)},updateValue:function(a,b){this.count=a;this.adultsField.innerHTML=b;ta.widgets.calendar.setPageAdultsCount(this.count);ta.widgets.calendar.syncAllDatePickers();var c=document.getElements(".adults");c.each(function(d){d.innerHTML=b})},getAdultsCount:function(){return this.count},getState:function(){return{adults:this.count+""}}});ta.commerce.meta.tracking={getTimingForNavArea:function(a){if(!a){return}var b=ta.commerce.meta.tracking.processNavArea(a);return ta.retrieve(b)},setTimingLockForNavArea:function(b,a){ta.store(b+"-LOCK",a)},isTimingLocked:function(b){var c=ta.commerce.meta.tracking.processNavArea(b);var d=ta.retrieve(c);if(!d){return false}var a=Date.now();if(a-d>=2000){ta.commerce.meta.tracking.resetTimingLockForNavArea(c);return false}return true},resetTimingLockForNavArea:function(a){var b=ta.commerce.meta.tracking.processNavArea(a);if(ta.retrieve(b+"-LOCK")){ta.remove(b+"-LOCK")}},resetAllTimingLocks:function(){var a=["QC_Meta_Inline","QC_Meta_Mini","QC_Meta_Metro","QC_Meta_Micro","QC_Meta_Lightbox"];for(var b=0;b<a.length;b++){ta.commerce.meta.tracking.resetTimingLockForNavArea(a[b])}},processNavArea:function(a){if(!a){return}if(a.indexOf("QC_Meta_Inline")==0){return"QC_Meta_Inline"}if(a.indexOf("QC_Meta_Mini")==0){return"QC_Meta_Mini"}if(a.indexOf("QC_Meta_Metro")==0){return"QC_Meta_Metro"}if(a.indexOf("QC_Meta_Micro")==0){return"QC_Meta_Micro"}if(a.indexOf("QC_Meta_Lightbox")==0){return"QC_Meta_Lightbox"}},setTimingForNavArea:function(c,b){if(!c){return}if(!b){b=Date.now()}var a=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.isTimingLocked(a)){return ta.commerce.meta.tracking.getTimingForNavArea(a)}ta.store(a,b);ta.commerce.meta.tracking.setTimingLockForNavArea(a,b);if(a=="QC_Meta_Inline"&&!ta.commerce.meta.tracking.containsSuppressedArea("QC_Meta_Mini")){ta.commerce.meta.tracking.setTimingLockForNavArea("QC_Meta_Mini",b)}return b},updateUrlWithTiming:function(b,a){if(!b||!a){return}var c=ta.commerce.meta.tracking.setTimingForNavArea(a);if(!c){return b}if(b.contains("&metaRequestTiming=")){var d=new RegExp("(&|\\?)metaRequestTiming=[^&]*");b=b.replace(d,"&metaRequestTiming="+c)}else{b+="&metaRequestTiming="+c}return b},suppressImpressionsForArea:function(c){if(!c){return}var b=ta.commerce.meta.tracking.processNavArea(c);if(ta.commerce.meta.tracking.containsSuppressedArea(b)){return}var a=ta.retrieve("suppressed.areas");a.push(b);ta.store("suppressed.areas",a)},getSuppressedAreas:function(){var a=ta.retrieve("suppressed.areas");if(!a){a=[];ta.store("suppressed.areas",a)}return a},getSuppressedAreasAsString:function(){var b=ta.commerce.meta.tracking.getSuppressedAreas();var a="";if(b.length>0){for(var c=0;c<b.length;c++){a+=b[c]+";"}}return a},hasAnySuppressedAreas:function(){var a=ta.commerce.meta.tracking.getSuppressedAreas();return a.length>0},containsSuppressedArea:function(d){if(!d){return false}var b=ta.commerce.meta.tracking.processNavArea(d);var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var c=0;c<a.length;c++){if(a[c]==b){return true}}return false},removeSuppressedArea:function(f){if(!f){return}var b=ta.commerce.meta.tracking.processNavArea(f);var g;var c;if(ta.commerce.meta.tracking.containsSuppressedArea(b)){var a=ta.commerce.meta.tracking.getSuppressedAreas();for(var d=0;d<a.length;d++){if(a[d]==b){c=d;g=true}if(g){a=ta.commerce.meta.tracking.removeElementByIndex(a,c);ta.store("suppressed.areas",a)}}}},removeElementByIndex:function(b,a){if(b&&a>=0&&a<b.length){b.splice(a,1)}return b},clearSuppressedAreas:function(){ta.store("suppressed.areas",[])}};ta.commerce.meta.polling={setPollingAttemptForRequest:function(a,b){var c=ta.commerce.meta.polling.getPollingMap();if(!b){b=1}c[a]=b;ta.commerce.meta.polling.setPollingMap(c)},getPollingAttemptForRequest:function(a){if(ta.commerce.meta.polling.isRequestBeingPolled(a)){var c=ta.commerce.meta.polling.getPollingMap();var b=c[a];if(b){return b}}},getPollingWaitTimeForRequest:function(a){var b=ta.commerce.meta.polling.getPollingAttemptForRequest(a);return ta.commerce.meta.polling.getPollWaitTimeForPollingAttempt(b)},isRequestBeingPolled:function(a){var c=ta.commerce.meta.polling.getPollingMap();var b=c[a];if(b){return true}return false},incrementPollingAttemptForRequest:function(a){var c=ta.commerce.meta.polling.getPollingMap();var b=c[a];if(b){b=b+1;c[a]=b}ta.commerce.meta.polling.setPollingMap(c);return b},clearAllPollingInfo:function(){var a=new Object();ta.store("ta.meta.polling.map")},removePollingInfoForRequest:function(a){if(ta.commerce.meta.polling.isRequestBeingPolled(a)){var b=ta.commerce.meta.polling.getPollingMap();delete b[a];ta.commerce.meta.polling.setPollingMap(b)}},getPollingMap:function(){var a=ta.retrieve("ta.meta.polling.map");if(!a){a=new Object();ta.store("ta.meta.polling.map",a)}return a},setPollingMap:function(a){if(a){ta.store("ta.meta.polling.map",a)}},getPollWaitTimeForPollingAttempt:function(a){switch(a){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return 1000;case 11:return 5000;case 12:return 15000;case 13:return 30000;case undefined:case null:default:return 1000}}};ta.commerce.meta.horizontalXSell=(function(){var m=10;var h=1000;var j=false;var c=null;var p=null;var o=null;var r=0;var g=function(s){if(s.contains("hacComplete")&&(s.contains("hacMiniOfferNotAvailable")||s.contains("hacMiniOfferUnavailable"))){return true}return false};var l=function(s){if(!a()){return false}if(!s.contains("hacMiniOfferUnavailable")){return true}return false};var f=function(u,y){try{if(!y){r=0}c=new Date().getTime();var w=c;var v=ta.commerce.checkrates.getTravelDataFromDOM();if(!v||!v.adults||!v.inDay||!v.outDay||!v.sInMonthYear||!v.sOutMonthYear){return}var s={detail:u,adults:v.adults,inMonth:v.sInMonthYear[0]+" "+v.sInMonthYear[1],inDay:v.inDay,outMonth:v.sOutMonthYear[0]+" "+v.sOutMonthYear[1],outDay:v.outDay,reqNum:y?"2":"1",type:"horizontal_hr"};var z=Object.toQueryString(s);if(!z||!z.trim()){ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - toQueryString failure",null,s);return}new Request({url:"/MetaBestPriceCrossSellAjax",data:s,evalScripts:true,onSuccess:function(D,F){if(w!=c){return}var I=new Element("div",{html:D});var E=I.getElement(".xsellHacStatusReady")||I.getElement(".xsellHacStatusSOL")||y;if(!E&&r<m){setTimeout(function(){r=r+1;f(u,true)},h)}else{var B=ta.id("HORIZONTAL_CROSS_SELL");var G=I.getElement(".metaMicro");if(B&&G){if(B.getElement(".metaMicro")){B.innerHTML=D}else{B.setStyle("opacity","0");var A=new Fx.Tween(B,{property:"opacity"});B.setStyle("height",0);var C=122;var H=new Fx.Tween(B,{property:"height",onComplete:function(){B.setStyle("height","auto");B.innerHTML=D;A.start(0,1)}});H.start(0,C)}if(p){p()}d(true);ta.trackEventOnPage("HorizXSell","displayed")}}},onFailure:function(){ta.util.error.record(null,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell - MetaBestPriceCrossSellAjax request failed")}}).send()}catch(t){ta.util.error.record(t,"ta.commerce.meta.horizontalXSell.loadHorizontalXSell")}};var k=function(s,t){if(!s||!s.getElement(".bc_flags")){return}var u=s.getElement(".bc_flags").className;if(l(u)){removeHorizontalXSell()}else{if(g(u)){f(t,false)}}};removeHorizontalXSell=function(){var s=ta.id("HORIZONTAL_CROSS_SELL");var u=ta.id("HORIZONTAL_CROSS_SELL_LIST");var v=document.getElement("#HORIZONTAL_CROSS_SELL_LIST .lodging");if(s&&u&&v){var w=u.getSize().y;s.setStyle("height",w);var y=new Fx.Tween(u,{duration:200,property:"opacity",onComplete:function(){u.addClass("hidden");t.start(w,0).chain(function(){s.setStyle("height",0);s.innerHTML=""})}});y.start(1,0);var t=new Fx.Tween(s,{duration:"long",property:"height"});if(o){o()}d(false)}};var a=function(){return j};var d=function(s){j=s};var q=function(s){p=s};var b=function(s){o=s};return{updateHorizontalXSell:k,removeHorizontalXSell:removeHorizontalXSell,isLoaded:a,setLoaded:d,setOnloadFunction:q,setOnRemoveFunction:b}}());ta.commerce.meta.horizontalXSellExtensions={putAvafBelowMap:function(){if(ta.commerce.meta.horizontalXSell.isLoaded()){return}var d=ta.id("AV_ABOVE_FOLD_META");var c=ta.id("RHS_MAP");var b=d.parentNode;if(d&&c&&b){var a=b.getElement(".bxDivider.map");if(a){b.insertBefore(a,d);b.insertBefore(c,a)}else{b.insertBefore(c,d)}}},putAvafAboveMap:function(){if(!ta.commerce.meta.horizontalXSell.isLoaded()){return}var d=ta.id("AV_ABOVE_FOLD_META");var c=ta.id("RHS_MAP");var b=d.parentNode;if(d&&c&&b){var a=b.getElement(".bxDivider.map");b.insertBefore(d,c)}}};if(!ta.tests){ta.tests={}}ta.tests.bookingcom=(function(o,l,g,f){var j="http://b.scorecardresearch.com/p?c1=3&c2=6036461&c3=ALbook1&c4=%ID1%&c5=%ID2%&c6=&c10=1&c11=%esid!&c13=%psz=!;&c16=dfp&cj=1&ax_fwd=1&rn=%RND%",b=[[1010,101010],[3030,303030]],r="BookingCom",c=/booking.(com|gif)/i,q=false,k=false,h=function(s){return(s)?q:k},p=function(y,u){if(g.find(y)&&u){var t=g.select(y);for(var s=0;s<t.length;s++){var w=t[s];if(w.get("data-provider")&&w.get("data-provider")==r&&!w.hasClass("hidden")){var v=w.hasClass(u);if(v){m(true);return true}else{if(!/noLink/.test(w.innerHTML)){m(false);return true}}}}}return false},a=function(w,v){if(h(v)){return true}if(g.find(w)){var t=g.select(w);for(var s=0;s<t.length;s++){var u=t[s];if(c.test(u.innerHTML)){m(v);return true}}}return false},d=function(s,t){if(h(t)){return true}if(s&&s.innerHTML){if(c.test(s.innerHTML)){m(t);return true}}return false},m=function(t){var u=(t)?b[0]:b[1];var s=j.replace("%ID1%",u[0]).replace("%ID2%",u[1]).replace("%RND%",Math.floor(Math.random()*100000));o.body.appendChild(new Element("img",{"class":"tracking",src:s,height:"0",width:"0"}));(t)?q=true:k=true;if(q&&k){g.remove("tests.bookingcom")}};return{chkLightbox:function(){setTimeout(function(){var t=g.find(".overlay #PROVIDER_BLOCK");if(t){var s=".overlay #PROVIDER_BLOCK .metaProvider.jsPrvdr";a(s,true);s=".overlay #PROVIDER_BLOCK .remainingProv.jsPrvdr";a(s,false)}},1000)},chkMicroMeta:function(s){setTimeout(function(){if(s){d(g.find(".micro_meta_first_block"),true)}else{d(g.find("#micro_meta_ajax"),true)}},1000)},chkHotels:function(){if(q){return}var s="#PAGE .metaPriceInfo .header";var t=p(s,"header");if(!t){s="#PAGE .provider:not(.hidden):not(.grayed_out)";p(s,"provider")}},chkChevronLayer:function(s){a(s,true)},chkSmartDeals:function(){var s="#PAGE .lpContainer";a(s,true);s="#PAGE .listContainer";a(s,false)},chkHR:function(t){if(t&&!q){var s="#CHECK_RATES_CONT .offer:not(.remaining):not(.noLink)";p(s,"premium")}else{if(!k){var s="#CHECK_RATES_CONT .remaining .providerName:not(.noLink)";a(s,false)}}}}}(document,window,ta));ta.common.flyout.memberOverlay=ta.overlays.Factory.memberOverlay;ta.common.flyout.intlPopup=ta.overlays.Factory.intlPopup;ta.common.flyout.showRecentLocationEmailOverlay=ta.overlays.Factory.showRecentLocationEmailOverlay;ta.common.flyout.clearRecentLocations=ta.overlays.Factory.clearRecentLocations;ta.commerce.checkrates.createPairedCalendar=ta.overlays.Factory.createPairedCalendar;ta.commerce.checkrates.pcrInit=ta.overlays.Factory.loadPCROverlay;ta.common.sendmessage.showSendMessage=ta.overlays.Factory.showSendMessage;ta.servlet.Hotel.showRoomTipsOverlay=ta.overlays.Factory.showRoomTipsOverlay;ta.servlet.Hotel.showReviewSummary=ta.overlays.Factory.showReviewSummary;ta.servlet.Hotel.showTranslationReviewSummary=ta.overlays.Factory.showTranslationReviewSummary;tamgShowLightbox=ta.overlays.Factory.tamgShowLightbox;ta.util.taLnk={mouseover:function(b){$(b).addClass("underline")},mouseout:function(b){$(b).removeClass("underline")}};var StringBuffer=new Class({initialize:function(a){this.strings=new Array();if(a){this.append(a)}},append:function(a){this.strings.push(a);return this},toString:function(){return this.strings.join("")},isEmpty:function(){return this.strings.length==0}});var Table=new Class({Implements:[Options],options:{properties:{cellpadding:0,cellspacing:0,border:0},rows:[]},initialize:function(a){this.setOptions(a);this.table=new Element("table").setProperties(this.options.properties);this.tbody=new Element("tbody").inject(this.table);this.options.rows.each(this.push.bind(this))},push:function(d,c,a){var b=new Element("tr").inject(c||this.tbody);d.each(function(f){var g=new Element(a?"th":"td").inject(b);if(f.properties){g.setProperties(f.properties)}if(f.content){g.setContent(f.content)}else{g.setContent(f)}});return this},pushHead:function(a){if(!this.thead){this.thead=new Element("thead").inject(this.table,"top")}this.push(a,this.thead,true);return this},pushFoot:function(a){if(!this.tfoot){this.tfoot=new Element("tfoot").inject(this.table)}this.push(a,this.tfoot);return this},pushCaption:function(a){new Element("caption").setContent(a).inject(this.table,"top");return this}});var TabSet=new Class({Implements:[Options,Events],options:{onActive:function(){},onBackground:function(){},show:0,collapsable:false},initialize:function(){var a,b,c;Array.each(arguments,function(g,f){switch(typeOf(g)){case"object":a=g;break;default:var d=$$(g);if(!b){b=d}else{c=d}}});this.togglers=b||[];this.elements=c||[];this.setOptions(a);this.elements.each(function(f,d){this.togglers[d].addEvent("click",this.display.bind(this).partial(Function._,d));if(this.options.show===d){f.show();this.previous=d;this.fireEvent("onActive",[null,this.togglers[d],f])}else{f.hide()}},this)},display:function(b,a){if(this.options.collapsable&&a==this.previous){if(this.elements[a].isHidden()){this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);this.elements[a].show()}else{this.fireEvent("onBackground",[b,this.togglers[a],this.elements[a]]);this.elements[a].hide()}return this}if(this.previous||this.previous===0){this.elements[this.previous].hide();this.fireEvent("onBackground",[b,this.togglers[this.previous],this.elements[this.previous]])}this.previous=a;this.elements[a].show();this.fireEvent("onActive",[b,this.togglers[a],this.elements[a]]);return this}});var ToggleSet=new Class({initialize:function(b,c,a){this.index=a||0;this.togglers=b||[];this.elements=c||[];this.togglers.each(function(f,d){this.togglers[d].addEvent("click",this.display.bind(this,d));this.elements[d].hide()},this)},add:function(c,b){var a=this.togglers.length;this.togglers.push(c);this.elements.push(b);c.addEvent("click",this.display.bind(this,a));b.hide()},expand:function(a){this.togglers[a].addClass("open");this.elements[a].show();return this},collapse:function(a){this.elements[a].hide();this.togglers[a].removeClass("open");return this},display:function(a){if(this.previous==a){if(this.elements[a].isHidden()){this.expand(a)}else{this.collapse(a)}}else{if(this.previous||this.previous===0){this.collapse(this.previous)}this.previous=a;this.expand(a)}return this}});var Slider=new Class({Implements:[Options,Events],Binds:["clickedElement","draggedKnob"],options:{onChange:function(){},onComplete:function(){},onTick:function(a){this.knob.setStyle(this.p,a)},mode:"horizontal",steps:100,offset:0},initialize:function(d,a,b){this.element=$(d);this.knob=$(a);this.setOptions(b);this.previousChange=-1;this.previousEnd=-1;this.step=-1;this.element.addEvent("mousedown",this.clickedElement);var c,g;switch(this.options.mode){case"horizontal":this.z="x";this.p="left";c={x:"left",y:false};g="offsetWidth";break;case"vertical":this.z="y";this.p="top";c={x:false,y:"top"};g="offsetHeight"}this.max=this.element[g]-this.knob[g]+(this.options.offset*2);this.half=this.knob[g]/2;this.getPos=this.element["get"+this.p.capitalize()].bind(this.element);this.knob.setStyle("position","relative").setStyle(this.p,-this.options.offset);var f={};f[this.z]=[-this.options.offset,this.max-this.options.offset];this.drag=new Drag(this.knob,{limit:f,modifiers:c,snap:0,onStart:this.draggedKnob(),onDrag:this.draggedKnob(),onComplete:function(){this.draggedKnob();this.end()}.bind(this)});if(this.options.initialize){this.options.initialize.call(this)}},set:function(a){this.step=a.limit(0,this.options.steps);this.checkStep();this.end();this.fireEvent("onTick",this.toPosition(this.step));return this},setDefault:function(a){if(a>this.options.steps){a=this.options.steps}else{if(a<0){a=0}}this.step=a;this.end();this.knob.setStyle(this.p,this.toPosition(this.step)+"px");return this},scrolledElement:function(a){if(a.wheel<0){this.set(this.step+1)}else{if(a.wheel>0){this.set(this.step-1)}}a.stop()},clickedElement:function(b){var a=b.page[this.z]-this.getPos()-this.half;a=a.limit(-this.options.offset,this.max-this.options.offset);this.step=this.toStep(a);this.checkStep();this.end();this.set(this.step)},draggedKnob:function(){if(!this.drag){return}this.step=this.toStep(this.drag.value.now[this.z]);this.checkStep();this.setDefault(this.step)},checkStep:function(){if(this.previousChange!=this.step){this.previousChange=this.step;this.fireEvent("onChange",this.step)}},end:function(){if(this.previousEnd!==this.step){this.previousEnd=this.step;this.fireEvent("onComplete",this.step+"")}},toStep:function(a){return Math.round((a+this.options.offset)/this.max*this.options.steps)},toPosition:function(a){return this.max*a/this.options.steps}});var rules={};var rulesN={};var ajaxRules={};var Behavior=new Class({register:function(b){this.rules=b;for(var a in this.rules){this.reload(a)}for(var c in rulesN){this.reloadN(c)}return this},reload:function(c){var a=$$(c);for(var d=0;d<a.length;d++){try{this.rules[c](a[d])}catch(b){ta.util.error.record(b,"rules",null,{element:ta.util.error.getSelectorString(a[d]),ruleCount:d})}}return a.length},reloadN:function(b){var a=0;while(n=ta.id(b+(a++))){rulesN[b](n)}return a-1},apply:function(a){processLinks(a);for(var b in this.rules){window.applyLastRule=b;a.getElements(b).each(function(c){this.rules[b](c)},this)}for(var b in ajaxRules){window.applyLastRule=b;a.getElements(b).each(function(c){ajaxRules[b](c)},this)}}});window.behavior=new Behavior();TAReadyEvent=window.TAReadyEvent||"domready";if(Browser.ie&&(typeof semHotelBoxFocus!="undefined")&&semHotelBoxFocus){ta.queueForLoad(behaviorFunction,"Behavior")}else{window.addEvent(TAReadyEvent,behaviorFunction)}var bfCount=0;function behaviorFunction(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorStart=new Number(new Date())}if(Browser.ie&&(!$("FOOT")||!$("FOOT").readyState||$("FOOT").readyState!="complete")&&bfCount<10){bfCount++;behaviorFunction.delay(30);return}if(window.hideOnLoad){Array.from(hideOnLoad).each(function(c){var b=$(c);if(b){b.hide()}})}if(!Browser.ie6){searchFocus()}processLinks(document);behavior.register(rules);var a=$("MAIN");if((window.location.hash=="#Calculator")&&($("HOMEPAGE")||(a&&a.hasClass("VacationRentals"))||$("HOTEL_LANDER"))){showDHTMLOverlayOnLoad=function(){};if(typeof vrCalculator!="undefined"){vrCalculator()}}if(typeof performancePingbackInit!="undefined"){performancePingbackInit.behaviorEnd=new Number(new Date());performancePingbackInit.domreadyTimeSet=true;checkAndSendPerformancePingback()}}function searchFocus(){var a=ta.id("mainSearch");if(a&&a.className.match(/\b(focusOnLoad)\b/)){try{a.focus()}catch(b){}}}function checkAndSendPerformancePingback(){if(typeof performancePingbackInit!="undefined"&&performancePingbackInit.enabled&&performancePingbackInit.domreadyTimeSet&&performancePingbackInit.loadTimeSet){var a=performancePingbackInit.behaviorStart-performancePingbackInit.start;var b=performancePingbackInit.loadEnd-performancePingbackInit.start;var d=performancePingbackInit.behaviorEnd-performancePingbackInit.behaviorStart;var c="/PerformancePingback?ppuid="+performancePingbackInit.uid+"&load="+b+"&domready="+a+"&behavior="+d+"&servlet="+performancePingbackInit.servlet;new Request({url:c}).send()}}function onPageLoaded(){if(typeof performancePingbackInit!="undefined"){performancePingbackInit.loadEnd=new Number(new Date());performancePingbackInit.loadTimeSet=true;checkAndSendPerformancePingback()}}window.addEvent("load",onPageLoaded);rulesN.EOBF=function(a){var b=a.innerHTML+"@tripadvisor"+a.title;new Element("a",{href:"mailto:"+b}).setContent(b).replaces(a)};var linkMap={};var popupIndex=0;function popup(s,u,p,m,h,g,b,d,c,r){try{new Event(s).preventDefault();var a="",l=this.className.match(/sz(\d+)x(\d+)/),k=ta.id(document.body),j,t,f;if(l){p=l[1];m=l[2]}if(this.href.indexOf("p=HotelsCom")>-1){p=Math.max(p,960);m=Math.max(m,window.getHeight(),600)}if(p){a+=",width="+p}if(m){a+=",height="+m}if(h){a+=",screenX="+h+",left="+h}if(g){a+=",screenY="+g+",top="+g}if(a!==""){if(c){a="toolbar=1,resizable=1,menubar=1,location=1,status=1,scrollbars=1"+a}else{a="toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars="+(b?0:1)+a}}if(!d){d=this.href}t=u||("p"+(popupIndex++));if(r&&Browser.ie){f=new Element("a",{target:t,href:d});f.inject(k,"bottom");j=window.open("",t,a);f.click();f.destroy()}else{j=window.open(d,t,a)}if(j!==null){try{j.opener=self}catch(o){}j.focus()}}catch(q){ta.util.error.record(q,"behavior popup",s);throw q}}linkMap.js_popup=function(a,b){popup.attempt(b,a)};linkMap.js_popComm=function(a,b){popup.attempt([b,null,950,610,null,null,null,null,true],a)};linkMap.js_popMap=function(a,b){Cookie.write("mapPopup","1",{domain:cookieDomain});popup.attempt([b,"map",820,960],a)};linkMap.js_popNoScroll=function(a,b){popup.attempt([b,null,null,null,null,null,true],a)};linkMap.js_popCR=function(a,b){popup.attempt([b,"cr",245,610,5,5],a)};linkMap.js_email=function(a,b){popup.attempt([b,"email",580,460,30,25],a)};linkMap.js_popReview=function(a,b){popup.attempt([b,"review",550,395,30,25],a)};linkMap.js_popPhoto=function(a,b){popup.attempt([b,"photo",650,350],a)};linkMap.js_popGallery=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",782,820],a)};linkMap.js_popGalleryComm=function(a,b){Cookie.write("PhotoPop","1",{domain:cookieDomain});popup.attempt([b,"media",780,950],a)};linkMap.js_popDMO=function(a,b){popup.attempt([b,"dmo",400,400],a)};linkMap.js_popNxTall=function(a,b){popup.attempt([b,330,680],a)};linkMap.js_popNxWide=function(a,b){popup.attempt([b,730,380],a)};linkMap.js_popNxLogin=function(a,b){popup.attempt([b,"login",795,645],a)};linkMap.js_popFraud=function(a,b){popup.attempt([b,"fraud",640,460],a)};linkMap.js_popDestGd=function(a,b){popup.attempt([b,"dest_guide",565,700,(screen.width-700)/2,(screen.height-600)/2],a)};linkMap.js_popSmall=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,600,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,500,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popProfPhoto=function(a,b){if(screen.width>1024){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,620,450,240,5,false,false,true],a)}else{popup.attempt([b,null,475,390,210,5,false,false,true],a)}}return a};linkMap.js_popPartner=function(a,b){if(screen.width>1024){popup.attempt([b,null,980,500,240,5,false,false,true],a)}else{if(screen.width>800){popup.attempt([b,null,800,500,240,5,false,false,true],a)}else{popup.attempt([b,null,620,450,210,5,false,false,true],a)}}return a};linkMap.js_noTAPD=function(a,b){Cookie.dispose("TAPD",{domain:cookieDomain})};rules["a#TERMS"]=function(a){a.addEvent("click",popup.bind(a).partial(Function._,"terms",300,300,30,25))};linkMap.js_ajaxSubmit=function(a,f){if(!a.className.match(/\bform_(\w+)\b/)){return}var d=$(RegExp.$1);var c={url:a.href,data:d,onFailure:function(h){if(d){d.removeClass("ajaxInFlight")}ta.util.error.ajaxFailure("behavior:js_ajaxSubmit",h)}};var g=window["callback"+d.id];if(a.className.match(/method_(\w+)\b/)){c.method=RegExp["$1"]}if(a.className.match(/\btgt_(\w+)\b/)){c.update=RegExp["$1"]}else{c.onSuccess=function(h){if(d){d.removeClass("ajaxInFlight")}ta.overlays.showInLightbox(h);if(g&&typeOf(g)=="function"){g()}}}new Event(f).preventDefault();var b=window["validate"+d.id];if(b&&typeOf(b)=="function"&&b.apply(d)==false){return}d.addClass("ajaxInFlight");if(a.className.match(/\bevalScripts\b/)){c.evalScripts=true}(c.update?new Request.HTML(c):new Request(c)).send()};linkMap.js_ajax=function(a,b){new Event(b).preventDefault();if(!(tgt=a.className.match(/\btgt_(\w+)\b/))){return}tgt=$(tgt[1]);new Request.HTML({url:a.href,update:tgt,onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajax")}).send()};linkMap.js_ajaxlogin=function(b,c){new Event(c).preventDefault();if(!(tgt=b.className.match(/\btgt_(\w+)\b/))){return}var a=b.href;tgt=$(tgt[1]);new Request({url:b.href,onSuccess:function(d,g){var f=(d.indexOf("<!--nologin-->")<0);if(!f){login(["tt","ajax","returnTo",a+"&rd=1","greeting","showuserreviews_vote_25ee"])}else{tgt.innerHTML=d}},onFailure:ta.util.error.ajaxFailure.partial("behavior:js_ajaxLogin")}).send()};linkMap.js_ajaxReport=function(a,b){ajaxReport.attempt(b,a)};var ajaxReport=function(a){new Event(a).preventDefault();ta.overlays.loadInLightbox(this.href)};function toggle(a){new Event(a).preventDefault();this.toggleClass("off")}var toggleMeRule=function(a){if(false==a.hasClass("defaultOpen")){a.addClass("off")}a.getElements(".show").addEvent("click",toggle.bind(a));a.getElements(".hide").addEvent("click",toggle.bind(a))};rules["#TOGGLEME"]=toggleMeRule;rules["#TOGGLEME2"]=toggleMeRule;ajaxRules["div.js_swapBlocks"]=function(b){var a=b.getElement(".js_swapOut");var c=b.getElement(".js_swapIn");var d=b.getElement("a.js_swapTrigger");var f=b.getElement("a.js_swapBackTrigger");if(a&&c&&d){d.addEvent("click",function(g){new Event(g).preventDefault();window.removedBit=a.dispose();c.show()});d.removeClass("js_swapTrigger")}if(a&&c&&f){f.addEvent("click",function(g){new Event(g).preventDefault();c.hide();$("parentOfSwapOut").appendChild(window.removedBit)});f.removeClass("js_swapBackTrigger")}};ajaxRules["#PM_UNBLOCK"]=function(a){a.addEvent("submit",function(c){new Event(c).stop();var b=$("PM_UNBLOCK");if(b.unblock.value=="1"){new Request({url:"/SendMessageRD",data:b,onSuccess:ta.overlays.showInLightbox,onFailure:ta.util.error.ajaxFailure.partial("behavior:#PM_UNBLOCK")}).request()}else{$("unblock-intercept").hide();$("blockedreply").show();b.unblock.value="1"}})};function enableCommunity(c,a){var b=c;if(!a){b=function(d){enableCommunityResponse(d,c)}}if(typeof(JS_SECURITY_TOKEN)=="undefined"){JS_SECURITY_TOKEN=""}new Request({url:"/MemberSubscriptionsController",data:{Action:"ChangeM2M",set:"on",token:JS_SECURITY_TOKEN},onSuccess:b,onFailure:ta.util.error.ajaxFailure.partial("behavior:enableCommunity")}).send()}function enableCommunityResponse(res,callback){var isf=document.getElementById("inviteStatusField");if(txt.match(/^{/)){var data=eval("("+txt+")");if(data.ERROR){isf.innerHTML=data.ERROR;isf.style.display="block"}}else{isf.innerHTML=JS_community_on;isf.style.display="block"}}function getRelativeURL(){return window.location.pathname+window.location.search+window.location.hash}var follow=function(a){return function(){window.location=$(a).href}};function showToggleBlock(a){$$(".js_toggleBlocks .js_toggleBlock").each(function(c,b){c.hide();if(c.hasClass(a)){c.show()}})}linkMap.js_toggleBlockTrigger=function(b,c){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(d){a=d});showToggleBlock(a)};rules["#SWAPBLOCK .js_toggleBlock"]=function(b){if(b.hasClass("js_toggleBlockSelected")){var a=b.getProperty("class");a.replace(/toggleBlock[0-9]+/g,function(c){a=c});showToggleBlock(a)}};var showLastSavesRD=function(){var a=$("LAST_SAVES_PLACEHOLDER");if(typeof savesIncluded!="undefined"){if(!a){return renderLastSaves(SAVES_RECENT_SAVES)}else{a.innerHTML=renderLastSaves(SAVES_RECENT_SAVES);flyout.positionCorners()}}else{if(!a){new Asset.javascript(savesJS);showLastSavesRD.delay(125);return new Element("div",{id:"LAST_SAVES_PLACEHOLDER"})}}};var showSavesWidget=function(d,g,c,b,h,f,a){if(typeof savesIncluded!="undefined"){showSavesWidget2(d,g,c,b,h,f,a)}else{new Asset.javascript(savesJS);showSavesWidget.delay(125,null,[d,g,c,b,h,f,a])}};var savesInlineLoginOnClickHandler=function(c,a,b){if(typeof savesIncluded!="undefined"){savesInlineLoginOnClickHandler2(c,a,b)}else{new Asset.javascript(savesJS);savesInlineLoginOnClickHandler.delay(125,null,[c,a,b])}};linkMap.js_trackDirPop=function(a,b){if(actionToRecord=a.className.match(/ar_(\w+)/)){actionToRecord=actionToRecord[1];new Request({url:"/ActionRecord?action="+actionToRecord}).send()}};function clearPopupForm(){$$("#POPUP_FORM #pass").setProperty("value","");$$("#DHTMLPOPUP .error-message").empty()}linkMap.js_clearPopupForm=function(a,b){clearPopupForm()};function setPopupFormAction(a){$$("#POPUP_FORM #action").setProperty("value",a)}linkMap.js_popupFormAction1=function(a,b){setPopupFormAction("1")};linkMap.js_popupFormAction2=function(a,b){setPopupFormAction("2")};var replaceContent=ta.util.element.replaceContent;linkMap.js_replaceContent=function(d,f){var b=d.className.match(/id_([^\s"]*)?/);if(!b||b.length!=2){throw new Error("Links with behavior js_replaceContent must also have a style class id_??? to indicate which element's contents should be replaced")}b=b[1];var c=$(b);var a=d.href;if(a){replaceContent(f,c,a)}f.stop()};var doBehavior=function(b){var b=new Event(b||window.event);var a=ta.id(b.target);if(a.get("tag")!="a"){a=a.getParent("a")}if(/pid(\d+)/.test(a.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}(a.className.match(/(js_\w+)/g)||[]).each(function(d){linkMap[d](a,b)})};function _processLink(a){if(a.className.indexOf("js_")>=0||a.className.indexOf("pid")>=0){if(a.addEventListener){a.addEventListener("click",doBehavior,false)}else{a.attachEvent("onclick",doBehavior)}try{if(a.className.match(/\b(js_pop)/)&&window.noPopClass){a.className=a.className+" "+window.noPopClass}}catch(b){ta.util.error.record(b,"_processLink - add no pop class")}}}function processLinks(a){var b=Array.from(a.getElementsByTagName("a"));b.each(_processLink);return b.length}if(typeof behavior=="undefined"){ta.queueForLoad(function(){processLinks(document)},"ProcessLinkBehavior")}(function(){function a(){if(window==window.top){var j=Cookie.read("ajaxAction");if(j){j=j.split("|");if(/^target:(\/[\w\d_-]+)/.test(j[0])){if(window.location.pathname.indexOf(RegExp.$1)!==0){return}j=j.slice(1)}else{if(window.opener){return}}Cookie.dispose("ajaxAction",{domain:cookieDomain,path:"/"});if((j[0]=="focus"||j[0]=="click")&&j.length>1){for(var f=0;f<j.length;f+=2){var d=ta.select(j[f+1]);if(d&&d.length){try{d[0][j[f]]()}catch(g){ta.util.error.record(g,"ajaxAction",null,{funcName:j[f],elmt:j[f+1]})}}}}else{try{var b=j.slice(1);b.unshift({});b.unshift(j[0]);ta.run.apply(null,b)}catch(h){ta.util.error.record(h,"ajaxAction",null,{funcName:j[0]})}}}}}ta.queueForLoad(function(){Cookie.dispose("TATypeAhead");a();if(Browser.firefox||Browser.safari||Browser.chrome){var c=window.location.hash;if(c.length>1){c=c.substring(1)}var b=ta.id(c);if(b&&b.getTop()!=window.getScrollTop()){window.scrollTo(0,b.getTop())}}if(/^#save/.test(location.hash)){doSavesPostLoginPopup()}freshVSCookieCheck()},"On_Load_Popups")}());ta.queueForLoad(function(){if(typeof cpu_run!="undefined"){cpu_run()}},"Commerce Popunder");function freshVSCookieCheck(){if(typeof freshVSTrackingCookie!="undefined"&&freshVSTrackingCookie){var a=new Cookie("v1st").readRaw();if(a){new Request({url:"/VSCookieRequest"}).send()}}}function royBatty(){if(typeof taSecureToken=="undefined"||!taSecureToken){return}try{var d=Cookie.read("roybatty");if(!d){Cookie.write("roybatty",taSecureToken+",1",{domain:cookieDomain});if(ta.browser&&ta.browser.isIE10Metro&&ta.browser.isIE10Metro()){new Request({url:"/CookiePingback?metroBrowser=true"}).send()}else{new Request({url:"/CookiePingback"}).send()}}else{var b=d.split(",");if(b&&b.length==2){var a=parseInt(b[1],10);Cookie.write("roybatty",taSecureToken+","+a,{domain:cookieDomain})}else{ta.util.error.record(null,"royBatty -- Bad value in cookie: "+d)}}}catch(c){ta.util.error.record(c,"javascript exection bot detection error")}}ta.queueForLoad(function(){if(typeof royBatty!="undefined"){royBatty()}},"RoyBatty");var doSavesPostLoginPopup=function(){if(typeof savesIncluded!="undefined"){handleSavesPostLoginPopup()}else{new Asset.javascript(savesJS);doSavesPostLoginPopup.delay(125)}};if(window.showPopup){showPopup()}var popupConfig={};function DHTMLOverlayRequest(g,f,c,d){var b="?";if(popupConfig.servletUrl.contains(b)){b="&"}if(popupConfig.servletUrl.contains("fromServlet=")){var a=popupConfig.servletUrl+b+"Action="+g}else{var a=popupConfig.servletUrl+b+"Action="+g+"&fromServlet="+pageServlet}new Request({url:a,onSuccess:f,onFailure:c,data:d,evalScripts:true}).send()}function showDHTMLPopup(b,g,d,a,f){try{popupConfig.servlet=b;popupConfig.servletUrl=g;popupConfig.lightbox=d;popupConfig.options=a;if(a&&a.loading&&f){f=new Event(f);ta.id(a.loading).show().inject(document.body).setStyles({left:f.page.x+20,top:f.page.y})}DHTMLOverlayRequest("Open",DHTMLOverlayResponse,null,a?a.data:null)}catch(c){ta.util.error.record(c,"showDHTMLPopup - "+b,f)}}var DHTMLOverlayResponse=function(h){if(!ta.overlays||!ta.overlays.Factory){ta.load("ta-overlays",function(){DHTMLOverlayResponse(h)});return}if(popupConfig.options&&popupConfig.options.forward&&window.popupForward){window.location=window.popupForward}$$("#FLYOUT").each(function(l,k){l.dispose()});window.lightbox.deactivate();$$(".overlay").each(function(l,k){if(l.overlay&&l.overlay.hide){l.overlay.hide()}else{if(l.hide){l.hide()}else{l.dispose()}}});if(popupConfig.options&&popupConfig.options.loading){ta.id(popupConfig.options.loading).hide()}var d;var c={};if(popupConfig.lightbox){c.backdrop=ta.overlays.BACKDROP_ALWAYS}if(popupConfig.options&&popupConfig.options.delayedPosition){c.delayedPosition=popupConfig.options.delayedPosition}if(popupConfig.options&&popupConfig.options.permanent){c.permanent=popupConfig.options.permanent}if(popupConfig.options&&popupConfig.options.center){c.autoShow=false;d=new ta.overlays.CenteredOverlay(c)}else{if(popupConfig.options&&popupConfig.options.permanent){c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.PermanentOverlay(c)}else{if(popupConfig.options&&popupConfig.options.daodaoPopup){c.xOffset=ta.id("PAGE").getLeft()+240;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}else{c.xOffset=ta.id("PAGE").getLeft()+100;c.yOffset=ta.id("PAGE").getTop()+220;d=new ta.overlays.AbsoluteOverlay(c)}}}d.loadRemoteSuccess(h);d.show();ta.popups.PopUtil.trackPopup(popupConfig.servletUrl);var j=function(){if(typeof dhtmlRedirectLink!="undefined"){window.location=dhtmlRedirectLink;return}if(this.inner.getElement(".refreshOnClose")){document.location.reload();return}if(typeof addPopupCloseClass!="undefined"&&!this.inner.getElement(".silentClose")){DHTMLOverlayRequest("Close")}if(this.inner.getElement(".popupBackOnClose")){if(/(?:^|;)\\s*TAReturnTo=\%1\%([^;]*)/.test(document.cookie)){window.location=decodeURIComponent(RegExp.$1)}else{window.location="/"}}};d.addEvent("onHide",j);if(popupConfig.servlet){d.container.addClass(popupConfig.servlet);d.container.addClass("np");if(popupConfig.servlet=="RuleBasedPopup"&&popupConfig.options&&popupConfig.options.cmsDisplayName){d.container.addClass(popupConfig.options.cmsDisplayName)}d.inner.getElements(".popupConvert").each(function(l,k){l.addEvent("click",function(){DHTMLOverlayRequest("Convert")})});d.inner.getElements(".popupDecline").each(function(l,k){l.addEvent("click",function(){DHTMLOverlayRequest("Decline")})});d.inner.getElements(".dhtmlclose").each(function(l,k){l.addEvent("click",function(){var m=d;m.hide()})});var b=function(l){var k=(l.charCode)?l.charCode:((l.which)?l.which:l.keyCode);if(k==13||k==10){f(l)}};var g=function(l){var k=(l.charCode)?l.charCode:((l.which)?l.which:l.keyCode);if(k==13||k==10){new Event(l).preventDefault()}};d.inner.getElements(".popupSubmitOnEnter").each(function(l,k){l.addEvent("keydown",b)});var a=function(k){$$("#POPUP_FORM #sendpass").setProperty("value","true");f(k)};d.inner.getElements(".popupSendForgotEmail").each(function(l,k){l.addEvent("click",a)});var f=function(k){new Event(k).preventDefault();d.inner.getElements(".popupSubmit").each(function(m,l){m.removeEvent("click",f)});d.inner.getElements(".popupSendForgotEmail").each(function(m,l){m.removeEvent("click",a)});d.inner.getElements(".popupSubmitOnEnter").each(function(m,l){m.removeEvent("keydown",b);m.addEvent("keydown",g)});d.inner.getElements(".focusClear").each(function(m,l){m.setProperty("value","")});if(popupConfig.options&&popupConfig.options.disableOnHideForSubmit){d.removeEvent("onHide",j)}DHTMLOverlayRequest("Submit",DHTMLOverlayResponse,null,d.inner.getElementById("POPUP_FORM"))};d.inner.getElements(".popupSubmit").each(function(l,k){l.addEvent("click",f)})}if(popupConfig.options&&popupConfig.options.callback){popupConfig.options.callback(d.container)}};function showOwnersDHTMLPopup(b,c){var a={callback:enableAffilBox};showDHTMLPopup(b,c,true,a)}function enableAffilBox(c){if(typeof c=="undefined"||c==null){return}for(var a=0;a<3;a++){var d="affil_"+a;var b=c.getElementById(d);if(b!=null&&b!=false&&b!=""){b.style.visibility="visible"}}}var cpu_win;function verifyPopunderExists(b){try{if(cpu_win&&cpu_win.location){return}}catch(a){}new Request({url:"/ActionRecord?action=EXITWINDOWLOG_popunderfollowup|fail|delay="+b}).send()}function doCookieCheck(){Cookie.write("SessionTest","true",{duration:0});if(Cookie.read("SessionTest")){Cookie.dispose("SessionTest");return true}return false}var blurPopunder=function(){try{var a=window.open("about:blank");if(a){a.focus();a.close()}}catch(b){ta.util.error.record(b,"commercePopunder - FF/Chrome blur failed")}};var suppressPopOnClick=function(g){var d=new Event(g||window.event);var c=ta.id(d.target);if(c){if(window.noPopClass&&(c.hasClass&&c.hasClass(window.noPopClass))||(c.getParent&&c.getParent("."+window.noPopClass))){return"no_cpu_class"}var a=c.onclick;if(a&&a.toString&&a.toString().match(/window\.open/g)){return"onclick_script"}if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){var f=c;while(f){var b=f.onclick?f.onclick.toString():false;if(b&&(b.match(/ta\.call/g)||b.match(/ta\.util\.Doer\.aimdoit/g))){return"onclick_ta_call"}f=f.parentNode}if(d.target&&d.target.nodeName&&d.target.nodeName.toLowerCase()=="html"){return"onclick_invalid_target"}if(d.type=="mousedown"&&d.event&&d.event.button!=0){return"onclick_not_left_button"}}if(c.target&&"a"===c.get("tag")){return"has_target"}}if(ta.browser.isIE10Metro()){return"ie10metro"}return false};if((typeof cpu_enabled!="undefined"&&cpu_enabled)){var cpu_paused=false;var cpu_go_impl=function(H,q){try{var k=ta.has("checkrates.add_holding_windows");var j=new Cookie("CommercePopunder").readRaw();var L=ta.popups.PopUtil.numPopundersCheck();var g=ta.popups.PopUtil.hasMTPU();if(q=="unload"){if(Browser.chrome){return"Chrome_unload"}else{if(k&&Browser.ie){return"IE_unload"}}}if(cpu_paused&&q=="unload"&&!isTakeOver){return"paused"}if(!doCookieCheck()){return"failed_cookie_check"}if(k&&(ta.popups.PopUtil.hwClosed||j.substr(0,11)=="SuppressAll")){return"user closed holding window"}if(!k||(k&&L>=ta.popups.PopUtil.maxPopunders)){if(j&&isTakeOver&&q=="click"){return"already_popped"}else{if(j&&!isTakeOver){if(j!="SuppressUnload"||q!="click"){return"already_popped"}}}}var E=typeof IS_MTPU_ENABLED!="undefined"&&IS_MTPU_ENABLED&&typeof MTPU_RULE!="undefined"&&MTPU_RULE>0&&!g;var U=E;if(q=="click"){try{var z=suppressPopOnClick(H);if(ta.has("checkrates.add_holding_windows")&&!E){var v=false;var m=/Hotel_Review|ShowUserReviews|Hotels|SmartDeals/;if(pageServlet&&m.test(pageServlet)){v=true;ta.store("checkrates.HWtracking","page")}var C=false;if(H.target&&H.target.href&&m.test(H.target.href)){C=true;ta.store("checkrates.HWtracking","link")}if(!v&&!C){z="add holding windows ineligible"}}if(z){return z}}catch(D){ta.util.error.record(D,"commercePopunder - suppressPopOnClick");return"error"}}if(typeof blockPU!="undefined"&&blockPU){return"block_pu"}var G="";if(typeof pageServlet!="undefined"&&pageServlet!==null){G=pageServlet}var O=new Cookie("TASession").readRaw();if(O&&/\*PD(\d+)\.(\d+)/.test(O)&&/\*CC\.(\d+)/.test(O)&&!U){return"commerce_click_happened"}if((!O||!(/\*LL\.(\d+)/.test(O)))&&!U){return"bug_28579"}var M=1;var Q=1;try{if(Browser.ie7){M=250;Q=100}if(Browser.safari||Browser.chrome){M=85;Q=100}}catch(D){ta.util.error.record(D,"commercePopunder - access to window attributes",H,{type:q})}var r=0,o=0;try{r=(window.screenLeft||window.screenX);o=(window.screenTop||window.screenY)}catch(T){ta.util.error.record(D,"commercePopunder - setting nX and nY",H,{type:q});r=undefined;o=undefined}var K=0,J=0;try{if(typeof(r)=="undefined"){r=0;o=0;K=r+window.screen.availWidth-M;J=o+window.screen.availHeight-Q}else{K=r+window.getWidth()-M;J=o+window.getHeight()-Q}}catch(D){ta.util.error.record(D,"commercePopunder - setting x and y",H,{type:q});K=200;J=200}try{if(Browser.ie7){J=J-95;K=K+13}else{if(Browser.safari||Browser.chrome){J=J-16}else{K=5000;J=5000}}}catch(D){ta.util.error.record(D,"commercePopunder - access to window attributes",H,{type:q})}if(!c){c=""}try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(R){ta.util.error.record(R,"commercePopunder - localStorage after before pop",null,{},"WARN")}var B="";if(typeof overlayBackupLoc!=undefined&&overlayBackupLoc){B="&backupLoc="+overlayBackupLoc}var s="";try{if(!!ta.retrieve("popunder.similar_hotels_new_rules")){s="http://"+window.location.hostname+"/SimilarHotelsPopunder?MTPU_RULE=0"}else{var b=window.escape(window.location.href);s="http://"+window.location.hostname+"/CommercePopunderEnhanced?mainWindowReturnTo="+b+"&fromServlet="+G+B}}catch(D){ta.util.error.record(D,"commercePopunder - error accessing window.location setting cpu_uri",H,{type:q})}var a=790;var f=660;if(!!ta.retrieve("popunder.similar_hotels")&&typeof MTPU_RULE!="undefined"&&(MTPU_RULE==286||MTPU_RULE==287||MTPU_RULE==315||MTPU_RULE==584||MTPU_RULE==586||MTPU_RULE==597||MTPU_RULE==598||MTPU_RULE==599||MTPU_RULE==600||MTPU_RULE==601||MTPU_RULE==602||MTPU_RULE==603||MTPU_RULE==604||MTPU_RULE==610||MTPU_RULE==611||MTPU_RULE==613||MTPU_RULE==629||MTPU_RULE==630||MTPU_RULE==632||MTPU_RULE==633||MTPU_RULE==634||MTPU_RULE==635||MTPU_RULE==680||MTPU_RULE==681||MTPU_RULE==682||MTPU_RULE==683||MTPU_RULE==684||MTPU_RULE==685||MTPU_RULE==689||MTPU_RULE==690||MTPU_RULE==692||MTPU_RULE==693||MTPU_RULE==694||MTPU_RULE==695||MTPU_RULE==696||MTPU_RULE==697||MTPU_RULE==698||MTPU_RULE==699||MTPU_RULE==712||MTPU_RULE==716||MTPU_RULE==717||MTPU_RULE==719||MTPU_RULE==720||MTPU_RULE==721||MTPU_RULE==722||MTPU_RULE==723||MTPU_RULE==724||MTPU_RULE==726||MTPU_RULE==727||MTPU_RULE==733||MTPU_RULE==734||MTPU_RULE==735||MTPU_RULE==736||(MTPU_RULE==771&&!!ta.retrieve("popunder.similar_hotels_new_rules")))){s="http://"+window.location.hostname+"/SimilarHotelsPopunder?MTPU_RULE="+MTPU_RULE;if(Browser.ie){f=750;a=950}else{a=960}if(ta.retrieve("similar_hotels_exit_window_chevron")){a=1040}}else{if(E){if(typeof geoParam!="undefined"&&geoParam){s="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+G+geoParam+B}else{s="http://"+window.location.hostname+"/RuleBasedPopunder?Rule="+MTPU_RULE+"&fromServlet="+G+B}}}if(q=="click"){s=s+"&onclick=1"}var S=(s.test(/RuleBasedPopunder\?Rule=286/)||s.test(/RuleBasedPopunder\?Rule=287/))?true:false;if(S){a=740;f=700;if(Browser.ie){a=a+10}}try{var l=1;var d=1;if(ta.browser&&ta.browser.isIE9orHigher&&ta.browser.isIE9orHigher()){l=0}else{if(Browser.chrome||Browser.firefox){if(Browser.chrome){d=0}M=a;Q=f;K=r+(window.getWidth()-a)/2;J=o+(window.getHeight()-f)/2}}if(k){if(ta.has("checkrates.avlb_popup_win")&&!E){var p=ta.id(H.target);var t=["checkRatesType=checkRates","avlbType=popup"];var N=false;var F=false;if(p&&p.href){var u=p.href.match(/-d(\d+)/);if(u){t.push("d="+u[1]);N=true}else{var P=p.href.match(/-g(\d+)/);if(P){t.push("g="+P[1]);F=true}}}else{if(typeof(modelLocId)!="undefined"&&modelLocId){t.push("d="+modelLocId);N=true}else{if(typeof(modelGeoId)!="undefined"&&modelGeoId){t.push("g="+modelGeoId);F=true}}}if(N||F){s="http://"+window.location.hostname+"/AlsoViewedLB?"+t.join("&")}else{return}}cpu_win=ta.popups.PopUtil.launchAddHoldingWindow(s)}else{if(ta.has("popunder.popunder_by_self_focus")){window.open("javascript:window.focus()","_self","")}if(Browser.chrome&&(Browser.version>29)){return"chrome_version_too_high"}else{cpu_win=window.open(s,"CommercePopunder","toolbar=1,location=1,directories=1,status=1,menubar="+l+",resizable=1,copyhistory=1,scrollbars="+d+",width="+M+",height="+Q+",left="+K+",top="+J)}}var A=1;var c=window.cookieDomain;if(!c){c=""}if(cpu_win!=null){if(!ta.has("popunder.popunder_by_self_focus")||ta.has("popunder.popunder_by_self_focus_shift_ctrl")){if(ta.has("checkrates.cr_popunder_by_shift_ctrl")&&Browser.version>23){ta.popups.PopUtil.openCloseTab()}else{if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){ta.store("checkrates.popunder",true)}}}var I=L+1;if(!k){ta.popups.PopUtil.trackPopunder(s,I)}if(!k){try{try{if(((Browser.firefox&&Browser.version>3.6)||(Browser.chrome&&(Browser.version<17||(Browser.version>20&&Browser.version<23))))&&q=="click"){blurPopunder()}}catch(R){ta.util.error.record(R,"commercePopunder - FF/Chrome did not blur")}cpu_win.opener=self;cpu_win.blur();window.focus();try{if(!Browser.chrome&&!Browser.firefox){cpu_win.moveTo(r+(window.getWidth()-a)/2,o+(window.getHeight()-f)/2);cpu_win.resizeTo(a,f)}}catch(R){ta.util.error.record(R,"commercePopunder - after pop, resize/move")}}catch(R){ta.util.error.record(R,"commercePopunder - after pop",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressAll*"+new Date().getTime(),{domain:c,duration:A})}else{Cookie.write("CommercePopunder","HW"+I,{domain:c,duration:0})}}else{ta.util.error.record(null,"commercePopunder - past rules, no pop",null,{},"WARN");if(q=="unload"){try{if(window.localStorage){localStorage.setItem("CommercePopunder.timeStamp",new Date().getTime())}}catch(R){ta.util.error.record(R,"commercePopunder - localStorage after pop unload fail",null,{},"WARN")}Cookie.write("CommercePopunder","SuppressUnload",{domain:c,duration:A})}}}catch(D){ta.util.error.record(D,"commercePopunder - pop window",H,{type:q})}}catch(R){ta.util.error.record(R,"commercePopunder - general",H,{type:q})}};var cpu_go=function(c,a){var b=cpu_go_impl(c,a);if(false&&document.getElement("#MAIN .poolR")&&b&&!ta.has("popunder.actionrecord")&&(b<4||b>6)){ta.store("popunder.actionrecord",true);new Request({url:"/ActionRecord?action=CPU_block_"+b}).send()}};var cpu_resume=function(){window.cpu_paused=false};var cpu_pause=function(c){var b=new Event(c||window.event);var a=ta.id(b.target);if(!cpu_paused&&a&&(a.get("tag")=="a"||a.getParent("a"))){window.cpu_paused=true;cpu_resume.delay(1000)}};var cpu_run=function(){if(Browser.chrome&&(Browser.version>29)){return}window.addEvent("beforeunload",function(a){cpu_go(a,"unload")});if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){document.addEvent("mousedown",cpu_pause)}else{document.addEvent("click",cpu_pause)}if(ta.has("checkrates.belligerent_hw")&&Browser.version>22){document.addEvent("mousedown",function(a){cpu_go(a,"click")});document.addEvent("click",ta.popups.PopUtil.openCloseTab)}else{document.addEvent("click",function(a){cpu_go(a,"click")})}}}function expandIframe(c,a,b){if(document.getElementById(c)){document.getElementById(c).width=a;document.getElementById(c).height=b}}function collapseAd(c){var a=ta.id(c);if(a==null){return}var b=ta.id(a.parentNode);if(b&&b.hasClass&&b.hasClass("adServer")){b.addClass("taEmpty")}else{ta.util.error.record(null,"ta.common.ads.collapseAd:fail",null,{},"WARN")}}function createAdIframe(d,b,a){var c=document.createElement("iframe");c.setAttribute("id",d);c.setAttribute("name",d);c.setAttribute("height",0);c.setAttribute("width",0);c.setAttribute("scrolling","no");c.setAttribute("border","0");c.setAttribute("marginheight","0");c.setAttribute("marginwidth","0");c.setAttribute("frameBorder","0");c.setAttribute("src","http://"+document.location.host+"/"+b+"#"+a);return c}function injectAds(){var d=$$(".adServer .details");if(d.length==0){return}var b="adp/adp.html";if(adpHtml){b=adpHtml}var a=window.documentDomainChanged?"dd+":"";for(var c=0;c<d.length;c++){var f=ta.id(d[c]).getParent(".adInner");if(f&&f.hasClass("deferAd")){continue}var g=d[c].id+"_iframe";if(!ta.id(g)){d[c].getParent().appendChild(createAdIframe(g,b,a+d[c].id))}}if(typeof PXL8_JS_SRC!="undefined"){setTimeout(ta.common.ads.addPixalateTracking,500)}}function injectAdsTargeted(a,b){ta.common.ads.injectAdsTargeted(a,b)}function getIncrementedAdsAjaxCount(){return ta.common.ads.getIncrementedAdsAjaxCount()}window.addEvent("load",function(){injectAds.delay(10)});ta.common.ads={_ajaxCount:0,getIncrementedAdsAjaxCount:function(){return ++ta.common.ads._ajaxCount},injectAdsTargeted:function(d,g){if(!d){return}var f=d.getElements(".adServer .details");if(f.length==0){return}var b="adp/adp.html";if(adpHtml){b=adpHtml}var a=window.documentDomainChanged?"dd+":"";for(var h=0;h<f.length;h++){var l=f[h].getParent(".adServer");var j=f[h].id+"_iframe";if(ta.id(j)){var k=f[h].cloneNode(true);l.empty().grab(k)}var c=createAdIframe(j,b,a+f[h].id);if(g){ta.id(c).addEvent("load",g)}l.appendChild(c)}},loadMonikers:function(){try{var b=ta.retrieve("ads.monikerUrl");if(b!=null){ta.common.ads._doLoadMonikers(b)}}catch(a){ta.util.error.record(a,"dynamic load of page monikers",null,{URL:"$iFrameURL"},"INFO")}},loadClickOutMonikers:function(){try{var b=ta.retrieve("ads.monikerClickOutUrl");if(b!=null){ta.common.ads._doLoadMonikers(b)}}catch(a){ta.util.error.record(a,"dynamic load of click out page monikers",null,{URL:"$iFrameURL"},"INFO")}},_doLoadMonikers:function(a){if(!a){return}try{var b=document.createElement("iframe");b.setAttribute("id","Monikers");b.setAttribute("width","1");b.setAttribute("height","1");document.body.appendChild(b);b.setAttribute("src",a)}catch(c){ta.util.error.record(c,"ta.common.ads._doLoadMonikers: failed to append iframe to body.")}},getMetaContent:function(c){var g=document.getElementsByTagName("meta");for(var b=0;b<g.length;b++){var f=g[b];var a=f.name;var d=new RegExp(c,"i");if(a.match(d)){return f.content.replace(/["<>]/g,"")}}return""},loadMonikersAdcomHelper:function(){var a=ta.common.ads.getMetaContent("keywords");var c=ta.common.ads.getMetaContent("description");var d=document.location.href;var f=document.referrer;var b="/uvpages/adcom.html?pageRef="+encodeURIComponent(f)+"&keywords="+encodeURIComponent(a)+"&description="+encodeURIComponent(c)+"&pageUrl="+encodeURIComponent(d);ta.common.ads._doLoadMonikers(b)},SEGMENT_MAP:{family:"fam",trendy:"trendy_hotel",business:"biz",on_the_beach:"beach",ski_in_out:"ski",luxury:"luxury",spa:"spa",casino:"casino"},resetAdsOnPage:function(a,c){if(typeof a=="object"&&a.length&&a[0].className&&a[0].className.indexOf("adInner")>-1){if(typeof window.ta_handleAdDefer=="function"){window.removeEvent("scroll",window.ta_handleAdDefer)}try{a.each(function(g){var f=false;if(typeof c=="object"){if(c.triptype&&!c.seg){var d=ta.common.ads.SEGMENT_MAP[c.triptype];if(d){c.seg=d}}f=ta.common.ads._updateAdDetails(g,c)}g.setAttribute("style","");ta.common.ads._resetAdServerDiv(g.getElement(".adServer"));ta.common.ads._addToDeferredQueue(g)})}catch(b){ta.util.error.record(b,"error resetting ads on page")}if(typeof window.ta_handleAdDefer=="function"){window.addEvent("scroll",window.ta_handleAdDefer)}}else{ta.util.error.record(b,"adParents must be an Array of .adInner elements")}},_resetAdServerDiv:function(b){try{b.removeClass("taEmpty");var a=b.getElement(".details");a.inject(b.empty(),"top")}catch(c){ta.util.error.record(c,"error resetting adServer div")}},_updateAdDetails:function(t,d){try{var g=t.getElement("input[id$=_url]");if(g){var k=g.value;if(typeof d=="object"){for(var s in d){var b=false;var r=t.childNodes;if(r){for(var j=0;j<r.length;j++){if(r[j].nodeType==8){b=r[j];break}}}if(b&&b.nodeValue.match("tile")){var p=b.nodeValue;var q=new RegExp(s+"=\\w*(?=\\W)");var l=new RegExp(s+"="+d[s]+"(?=\\W)");var f=s+"="+d[s];if(!p.match(l)){if(p.match(q)){if("seg"==s){var c=new RegExp(s+"=\\w*(?=\\W)","gi");var o=k.match(c);var h=o[o.length-1];var a=new RegExp(h+"(?=\\W)");b.nodeValue=p.replace(a,h+"\n"+f)}else{b.nodeValue=p.replace(q,f)}}else{b.nodeValue=p.replace(/\ntile=/,"\n"+f+"\ntile=")}}}k=ta.common.ads._updateAdParam(k,s,d[s])}g.value=k;return true}}else{ta.util.error.record(null,'error updating ad script; no input element found ending in "_url"')}}catch(m){ta.util.error.record(m,"error updating ad script")}return false},_addToDeferredQueue:function(c){var b=ta.retrieve("deferAds.ads");if(b){for(var a=0;a<b.length;a++){if(b[a].id&&c.id&&b[a].id==c.id){return}}}else{b=[]}if(c){b.push(c);ta.store("deferAds.ads",b)}},_updateAdParam:function(f,g,l){var k=new RegExp(";"+g+"=\\w*(?=$|;)");var h=new RegExp(";"+g+"="+encodeURI(l)+"(?=$|;)");var c=";"+g+"="+encodeURI(l);if(f.length&&!f.match(h)){if(f.match(k)){if("seg"==g){var b=new RegExp(";"+g+"=\\w*(?=$|;)","gi");var j=f.match(b);var d=j[j.length-1];var a=new RegExp(d+"(?=$|;)");return f.replace(a,d+c)}else{return f.replace(k,c)}}else{return f.replace(/;sz=/gi,c+";sz=")}}else{return f}},refreshAdAjax:function(b,a,c,d){new Request({url:"/InjectAdAjax?t="+a+"&adParamKey="+c+"&adParamVal="+d,method:"get",evalScripts:true,onSuccess:function(f,g){var h=document.getElement(b);if(h){h.empty();h.set("html",f);injectAdsTargeted(h)}else{ta.util.error.record(null,"ta.common.ads.refreshAdAjax: target not found")}},onFailure:function(f,g){ta.util.error.record(null,"ta.common.ads.refreshAdAjax: request failed")}}).send()},deferAds:function(){var l=ta.retrieve("deferAds.ads");var k=1000;if(!l){return}try{var j=false;for(var f=0,g=l.length;f<g;f++){var d=ta.id(l[f]);if(d&&d.getTop()<=(window.getScroll().y+window.getHeight())){if(d.hasClass("deferAd")){injectAdsTargeted(d);if(typeof PXL8_JS_SRC!="undefined"){setTimeout((function(m){return function(){ta.common.ads.addPixalateTracking(m)}})(d.id),500)}if(d.id=="ad300X250-bottom"){var a=ta.retrieve("scrollAd.enableScroll");if(a){window.ta_handleScroll=ta.common.scrollAd.handleScroll;setTimeout(function(){window.addEvent("scroll",window.ta_handleScroll)},k)}}}j=true;delete l[f]}}if(j){var b=[];for(var f=0,g=l.length;f<g;f++){if(typeof l[f]!="undefined"){b.push(l[f])}}ta.store("deferAds.ads",b);if(b.length<1){window.removeEvent("scroll",window.ta_handleAdDefer)}}}catch(h){try{window.removeEvent("scroll",window.ta_handleAdDefer)}catch(h){}var c="ta.common.Ads.deferAds: Error with defer. ad IDs: "+ta.common.ads.getAdInfo();ta.util.error.record(h,c)}},getAdID:function(a){aIDs=this.getAdIDs(a);return(aIDs&&aIDs[a])?aIDs[a]:null},getAdIDs:function(b){var h=[];var a=ta.retrieve("ta.ads.adIDs")||[];var f=(b)?$$("#"+b):$$(".adInner");if(f){for(var d=0;d<f.length;d++){var g=f[d];if(a[g.id]){h[g.id]=a[g.id]}else{var c=this.scrapeAdId(g.id);if(c){h[g.id]=a[g.id]=c}}}}ta.store("ta.ads.adIDs",a);return h},scrapeAdId:function(g){var h;var a=/.*\/\w+;(\d{8,});.*/;var o=["noscript","a","iframe","param","script"];var q=false;try{var r=ta.id(g);var p=this.getAdServerDiv(r);if(p){for(var d=0;d<o.length;d++){var c=p.getElementsByTagName(o[d]);for(var b=0;b<c.length;b++){var m=(o[d]=="noscript")?c[b].textContent||c[b].innerHTML:c[b].href||c[b].src||c[b].value;if(m&&m.indexOf("doubleclick.net")>0){var f=decodeURIComponent(unescape(m)).match(a);if(f&&f.length>1){h=f[1];q=true;break}}}if(q){break}}}}catch(l){ta.util.error.record(l,"ta.common.Ads.scrapeAdId: Error scraping ad ID")}return h},getAdInfo:function(b){var b=this.getAdIDs();var c="";for(var a in b){if(b.hasOwnProperty(a)){c+=";"+a+":"+b[a]}}return(c.length)?c.substring(1):c},getAdServerDiv:function(b){b=ta.id(b);if(b){if(b.id=="ad728X90"){var c=b.getElement(".details");if(!c){return b.getElement(".adServer")}}var a=b.getElements("iframe");for(var d=0;d<a.length;d++){if(a[d].src.indexOf("adp/adp")>0){var f=a[d].contentDocument||a[d].contentWindow.document;return f.getElementById("adServer")}}}return null},addPixalateTracking:function(c){var b=["ad728X90","ad160X600","ad300X250","ad300X250-bottom"];if(c){var a=b.join(",")+",";if(a.indexOf(c+",")>-1){b=[c]}else{return}}b.each(function(g){var k=ta.common.ads.getAdServerDiv(g);if(k&&!k.getAttribute("tracked")){var o=ta.common.ads.getAdScript(k);var f=top.pageServlet||window.pageServlet||"none";var d=ta.common.ads.getScriptVal(o,"pos");var p=ta.common.ads.getScriptVal(o,"sz");if(p&&p.indexOf("%2C")){p=p.replace(/%2C.*/,"")}var m=ta.common.ads.getScriptVal(o,"kw");var l=ta.common.ads.getScriptVal(o,"pool");var h=PXL8_JS_SRC+"kv1="+f+";kv2="+d+";kv3="+p+";kv4="+m+";kv5="+l+";";var j=new Element("script",{type:"text/javascript",src:h});k.setAttribute("tracked","pxl8");k.appendChild(j)}})},getAdScript:function(d){if(!d){return null}var c=false;var f=/http(s)?:\/\/ad\.doubleclick\.net(\/N\d+)?\/adj.*/;var a=d.getElementsByTagName("script");for(var b=0;b<a.length;b++){var g=a[b];if(g&&g.src&&f.test(g.src)){c=g;break}}if(!c){ta.util.error.record(null,"ta.common.Ads.getAdScript: Ad script not found",null,{},"WARN")}return c?c.src:null},getScriptVal:function(d,b){if(d){var c=new RegExp(b+"=([\\w,+,%,-]+)");var a=d.match(c);return(a&&a.length==2)?a[1]:"none"}return"none"},getAssetDomains:function(g){var f=ta.id(g);var b=[];if(f){var d=f.getElements("script").concat(f.getElements("iframe"));for(var c=0;c<d.length;c++){if(d[c].src){var a=d[c].src.replace("http://","");a=(a.indexOf("/"))?a.substring(0,a.indexOf("/")):a;if(a.indexOf("doubleclick.net")==-1){b.push(a)}}}}return b.join("|")},scrapeAndLog:function(f,b,a){var d="Leaderboard Ad Latency:"+b;var c={};c.id=ta.common.ads.getAdID(f);c.domains=ta.common.ads.getAssetDomains(f);c.ipCntryId=(typeof ipCountryId!="undefined")?ipCountryId:null;if(a){c.loadMS=a}ta.util.error.record(null,d,null,c,"INFO")},refreshAdsWithStyle:function(a){if(a=="undefined"||a==""){a="none"}var d={triptype:a,kw:"none"};var c=ta.select(".sidebar .adInner");if(!ta.has("sponsor.active")){var b=ta.id("ad728X90");if(b){c.push(b)}}if(c.length){ta.common.ads.resetAdsOnPage(c,d)}}};linkMap.js_modifySub=function(a,b){modifySub.apply(a,[b])};rules["#NEWSLETTER_CALLOUT input.memberUpdateEmail[type=text]"]=function(a){$("memberUpdatesEmailDefault").hide();$(a.form).addEvent("submit",function(b){if(a.value==$("memberUpdatesEmailDefault").innerHTML){a.value=""}})};function alertIfEmpty(a){if(a&&a.value==""){if(msg=a.className.match(/\bmsg_([\w\d]+)\b/)){alert(window[msg[1]])}else{alert("The field can not be empty")}return false}return true}function addNonMember(c,b){if(!b){b=this}popupConfig.clickedElement=b;new Event(c).preventDefault();var a="/MemberBenefitsPopup";if(/pid(\d+)/.test(b.className)){a+="?pid="+RegExp.$1}showDHTMLPopup("MemberBenefitsPopup",a,true)}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}function clickNonMember(){setTimeout("window.lightbox.deactivate()",500);if(popupConfig.clickedElement==null){return}var a=popupConfig.clickedElement;popupConfig.clickedElement=null;$$("#TRAVEL_GUIDES_LANDER .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});$$("#TRAVEL_GUIDES_FLY .clickNonMember").each(function(c,b){c.removeEvent("click",addNonMember)});if(a.className.match(/\bclickPopDestMOGLink\b/)){processPopDestMOGLink(null,a)}else{if(a.get("tag")=="a"){window.location=a.getProperty("href")}else{a.click()}}}function processPopDestMOGLink(b,a){if(!a){a=this}if(!loggedIn){addNonMember(b,a)}else{processGuideLink(b,a)}}rules["#TRAVEL_GUIDES_LANDER .clickNonMember"]=rules["#TRAVEL_GUIDES_FLY .clickNonMember"]=function(a){if(a.get("tag")!="a"||!a.className.match(/\bskipATag\b/)){a.addEvent("click",addNonMember)}};rules["#TRAVEL_GUIDES_LANDER .clickPopDestMOGLink"]=function(a){a.addEvent("click",processPopDestMOGLink)};rules["#HELP_CENTER dl.js_toggleset"]=function(a){var c=0;var b=new ToggleSet(a.getElements("dt"),a.getElements("dd"));if(window.location.hash&&(hash=window.location.hash.match(/c(\d+)/))){b.display(parseInt(hash[1]))}};rules["#TAB_CONTAINER"]=ta.widgets.tabContainer;linkMap.js_replaceContentSet=function(c,f){var d=c.className.match(/set_([^\s"]*)?/);if(!d||d.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class set_??? to indicate the set of elements the contents of which should be replaced")}var a=c.className.match(/id_([^\s"]*)?/);if(!a||a.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}a=a[1];var b=$(a);if(!b){throw new Error("Element of id "+a+" does not exist.")}d=d[1];replaceContentSet(d,f,b.id)};var replaceContentSet=function(h,j,f){j=new Event(j);var b=$$("a.set_"+h);for(var c=0;c<b.length;c++){var k=b[c];var g=k.className.match(/id_([^\s"]*)?/);if(!g||g.length!=2){throw new Error("Links with behavior js_replaceContentSet must also have a style class id_??? to indicate which element's contents should be replaced")}g=g[1];var d=$(g);var a=k.href;if(c==b.length-1&&f){d.addEvent("onContentReplaced",function(){window.setTimeout(function(){window.location.hash=f},200)})}else{if(f){d.removeEvents("onContentReplaced")}}if(a){replaceContent(j,d,a)}}j.stop()};function vrCalculator(c,g){var f=g!=null?new Event(g):null;if(c&&/pid(\d+)/.test(c.className)){ta.util.cookie.setPIDCookie(RegExp.$1)}var b="";var a=$("homePageVRCalcPromo");if(!a){a=$("calculatorOverviewPromo")}if(!a){a=$("calculatorLanderPromo")}if(!a){a=$("expandedHomePageVRCalcPromo")}if(a&&$("vrCalculatorForm")){var d=a.getElement("#geoName");if(d.hasClass("focusClear")){d.value="";d.removeClass("focusClear")}b="&geoName="+a.getElement("#geoName").value;if(a.getElement("#adults")){b+="&adults="+a.getElement("#adults").value}if(a.getElement("#nights")){b+="&nights="+a.getElement("#nights").value}}new ta.overlays.CenteredOverlay({backdrop:ta.overlays.BACKDROP_ALWAYS,backdropClickClose:true,onReady:function(){this.inner.getElement("input").focus()}}).loadRemoteContent("/VacationRentalCalculator?restart=true"+b);if(f){f.stop()}return false}linkMap.js_submitVRCalculator=function(b,g){var d=g!=null?new Event(g):null;var h=$("vrCalculator");var c=h.getElement("form");var f=h.getElement(".serverErrorMsg");if(f){f.style.display="none"}if(c.geoName.value==""){h.getElement(".errorMsg").style.display=""}else{var a=c.action+"?"+c.toQueryString();replaceContent(g,h.getParent(),a)}if(d){d.stop()}return false};var SocialHistory=function(){var q={f:["http://www.facebook.com/","https://login.facebook.com/login.php","http://www.facebook.com/home.php"]};var m={};function o(v,u,t){if(v.currentStyle){var w=v.currentStyle[t]}else{if(window.getComputedStyle){var w=u.defaultView.getComputedStyle(v,null).getPropertyValue(t)}}return w}function k(t){t.parentNode.removeChild(t)}function r(){var t=document.createElement("iframe");t.style.position="absolute";t.style.visibility="hidden";document.body.appendChild(t);if(t.contentDocument){t.doc=t.contentDocument}else{if(t.contentWindow){t.doc=t.contentWindow.document}}t.doc.open();t.doc.write("<style>");t.doc.write("a{color: #000000; display:none;}");t.doc.write("a:visited {color: #FF0000; display:inline;}");t.doc.write("</style>");t.doc.close();return t}var h=r();function c(u,v){var t=h.doc.createElement("a");t.href=u;t.innerHTML=a;h.doc.body.appendChild(t)}for(var a in q){var p=q[a];for(var j=0;j<p.length;j++){c(p[j],a);if(p[j].match(/www\./)){var f=p[j].replace(/www\./,"");c(f,a)}else{var d=p[j].indexOf("//")+2;var g=p[j].substring(0,d)+"www."+p[j].substring(d);c(g,a)}}}var s=h.doc.body.childNodes;for(var j=0;j<s.length;j++){var l=o(s[j],h.doc,"display");var b=l!="none";if(b){m[s[j].innerHTML]=true}}k(h);return new (function(){var t=[];for(var u in m){t.push(u)}this.visitedSites=function(){return t};this.doesVisit=function(w){if(typeof(q[w])=="undefined"){return -1}return typeof(m[w])!="undefined"};var v=[];for(var u in q){v.push(u)}this.checkedSites=function(){return v}})()};function sniffFacebook(){var d=false;try{var a=SocialHistory();var b=a.visitedSites();if(b[0]=="f"){d=true}}catch(c){}return d}function registerOnLoad(b,a){if(ta&&ta.queueForLoad){ta.queueForLoad(b,a)}else{window.addEvent("load",b)}}function registerOnUnload(a){window.addEvent("unload",a)}function getScrollOffset(){return[window.getScrollLeft(),window.getScrollTop()]}function isIn(j,m,a){var d=getScrollOffset();m=$(m);var h=findPos(m);var f=h[0]-d[0];var k=h[1]-d[1];var c=f+m.clientWidth;var g=k+m.clientHeight;if(a){if(typeof(a)=="number"){f=f-a;k=k-a;c=c+a;g=g+a}else{if(a instanceof Array&&(a.length==2||a.length==4)){k=k-a[0];c=c+a[1];f=f-(a.length==4?a[3]:a[1]);g=g+(a.length==4?a[2]:a[0])}}}return(j[0]>=f&&j[0]<=c&&j[1]>=k&&j[1]<=g)}function setDetails(b,d,a,c){new Event(b).stop();$("title").value=d;$("category").value=a;$("space").value=c;$("newPage").submit()}function setOneTimeCookie(a,b){Cookie.write(a,b,{domain:cookieDomain,time:5});return true}var getChildByClass=function(f,d,c){if(!d||d.length==0){if(c==f.tagName){return f}}else{if(f.className&&(!c||c==f.tagName)){var g=-1;do{g=f.className.indexOf(d,g+1);if(g>=0&&(g==0||f.className.charCodeAt(g-1)==32)&&(g+d.length==f.className.length||f.className.charCodeAt(g+d.length)==32)){return f}}while(g>=0)}}for(var b=0;b<f.childNodes.length;b++){var a=getChildByClass(f.childNodes[b],d,c);if(a){return a}}return null};function showPrivacyPolicy(){window.open("/pages/privacy.html","PrivacyPolicy","toolbar=0,resizable=1,menubar=0,location=0,status=0,scrollbars=3,width=800,height=600,screenX=30,screenY=25,left=30,top=25")}ta.common.header={clear:function(b,a){a=ta.id(a);a.value="";a.removeClass("hasDefault");a.removeEvent("focus","ta.common.header.clear")},clearIfEquals:function(c,a,b){if(a.value==b){ta.run("ta.common.header.clear",{},c,a)}},setSearchText:function(d,b,c){b=ta.id(b);var a=b.getParent().getNext("input");a.value=c;a.addClass("hasDefault");a.addEvent("focus",function(f){ta.call("ta.common.header.clear",f,a)})},changeSearchType:function(j,b,g){b=ta.id(b);var d=b.getParent("form"),a=b.getParent().getNext("input"),f=a.getParent().getNext(),h=a.retrieve("nameTA"),c=a.retrieve("geoTA");ta.run("ta.common.header.setSearchText",{},j,b,g);if(b.id=="dropGeoRadio"){if(h){h.pause()}if(c){c.resume()}else{if(!ta.retrieve("hotelGeoTA")){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(k){a.store("geoTA",k)}},j,a,"GEO",function(){},{minLength:3})}}d.action="/HACSearch";f.show()}else{if(c){c.pause()}if(h){h.resume()}else{if(!ta.retrieve("hotelNameTA")){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(k){a.store("nameTA",k)}},j,a,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}d.action="/Search";f.hide()}},createDrop:function(c,a){a=ta.id(a);var b=a.getNext().getElement(".subNav");ta.run("ta.overlays.Factory.createDropDown",{},c,a,b)},firstClickHotelText:function(g,b,f){b=ta.id(b);var d=b.getParent("form"),a=ta.id("dropGeoRadio"),c=ta.retrieve("hotelNameTA");hasGeoTA=b.retrieve("hotelGeoTA");if(a.checked){if(!hasGeoTA){ta.store("hotelGeoTA",true);ta.run("ta.widgets.typeahead.factory.location_mutable",{onComplete:function(h){b.store("geoTA",h)}},g,b,"GEO",function(){},{minLength:3})}}else{if(!c){ta.store("hotelNameTA",true);ta.run("ta.widgets.typeahead.factory.standard_mutable",{onComplete:function(h){b.store("nameTA")}},g,b,"LOCATION","ta.widgets.typeahead.events.onSelectHotelDrop",{minLength:3,xargs:"&types=hotel"})}}ta.run("ta.common.header.clear",{},g,b);b.removePropertyEvent("focus","ta.common.header.firstClickHotelText")},stopEventProp:function(b,a){new Event(b).stopPropagation()},submitAndSetPid:function(c,b,a){setPID(a);form=b.getParent("form");if(a&&a==18898&&ta.id("dropVracGeo").value==""){window.location="/VacationRentals"}else{form.submit()}},submitHotelsForm:function(d,b,a){setPID(a);form=b.getParent("form");if(ta.has("useHotelsFilterState")){var c=form.toQueryString();new Request({url:"/FilterState",data:c,method:"post",onSuccess:function(f){ta.widgets.calendar.redirectToHotelOverview(f)},onFailure:function(f){ta.widgets.calendar.redirectToHotelOverview(null)}}).send()}else{form.submit()}},showFriendsOverlay:function(){var b=ta.id("FRIENDSTAB");var c=new ta.overlays.RelativeOverlayBelow({showCloseButton:true,showArrow:true,arrowClass:"ttarrow",activate:ta.overlays.ACTIVATE_BOTH,style:"fbtt"},b);ta.store("friendsToolTip",c);if(ta.retrieve("friends_1st_resize")){var a=false;window.addEvent("resize",function(){if(!a){a=true}else{ta.common.header.hideFriendsToolTip(true)}})}else{window.addEvent("resize",function(){ta.common.header.hideFriendsToolTip(true)})}},checkFriendsToolTip:function(){if(!ta.util.localstorage||!ta.util.localstorage.canUseLocalStore()){return}var b=false;try{var a="taFriendsToolTipShown";if(!localStorage.getItem(a)){localStorage.setItem(a,true);b=true}}catch(d){ta.util.error.record(d,"checkFriendsToolTip - localStorage",null,{},"WARN")}if(b){var c=ta.id("COOKIE_BANNER");if(!ta.overlays||!ta.overlays.RelativeOverlayBelow){if(typeof(taExtraOverlayJs)!="undefined"){new Asset.javascript(taExtraOverlayJs,{onload:ta.common.header.showFriendsOverlay})}}else{if(typeof(c)!="undefined"&&c){ta.common.header.showFriendsOverlay.delay(2000)}else{ta.common.header.showFriendsOverlay()}}}},hideFriendsToolTip:function(b){var a=ta.retrieve("friendsToolTip");if(a){a.hide();window.removeEvent("resize",ta.common.header.hideFriendsToolTip)}var c=ta.id("FRIENDSTAB");if(c&&(typeof(b)=="undefined"||(b!=true))){c.addClass("hidenew")}},adjustFriendsLink:function(b){var a=$("TAIPPREFS");if(a){if(a.hasClass("auth_ip")){ta.util.cookie.setPIDCookie(18783)}else{if(a.hasClass("auth_fbc")){ta.util.cookie.setPIDCookie(15210)}else{return true}}window.location="/Friends";return false}return true}};